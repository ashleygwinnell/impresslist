if(function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function r(a,b){return b.toUpperCase()}var c=[],d=a.document,e=c.slice,f=c.concat,g=c.push,h=c.indexOf,i={},j=i.toString,k=i.hasOwnProperty,l={},m="2.2.4",n=function(a,b){return new n.fn.init(a,b)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi;function s(a){var b=!!a&&"length"in a&&a.length,c=n.type(a);return"function"!==c&&!n.isWindow(a)&&("array"===c||0===b||"number"==typeof b&&0<b&&b-1 in a)}n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function(){return e.call(this)},get:function(a){return null!=a?a<0?this[a+this.length]:this[a]:e.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a){return n.each(this,a)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(e.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(0<=c&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:g,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],g!==(d=a[b])&&(j&&d&&(n.isPlainObject(d)||(e=n.isArray(d)))?(f=e?(e=!1,c&&n.isArray(c)?c:[]):c&&n.isPlainObject(c)?c:{},g[b]=n.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var b=a&&a.toString();return!n.isArray(a)&&0<=b-parseFloat(b)+1},isPlainObject:function(a){var b;if("object"!==n.type(a)||a.nodeType||n.isWindow(a))return!1;if(a.constructor&&!k.call(a,"constructor")&&!k.call(a.constructor.prototype||{},"isPrototypeOf"))return!1;for(b in a);return void 0===b||k.call(a,b)},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?i[j.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;(a=n.trim(a))&&(1===a.indexOf("use strict")?((b=d.createElement("script")).text=a,d.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(p,"ms-").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b){var c,d=0;if(s(a))for(c=a.length;d<c&&!1!==b.call(a[d],d,a[d]);d++);else for(d in a)if(!1===b.call(a[d],d,a[d]))break;return a},trim:function(a){return null==a?"":(a+"").replace(o,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):g.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:h.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var e=[],f=0,g=a.length,h=!c;f<g;f++)!b(a[f],f)!=h&&e.push(a[f]);return e},map:function(a,b,c){var d,e,g=0,h=[];if(s(a))for(d=a.length;g<d;g++)null!=(e=b(a[g],g,c))&&h.push(e);else for(g in a)null!=(e=b(a[g],g,c))&&h.push(e);return f.apply([],h)},guid:1,proxy:function(a,b){var c,d,f;return"string"==typeof b&&(c=a[b],b=a,a=c),n.isFunction(a)?(d=e.call(arguments,2),(f=function(){return a.apply(b||this,d.concat(e.call(arguments)))}).guid=a.guid=a.guid||n.guid++,f):void 0},now:Date.now,support:l}),"function"==typeof Symbol&&(n.fn[Symbol.iterator]=c[Symbol.iterator]),n.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,b){i["[object "+b+"]"]=b.toLowerCase()});var t=function(a){function ca(a,b,c){var d="0x"+b-65536;return d!=d||c?b:d<0?String.fromCharCode(65536+d):String.fromCharCode(d>>10|55296,1023&d|56320)}function da(){m()}var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ga(),z=ga(),A=ga(),B=function(a,b){return a===b&&(l=!0),0},D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+M+"))|)"+L+"*\\]",O=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+N+")*)|.*)\\)|)",P=new RegExp(L+"+","g"),Q=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),R=new RegExp("^"+L+"*,"+L+"*"),S=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),T=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),U=new RegExp(O),V=new RegExp("^"+M+"$"),W={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M+"|[*])"),ATTR:new RegExp("^"+N),PSEUDO:new RegExp("^"+O),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},X=/^(?:input|select|textarea|button)$/i,Y=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,$=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_=/[+~]/,aa=/'|\\/g,ba=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig");try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(ea){H={apply:E.length?function(a,b){G.apply(a,I.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}function fa(a,b,d,e){var f,h,j,k,l,o,r,s,w=b&&b.ownerDocument,x=b?b.nodeType:9;if(d=d||[],"string"!=typeof a||!a||1!==x&&9!==x&&11!==x)return d;if(!e&&((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,p)){if(11!==x&&(o=$.exec(a)))if(f=o[1]){if(9===x){if(!(j=b.getElementById(f)))return d;if(j.id===f)return d.push(j),d}else if(w&&(j=w.getElementById(f))&&t(b,j)&&j.id===f)return d.push(j),d}else{if(o[2])return H.apply(d,b.getElementsByTagName(a)),d;if((f=o[3])&&c.getElementsByClassName&&b.getElementsByClassName)return H.apply(d,b.getElementsByClassName(f)),d}if(c.qsa&&!A[a+" "]&&(!q||!q.test(a))){if(1!==x)w=b,s=a;else if("object"!==b.nodeName.toLowerCase()){for((k=b.getAttribute("id"))?k=k.replace(aa,"\\$&"):b.setAttribute("id",k=u),h=(r=g(a)).length,l=V.test(k)?"#"+k:"[id='"+k+"']";h--;)r[h]=l+" "+qa(r[h]);s=r.join(","),w=_.test(a)&&oa(b.parentNode)||b}if(s)try{return H.apply(d,w.querySelectorAll(s)),d}catch(y){}finally{k===u&&b.removeAttribute("id")}}}return i(a.replace(Q,"$1"),b,d,e)}function ga(){var a=[];return function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}}function ha(a){return a[u]=!0,a}function ia(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ja(a,b){for(var c=a.split("|"),e=c.length;e--;)d.attrHandle[c[e]]=b}function ka(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||1<<31)-(~a.sourceIndex||1<<31);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function la(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function na(a){return ha(function(b){return b=+b,ha(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function oa(a){return a&&void 0!==a.getElementsByTagName&&a}for(b in c=fa.support={},f=fa.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},m=fa.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement&&(o=(n=g).documentElement,p=!f(n),(e=n.defaultView)&&e.top!==e&&(e.addEventListener?e.addEventListener("unload",da,!1):e.attachEvent&&e.attachEvent("onunload",da)),c.attributes=ia(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ia(function(a){return a.appendChild(n.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=Z.test(n.getElementsByClassName),c.getById=ia(function(a){return o.appendChild(a).id=u,!n.getElementsByName||!n.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if(void 0!==b.getElementById&&p){var c=b.getElementById(a);return c?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ba,ca);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ba,ca);return function(a){var c=void 0!==a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return void 0!==b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"!==a)return f;for(;c=f[e++];)1===c.nodeType&&d.push(c);return d},d.find.CLASS=c.getElementsByClassName&&function(a,b){return void 0!==b.getElementsByClassName&&p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=Z.test(n.querySelectorAll))&&(ia(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\r\\' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ia(function(a){var b=n.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=Z.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ia(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",O)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=Z.test(o.compareDocumentPosition),t=b||Z.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d||(1&(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1)||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===n||a.ownerDocument===v&&t(v,a)?-1:b===n||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,g=[a],h=[b];if(!e||!f)return a===n?-1:b===n?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return ka(a,b);for(c=a;c=c.parentNode;)g.unshift(c);for(c=b;c=c.parentNode;)h.unshift(c);for(;g[d]===h[d];)d++;return d?ka(g[d],h[d]):g[d]===v?-1:h[d]===v?1:0}),n},fa.matches=function(a,b){return fa(a,null,null,b)},fa.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(T,"='$1']"),c.matchesSelector&&p&&!A[b+" "]&&(!r||!r.test(b))&&(!q||!q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return 0<fa(b,n,null,[a]).length},fa.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},fa.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},fa.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},fa.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){for(;b=a[f++];)b===a[f]&&(e=d.push(f));for(;e--;)a.splice(d[e],1)}return k=null,a},e=fa.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else for(;b=a[d++];)c+=e(b);return c},(d=fa.selectors={cacheLength:50,createPseudo:ha,match:W,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ba,ca),a[3]=(a[3]||a[4]||a[5]||"").replace(ba,ca),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||fa.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&fa.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return W.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&U.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ba,ca).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||void 0!==a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=fa.attr(d,a);return null==e?"!="===b:!b||(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&-1<e.indexOf(c):"$="===b?c&&e.slice(-c.length)===c:"~="===b?-1<(" "+e.replace(P," ")+" ").indexOf(c):"|="===b&&(e===c||e.slice(0,c.length+1)===c+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!=g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){for(;p;){for(m=b;m=m[p];)if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(t=(n=(j=(k=(l=(m=q)[u]||(m[u]={}))[m.uniqueID]||(l[m.uniqueID]={}))[a]||[])[0]===w&&j[1])&&j[2],m=n&&q.childNodes[n];m=++n&&m&&m[p]||(t=n=0)||o.pop();)if(1===m.nodeType&&++t&&m===b){k[a]=[w,n,t];break}}else if(s&&(t=n=(j=(k=(l=(m=b)[u]||(m[u]={}))[m.uniqueID]||(l[m.uniqueID]={}))[a]||[])[0]===w&&j[1]),!1===t)for(;(m=++n&&m&&m[p]||(t=n=0)||o.pop())&&((h?m.nodeName.toLowerCase()!==r:1!==m.nodeType)||!++t||(s&&((k=(l=m[u]||(m[u]={}))[m.uniqueID]||(l[m.uniqueID]={}))[a]=[w,t]),m!==b)););return(t-=e)===d||t%d==0&&0<=t/d}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||fa.error("unsupported pseudo: "+a);return e[u]?e(b):1<e.length?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ha(function(a,c){for(var d,f=e(a,b),g=f.length;g--;)a[d=J(a,f[g])]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ha(function(a){var b=[],c=[],d=h(a.replace(Q,"$1"));return d[u]?ha(function(a,b,c,e){for(var f,g=d(a,null,e,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ha(function(a){return function(b){return 0<fa(a,b).length}}),contains:ha(function(a){return a=a.replace(ba,ca),function(b){return-1<(b.textContent||b.innerText||e(b)).indexOf(a)}}),lang:ha(function(a){return V.test(a||"")||fa.error("unsupported lang: "+a),a=a.replace(ba,ca).toLowerCase(),function(b){var c;do{if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return(c=c.toLowerCase())===a||0===c.indexOf(a+"-")}while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Y.test(a.nodeName)},input:function(a){return X.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:na(function(){return[0]}),last:na(function(a,b){return[b-1]}),eq:na(function(a,b,c){return[c<0?c+b:c]}),even:na(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:na(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:na(function(a,b,c){for(var d=c<0?c+b:c;0<=--d;)a.push(d);return a}),gt:na(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}}).pseudos.nth=d.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=la(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=ma(b);function pa(){}function qa(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function ra(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j,k=[w,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if((h=(i=(j=b[u]||(b[u]={}))[b.uniqueID]||(j[b.uniqueID]={}))[d])&&h[0]===w&&h[1]===f)return k[2]=h[2];if((i[d]=k)[2]=a(b,c,g))return!0}}}function sa(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function ua(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function va(a,b,c,d,e,f){return d&&!d[u]&&(d=va(d)),e&&!e[u]&&(e=va(e,f)),ha(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||function(a,b,c){for(var d=0,e=b.length;d<e;d++)fa(a,b[d],c);return c}(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:ua(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d)for(j=ua(r,n),d(j,[],h,i),k=j.length;k--;)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l));if(f){if(e||a){if(e){for(j=[],k=r.length;k--;)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}for(k=r.length;k--;)(l=r[k])&&-1<(j=e?J(f,l):m[k])&&(f[j]=!(g[j]=l))}}else r=ua(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r)})}function wa(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=ra(function(a){return a===b},h,!0),l=ra(function(a){return-1<J(b,a)},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];i<f;i++)if(c=d.relative[a[i].type])m=[ra(sa(m),c)];else{if((c=d.filter[a[i].type].apply(null,a[i].matches))[u]){for(e=++i;e<f&&!d.relative[a[e].type];e++);return va(1<i&&sa(m),1<i&&qa(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(Q,"$1"),c,i<e&&wa(a.slice(i,e)),e<f&&wa(a=a.slice(e)),e<f&&qa(a))}m.push(c)}return sa(m)}function xa(a,b){var c=0<b.length,e=0<a.length,f=function(f,g,h,i,k){var l,o,q,r=0,s="0",t=f&&[],u=[],v=j,x=f||e&&d.find.TAG("*",k),y=w+=null==v?1:Math.random()||.1,z=x.length;for(k&&(j=g===n||g||k);s!==z&&null!=(l=x[s]);s++){if(e&&l){for(o=0,g||l.ownerDocument===n||(m(l),h=!p);q=a[o++];)if(q(l,g||n,h)){i.push(l);break}k&&(w=y)}c&&((l=!q&&l)&&r--,f&&t.push(l))}if(r+=s,c&&s!==r){for(o=0;q=b[o++];)q(t,u,g,h);if(f){if(0<r)for(;s--;)t[s]||u[s]||(u[s]=F.call(i));u=ua(u)}H.apply(i,u),k&&!f&&0<u.length&&1<r+b.length&&fa.uniqueSort(i)}return k&&(w=y,j=v),t};return c?ha(f):f}return pa.prototype=d.filters=d.pseudos,d.setFilters=new pa,g=fa.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);for(h=a,i=[],j=d.preFilter;h;){for(g in c&&!(e=R.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=S.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(Q," ")}),h=h.slice(c.length)),d.filter)!(e=W[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?fa.error(a):z(a,i).slice(0)},h=fa.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){for(c=(b=b||g(a)).length;c--;)(f=wa(b[c]))[u]?d.push(f):e.push(f);(f=A(a,xa(e,d))).selector=a}return f},i=fa.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(2<(j=o[0]=o[0].slice(0)).length&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(!(b=(d.find.ID(k.matches[0].replace(ba,ca),b)||[])[0]))return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}for(i=W.needsContext.test(a)?0:j.length;i--&&(k=j[i],!d.relative[l=k.type]);)if((m=d.find[l])&&(f=m(k.matches[0].replace(ba,ca),_.test(j[0].type)&&oa(b.parentNode)||b))){if(j.splice(i,1),!(a=f.length&&qa(j)))return H.apply(e,f),e;break}}return(n||h(a,o))(f,b,!p,e,!b||_.test(a)&&oa(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ia(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),ia(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ja("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ia(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ja("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),ia(function(a){return null==a.getAttribute("disabled")})||ja(K,function(a,b,c){var d;return c?void 0:!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),fa}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.uniqueSort=n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;function u(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&n(a).is(c))break;d.push(a)}return d}function v(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}var w=n.expr.match.needsContext,x=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,y=/^.[^:#\[\.,]*$/;function z(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(y.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return-1<h.call(b,a)!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;b<c;b++)if(n.contains(e[b],this))return!0}));for(b=0;b<c;b++)n.find(a,e[b],d);return(d=this.pushStack(1<c?n.unique(d):d)).selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(z(this,a||[],!1))},not:function(a){return this.pushStack(z(this,a||[],!0))},is:function(a){return!!z(this,"string"==typeof a&&w.test(a)?n(a):a||[],!1).length}});var A,B=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(n.fn.init=function(a,b,c){var e,f;if(!a)return this;if(c=c||A,"string"!=typeof a)return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?void 0!==c.ready?c.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this));if(!(e="<"===a[0]&&">"===a[a.length-1]&&3<=a.length?[null,a,null]:B.exec(a))||!e[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(e[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(e[1],b&&b.nodeType?b.ownerDocument||b:d,!0)),x.test(e[1])&&n.isPlainObject(b))for(e in b)n.isFunction(this[e])?this[e](b[e]):this.attr(e,b[e]);return this}return(f=d.getElementById(e[2]))&&f.parentNode&&(this.length=1,this[0]=f),this.context=d,this.selector=a,this}).prototype=n.fn,A=n(d);var D=/^(?:parents|prev(?:Until|All))/,E={children:!0,contents:!0,next:!0,prev:!0};function F(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}n.fn.extend({has:function(a){var b=n(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(n.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=w.test(a)||"string"!=typeof a?n(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?-1<g.index(c):1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(1<f.length?n.uniqueSort(f):f)},index:function(a){return a?"string"==typeof a?h.call(n(a),this[0]):h.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.uniqueSort(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return u(a,"parentNode")},parentsUntil:function(a,b,c){return u(a,"parentNode",c)},next:function(a){return F(a,"nextSibling")},prev:function(a){return F(a,"previousSibling")},nextAll:function(a){return u(a,"nextSibling")},prevAll:function(a){return u(a,"previousSibling")},nextUntil:function(a,b,c){return u(a,"nextSibling",c)},prevUntil:function(a,b,c){return u(a,"previousSibling",c)},siblings:function(a){return v((a.parentNode||{}).firstChild,a)},children:function(a){return v(a.firstChild)},contents:function(a){return a.contentDocument||n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),1<this.length&&(E[a]||n.uniqueSort(e),D.test(a)&&e.reverse()),this.pushStack(e)}});var I,G=/\S+/g;function J(){d.removeEventListener("DOMContentLoaded",J),a.removeEventListener("load",J),n.ready()}n.Callbacks=function(a){a="string"==typeof a?function(a){var b={};return n.each(a.match(G)||[],function(a,c){b[c]=!0}),b}(a):n.extend({},a);function i(){for(e=a.once,d=b=!0;g.length;h=-1)for(c=g.shift();++h<f.length;)!1===f[h].apply(c[0],c[1])&&a.stopOnFalse&&(h=f.length,c=!1);a.memory||(c=!1),b=!1,e&&(f=c?[]:"")}var b,c,d,e,f=[],g=[],h=-1,j={add:function(){return f&&(c&&!b&&(h=f.length-1,g.push(c)),function d(b){n.each(b,function(b,c){n.isFunction(c)?a.unique&&j.has(c)||f.push(c):c&&c.length&&"string"!==n.type(c)&&d(c)})}(arguments),c&&!b&&i()),this},remove:function(){return n.each(arguments,function(a,b){for(var c;-1<(c=n.inArray(b,f,c));)f.splice(c,1),c<=h&&h--}),this},has:function(a){return a?-1<n.inArray(a,f):0<f.length},empty:function(){return f=f&&[],this},disable:function(){return e=g=[],f=c="",this},disabled:function(){return!f},lock:function(){return e=g=[],c||(f=c=""),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=[a,(c=c||[]).slice?c.slice():c],g.push(c),b||i()),this},fire:function(){return j.fireWith(this,arguments),this},fired:function(){return!!d}};return j},n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().progress(c.notify).done(c.resolve).fail(c.reject):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){function h(a,b,c){return function(d){b[a]=this,c[a]=1<arguments.length?e.call(arguments):d,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}}var i,j,k,b=0,c=e.call(arguments),d=c.length,f=1!==d||a&&n.isFunction(a.promise)?d:0,g=1===f?a:n.Deferred();if(1<d)for(i=new Array(d),j=new Array(d),k=new Array(d);b<d;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().progress(h(b,j,i)).done(h(b,k,c)).fail(g.reject):--f;return f||g.resolveWith(k,c),g.promise()}}),n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){(!0===a?--n.readyWait:n.isReady)||((n.isReady=!0)!==a&&0<--n.readyWait||(I.resolveWith(d,[n]),n.fn.triggerHandler&&(n(d).triggerHandler("ready"),n(d).off("ready"))))}}),n.ready.promise=function(b){return I||(I=n.Deferred(),"complete"===d.readyState||"loading"!==d.readyState&&!d.documentElement.doScroll?a.setTimeout(n.ready):(d.addEventListener("DOMContentLoaded",J),a.addEventListener("load",J))),I.promise(b)},n.ready.promise();function L(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType}var K=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c))for(h in e=!0,c)K(a,b,h,c[h],!0,f,g);else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(b=g?(b.call(a,d),null):(j=b,function(a,b,c){return j.call(n(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};function M(){this.expando=n.expando+M.uid++}M.uid=1,M.prototype={register:function(a,b){var c=b||{};return a.nodeType?a[this.expando]=c:Object.defineProperty(a,this.expando,{value:c,writable:!0,configurable:!0}),a[this.expando]},cache:function(a){if(!L(a))return{};var b=a[this.expando];return b||(b={},L(a)&&(a.nodeType?a[this.expando]=b:Object.defineProperty(a,this.expando,{value:b,configurable:!0}))),b},set:function(a,b,c){var d,e=this.cache(a);if("string"==typeof b)e[b]=c;else for(d in b)e[d]=b[d];return e},get:function(a,b){return void 0===b?this.cache(a):a[this.expando]&&a[this.expando][b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?void 0!==(d=this.get(a,b))?d:this.get(a,n.camelCase(b)):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=a[this.expando];if(void 0!==f){if(void 0===b)this.register(a);else{c=(d=n.isArray(b)?b.concat(b.map(n.camelCase)):(e=n.camelCase(b),b in f?[b,e]:(d=e)in f?[d]:d.match(G)||[])).length;for(;c--;)delete f[d[c]]}void 0!==b&&!n.isEmptyObject(f)||(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){var b=a[this.expando];return void 0!==b&&!n.isEmptyObject(b)}};var N=new M,O=new M,P=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Q=/[A-Z]/g;function R(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(Q,"-$&").toLowerCase(),"string"==typeof(c=a.getAttribute(d))){try{c="true"===c||"false"!==c&&("null"===c?null:+c+""===c?+c:P.test(c)?n.parseJSON(c):c)}catch(e){}O.set(a,b,c)}else c=void 0;return c}n.extend({hasData:function(a){return O.hasData(a)||N.hasData(a)},data:function(a,b,c){return O.access(a,b,c)},removeData:function(a,b){O.remove(a,b)},_data:function(a,b,c){return N.access(a,b,c)},_removeData:function(a,b){N.remove(a,b)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0!==a)return"object"==typeof a?this.each(function(){O.set(this,a)}):K(this,function(b){var c,d;if(f&&void 0===b){if(void 0!==(c=O.get(f,a)||O.get(f,a.replace(Q,"-$&").toLowerCase())))return c;if(d=n.camelCase(a),void 0!==(c=O.get(f,d)))return c;if(void 0!==(c=R(f,d,void 0)))return c}else d=n.camelCase(a),this.each(function(){var c=O.get(this,d);O.set(this,d,b),-1<a.indexOf("-")&&void 0!==c&&O.set(this,a,b)})},null,b,1<arguments.length,null,!0);if(this.length&&(e=O.get(f),1===f.nodeType&&!N.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(0===(d=g[c].name).indexOf("data-")&&(d=n.camelCase(d.slice(5)),R(f,d,e[d])));N.set(f,"hasDataAttrs",!0)}return e},removeData:function(a){return this.each(function(){O.remove(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=N.get(a,b),c&&(!d||n.isArray(c)?d=N.access(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b);"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,function(){n.dequeue(a,b)},f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return N.get(a,c)||N.access(a,c,{empty:n.Callbacks("once memory").add(function(){N.remove(a,[b+"queue",c])})})}}),n.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){function h(){--d||e.resolveWith(f,[f])}var c,d=1,e=n.Deferred(),f=this,g=this.length;for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)(c=N.get(f[g],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});function V(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)}var S=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=new RegExp("^(?:([+-])=|)("+S+")([a-z%]*)$","i"),U=["Top","Right","Bottom","Left"];function W(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return n.css(a,b,"")},i=h(),j=c&&c[3]||(n.cssNumber[b]?"":"px"),k=(n.cssNumber[b]||"px"!==j&&+i)&&T.exec(n.css(a,b));if(k&&k[3]!==j)for(j=j||k[3],c=c||[],k=+i||1;k/=f=f||".5",n.style(a,b,k+j),f!==(f=h()/i)&&1!==f&&--g;);return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}var X=/^(?:checkbox|radio)$/i,Y=/<([\w:-]+)/,Z=/^$|\/(?:java|ecma)script/i,$={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function _(a,b){var c=void 0!==a.getElementsByTagName?a.getElementsByTagName(b||"*"):void 0!==a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&n.nodeName(a,b)?n.merge([a],c):c}function aa(a,b){for(var c=0,d=a.length;c<d;c++)N.set(a[c],"globalEval",!b||N.get(b[c],"globalEval"))}$.optgroup=$.option,$.tbody=$.tfoot=$.colgroup=$.caption=$.thead,$.th=$.td;var ba=/<|&#?\w+;/;function ca(a,b,c,d,e){for(var f,g,h,i,j,k,l=b.createDocumentFragment(),m=[],o=0,p=a.length;o<p;o++)if((f=a[o])||0===f)if("object"===n.type(f))n.merge(m,f.nodeType?[f]:f);else if(ba.test(f)){for(g=g||l.appendChild(b.createElement("div")),h=(Y.exec(f)||["",""])[1].toLowerCase(),i=$[h]||$._default,g.innerHTML=i[1]+n.htmlPrefilter(f)+i[2],k=i[0];k--;)g=g.lastChild;n.merge(m,g.childNodes),(g=l.firstChild).textContent=""}else m.push(b.createTextNode(f));for(l.textContent="",o=0;f=m[o++];)if(d&&-1<n.inArray(f,d))e&&e.push(f);else if(j=n.contains(f.ownerDocument,f),g=_(l.appendChild(f),"script"),j&&aa(g),c)for(k=0;f=g[k++];)Z.test(f.type||"")&&c.push(f);return l}!function(){var b=d.createDocumentFragment().appendChild(d.createElement("div")),c=d.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),l.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",l.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var da=/^key/,ea=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,fa=/^([^.]*)(?:\.(.+)|)/;function ga(){return!0}function ha(){return!1}function ia(){try{return d.activeElement}catch(a){}}function ja(a,b,c,d,e,f){var g,h;if("object"==typeof b){for(h in"string"!=typeof c&&(d=d||c,c=void 0),b)ja(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),!1===e)e=ha;else if(!e)return a;return 1===f&&(g=e,(e=function(a){return n().off(a),g.apply(this,arguments)}).guid=g.guid||(g.guid=n.guid++)),a.each(function(){n.event.add(this,b,e,d,c)})}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=N.get(a);if(r)for(c.handler&&(c=(f=c).handler,e=f.selector),c.guid||(c.guid=n.guid++),(i=r.events)||(i=r.events={}),(g=r.handle)||(g=r.handle=function(b){return void 0!==n&&n.event.triggered!==b.type?n.event.dispatch.apply(a,arguments):void 0}),j=(b=(b||"").match(G)||[""]).length;j--;)o=q=(h=fa.exec(b[j])||[])[1],p=(h[2]||"").split(".").sort(),o&&(l=n.event.special[o]||{},o=(e?l.delegateType:l.bindType)||o,l=n.event.special[o]||{},k=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},f),(m=i[o])||((m=i[o]=[]).delegateCount=0,l.setup&&!1!==l.setup.call(a,d,p,g)||a.addEventListener&&a.addEventListener(o,g)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),n.event.global[o]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=N.hasData(a)&&N.get(a);if(r&&(i=r.events)){for(j=(b=(b||"").match(G)||[""]).length;j--;)if(o=q=(h=fa.exec(b[j])||[])[1],p=(h[2]||"").split(".").sort(),o){for(l=n.event.special[o]||{},m=i[o=(d?l.delegateType:l.bindType)||o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&q!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&!1!==l.teardown.call(a,p,r.handle)||n.removeEvent(a,o,r.handle),delete i[o])}else for(o in i)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(i)&&N.remove(a,"handle events")}},dispatch:function(a){a=n.event.fix(a);var b,c,d,f,g,h=[],i=e.call(arguments),j=(N.get(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if((i[0]=a).delegateTarget=this,!k.preDispatch||!1!==k.preDispatch.call(this,a)){for(h=n.event.handlers.call(this,a,j),b=0;(f=h[b++])&&!a.isPropagationStopped();)for(a.currentTarget=f.elem,c=0;(g=f.handlers[c++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(g.namespace)||(a.handleObj=g,a.data=g.data,void 0!==(d=((n.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i))&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation()));return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&("click"!==a.type||isNaN(a.button)||a.button<1))for(;i!==this;i=i.parentNode||this)if(1===i.nodeType&&(!0!==i.disabled||"click"!==a.type)){for(d=[],c=0;c<h;c++)void 0===d[e=(f=b[c]).selector+" "]&&(d[e]=f.needsContext?-1<n(e,this).index(i):n.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,e,f,g=b.button;return null==a.pageX&&null!=b.clientX&&(e=(c=a.target.ownerDocument||d).documentElement,f=c.body,a.pageX=b.clientX+(e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&f.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||f&&f.clientTop||0)),a.which||void 0===g||(a.which=1&g?1:2&g?3:4&g?2:0),a}},fix:function(a){if(a[n.expando])return a;var b,c,e,f=a.type,g=a,h=this.fixHooks[f];for(h||(this.fixHooks[f]=h=ea.test(f)?this.mouseHooks:da.test(f)?this.keyHooks:{}),e=h.props?this.props.concat(h.props):this.props,a=new n.Event(g),b=e.length;b--;)a[c=e[b]]=g[c];return a.target||(a.target=d),3===a.target.nodeType&&(a.target=a.target.parentNode),h.filter?h.filter(a,g):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==ia()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===ia()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&n.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}},n.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?ga:ha):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={constructor:n.Event,isDefaultPrevented:ha,isPropagationStopped:ha,isImmediatePropagationStopped:ha,isSimulated:!1,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=ga,a&&!this.isSimulated&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=ga,a&&!this.isSimulated&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=ga,a&&!this.isSimulated&&a.stopImmediatePropagation(),this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,e=a.relatedTarget,f=a.handleObj;return e&&(e===this||n.contains(this,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),n.fn.extend({on:function(a,b,c,d){return ja(this,a,b,c,d)},one:function(a,b,c,d){return ja(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"!=typeof a)return!1!==b&&"function"!=typeof b||(c=b,b=void 0),!1===c&&(c=ha),this.each(function(){n.event.remove(this,a,c,b)});for(e in a)this.off(e,b,a[e]);return this}});var ka=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,la=/<script|<style|<link/i,ma=/checked\s*(?:[^=]|=\s*.checked.)/i,na=/^true\/(.*)/,oa=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function pa(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function qa(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function ra(a){var b=na.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function sa(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(N.hasData(a)&&(f=N.access(a),g=N.set(b,f),j=f.events))for(e in delete g.handle,g.events={},j)for(c=0,d=j[e].length;c<d;c++)n.event.add(b,e,j[e][c]);O.hasData(a)&&(h=O.access(a),i=n.extend({},h),O.set(b,i))}}function ta(a,b){var c=b.nodeName.toLowerCase();"input"===c&&X.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function ua(a,b,c,d){b=f.apply([],b);var e,g,h,i,j,k,m=0,o=a.length,p=o-1,q=b[0],r=n.isFunction(q);if(r||1<o&&"string"==typeof q&&!l.checkClone&&ma.test(q))return a.each(function(e){var f=a.eq(e);r&&(b[0]=q.call(this,e,f.html())),ua(f,b,c,d)});if(o&&(g=(e=ca(b,a[0].ownerDocument,!1,a,d)).firstChild,1===e.childNodes.length&&(e=g),g||d)){for(i=(h=n.map(_(e,"script"),qa)).length;m<o;m++)j=e,m!==p&&(j=n.clone(j,!0,!0),i&&n.merge(h,_(j,"script"))),c.call(a[m],j,m);if(i)for(k=h[h.length-1].ownerDocument,n.map(h,ra),m=0;m<i;m++)j=h[m],Z.test(j.type||"")&&!N.access(j,"globalEval")&&n.contains(k,j)&&(j.src?n._evalUrl&&n._evalUrl(j.src):n.globalEval(j.textContent.replace(oa,"")))}return a}function va(a,b,c){for(var d,e=b?n.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||n.cleanData(_(d)),d.parentNode&&(c&&n.contains(d.ownerDocument,d)&&aa(_(d,"script")),d.parentNode.removeChild(d));return a}n.extend({htmlPrefilter:function(a){return a.replace(ka,"<$1></$2>")},clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=n.contains(a.ownerDocument,a);if(!(l.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(g=_(h),d=0,e=(f=_(a)).length;d<e;d++)ta(f[d],g[d]);if(b)if(c)for(f=f||_(a),g=g||_(h),d=0,e=f.length;d<e;d++)sa(f[d],g[d]);else sa(a,h);return 0<(g=_(h,"script")).length&&aa(g,!i&&_(a,"script")),h},cleanData:function(a){for(var b,c,d,e=n.event.special,f=0;void 0!==(c=a[f]);f++)if(L(c)){if(b=c[N.expando]){if(b.events)for(d in b.events)e[d]?n.event.remove(c,d):n.removeEvent(c,d,b.handle);c[N.expando]=void 0}c[O.expando]&&(c[O.expando]=void 0)}}}),n.fn.extend({domManip:ua,detach:function(a){return va(this,a,!0)},remove:function(a){return va(this,a)},text:function(a){return K(this,function(a){return void 0===a?n.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return ua(this,arguments,function(a){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||pa(this,a).appendChild(a)})},prepend:function(){return ua(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=pa(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return ua(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return ua(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(n.cleanData(_(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return K(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!la.test(a)&&!$[(Y.exec(a)||["",""])[1].toLowerCase()]){a=n.htmlPrefilter(a);try{for(;c<d;c++)1===(b=this[c]||{}).nodeType&&(n.cleanData(_(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return ua(this,arguments,function(b){var c=this.parentNode;n.inArray(this,a)<0&&(n.cleanData(_(this)),c&&c.replaceChild(b,this))},a)}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=[],e=n(a),f=e.length-1,h=0;h<=f;h++)c=h===f?this:this.clone(!0),n(e[h])[b](c),g.apply(d,c.get());return this.pushStack(d)}});var wa,xa={HTML:"block",BODY:"block"};function ya(a,b){var c=n(b.createElement(a)).appendTo(b.body),d=n.css(c[0],"display");return c.detach(),d}function za(a){var b=d,c=xa[a];return c||("none"!==(c=ya(a,b))&&c||((b=(wa=(wa||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement))[0].contentDocument).write(),b.close(),c=ya(a,b),wa.detach()),xa[a]=c),c}function Da(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];for(f in e=c.apply(a,d||[]),b)a.style[f]=g[f];return e}var Aa=/^margin/,Ba=new RegExp("^("+S+")(?!px)[a-z%]+$","i"),Ca=function(b){var c=b.ownerDocument.defaultView;return c&&c.opener||(c=a),c.getComputedStyle(b)},Ea=d.documentElement;function Fa(a,b,c){var d,e,f,g,h=a.style;return""!==(g=(c=c||Ca(a))?c.getPropertyValue(b)||c[b]:void 0)&&void 0!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),c&&!l.pixelMarginRight()&&Ba.test(g)&&Aa.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f),void 0!==g?g+"":g}function Ga(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,e,f,g=d.createElement("div"),h=d.createElement("div");if(h.style){function i(){h.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",h.innerHTML="",Ea.appendChild(g);var d=a.getComputedStyle(h);b="1%"!==d.top,f="2px"===d.marginLeft,c="4px"===d.width,h.style.marginRight="50%",e="4px"===d.marginRight,Ea.removeChild(g)}h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===h.style.backgroundClip,g.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",g.appendChild(h),n.extend(l,{pixelPosition:function(){return i(),b},boxSizingReliable:function(){return null==c&&i(),c},pixelMarginRight:function(){return null==c&&i(),e},reliableMarginLeft:function(){return null==c&&i(),f},reliableMarginRight:function(){var b,c=h.appendChild(d.createElement("div"));return c.style.cssText=h.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",h.style.width="1px",Ea.appendChild(g),b=!parseFloat(a.getComputedStyle(c).marginRight),Ea.removeChild(g),h.removeChild(c),b}})}}();var Ha=/^(none|table(?!-c[ea]).+)/,Ia={position:"absolute",visibility:"hidden",display:"block"},Ja={letterSpacing:"0",fontWeight:"400"},Ka=["Webkit","O","Moz","ms"],La=d.createElement("div").style;function Ma(a){if(a in La)return a;for(var b=a[0].toUpperCase()+a.slice(1),c=Ka.length;c--;)if((a=Ka[c]+b)in La)return a}function Na(a,b,c){var d=T.exec(b);return d?Math.max(0,d[2]-(c||0))+(d[3]||"px"):b}function Oa(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;f<4;f+=2)"margin"===c&&(g+=n.css(a,c+U[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+U[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+U[f]+"Width",!0,e))):(g+=n.css(a,"padding"+U[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+U[f]+"Width",!0,e)));return g}function Pa(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ca(a),g="border-box"===n.css(a,"boxSizing",!1,f);if(e<=0||null==e){if(((e=Fa(a,b,f))<0||null==e)&&(e=a.style[b]),Ba.test(e))return e;d=g&&(l.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Oa(a,b,c||(g?"border":"content"),d,f)+"px"}function Qa(a,b){for(var c,d,e,f=[],g=0,h=a.length;g<h;g++)(d=a[g]).style&&(f[g]=N.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&V(d)&&(f[g]=N.access(d,"olddisplay",za(d.nodeName)))):(e=V(d),"none"===c&&e||N.set(d,"olddisplay",e?c:n.css(d,"display"))));for(g=0;g<h;g++)(d=a[g]).style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function Ra(a,b,c,d,e){return new Ra.prototype.init(a,b,c,d,e)}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Fa(a,"opacity");return""===c?"1":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;return b=n.cssProps[h]||(n.cssProps[h]=Ma(h)||h),g=n.cssHooks[b]||n.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:("string"===(f=typeof c)&&(e=T.exec(c))&&e[1]&&(c=W(a,b,e),f="number"),void(null!=c&&c==c&&("number"===f&&(c+=e&&e[3]||(n.cssNumber[h]?"":"px")),l.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c))))}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Ma(h)||h),(g=n.cssHooks[b]||n.cssHooks[h])&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=Fa(a,b,d)),"normal"===e&&b in Ja&&(e=Ja[b]),""===c||c?(f=parseFloat(e),!0===c||isFinite(f)?f||0:e):e}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?Ha.test(n.css(a,"display"))&&0===a.offsetWidth?Da(a,Ia,function(){return Pa(a,b,d)}):Pa(a,b,d):void 0},set:function(a,c,d){var e,f=d&&Ca(a),g=d&&Oa(a,b,d,"border-box"===n.css(a,"boxSizing",!1,f),f);return g&&(e=T.exec(c))&&"px"!==(e[3]||"px")&&(a.style[b]=c,c=n.css(a,b)),Na(0,c,g)}}}),n.cssHooks.marginLeft=Ga(l.reliableMarginLeft,function(a,b){return b?(parseFloat(Fa(a,"marginLeft"))||a.getBoundingClientRect().left-Da(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+"px":void 0}),n.cssHooks.marginRight=Ga(l.reliableMarginRight,function(a,b){return b?Da(a,{display:"inline-block"},Fa,[a,"marginRight"]):void 0}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+U[d]+b]=f[d]||f[d-2]||f[0];return e}},Aa.test(a)||(n.cssHooks[a+b].set=Na)}),n.fn.extend({css:function(a,b){return K(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=Ca(a),e=b.length;g<e;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)},a,b,1<arguments.length)},show:function(){return Qa(this,!0)},hide:function(){return Qa(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){V(this)?n(this).show():n(this).hide()})}}),((n.Tween=Ra).prototype={constructor:Ra,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||n.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=Ra.propHooks[this.prop];return a&&a.get?a.get(this):Ra.propHooks._default.get(this)},run:function(a){var b,c=Ra.propHooks[this.prop];return this.options.duration?this.pos=b=n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Ra.propHooks._default.set(this),this}}).init.prototype=Ra.prototype,(Ra.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=n.css(a.elem,a.prop,""))&&"auto"!==b?b:0},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[n.cssProps[a.prop]]&&!n.cssHooks[a.prop]?a.elem[a.prop]=a.now:n.style(a.elem,a.prop,a.now+a.unit)}}}).scrollTop=Ra.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"},n.fx=Ra.prototype.init,n.fx.step={};var Sa,Ta,Ua=/^(?:toggle|show|hide)$/,Va=/queueHooks$/;function Wa(){return a.setTimeout(function(){Sa=void 0}),Sa=n.now()}function Xa(a,b){var c,d=0,e={height:a};for(b=b?1:0;d<4;d+=2-b)e["margin"+(c=U[d])]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function Ya(a,b,c){for(var d,e=(_a.tweeners[b]||[]).concat(_a.tweeners["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function _a(a,b,c){var d,e,f=0,g=_a.prefilters.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Sa||Wa(),c=Math.max(0,j.startTime+j.duration-b),f=1-(c/j.duration||0),g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{},easing:n.easing._default},c),originalProperties:b,originalOptions:c,startTime:Sa||Wa(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for(function(a,b){var c,d,e,f,g;for(c in a)if(e=b[d=n.camelCase(c)],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(g=n.cssHooks[d])&&"expand"in g)for(c in f=g.expand(f),delete a[d],f)c in a||(a[c]=f[c],b[c]=e);else b[d]=e}(k,j.opts.specialEasing);f<g;f++)if(d=_a.prefilters[f].call(j,a,k,j.opts))return n.isFunction(d.stop)&&(n._queueHooks(j.elem,j.opts.queue).stop=n.proxy(d.stop,d)),d;return n.map(k,Ya,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(_a,{tweeners:{"*":[function(a,b){var c=this.createTween(a,b);return W(c.elem,a,T.exec(b),c),c}]},tweener:function(a,b){for(var c,d=0,e=(a=n.isFunction(a)?(b=a,["*"]):a.match(G)).length;d<e;d++)c=a[d],_a.tweeners[c]=_a.tweeners[c]||[],_a.tweeners[c].unshift(b)},prefilters:[function(a,b,c){var d,e,f,g,h,i,j,l=this,m={},o=a.style,p=a.nodeType&&V(a),q=N.get(a,"fxshow");for(d in c.queue||(null==(h=n._queueHooks(a,"fx")).unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],"inline"===("none"===(j=n.css(a,"display"))?N.get(a,"olddisplay")||za(a.nodeName):j)&&"none"===n.css(a,"float")&&(o.display="inline-block")),c.overflow&&(o.overflow="hidden",l.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]})),b)if(e=b[d],Ua.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}m[d]=q&&q[d]||n.style(a,d)}else j=void 0;if(n.isEmptyObject(m))"inline"===("none"===j?za(a.nodeName):j)&&(o.display=j);else for(d in q?"hidden"in q&&(p=q.hidden):q=N.access(a,"fxshow",{}),f&&(q.hidden=!p),p?n(a).show():l.done(function(){n(a).hide()}),l.done(function(){var b;for(b in N.remove(a,"fxshow"),m)n.style(a,b,m[b])}),m)g=Ya(p?q[d]:0,d,l),d in q||(q[d]=g.start,p&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}],prefilter:function(a,b){b?_a.prefilters.unshift(a):_a.prefilters.push(a)}}),n.speed=function(a,b,c){var d=a&&"object"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,null!=d.queue&&!0!==d.queue||(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(V).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){var b=_a(this,n.extend({},a),f);(e||N.get(this,"finish"))&&b.stop(!0)}var e=n.isEmptyObject(a),f=n.speed(b,c,d);return g.finish=g,e||!1===f.queue?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){function d(a){var b=a.stop;delete a.stop,b(c)}return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=N.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Va.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||n.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var b,c=N.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(Xa(b,!0),a,d,e)}}),n.each({slideDown:Xa("show"),slideUp:Xa("hide"),slideToggle:Xa("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=0,c=n.timers;for(Sa=n.now();b<c.length;b++)(a=c[b])()||c[b]!==a||c.splice(b--,1);c.length||n.fx.stop(),Sa=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){Ta=Ta||a.setInterval(n.fx.tick,n.fx.interval)},n.fx.stop=function(){a.clearInterval(Ta),Ta=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(b,c){return b=n.fx&&n.fx.speeds[b]||b,c=c||"fx",this.queue(c,function(c,d){var e=a.setTimeout(c,b);d.stop=function(){a.clearTimeout(e)}})},function(){var a=d.createElement("input"),b=d.createElement("select"),c=b.appendChild(d.createElement("option"));a.type="checkbox",l.checkOn=""!==a.value,l.optSelected=c.selected,b.disabled=!0,l.optDisabled=!c.disabled,(a=d.createElement("input")).value="t",a.type="radio",l.radioValue="t"===a.value}();var ab,bb=n.expr.attrHandle;n.fn.extend({attr:function(a,b){return K(this,n.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return void 0===a.getAttribute?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),e=n.attrHooks[b]||(n.expr.match.bool.test(b)?ab:void 0)),void 0!==c?null===c?void n.removeAttr(a,b):e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+""),c):e&&"get"in e&&null!==(d=e.get(a,b))?d:null==(d=n.find.attr(a,b))?void 0:d)},attrHooks:{type:{set:function(a,b){if(!l.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(G);if(f&&1===a.nodeType)for(;c=f[e++];)d=n.propFix[c]||c,n.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)}}),ab={set:function(a,b,c){return!1===b?n.removeAttr(a,c):a.setAttribute(c,c),c}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=bb[b]||n.find.attr;bb[b]=function(a,b,d){var e,f;return d||(f=bb[b],bb[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,bb[b]=f),e}});var cb=/^(?:input|select|textarea|button)$/i,db=/^(?:a|area)$/i;n.fn.extend({prop:function(a,b){return K(this,n.prop,a,b,1<arguments.length)},removeProp:function(a){return this.each(function(){delete this[n.propFix[a]||a]})}}),n.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&n.isXMLDoc(a)||(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=n.find.attr(a,"tabindex");return b?parseInt(b,10):cb.test(a.nodeName)||db.test(a.nodeName)&&a.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),l.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this});var eb=/[\t\r\n\f]/g;function fb(a){return a.getAttribute&&a.getAttribute("class")||""}n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,fb(this)))});if("string"==typeof a&&a)for(b=a.match(G)||[];c=this[i++];)if(e=fb(c),d=1===c.nodeType&&(" "+e+" ").replace(eb," ")){for(g=0;f=b[g++];)d.indexOf(" "+f+" ")<0&&(d+=f+" ");e!==(h=n.trim(d))&&c.setAttribute("class",h)}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,fb(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a)for(b=a.match(G)||[];c=this[i++];)if(e=fb(c),d=1===c.nodeType&&(" "+e+" ").replace(eb," ")){for(g=0;f=b[g++];)for(;-1<d.indexOf(" "+f+" ");)d=d.replace(" "+f+" "," ");e!==(h=n.trim(d))&&c.setAttribute("class",h)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"==c?b?this.addClass(a):this.removeClass(a):n.isFunction(a)?this.each(function(c){n(this).toggleClass(a.call(this,c,fb(this),b),b)}):this.each(function(){var b,d,e,f;if("string"==c)for(d=0,e=n(this),f=a.match(G)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else void 0!==a&&"boolean"!=c||((b=fb(this))&&N.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||!1===a?"":N.get(this,"__className__")||""))})},hasClass:function(a){var b,c,d=0;for(b=" "+a+" ";c=this[d++];)if(1===c.nodeType&&-1<(" "+fb(c)+" ").replace(eb," ").indexOf(b))return!0;return!1}});var gb=/\r/g,hb=/[\x20\t\r\n\f]+/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];return arguments.length?(d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(null==(e=d?a.call(this,c,n(this).val()):a)?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+""})),(b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()])&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))})):e?(b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:"string"==typeof(c=e.value)?c.replace(gb,""):null==c?"":c:void 0}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.trim(n.text(a)).replace(hb," ")}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||e<0,g=f?null:[],h=f?e+1:d.length,i=e<0?h:f?e:0;i<h;i++)if(((c=d[i]).selected||i===e)&&(l.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=n.makeArray(b),g=e.length;g--;)((d=e[g]).selected=-1<n.inArray(n.valHooks.option.get(d),f))&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=-1<n.inArray(n(a).val(),b):void 0}},l.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var ib=/^(?:focusinfocus|focusoutblur)$/;n.extend(n.event,{trigger:function(b,c,e,f){var g,h,i,j,l,m,o,p=[e||d],q=k.call(b,"type")?b.type:b,r=k.call(b,"namespace")?b.namespace.split("."):[];if(h=i=e=e||d,3!==e.nodeType&&8!==e.nodeType&&!ib.test(q+n.event.triggered)&&(-1<q.indexOf(".")&&(q=(r=q.split(".")).shift(),r.sort()),l=q.indexOf(":")<0&&"on"+q,(b=b[n.expando]?b:new n.Event(q,"object"==typeof b&&b)).isTrigger=f?2:3,b.namespace=r.join("."),b.rnamespace=b.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=e),c=null==c?[b]:n.makeArray(c,[b]),o=n.event.special[q]||{},f||!o.trigger||!1!==o.trigger.apply(e,c))){if(!f&&!o.noBubble&&!n.isWindow(e)){for(j=o.delegateType||q,ib.test(j+q)||(h=h.parentNode);h;h=h.parentNode)p.push(h),i=h;i===(e.ownerDocument||d)&&p.push(i.defaultView||i.parentWindow||a)}for(g=0;(h=p[g++])&&!b.isPropagationStopped();)b.type=1<g?j:o.bindType||q,(m=(N.get(h,"events")||{})[b.type]&&N.get(h,"handle"))&&m.apply(h,c),(m=l&&h[l])&&m.apply&&L(h)&&(b.result=m.apply(h,c),!1===b.result&&b.preventDefault());return b.type=q,f||b.isDefaultPrevented()||o._default&&!1!==o._default.apply(p.pop(),c)||!L(e)||l&&n.isFunction(e[q])&&!n.isWindow(e)&&((i=e[l])&&(e[l]=null),e[n.event.triggered=q](),n.event.triggered=void 0,i&&(e[l]=i)),b.result}},simulate:function(a,b,c){var d=n.extend(new n.Event,c,{type:a,isSimulated:!0});n.event.trigger(d,null,b)}}),n.fn.extend({trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return 0<arguments.length?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),l.focusin="onfocusin"in a,l.focusin||n.each({focus:"focusin",blur:"focusout"},function(a,b){function c(a){n.event.simulate(b,a.target,n.event.fix(a))}n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=N.access(d,b);e||d.addEventListener(a,c,!0),N.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=N.access(d,b)-1;e?N.access(d,b,e):(d.removeEventListener(a,c,!0),N.remove(d,b))}}});var jb=a.location,kb=n.now(),lb=/\?/;n.parseJSON=function(a){return JSON.parse(a+"")},n.parseXML=function(b){var c;if(!b||"string"!=typeof b)return null;try{c=(new a.DOMParser).parseFromString(b,"text/xml")}catch(d){c=void 0}return c&&!c.getElementsByTagName("parsererror").length||n.error("Invalid XML: "+b),c};var mb=/#.*$/,nb=/([?&])_=[^&]*/,ob=/^(.*?):[ \t]*([^\r\n]*)$/gm,qb=/^(?:GET|HEAD)$/,rb=/^\/\//,sb={},tb={},ub="*/".concat("*"),vb=d.createElement("a");function wb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(G)||[];if(n.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function xb(a,b,c,d){var e={},f=a===tb;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function yb(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d=d||{})[c]=b[c]);return d&&n.extend(!0,a,d),a}vb.href=jb.href,n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:jb.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(jb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ub,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?yb(yb(a,n.ajaxSettings),b):yb(n.ajaxSettings,a)},ajaxPrefilter:wb(sb),ajaxTransport:wb(tb),ajax:function(b,c){"object"==typeof b&&(c=b,b=void 0),c=c||{};var e,f,g,h,i,j,k,l,m=n.ajaxSetup({},c),o=m.context||m,p=m.context&&(o.nodeType||o.jquery)?n(o):n.event,q=n.Deferred(),r=n.Callbacks("once memory"),s=m.statusCode||{},t={},u={},v=0,w="canceled",x={readyState:0,getResponseHeader:function(a){var b;if(2===v){if(!h)for(h={};b=ob.exec(g);)h[b[1].toLowerCase()]=b[2];b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===v?g:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return v||(a=u[c]=u[c]||a,t[a]=b),this},overrideMimeType:function(a){return v||(m.mimeType=a),this},statusCode:function(a){var b;if(a)if(v<2)for(b in a)s[b]=[s[b],a[b]];else x.always(a[x.status]);return this},abort:function(a){var b=a||w;return e&&e.abort(b),z(0,b),this}};if(q.promise(x).complete=r.add,x.success=x.done,x.error=x.fail,m.url=((b||m.url||jb.href)+"").replace(mb,"").replace(rb,jb.protocol+"//"),m.type=c.method||c.type||m.method||m.type,m.dataTypes=n.trim(m.dataType||"*").toLowerCase().match(G)||[""],null==m.crossDomain){j=d.createElement("a");try{j.href=m.url,j.href=j.href,m.crossDomain=vb.protocol+"//"+vb.host!=j.protocol+"//"+j.host}catch(y){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=n.param(m.data,m.traditional)),xb(sb,m,c,x),2===v)return x;for(l in(k=n.event&&m.global)&&0==n.active++&&n.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!qb.test(m.type),f=m.url,m.hasContent||(m.data&&(f=m.url+=(lb.test(f)?"&":"?")+m.data,delete m.data),!1===m.cache&&(m.url=nb.test(f)?f.replace(nb,"$1_="+kb++):f+(lb.test(f)?"&":"?")+"_="+kb++)),m.ifModified&&(n.lastModified[f]&&x.setRequestHeader("If-Modified-Since",n.lastModified[f]),n.etag[f]&&x.setRequestHeader("If-None-Match",n.etag[f])),(m.data&&m.hasContent&&!1!==m.contentType||c.contentType)&&x.setRequestHeader("Content-Type",m.contentType),x.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+ub+"; q=0.01":""):m.accepts["*"]),m.headers)x.setRequestHeader(l,m.headers[l]);if(m.beforeSend&&(!1===m.beforeSend.call(o,x,m)||2===v))return x.abort();for(l in w="abort",{success:1,error:1,complete:1})x[l](m[l]);if(e=xb(tb,m,c,x)){if(x.readyState=1,k&&p.trigger("ajaxSend",[x,m]),2===v)return x;m.async&&0<m.timeout&&(i=a.setTimeout(function(){x.abort("timeout")},m.timeout));try{v=1,e.send(t,z)}catch(y){if(!(v<2))throw y;z(-1,y)}}else z(-1,"No Transport");function z(b,c,d,h){var j,l,t,u,w,y=c;2!==v&&(v=2,i&&a.clearTimeout(i),e=void 0,g=h||"",x.readyState=0<b?4:0,j=200<=b&&b<300||304===b,d&&(u=function(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g=g||e}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}(m,x,d)),u=function(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(!(g=j[i+" "+f]||j["* "+f]))for(e in j)if((h=e.split(" "))[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){!0===g?g=j[e]:!0!==j[e]&&(f=h[0],k.unshift(h[1]));break}if(!0!==g)if(g&&a.throws)b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}(m,u,x,j),j?(m.ifModified&&((w=x.getResponseHeader("Last-Modified"))&&(n.lastModified[f]=w),(w=x.getResponseHeader("etag"))&&(n.etag[f]=w)),204===b||"HEAD"===m.type?y="nocontent":304===b?y="notmodified":(y=u.state,l=u.data,j=!(t=u.error))):(t=y,!b&&y||(y="error",b<0&&(b=0))),x.status=b,x.statusText=(c||y)+"",j?q.resolveWith(o,[l,y,x]):q.rejectWith(o,[x,y,t]),x.statusCode(s),s=void 0,k&&p.trigger(j?"ajaxSuccess":"ajaxError",[x,m,j?l:t]),r.fireWith(o,[x,y]),k&&(p.trigger("ajaxComplete",[x,m]),--n.active||n.event.trigger("ajaxStop")))}return x},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax(n.extend({url:a,type:b,dataType:e,data:c,success:d},n.isPlainObject(a)&&a))}}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},n.fn.extend({wrapAll:function(a){var b;return n.isFunction(a)?this.each(function(b){n(this).wrapAll(a.call(this,b))}):(this[0]&&(b=n(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return n.isFunction(a)?this.each(function(b){n(this).wrapInner(a.call(this,b))}):this.each(function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return!n.expr.filters.visible(a)},n.expr.filters.visible=function(a){return 0<a.offsetWidth||0<a.offsetHeight||0<a.getClientRects().length};var Bb=/%20/g,Cb=/\[\]$/,Db=/\r?\n/g,Eb=/^(?:submit|button|image|reset|file)$/i,Fb=/^(?:input|select|textarea|keygen)/i;function Gb(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||Cb.test(a)?d(a,e):Gb(a+"["+("object"==typeof e&&null!=e?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)Gb(a+"["+e+"]",b[e],c,d)}n.param=function(a,b){function e(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)}var c,d=[];if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Gb(c,a[c],b,e);return d.join("&").replace(Bb,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&Fb.test(this.nodeName)&&!Eb.test(a)&&(this.checked||!X.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(Db,"\r\n")}}):{name:b.name,value:c.replace(Db,"\r\n")}}).get()}}),n.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(b){}};var Hb={0:200,1223:204},Ib=n.ajaxSettings.xhr();l.cors=!!Ib&&"withCredentials"in Ib,l.ajax=Ib=!!Ib,n.ajaxTransport(function(b){var c,d;return l.cors||Ib&&!b.crossDomain?{send:function(e,f){var g,h=b.xhr();if(h.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(g in b.xhrFields)h[g]=b.xhrFields[g];for(g in b.mimeType&&h.overrideMimeType&&h.overrideMimeType(b.mimeType),b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)h.setRequestHeader(g,e[g]);c=function(a){return function(){c&&(c=d=h.onload=h.onerror=h.onabort=h.onreadystatechange=null,"abort"===a?h.abort():"error"===a?"number"!=typeof h.status?f(0,"error"):f(h.status,h.statusText):f(Hb[h.status]||h.status,h.statusText,"text"!==(h.responseType||"text")||"string"!=typeof h.responseText?{binary:h.response}:{text:h.responseText},h.getAllResponseHeaders()))}},h.onload=c(),d=h.onerror=c("error"),void 0!==h.onabort?h.onabort=d:h.onreadystatechange=function(){4===h.readyState&&a.setTimeout(function(){c&&d()})},c=c("abort");try{h.send(b.hasContent&&b.data||null)}catch(i){if(c)throw i}},abort:function(){c&&c()}}:void 0}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),n.ajaxTransport("script",function(a){var b,c;if(a.crossDomain)return{send:function(e,f){b=n("<script>").prop({charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&f("error"===a.type?404:200,a.type)}),d.head.appendChild(b[0])},abort:function(){c&&c()}}});var Jb=[],Kb=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Jb.pop()||n.expando+"_"+kb++;return this[a]=!0,a}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=!1!==b.jsonp&&(Kb.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Kb.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Kb,"$1"+e):!1!==b.jsonp&&(b.url+=(lb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){void 0===f?n(a).removeProp(e):a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Jb.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||d;var e=x.exec(a),f=!c&&[];return e?[b.createElement(e[1])]:(e=ca([a],b,f),f&&f.length&&n(f).remove(),n.merge([],e.childNodes))};var Lb=n.fn.load;function Mb(a){return n.isWindow(a)?a:9===a.nodeType&&a.defaultView}n.fn.load=function(a,b,c){if("string"!=typeof a&&Lb)return Lb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return-1<h&&(d=n.trim(a.slice(h)),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),0<g.length&&n.ajax({url:a,type:e||"GET",dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(this,f||[a.responseText,b,a])})}),this},n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length},n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),e=("absolute"===k||"fixed"===k)&&-1<(f+i).indexOf("auto")?(g=(d=l.position()).top,d.left):(g=parseFloat(f)||0,parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,n.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;return f?(b=f.documentElement,n.contains(b,d)?(e=d.getBoundingClientRect(),c=Mb(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e):void 0},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===n.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent;a&&"static"===n.css(a,"position");)a=a.offsetParent;return a||Ea})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;n.fn[a]=function(d){return K(this,function(a,d,e){var f=Mb(a);return void 0===e?f?f[b]:a[d]:void(f?f.scrollTo(c?f.pageXOffset:e,c?e:f.pageYOffset):a[d]=e)},a,d,arguments.length)}}),n.each(["top","left"],function(a,b){n.cssHooks[b]=Ga(l.pixelPosition,function(a,c){return c?(c=Fa(a,b),Ba.test(c)?n(a).position()[b]+"px":c):void 0})}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(!0===d||!0===e?"margin":"border");return K(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)},size:function(){return this.length}}),n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n});var Nb=a.jQuery,Ob=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=Ob),b&&a.jQuery===n&&(a.jQuery=Nb),n},b||(a.jQuery=a.$=n),n}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.moment=t()}(this,function(){"use strict";var e,i;function c(){return e.apply(null,arguments)}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function u(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function l(e){return void 0===e}function d(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function h(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function f(e,t){var n,s=[];for(n=0;n<e.length;++n)s.push(t(e[n],n));return s}function m(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function _(e,t){for(var n in t)m(t,n)&&(e[n]=t[n]);return m(t,"toString")&&(e.toString=t.toString),m(t,"valueOf")&&(e.valueOf=t.valueOf),e}function y(e,t,n,s){return Ot(e,t,n,s,!0).utc()}function g(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function p(e){if(null==e._isValid){var t=g(e),n=i.call(t.parsedDateParts,function(e){return null!=e}),s=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(s=s&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return s;e._isValid=s}return e._isValid}function v(e){var t=y(NaN);return null!=e?_(g(t),e):g(t).userInvalidated=!0,t}i=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,s=0;s<n;s++)if(s in t&&e.call(this,t[s],s,t))return!0;return!1};var r=c.momentProperties=[];function w(e,t){var n,s,i;if(l(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),l(t._i)||(e._i=t._i),l(t._f)||(e._f=t._f),l(t._l)||(e._l=t._l),l(t._strict)||(e._strict=t._strict),l(t._tzm)||(e._tzm=t._tzm),l(t._isUTC)||(e._isUTC=t._isUTC),l(t._offset)||(e._offset=t._offset),l(t._pf)||(e._pf=g(t)),l(t._locale)||(e._locale=t._locale),0<r.length)for(n=0;n<r.length;n++)l(i=t[s=r[n]])||(e[s]=i);return e}var t=!1;function M(e){w(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===t&&(t=!0,c.updateOffset(this),t=!1)}function S(e){return e instanceof M||null!=e&&null!=e._isAMomentObject}function D(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function k(e){var t=+e,n=0;return 0!=t&&isFinite(t)&&(n=D(t)),n}function a(e,t,n){var s,i=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),a=0;for(s=0;s<i;s++)(n&&e[s]!==t[s]||!n&&k(e[s])!==k(t[s]))&&a++;return a+r}function Y(e){!1===c.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function n(i,r){var a=!0;return _(function(){if(null!=c.deprecationHandler&&c.deprecationHandler(null,i),a){for(var e,t=[],n=0;n<arguments.length;n++){if(e="","object"==typeof arguments[n]){for(var s in e+="\n["+n+"] ",arguments[0])e+=s+": "+arguments[0][s]+", ";e=e.slice(0,-2)}else e=arguments[n];t.push(e)}Y(i+"\nArguments: "+Array.prototype.slice.call(t).join("")+"\n"+(new Error).stack),a=!1}return r.apply(this,arguments)},r)}var s,O={};function T(e,t){null!=c.deprecationHandler&&c.deprecationHandler(e,t),O[e]||(Y(t),O[e]=!0)}function x(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function b(e,t){var n,s=_({},e);for(n in t)m(t,n)&&(u(e[n])&&u(t[n])?(s[n]={},_(s[n],e[n]),_(s[n],t[n])):null!=t[n]?s[n]=t[n]:delete s[n]);for(n in e)m(e,n)&&!m(t,n)&&u(e[n])&&(s[n]=_({},s[n]));return s}function P(e){null!=e&&this.set(e)}c.suppressDeprecationWarnings=!1,c.deprecationHandler=null,s=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)m(e,t)&&n.push(t);return n};var W={};function H(e,t){var n=e.toLowerCase();W[n]=W[n+"s"]=W[t]=e}function R(e){return"string"==typeof e?W[e]||W[e.toLowerCase()]:void 0}function C(e){var t,n,s={};for(n in e)m(e,n)&&(t=R(n))&&(s[t]=e[n]);return s}var F={};function L(e,t){F[e]=t}function U(e,t,n){var s=""+Math.abs(e),i=t-s.length;return(0<=e?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+s}var N=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,G=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,V={},E={};function I(e,t,n,s){var i=s;"string"==typeof s&&(i=function(){return this[s]()}),e&&(E[e]=i),t&&(E[t[0]]=function(){return U(i.apply(this,arguments),t[1],t[2])}),n&&(E[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function A(e,t){return e.isValid()?(t=j(t,e.localeData()),V[t]=V[t]||function(s){var e,i,t,r=s.match(N);for(e=0,i=r.length;e<i;e++)E[r[e]]?r[e]=E[r[e]]:r[e]=(t=r[e]).match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"");return function(e){var t,n="";for(t=0;t<i;t++)n+=x(r[t])?r[t].call(e,s):r[t];return n}}(t),V[t](e)):e.localeData().invalidDate()}function j(e,t){var n=5;function s(e){return t.longDateFormat(e)||e}for(G.lastIndex=0;0<=n&&G.test(e);)e=e.replace(G,s),G.lastIndex=0,n-=1;return e}var Z=/\d/,z=/\d\d/,$=/\d{3}/,q=/\d{4}/,J=/[+-]?\d{6}/,B=/\d\d?/,Q=/\d\d\d\d?/,X=/\d\d\d\d\d\d?/,K=/\d{1,3}/,ee=/\d{1,4}/,te=/[+-]?\d{1,6}/,ne=/\d+/,se=/[+-]?\d+/,ie=/Z|[+-]\d\d:?\d\d/gi,re=/Z|[+-]\d\d(?::?\d\d)?/gi,ae=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,oe={};function ue(e,n,s){oe[e]=x(n)?n:function(e,t){return e&&s?s:n}}function le(e,t){return m(oe,e)?oe[e](t._strict,t._locale):new RegExp(de(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,s,i){return t||n||s||i})))}function de(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var he={};function ce(e,n){var t,s=n;for("string"==typeof e&&(e=[e]),d(n)&&(s=function(e,t){t[n]=k(e)}),t=0;t<e.length;t++)he[e[t]]=s}function fe(e,i){ce(e,function(e,t,n,s){n._w=n._w||{},i(e,n._w,n,s)})}var me=0,_e=1,ye=2,ge=3,pe=4,ve=5,we=6,Me=7,Se=8;function De(e){return ke(e)?366:365}function ke(e){return e%4==0&&e%100!=0||e%400==0}I("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),I(0,["YY",2],0,function(){return this.year()%100}),I(0,["YYYY",4],0,"year"),I(0,["YYYYY",5],0,"year"),I(0,["YYYYYY",6,!0],0,"year"),H("year","y"),L("year",1),ue("Y",se),ue("YY",B,z),ue("YYYY",ee,q),ue("YYYYY",te,J),ue("YYYYYY",te,J),ce(["YYYYY","YYYYYY"],me),ce("YYYY",function(e,t){t[me]=2===e.length?c.parseTwoDigitYear(e):k(e)}),ce("YY",function(e,t){t[me]=c.parseTwoDigitYear(e)}),ce("Y",function(e,t){t[me]=parseInt(e,10)}),c.parseTwoDigitYear=function(e){return k(e)+(68<k(e)?1900:2e3)};var Ye,Oe=Te("FullYear",!0);function Te(t,n){return function(e){return null!=e?(be(this,t,e),c.updateOffset(this,n),this):xe(this,t)}}function xe(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function be(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&ke(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Pe(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function Pe(e,t){if(isNaN(e)||isNaN(t))return NaN;var s=(t%12+12)%12;return e+=(t-s)/12,1==s?ke(e)?29:28:31-s%7%2}Ye=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},I("M",["MM",2],"Mo",function(){return this.month()+1}),I("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),I("MMMM",0,0,function(e){return this.localeData().months(this,e)}),H("month","M"),L("month",8),ue("M",B),ue("MM",B,z),ue("MMM",function(e,t){return t.monthsShortRegex(e)}),ue("MMMM",function(e,t){return t.monthsRegex(e)}),ce(["M","MM"],function(e,t){t[_e]=k(e)-1}),ce(["MMM","MMMM"],function(e,t,n,s){var i=n._locale.monthsParse(e,s,n._strict);null!=i?t[_e]=i:g(n).invalidMonth=e});var We=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,He="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Re="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Ce(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=k(t);else if(!d(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),Pe(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function Fe(e){return null!=e?(Ce(this,e),c.updateOffset(this,!0),this):xe(this,"Month")}var Le=ae,Ue=ae;function Ne(){function e(e,t){return t.length-e.length}var t,n,s=[],i=[],r=[];for(t=0;t<12;t++)n=y([2e3,t]),s.push(this.monthsShort(n,"")),i.push(this.months(n,"")),r.push(this.months(n,"")),r.push(this.monthsShort(n,""));for(s.sort(e),i.sort(e),r.sort(e),t=0;t<12;t++)s[t]=de(s[t]),i[t]=de(i[t]);for(t=0;t<24;t++)r[t]=de(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Ge(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&0<=e&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function Ve(e,t,n){var s=7+t-n;return-(7+Ge(e,0,s).getUTCDay()-t)%7+s-1}function Ee(e,t,n,s,i){var r,a,o=1+7*(t-1)+(7+n-s)%7+Ve(e,s,i);return a=o<=0?De(r=e-1)+o:o>De(e)?(r=e+1,o-De(e)):(r=e,o),{year:r,dayOfYear:a}}function Ie(e,t,n){var s,i,r=Ve(e.year(),t,n),a=Math.floor((e.dayOfYear()-r-1)/7)+1;return a<1?s=a+Ae(i=e.year()-1,t,n):a>Ae(e.year(),t,n)?(s=a-Ae(e.year(),t,n),i=e.year()+1):(i=e.year(),s=a),{week:s,year:i}}function Ae(e,t,n){var s=Ve(e,t,n),i=Ve(e+1,t,n);return(De(e)-s+i)/7}I("w",["ww",2],"wo","week"),I("W",["WW",2],"Wo","isoWeek"),H("week","w"),H("isoWeek","W"),L("week",5),L("isoWeek",5),ue("w",B),ue("ww",B,z),ue("W",B),ue("WW",B,z),fe(["w","ww","W","WW"],function(e,t,n,s){t[s.substr(0,1)]=k(e)}),I("d",0,"do","day"),I("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),I("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),I("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),I("e",0,0,"weekday"),I("E",0,0,"isoWeekday"),H("day","d"),H("weekday","e"),H("isoWeekday","E"),L("day",11),L("weekday",11),L("isoWeekday",11),ue("d",B),ue("e",B),ue("E",B),ue("dd",function(e,t){return t.weekdaysMinRegex(e)}),ue("ddd",function(e,t){return t.weekdaysShortRegex(e)}),ue("dddd",function(e,t){return t.weekdaysRegex(e)}),fe(["dd","ddd","dddd"],function(e,t,n,s){var i=n._locale.weekdaysParse(e,s,n._strict);null!=i?t.d=i:g(n).invalidWeekday=e}),fe(["d","e","E"],function(e,t,n,s){t[s]=k(e)});var je="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ze="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),ze="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),$e=ae,qe=ae,Je=ae;function Be(){function e(e,t){return t.length-e.length}var t,n,s,i,r,a=[],o=[],u=[],l=[];for(t=0;t<7;t++)n=y([2e3,1]).day(t),s=this.weekdaysMin(n,""),i=this.weekdaysShort(n,""),r=this.weekdays(n,""),a.push(s),o.push(i),u.push(r),l.push(s),l.push(i),l.push(r);for(a.sort(e),o.sort(e),u.sort(e),l.sort(e),t=0;t<7;t++)o[t]=de(o[t]),u[t]=de(u[t]),l[t]=de(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Qe(){return this.hours()%12||12}function Xe(e,t){I(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Ke(e,t){return t._meridiemParse}I("H",["HH",2],0,"hour"),I("h",["hh",2],0,Qe),I("k",["kk",2],0,function(){return this.hours()||24}),I("hmm",0,0,function(){return""+Qe.apply(this)+U(this.minutes(),2)}),I("hmmss",0,0,function(){return""+Qe.apply(this)+U(this.minutes(),2)+U(this.seconds(),2)}),I("Hmm",0,0,function(){return""+this.hours()+U(this.minutes(),2)}),I("Hmmss",0,0,function(){return""+this.hours()+U(this.minutes(),2)+U(this.seconds(),2)}),Xe("a",!0),Xe("A",!1),H("hour","h"),L("hour",13),ue("a",Ke),ue("A",Ke),ue("H",B),ue("h",B),ue("k",B),ue("HH",B,z),ue("hh",B,z),ue("kk",B,z),ue("hmm",Q),ue("hmmss",X),ue("Hmm",Q),ue("Hmmss",X),ce(["H","HH"],ge),ce(["k","kk"],function(e,t,n){var s=k(e);t[ge]=24===s?0:s}),ce(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),ce(["h","hh"],function(e,t,n){t[ge]=k(e),g(n).bigHour=!0}),ce("hmm",function(e,t,n){var s=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s)),g(n).bigHour=!0}),ce("hmmss",function(e,t,n){var s=e.length-4,i=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s,2)),t[ve]=k(e.substr(i)),g(n).bigHour=!0}),ce("Hmm",function(e,t,n){var s=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s))}),ce("Hmmss",function(e,t,n){var s=e.length-4,i=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s,2)),t[ve]=k(e.substr(i))});var et,tt=Te("Hours",!0),nt={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:He,monthsShort:Re,week:{dow:0,doy:6},weekdays:je,weekdaysMin:ze,weekdaysShort:Ze,meridiemParse:/[ap]\.?m?\.?/i},st={},it={};function rt(e){return e?e.toLowerCase().replace("_","-"):e}function at(e){var t=null;if(!st[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=et._abbr,require("./locale/"+e),ot(t)}catch(e){}return st[e]}function ot(e,t){var n;return e&&((n=l(t)?lt(e):ut(e,t))?et=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),et._abbr}function ut(e,t){if(null===t)return delete st[e],null;var n,s=nt;if(t.abbr=e,null!=st[e])T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=st[e]._config;else if(null!=t.parentLocale)if(null!=st[t.parentLocale])s=st[t.parentLocale]._config;else{if(null==(n=at(t.parentLocale)))return it[t.parentLocale]||(it[t.parentLocale]=[]),it[t.parentLocale].push({name:e,config:t}),null;s=n._config}return st[e]=new P(b(s,t)),it[e]&&it[e].forEach(function(e){ut(e.name,e.config)}),ot(e),st[e]}function lt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return et;if(!o(e)){if(t=at(e))return t;e=[e]}return function(e){for(var t,n,s,i,r=0;r<e.length;){for(t=(i=rt(e[r]).split("-")).length,n=(n=rt(e[r+1]))?n.split("-"):null;0<t;){if(s=at(i.slice(0,t).join("-")))return s;if(n&&n.length>=t&&a(i,n,!0)>=t-1)break;t--}r++}return et}(e)}function dt(e){var t,n=e._a;return n&&-2===g(e).overflow&&(t=n[_e]<0||11<n[_e]?_e:n[ye]<1||n[ye]>Pe(n[me],n[_e])?ye:n[ge]<0||24<n[ge]||24===n[ge]&&(0!==n[pe]||0!==n[ve]||0!==n[we])?ge:n[pe]<0||59<n[pe]?pe:n[ve]<0||59<n[ve]?ve:n[we]<0||999<n[we]?we:-1,g(e)._overflowDayOfYear&&(t<me||ye<t)&&(t=ye),g(e)._overflowWeeks&&-1===t&&(t=Me),g(e)._overflowWeekday&&-1===t&&(t=Se),g(e).overflow=t),e}function ht(e,t,n){return null!=e?e:null!=t?t:n}function ct(e){var t,n,s,i,r,a=[];if(!e._d){var o,u;for(o=e,u=new Date(c.now()),s=o._useUTC?[u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()]:[u.getFullYear(),u.getMonth(),u.getDate()],e._w&&null==e._a[ye]&&null==e._a[_e]&&function(e){var t,n,s,i,r,a,o,u;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)r=1,a=4,n=ht(t.GG,e._a[me],Ie(Tt(),1,4).year),s=ht(t.W,1),((i=ht(t.E,1))<1||7<i)&&(u=!0);else{r=e._locale._week.dow,a=e._locale._week.doy;var l=Ie(Tt(),r,a);n=ht(t.gg,e._a[me],l.year),s=ht(t.w,l.week),null!=t.d?((i=t.d)<0||6<i)&&(u=!0):null!=t.e?(i=t.e+r,(t.e<0||6<t.e)&&(u=!0)):i=r}s<1||s>Ae(n,r,a)?g(e)._overflowWeeks=!0:null!=u?g(e)._overflowWeekday=!0:(o=Ee(n,s,i,r,a),e._a[me]=o.year,e._dayOfYear=o.dayOfYear)}(e),null!=e._dayOfYear&&(r=ht(e._a[me],s[me]),(e._dayOfYear>De(r)||0===e._dayOfYear)&&(g(e)._overflowDayOfYear=!0),n=Ge(r,0,e._dayOfYear),e._a[_e]=n.getUTCMonth(),e._a[ye]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=s[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ge]&&0===e._a[pe]&&0===e._a[ve]&&0===e._a[we]&&(e._nextDay=!0,e._a[ge]=0),e._d=(e._useUTC?Ge:function(e,t,n,s,i,r,a){var o=new Date(e,t,n,s,i,r,a);return e<100&&0<=e&&isFinite(o.getFullYear())&&o.setFullYear(e),o}).apply(null,a),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ge]=24),e._w&&void 0!==e._w.d&&e._w.d!==i&&(g(e).weekdayMismatch=!0)}}var ft=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,_t=/Z|[+-]\d\d(?::?\d\d)?/,yt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],gt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],pt=/^\/?Date\((\-?\d+)/i;function vt(e){var t,n,s,i,r,a,o=e._i,u=ft.exec(o)||mt.exec(o);if(u){for(g(e).iso=!0,t=0,n=yt.length;t<n;t++)if(yt[t][1].exec(u[1])){i=yt[t][0],s=!1!==yt[t][2];break}if(null==i)return void(e._isValid=!1);if(u[3]){for(t=0,n=gt.length;t<n;t++)if(gt[t][1].exec(u[3])){r=(u[2]||" ")+gt[t][0];break}if(null==r)return void(e._isValid=!1)}if(!s&&null!=r)return void(e._isValid=!1);if(u[4]){if(!_t.exec(u[4]))return void(e._isValid=!1);a="Z"}e._f=i+(r||"")+(a||""),kt(e)}else e._isValid=!1}var wt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;var St={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Dt(e){var t,n,s,i=wt.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(i){var r=function(e,t,n,s,i,r){var a=[function(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}(e),Re.indexOf(t),parseInt(n,10),parseInt(s,10),parseInt(i,10)];return r&&a.push(parseInt(r,10)),a}(i[4],i[3],i[2],i[5],i[6],i[7]);if(n=r,s=e,(t=i[1])&&Ze.indexOf(t)!==new Date(n[0],n[1],n[2]).getDay()&&(g(s).weekdayMismatch=!0,!(s._isValid=!1)))return;e._a=r,e._tzm=function(e,t,n){if(e)return St[e];if(t)return 0;var s=parseInt(n,10),i=s%100;return(s-i)/100*60+i}(i[8],i[9],i[10]),e._d=Ge.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),g(e).rfc2822=!0}else e._isValid=!1}function kt(e){if(e._f!==c.ISO_8601)if(e._f!==c.RFC_2822){e._a=[],g(e).empty=!0;var t,n,s,i,r,a,o,u,l=""+e._i,d=l.length,h=0;for(s=j(e._f,e._locale).match(N)||[],t=0;t<s.length;t++)i=s[t],(n=(l.match(le(i,e))||[])[0])&&(0<(r=l.substr(0,l.indexOf(n))).length&&g(e).unusedInput.push(r),l=l.slice(l.indexOf(n)+n.length),h+=n.length),E[i]?(n?g(e).empty=!1:g(e).unusedTokens.push(i),a=i,u=e,null!=(o=n)&&m(he,a)&&he[a](o,u._a,u,a)):e._strict&&!n&&g(e).unusedTokens.push(i);g(e).charsLeftOver=d-h,0<l.length&&g(e).unusedInput.push(l),e._a[ge]<=12&&!0===g(e).bigHour&&0<e._a[ge]&&(g(e).bigHour=void 0),g(e).parsedDateParts=e._a.slice(0),g(e).meridiem=e._meridiem,e._a[ge]=function(e,t,n){var s;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):(null!=e.isPM&&((s=e.isPM(n))&&t<12&&(t+=12),s||12!==t||(t=0)),t)}(e._locale,e._a[ge],e._meridiem),ct(e),dt(e)}else Dt(e);else vt(e)}function Yt(e){var t,n,s,i,r=e._i,a=e._f;return e._locale=e._locale||lt(e._l),null===r||void 0===a&&""===r?v({nullInput:!0}):("string"==typeof r&&(e._i=r=e._locale.preparse(r)),S(r)?new M(dt(r)):(h(r)?e._d=r:o(a)?function(e){var t,n,s,i,r;if(0===e._f.length)return g(e).invalidFormat=!0,e._d=new Date(NaN);for(i=0;i<e._f.length;i++)r=0,t=w({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],kt(t),p(t)&&(r+=g(t).charsLeftOver,r+=10*g(t).unusedTokens.length,g(t).score=r,(null==s||r<s)&&(s=r,n=t));_(e,n||t)}(e):a?kt(e):l(n=(t=e)._i)?t._d=new Date(c.now()):h(n)?t._d=new Date(n.valueOf()):"string"==typeof n?(s=t,null===(i=pt.exec(s._i))?(vt(s),!1===s._isValid&&(delete s._isValid,Dt(s),!1===s._isValid&&(delete s._isValid,c.createFromInputFallback(s)))):s._d=new Date(+i[1])):o(n)?(t._a=f(n.slice(0),function(e){return parseInt(e,10)}),ct(t)):u(n)?function(e){if(!e._d){var t=C(e._i);e._a=f([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),ct(e)}}(t):d(n)?t._d=new Date(n):c.createFromInputFallback(t),p(e)||(e._d=null),e))}function Ot(e,t,n,s,i){var r,a={};return!0!==n&&!1!==n||(s=n,n=void 0),(u(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||o(e)&&0===e.length)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=i,a._l=n,a._i=e,a._f=t,a._strict=s,(r=new M(dt(Yt(a))))._nextDay&&(r.add(1,"d"),r._nextDay=void 0),r}function Tt(e,t,n,s){return Ot(e,t,n,s,!1)}c.createFromInputFallback=n("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),c.ISO_8601=function(){},c.RFC_2822=function(){};var xt=n("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Tt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:v()}),bt=n("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Tt.apply(null,arguments);return this.isValid()&&e.isValid()?this<e?this:e:v()});function Pt(e,t){var n,s;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return Tt();for(n=t[0],s=1;s<t.length;++s)t[s].isValid()&&!t[s][e](n)||(n=t[s]);return n}var Wt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Ht(e){var t=C(e),n=t.year||0,s=t.quarter||0,i=t.month||0,r=t.week||0,a=t.day||0,o=t.hour||0,u=t.minute||0,l=t.second||0,d=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===Ye.call(Wt,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,s=0;s<Wt.length;++s)if(e[Wt[s]]){if(n)return!1;parseFloat(e[Wt[s]])!==k(e[Wt[s]])&&(n=!0)}return!0}(t),this._milliseconds=+d+1e3*l+6e4*u+1e3*o*60*60,this._days=+a+7*r,this._months=+i+3*s+12*n,this._data={},this._locale=lt(),this._bubble()}function Rt(e){return e instanceof Ht}function Ct(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ft(e,n){I(e,0,0,function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+U(~~(e/60),2)+n+U(~~e%60,2)})}Ft("Z",":"),Ft("ZZ",""),ue("Z",re),ue("ZZ",re),ce(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Ut(re,e)});var Lt=/([\+\-]|\d\d)/gi;function Ut(e,t){var n=(t||"").match(e);if(null===n)return null;var s=((n[n.length-1]||[])+"").match(Lt)||["-",0,0],i=60*s[1]+k(s[2]);return 0===i?0:"+"===s[0]?i:-i}function Nt(e,t){var n,s;return t._isUTC?(n=t.clone(),s=(S(e)||h(e)?e.valueOf():Tt(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+s),c.updateOffset(n,!1),n):Tt(e).local()}function Gt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Vt(){return!!this.isValid()&&this._isUTC&&0===this._offset}c.updateOffset=function(){};var Et=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,It=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function At(e,t){var n,s,i,r=e,a=null;return Rt(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:d(e)?(r={},t?r[t]=e:r.milliseconds=e):(a=Et.exec(e))?(n="-"===a[1]?-1:1,r={y:0,d:k(a[ye])*n,h:k(a[ge])*n,m:k(a[pe])*n,s:k(a[ve])*n,ms:k(Ct(1e3*a[we]))*n}):(a=It.exec(e))?(n="-"===a[1]?-1:(a[1],1),r={y:jt(a[2],n),M:jt(a[3],n),w:jt(a[4],n),d:jt(a[5],n),h:jt(a[6],n),m:jt(a[7],n),s:jt(a[8],n)}):null==r?r={}:"object"==typeof r&&("from"in r||"to"in r)&&(i=function(e,t){var n;return e.isValid()&&t.isValid()?(t=Nt(t,e),e.isBefore(t)?n=Zt(e,t):((n=Zt(t,e)).milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}(Tt(r.from),Tt(r.to)),(r={}).ms=i.milliseconds,r.M=i.months),s=new Ht(r),Rt(e)&&m(e,"_locale")&&(s._locale=e._locale),s}function jt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Zt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function zt(s,i){return function(e,t){var n;return null===t||isNaN(+t)||(T(i,"moment()."+i+"(period, number) is deprecated. Please use moment()."+i+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=e,e=t,t=n),$t(this,At(e="string"==typeof e?+e:e,t),s),this}}function $t(e,t,n,s){var i=t._milliseconds,r=Ct(t._days),a=Ct(t._months);e.isValid()&&(s=null==s||s,a&&Ce(e,xe(e,"Month")+a*n),r&&be(e,"Date",xe(e,"Date")+r*n),i&&e._d.setTime(e._d.valueOf()+i*n),s&&c.updateOffset(e,r||a))}At.fn=Ht.prototype,At.invalid=function(){return At(NaN)};var qt=zt(1,"add"),Jt=zt(-1,"subtract");function Bt(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(n,"months");return-(n+(t-s<0?(t-s)/(s-e.clone().add(n-1,"months")):(t-s)/(e.clone().add(1+n,"months")-s)))||0}function Qt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=lt(e))&&(this._locale=t),this)}c.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",c.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Xt=n("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function Kt(){return this._locale}function en(e,t){I(0,[e,e.length],0,t)}function tn(e,t,n,s,i){var r;return null==e?Ie(this,s,i).year:((r=Ae(e,s,i))<t&&(t=r),function(e,t,n,s,i){var r=Ee(e,t,n,s,i),a=Ge(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}.call(this,e,t,n,s,i))}I(0,["gg",2],0,function(){return this.weekYear()%100}),I(0,["GG",2],0,function(){return this.isoWeekYear()%100}),en("gggg","weekYear"),en("ggggg","weekYear"),en("GGGG","isoWeekYear"),en("GGGGG","isoWeekYear"),H("weekYear","gg"),H("isoWeekYear","GG"),L("weekYear",1),L("isoWeekYear",1),ue("G",se),ue("g",se),ue("GG",B,z),ue("gg",B,z),ue("GGGG",ee,q),ue("gggg",ee,q),ue("GGGGG",te,J),ue("ggggg",te,J),fe(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,s){t[s.substr(0,2)]=k(e)}),fe(["gg","GG"],function(e,t,n,s){t[s]=c.parseTwoDigitYear(e)}),I("Q",0,"Qo","quarter"),H("quarter","Q"),L("quarter",7),ue("Q",Z),ce("Q",function(e,t){t[_e]=3*(k(e)-1)}),I("D",["DD",2],"Do","date"),H("date","D"),L("date",9),ue("D",B),ue("DD",B,z),ue("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),ce(["D","DD"],ye),ce("Do",function(e,t){t[ye]=k(e.match(B)[0])});var nn=Te("Date",!0);I("DDD",["DDDD",3],"DDDo","dayOfYear"),H("dayOfYear","DDD"),L("dayOfYear",4),ue("DDD",K),ue("DDDD",$),ce(["DDD","DDDD"],function(e,t,n){n._dayOfYear=k(e)}),I("m",["mm",2],0,"minute"),H("minute","m"),L("minute",14),ue("m",B),ue("mm",B,z),ce(["m","mm"],pe);var sn=Te("Minutes",!1);I("s",["ss",2],0,"second"),H("second","s"),L("second",15),ue("s",B),ue("ss",B,z),ce(["s","ss"],ve);var rn,an=Te("Seconds",!1);for(I("S",0,0,function(){return~~(this.millisecond()/100)}),I(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),I(0,["SSS",3],0,"millisecond"),I(0,["SSSS",4],0,function(){return 10*this.millisecond()}),I(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),I(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),I(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),I(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),I(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),H("millisecond","ms"),L("millisecond",16),ue("S",K,Z),ue("SS",K,z),ue("SSS",K,$),rn="SSSS";rn.length<=9;rn+="S")ue(rn,ne);function on(e,t){t[we]=k(1e3*("0."+e))}for(rn="S";rn.length<=9;rn+="S")ce(rn,on);var un=Te("Milliseconds",!1);I("z",0,0,"zoneAbbr"),I("zz",0,0,"zoneName");var ln=M.prototype;function dn(e){return e}ln.add=qt,ln.calendar=function(e,t){var n=e||Tt(),s=Nt(n,this).startOf("day"),i=c.calendarFormat(this,s)||"sameElse",r=t&&(x(t[i])?t[i].call(this,n):t[i]);return this.format(r||this.localeData().calendar(i,this,Tt(n)))},ln.clone=function(){return new M(this)},ln.diff=function(e,t,n){var s,i,r;if(!this.isValid())return NaN;if(!(s=Nt(e,this)).isValid())return NaN;switch(i=6e4*(s.utcOffset()-this.utcOffset()),t=R(t)){case"year":r=Bt(this,s)/12;break;case"month":r=Bt(this,s);break;case"quarter":r=Bt(this,s)/3;break;case"second":r=(this-s)/1e3;break;case"minute":r=(this-s)/6e4;break;case"hour":r=(this-s)/36e5;break;case"day":r=(this-s-i)/864e5;break;case"week":r=(this-s-i)/6048e5;break;default:r=this-s}return n?r:D(r)},ln.endOf=function(e){return void 0===(e=R(e))||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))},ln.format=function(e){e=e||(this.isUtc()?c.defaultFormatUtc:c.defaultFormat);var t=A(this,e);return this.localeData().postformat(t)},ln.from=function(e,t){return this.isValid()&&(S(e)&&e.isValid()||Tt(e).isValid())?At({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},ln.fromNow=function(e){return this.from(Tt(),e)},ln.to=function(e,t){return this.isValid()&&(S(e)&&e.isValid()||Tt(e).isValid())?At({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},ln.toNow=function(e){return this.to(Tt(),e)},ln.get=function(e){return x(this[e=R(e)])?this[e]():this},ln.invalidAt=function(){return g(this).overflow},ln.isAfter=function(e,t){var n=S(e)?e:Tt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=R(l(t)?"millisecond":t))?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},ln.isBefore=function(e,t){var n=S(e)?e:Tt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=R(l(t)?"millisecond":t))?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},ln.isBetween=function(e,t,n,s){return("("===(s=s||"()")[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===s[1]?this.isBefore(t,n):!this.isAfter(t,n))},ln.isSame=function(e,t){var n,s=S(e)?e:Tt(e);return!(!this.isValid()||!s.isValid())&&("millisecond"===(t=R(t||"millisecond"))?this.valueOf()===s.valueOf():(n=s.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},ln.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},ln.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},ln.isValid=function(){return p(this)},ln.lang=Xt,ln.locale=Qt,ln.localeData=Kt,ln.max=bt,ln.min=xt,ln.parsingFlags=function(){return _({},g(this))},ln.set=function(e,t){if("object"==typeof e)for(var n=function(e){var t=[];for(var n in e)t.push({unit:n,priority:F[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}(e=C(e)),s=0;s<n.length;s++)this[n[s].unit](e[n[s].unit]);else if(x(this[e=R(e)]))return this[e](t);return this},ln.startOf=function(e){switch(e=R(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},ln.subtract=Jt,ln.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},ln.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},ln.toDate=function(){return new Date(this.valueOf())},ln.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||9999<n.year()?A(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):x(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",A(n,"Z")):A(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},ln.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',s=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i=t+'[")]';return this.format(n+s+"-MM-DD[T]HH:mm:ss.SSS"+i)},ln.toJSON=function(){return this.isValid()?this.toISOString():null},ln.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},ln.unix=function(){return Math.floor(this.valueOf()/1e3)},ln.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},ln.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},ln.year=Oe,ln.isLeapYear=function(){return ke(this.year())},ln.weekYear=function(e){return tn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},ln.isoWeekYear=function(e){return tn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},ln.quarter=ln.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},ln.month=Fe,ln.daysInMonth=function(){return Pe(this.year(),this.month())},ln.week=ln.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},ln.isoWeek=ln.isoWeeks=function(e){var t=Ie(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},ln.weeksInYear=function(){var e=this.localeData()._week;return Ae(this.year(),e.dow,e.doy)},ln.isoWeeksInYear=function(){return Ae(this.year(),1,4)},ln.date=nn,ln.day=ln.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t,n,s=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(t=e,n=this.localeData(),e="string"!=typeof t?t:isNaN(t)?"number"==typeof(t=n.weekdaysParse(t))?t:null:parseInt(t,10),this.add(e-s,"d")):s},ln.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},ln.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null==e)return this.day()||7;var n,s,t=(n=e,s=this.localeData(),"string"==typeof n?s.weekdaysParse(n)%7||7:isNaN(n)?null:n);return this.day(this.day()%7?t:t-7)},ln.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},ln.hour=ln.hours=tt,ln.minute=ln.minutes=sn,ln.second=ln.seconds=an,ln.millisecond=ln.milliseconds=un,ln.utcOffset=function(e,t,n){var s,i=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null==e)return this._isUTC?i:Gt(this);if("string"==typeof e){if(null===(e=Ut(re,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(s=Gt(this)),this._offset=e,this._isUTC=!0,null!=s&&this.add(s,"m"),i!==e&&(!t||this._changeInProgress?$t(this,At(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,c.updateOffset(this,!0),this._changeInProgress=null)),this},ln.utc=function(e){return this.utcOffset(0,e)},ln.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Gt(this),"m")),this},ln.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Ut(ie,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},ln.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Tt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},ln.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},ln.isLocal=function(){return!!this.isValid()&&!this._isUTC},ln.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},ln.isUtc=Vt,ln.isUTC=Vt,ln.zoneAbbr=function(){return this._isUTC?"UTC":""},ln.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},ln.dates=n("dates accessor is deprecated. Use date instead.",nn),ln.months=n("months accessor is deprecated. Use month instead",Fe),ln.years=n("years accessor is deprecated. Use year instead",Oe),ln.zone=n("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),ln.isDSTShifted=n("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!l(this._isDSTShifted))return this._isDSTShifted;var e={};if(w(e,this),(e=Yt(e))._a){var t=e._isUTC?y(e._a):Tt(e._a);this._isDSTShifted=this.isValid()&&0<a(e._a,t.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var hn=P.prototype;function cn(e,t,n,s){var i=lt(),r=y().set(s,t);return i[n](r,e)}function fn(e,t,n){if(d(e)&&(t=e,e=void 0),e=e||"",null!=t)return cn(e,t,n,"month");var s,i=[];for(s=0;s<12;s++)i[s]=cn(e,s,n,"month");return i}function mn(e,t,n,s){"boolean"==typeof e?d(t)&&(n=t,t=void 0):(t=e,e=!1,d(n=t)&&(n=t,t=void 0)),t=t||"";var i,r=lt(),a=e?r._week.dow:0;if(null!=n)return cn(t,(n+a)%7,s,"day");var o=[];for(i=0;i<7;i++)o[i]=cn(t,(i+a)%7,s,"day");return o}hn.calendar=function(e,t,n){var s=this._calendar[e]||this._calendar.sameElse;return x(s)?s.call(t,n):s},hn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},hn.invalidDate=function(){return this._invalidDate},hn.ordinal=function(e){return this._ordinal.replace("%d",e)},hn.preparse=dn,hn.postformat=dn,hn.relativeTime=function(e,t,n,s){var i=this._relativeTime[n];return x(i)?i(e,t,n,s):i.replace(/%d/i,e)},hn.pastFuture=function(e,t){var n=this._relativeTime[0<e?"future":"past"];return x(n)?n(t):n.replace(/%s/i,t)},hn.set=function(e){var t,n;for(n in e)x(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},hn.months=function(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||We).test(t)?"format":"standalone"][e.month()]:o(this._months)?this._months:this._months.standalone},hn.monthsShort=function(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[We.test(t)?"format":"standalone"][e.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},hn.monthsParse=function(e,t,n){var s,i,r;if(this._monthsParseExact)return function(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)r=y([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=Ye.call(this._shortMonthsParse,a))?i:null:-1!==(i=Ye.call(this._longMonthsParse,a))?i:null:"MMM"===t?-1!==(i=Ye.call(this._shortMonthsParse,a))?i:-1!==(i=Ye.call(this._longMonthsParse,a))?i:null:-1!==(i=Ye.call(this._longMonthsParse,a))?i:-1!==(i=Ye.call(this._shortMonthsParse,a))?i:null}.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(i=y([2e3,s]),n&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[s]||(r="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[s]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[s].test(e))return s;if(n&&"MMM"===t&&this._shortMonthsParse[s].test(e))return s;if(!n&&this._monthsParse[s].test(e))return s}},hn.monthsRegex=function(e){return this._monthsParseExact?(m(this,"_monthsRegex")||Ne.call(this),e?this._monthsStrictRegex:this._monthsRegex):(m(this,"_monthsRegex")||(this._monthsRegex=Ue),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},hn.monthsShortRegex=function(e){return this._monthsParseExact?(m(this,"_monthsRegex")||Ne.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(m(this,"_monthsShortRegex")||(this._monthsShortRegex=Le),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},hn.week=function(e){return Ie(e,this._week.dow,this._week.doy).week},hn.firstDayOfYear=function(){return this._week.doy},hn.firstDayOfWeek=function(){return this._week.dow},hn.weekdays=function(e,t){return e?o(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:o(this._weekdays)?this._weekdays:this._weekdays.standalone},hn.weekdaysMin=function(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin},hn.weekdaysShort=function(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort},hn.weekdaysParse=function(e,t,n){var s,i,r;if(this._weekdaysParseExact)return function(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)r=y([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=Ye.call(this._weekdaysParse,a))?i:null:"ddd"===t?-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:null:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:"dddd"===t?-1!==(i=Ye.call(this._weekdaysParse,a))?i:-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:"ddd"===t?-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:-1!==(i=Ye.call(this._weekdaysParse,a))?i:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:-1!==(i=Ye.call(this._weekdaysParse,a))?i:-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:null}.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(i=y([2e3,1]).day(s),n&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[s]||(r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[s]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[s].test(e))return s;if(n&&"ddd"===t&&this._shortWeekdaysParse[s].test(e))return s;if(n&&"dd"===t&&this._minWeekdaysParse[s].test(e))return s;if(!n&&this._weekdaysParse[s].test(e))return s}},hn.weekdaysRegex=function(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||Be.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(m(this,"_weekdaysRegex")||(this._weekdaysRegex=$e),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},hn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||Be.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(m(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=qe),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},hn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||Be.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(m(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Je),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},hn.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},hn.meridiem=function(e,t,n){return 11<e?n?"pm":"PM":n?"am":"AM"},ot("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===k(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th")}}),c.lang=n("moment.lang is deprecated. Use moment.locale instead.",ot),c.langData=n("moment.langData is deprecated. Use moment.localeData instead.",lt);var _n=Math.abs;function yn(e,t,n,s){var i=At(t,n);return e._milliseconds+=s*i._milliseconds,e._days+=s*i._days,e._months+=s*i._months,e._bubble()}function gn(e){return e<0?Math.floor(e):Math.ceil(e)}function pn(e){return 4800*e/146097}function vn(e){return 146097*e/4800}function wn(e){return function(){return this.as(e)}}var Mn=wn("ms"),Sn=wn("s"),Dn=wn("m"),kn=wn("h"),Yn=wn("d"),On=wn("w"),Tn=wn("M"),xn=wn("y");function bn(e){return function(){return this.isValid()?this._data[e]:NaN}}var Pn=bn("milliseconds"),Wn=bn("seconds"),Hn=bn("minutes"),Rn=bn("hours"),Cn=bn("days"),Fn=bn("months"),Ln=bn("years"),Un=Math.round,Nn={ss:44,s:45,m:45,h:22,d:26,M:11},Gn=Math.abs;function Vn(e){return(0<e)-(e<0)||+e}function En(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=Gn(this._milliseconds)/1e3,s=Gn(this._days),i=Gn(this._months);t=D((e=D(n/60))/60),n%=60,e%=60;var r=D(i/12),a=i%=12,o=s,u=t,l=e,d=n?n.toFixed(3).replace(/\.?0+$/,""):"",h=this.asSeconds();if(!h)return"P0D";var c=h<0?"-":"",f=Vn(this._months)!==Vn(h)?"-":"",m=Vn(this._days)!==Vn(h)?"-":"",_=Vn(this._milliseconds)!==Vn(h)?"-":"";return c+"P"+(r?f+r+"Y":"")+(a?f+a+"M":"")+(o?m+o+"D":"")+(u||l||d?"T":"")+(u?_+u+"H":"")+(l?_+l+"M":"")+(d?_+d+"S":"")}var In=Ht.prototype;return In.isValid=function(){return this._isValid},In.abs=function(){var e=this._data;return this._milliseconds=_n(this._milliseconds),this._days=_n(this._days),this._months=_n(this._months),e.milliseconds=_n(e.milliseconds),e.seconds=_n(e.seconds),e.minutes=_n(e.minutes),e.hours=_n(e.hours),e.months=_n(e.months),e.years=_n(e.years),this},In.add=function(e,t){return yn(this,e,t,1)},In.subtract=function(e,t){return yn(this,e,t,-1)},In.as=function(e){if(!this.isValid())return NaN;var t,n,s=this._milliseconds;if("month"===(e=R(e))||"year"===e)return t=this._days+s/864e5,n=this._months+pn(t),"month"===e?n:n/12;switch(t=this._days+Math.round(vn(this._months)),e){case"week":return t/7+s/6048e5;case"day":return t+s/864e5;case"hour":return 24*t+s/36e5;case"minute":return 1440*t+s/6e4;case"second":return 86400*t+s/1e3;case"millisecond":return Math.floor(864e5*t)+s;default:throw new Error("Unknown unit "+e)}},In.asMilliseconds=Mn,In.asSeconds=Sn,In.asMinutes=Dn,In.asHours=kn,In.asDays=Yn,In.asWeeks=On,In.asMonths=Tn,In.asYears=xn,In.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*k(this._months/12):NaN},In._bubble=function(){var e,t,n,s,i,r=this._milliseconds,a=this._days,o=this._months,u=this._data;return 0<=r&&0<=a&&0<=o||r<=0&&a<=0&&o<=0||(r+=864e5*gn(vn(o)+a),o=a=0),u.milliseconds=r%1e3,e=D(r/1e3),u.seconds=e%60,t=D(e/60),u.minutes=t%60,n=D(t/60),u.hours=n%24,o+=i=D(pn(a+=D(n/24))),a-=gn(vn(i)),s=D(o/12),o%=12,u.days=a,u.months=o,u.years=s,this},In.clone=function(){return At(this)},In.get=function(e){return e=R(e),this.isValid()?this[e+"s"]():NaN},In.milliseconds=Pn,In.seconds=Wn,In.minutes=Hn,In.hours=Rn,In.days=Cn,In.weeks=function(){return D(this.days()/7)},In.months=Fn,In.years=Ln,In.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var n,s,i,r,a,o,u,l,d,h,c=this.localeData(),f=(n=!e,s=c,i=At(this).abs(),r=Un(i.as("s")),a=Un(i.as("m")),o=Un(i.as("h")),u=Un(i.as("d")),l=Un(i.as("M")),d=Un(i.as("y")),(h=r<=Nn.ss&&["s",r]||r<Nn.s&&["ss",r]||a<=1&&["m"]||a<Nn.m&&["mm",a]||o<=1&&["h"]||o<Nn.h&&["hh",o]||u<=1&&["d"]||u<Nn.d&&["dd",u]||l<=1&&["M"]||l<Nn.M&&["MM",l]||d<=1&&["y"]||["yy",d])[2]=n,h[3]=0<+this,h[4]=s,function(e,t,n,s,i){return i.relativeTime(t||1,!!n,e,s)}.apply(null,h));return e&&(f=c.pastFuture(+this,f)),c.postformat(f)},In.toISOString=En,In.toString=En,In.toJSON=En,In.locale=Qt,In.localeData=Kt,In.toIsoString=n("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",En),In.lang=Xt,I("X",0,0,"unix"),I("x",0,0,"valueOf"),ue("x",se),ue("X",/[+-]?\d+(\.\d{1,3})?/),ce("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),ce("x",function(e,t,n){n._d=new Date(k(e))}),c.version="2.22.2",e=Tt,c.fn=ln,c.min=function(){return Pt("isBefore",[].slice.call(arguments,0))},c.max=function(){return Pt("isAfter",[].slice.call(arguments,0))},c.now=function(){return Date.now?Date.now():+new Date},c.utc=y,c.unix=function(e){return Tt(1e3*e)},c.months=function(e,t){return fn(e,t,"months")},c.isDate=h,c.locale=ot,c.invalid=v,c.duration=At,c.isMoment=S,c.weekdays=function(e,t,n){return mn(e,t,n,"weekdays")},c.parseZone=function(){return Tt.apply(null,arguments).parseZone()},c.localeData=lt,c.isDuration=Rt,c.monthsShort=function(e,t){return fn(e,t,"monthsShort")},c.weekdaysMin=function(e,t,n){return mn(e,t,n,"weekdaysMin")},c.defineLocale=ut,c.updateLocale=function(e,t){if(null!=t){var n,s,i=nt;null!=(s=at(e))&&(i=s._config),(n=new P(t=b(i,t))).parentLocale=st[e],st[e]=n,ot(e)}else null!=st[e]&&(null!=st[e].parentLocale?st[e]=st[e].parentLocale:null!=st[e]&&delete st[e]);return st[e]},c.locales=function(){return s(st)},c.weekdaysShort=function(e,t,n){return mn(e,t,n,"weekdaysShort")},c.normalizeUnits=R,c.relativeTimeRounding=function(e){return void 0===e?Un:"function"==typeof e&&(Un=e,!0)},c.relativeTimeThreshold=function(e,t){return void 0!==Nn[e]&&(void 0===t?Nn[e]:(Nn[e]=t,"s"===e&&(Nn.ss=t-1),!0))},c.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},c.prototype=ln,c.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},c}),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");!function(){"use strict";var b=jQuery.fn.jquery.split(" ")[0].split(".");if(b[0]<2&&b[1]<9||1==b[0]&&9==b[1]&&b[2]<1||3<b[0])throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(),function(a){"use strict";a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});return setTimeout(function(){c||a(d).trigger(a.support.transition.end)},b),this},a(function(){a.support.transition=function(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){if(a(b.target).is(this))return b.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(a){"use strict";function d(b){a(b).on("click",c,this.close)}var c='[data-dismiss="alert"]';d.VERSION="3.3.7",d.TRANSITION_DURATION=150,d.prototype.close=function(b){function c(){g.detach().trigger("closed.bs.alert").remove()}var e=a(this),f=e.attr("data-target");f||(f=(f=e.attr("href"))&&f.replace(/.*(?=#[^\s]*$)/,""));var g=a("#"===f?[]:f);b&&b.preventDefault(),g.length||(g=e.closest(".alert")),g.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(g.removeClass("in"),a.support.transition&&g.hasClass("fade")?g.one("bsTransitionEnd",c).emulateTransitionEnd(d.TRANSITION_DURATION):c())};var e=a.fn.alert;a.fn.alert=function(b){return this.each(function(){var c=a(this),e=c.data("bs.alert");e||c.data("bs.alert",e=new d(this)),"string"==typeof b&&e[b].call(c)})},a.fn.alert.Constructor=d,a.fn.alert.noConflict=function(){return a.fn.alert=e,this},a(document).on("click.bs.alert.data-api",c,d.prototype.close)}(jQuery),function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof b&&b;e||d.data("bs.button",e=new c(this,f)),"toggle"==b?e.toggle():b&&e.setState(b)})}var c=function(b,d){this.$element=a(b),this.options=a.extend({},c.DEFAULTS,d),this.isLoading=!1};c.VERSION="3.3.7",c.DEFAULTS={loadingText:"loading..."},c.prototype.setState=function(b){var c="disabled",d=this.$element,e=d.is("input")?"val":"html",f=d.data();b+="Text",null==f.resetText&&d.data("resetText",d[e]()),setTimeout(a.proxy(function(){d[e](null==f[b]?this.options[b]:f[b]),"loadingText"==b?(this.isLoading=!0,d.addClass(c).attr(c,c).prop(c,!0)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c).prop(c,!1))},this),0)},c.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle="buttons"]');if(b.length){var c=this.$element.find("input");"radio"==c.prop("type")?(c.prop("checked")&&(a=!1),b.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==c.prop("type")&&(c.prop("checked")!==this.$element.hasClass("active")&&(a=!1),this.$element.toggleClass("active")),c.prop("checked",this.$element.hasClass("active")),a&&c.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var d=a.fn.button;a.fn.button=b,a.fn.button.Constructor=c,a.fn.button.noConflict=function(){return a.fn.button=d,this},a(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(c){var d=a(c.target).closest(".btn");b.call(d,"toggle"),a(c.target).is('input[type="radio"], input[type="checkbox"]')||(c.preventDefault(),d.is("input,button")?d.trigger("focus"):d.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(b){a(b.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(b.type))})}(jQuery),function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},c.DEFAULTS,d.data(),"object"==typeof b&&b),g="string"==typeof b?b:f.slide;e||d.data("bs.carousel",e=new c(this,f)),"number"==typeof b?e.to(b):g?e[g]():f.interval&&e.pause().cycle()})}var c=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",a.proxy(this.keydown,this)),"hover"!=this.options.pause||"ontouchstart"in document.documentElement||this.$element.on("mouseenter.bs.carousel",a.proxy(this.pause,this)).on("mouseleave.bs.carousel",a.proxy(this.cycle,this))};c.VERSION="3.3.7",c.TRANSITION_DURATION=600,c.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},c.prototype.keydown=function(a){if(!/input|textarea/i.test(a.target.tagName)){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()}},c.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},c.prototype.getItemIndex=function(a){return this.$items=a.parent().children(".item"),this.$items.index(a||this.$active)},c.prototype.getItemForDirection=function(a,b){var c=this.getItemIndex(b);if(("prev"==a&&0===c||"next"==a&&c==this.$items.length-1)&&!this.options.wrap)return b;var f=(c+("prev"==a?-1:1))%this.$items.length;return this.$items.eq(f)},c.prototype.to=function(a){var b=this,c=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(a>this.$items.length-1||a<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){b.to(a)}):c==a?this.pause().cycle():this.slide(c<a?"next":"prev",this.$items.eq(a))},c.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},c.prototype.next=function(){if(!this.sliding)return this.slide("next")},c.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},c.prototype.slide=function(b,d){var e=this.$element.find(".item.active"),f=d||this.getItemForDirection(b,e),g=this.interval,h="next"==b?"left":"right",i=this;if(f.hasClass("active"))return this.sliding=!1;var j=f[0],k=a.Event("slide.bs.carousel",{relatedTarget:j,direction:h});if(this.$element.trigger(k),!k.isDefaultPrevented()){if(this.sliding=!0,g&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var l=a(this.$indicators.children()[this.getItemIndex(f)]);l&&l.addClass("active")}var m=a.Event("slid.bs.carousel",{relatedTarget:j,direction:h});return a.support.transition&&this.$element.hasClass("slide")?(f.addClass(b),f[0].offsetWidth,e.addClass(h),f.addClass(h),e.one("bsTransitionEnd",function(){f.removeClass([b,h].join(" ")).addClass("active"),e.removeClass(["active",h].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger(m)},0)}).emulateTransitionEnd(c.TRANSITION_DURATION)):(e.removeClass("active"),f.addClass("active"),this.sliding=!1,this.$element.trigger(m)),g&&this.cycle(),this}};var d=a.fn.carousel;a.fn.carousel=b,a.fn.carousel.Constructor=c,a.fn.carousel.noConflict=function(){return a.fn.carousel=d,this};var e=function(c){var d,e=a(this),f=a(e.attr("data-target")||(d=e.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""));if(f.hasClass("carousel")){var g=a.extend({},f.data(),e.data()),h=e.attr("data-slide-to");h&&(g.interval=!1),b.call(f,g),h&&f.data("bs.carousel").to(h),c.preventDefault()}};a(document).on("click.bs.carousel.data-api","[data-slide]",e).on("click.bs.carousel.data-api","[data-slide-to]",e),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var c=a(this);b.call(c,c.data())})})}(jQuery),function(a){"use strict";function b(b){var c,d=b.attr("data-target")||(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");return a(d)}function c(b){return this.each(function(){var c=a(this),e=c.data("bs.collapse"),f=a.extend({},d.DEFAULTS,c.data(),"object"==typeof b&&b);!e&&f.toggle&&/show|hide/.test(b)&&(f.toggle=!1),e||c.data("bs.collapse",e=new d(this,f)),"string"==typeof b&&e[b]()})}var d=function(b,c){this.$element=a(b),this.options=a.extend({},d.DEFAULTS,c),this.$trigger=a('[data-toggle="collapse"][href="#'+b.id+'"],[data-toggle="collapse"][data-target="#'+b.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};d.VERSION="3.3.7",d.TRANSITION_DURATION=350,d.DEFAULTS={toggle:!0},d.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},d.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b,e=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(e&&e.length&&((b=e.data("bs.collapse"))&&b.transitioning))){var f=a.Event("show.bs.collapse");if(this.$element.trigger(f),!f.isDefaultPrevented()){e&&e.length&&(c.call(e,"hide"),b||e.data("bs.collapse",null));var g=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[g](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var h=function(){this.$element.removeClass("collapsing").addClass("collapse in")[g](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return h.call(this);var i=a.camelCase(["scroll",g].join("-"));this.$element.one("bsTransitionEnd",a.proxy(h,this)).emulateTransitionEnd(d.TRANSITION_DURATION)[g](this.$element[0][i])}}}},d.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var e=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return a.support.transition?void this.$element[c](0).one("bsTransitionEnd",a.proxy(e,this)).emulateTransitionEnd(d.TRANSITION_DURATION):e.call(this)}}},d.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},d.prototype.getParent=function(){return a(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(c,d){var e=a(d);this.addAriaAndCollapsedClass(b(e),e)},this)).end()},d.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass("in");a.attr("aria-expanded",c),b.toggleClass("collapsed",!c).attr("aria-expanded",c)};var e=a.fn.collapse;a.fn.collapse=c,a.fn.collapse.Constructor=d,a.fn.collapse.noConflict=function(){return a.fn.collapse=e,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(d){var e=a(this);e.attr("data-target")||d.preventDefault();var f=b(e),h=f.data("bs.collapse")?"toggle":e.data();c.call(f,h)})}(jQuery),function(a){"use strict";function b(b){var c=b.attr("data-target");c||(c=(c=b.attr("href"))&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}function c(c){c&&3===c.which||(a(".dropdown-backdrop").remove(),a(f).each(function(){var d=a(this),e=b(d),f={relatedTarget:this};e.hasClass("open")&&(c&&"click"==c.type&&/input|textarea/i.test(c.target.tagName)&&a.contains(e[0],c.target)||(e.trigger(c=a.Event("hide.bs.dropdown",f)),c.isDefaultPrevented()||(d.attr("aria-expanded","false"),e.removeClass("open").trigger(a.Event("hidden.bs.dropdown",f)))))}))}function g(b){a(b).on("click.bs.dropdown",this.toggle)}var f='[data-toggle="dropdown"]';g.VERSION="3.3.7",g.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=b(e),g=f.hasClass("open");if(c(),!g){"ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",c);var h={relatedTarget:this};if(f.trigger(d=a.Event("show.bs.dropdown",h)),d.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),f.toggleClass("open").trigger(a.Event("shown.bs.dropdown",h))}return!1}},g.prototype.keydown=function(c){if(/(38|40|27|32)/.test(c.which)&&!/input|textarea/i.test(c.target.tagName)){var d=a(this);if(c.preventDefault(),c.stopPropagation(),!d.is(".disabled, :disabled")){var e=b(d),g=e.hasClass("open");if(!g&&27!=c.which||g&&27==c.which)return 27==c.which&&e.find(f).trigger("focus"),d.trigger("click");var i=e.find(".dropdown-menu li:not(.disabled):visible a");if(i.length){var j=i.index(c.target);38==c.which&&0<j&&j--,40==c.which&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger("focus")}}}};var h=a.fn.dropdown;a.fn.dropdown=function(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new g(this)),"string"==typeof b&&d[b].call(c)})},a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on("click.bs.dropdown.data-api",c).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",f,g.prototype.toggle).on("keydown.bs.dropdown.data-api",f,g.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",g.prototype.keydown)}(jQuery),function(a){"use strict";function b(b,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},c.DEFAULTS,e.data(),"object"==typeof b&&b);f||e.data("bs.modal",f=new c(this,g)),"string"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};c.VERSION="3.3.7",c.TRANSITION_DURATION=300,c.BACKDROP_TRANSITION_DURATION=150,c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var d=this,e=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){d.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(d.$element)&&(d.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=a.support.transition&&d.$element.hasClass("fade");d.$element.parent().length||d.$element.appendTo(d.$body),d.$element.show().scrollTop(0),d.adjustDialog(),e&&d.$element[0].offsetWidth,d.$element.addClass("in"),d.enforceFocus();var f=a.Event("shown.bs.modal",{relatedTarget:b});e?d.$dialog.one("bsTransitionEnd",function(){d.$element.trigger("focus").trigger(f)}).emulateTransitionEnd(c.TRANSITION_DURATION):d.$element.trigger("focus").trigger(f)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(c.TRANSITION_DURATION):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){document===a.target||this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},c.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var d=this,e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var f=a.support.transition&&e;if(this.$backdrop=a(document.createElement("div")).addClass("modal-backdrop "+e).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),f&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;f?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var g=function(){d.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):g()}else b&&b()},c.prototype.handleUpdate=function(){this.adjustDialog()},c.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},c.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},c.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},c.prototype.setScrollbar=function(){var a=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},c.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is("a")&&c.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){d.is(":visible")&&d.trigger("focus")})}),b.call(f,g,this)})}(jQuery),function(a){"use strict";function c(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",a,b)}c.VERSION="3.3.7",c.TRANSITION_DURATION=150,c.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},c.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(a.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(b){return(b=a.extend({},this.getDefaults(),this.$element.data(),b)).delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},c.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},c.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusin"==b.type?"focus":"hover"]=!0),c.tip().hasClass("in")||"in"==c.hoverState?void(c.hoverState="in"):(clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},c.prototype.isInStateTrue=function(){for(var a in this.inState)if(this.inState[a])return!0;return!1},c.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);if(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusout"==b.type?"focus":"hover"]=!1),!c.isInStateTrue())return clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},c.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var d=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!d)return;var e=this,f=this.tip(),g=this.getUID(this.type);this.setContent(),f.attr("id",g),this.$element.attr("aria-describedby",g),this.options.animation&&f.addClass("fade");var h="function"==typeof this.options.placement?this.options.placement.call(this,f[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,j=i.test(h);j&&(h=h.replace(i,"")||"top"),f.detach().css({top:0,left:0,display:"block"}).addClass(h).data("bs."+this.type,this),this.options.container?f.appendTo(this.options.container):f.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var k=this.getPosition(),l=f[0].offsetWidth,m=f[0].offsetHeight;if(j){var n=h,o=this.getPosition(this.$viewport);h="bottom"==h&&k.bottom+m>o.bottom?"top":"top"==h&&k.top-m<o.top?"bottom":"right"==h&&k.right+l>o.width?"left":"left"==h&&k.left-l<o.left?"right":h,f.removeClass(n).addClass(h)}var p=this.getCalculatedOffset(h,k,l,m);this.applyPlacement(p,h);var q=function(){var a=e.hoverState;e.$element.trigger("shown.bs."+e.type),e.hoverState=null,"out"==a&&e.leave(e)};a.support.transition&&this.$tip.hasClass("fade")?f.one("bsTransitionEnd",q).emulateTransitionEnd(c.TRANSITION_DURATION):q()}},c.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top+=g,b.left+=h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},c.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},c.prototype.hide=function(b){function d(){"in"!=e.hoverState&&f.detach(),e.$element&&e.$element.removeAttr("aria-describedby").trigger("hidden.bs."+e.type),b&&b()}var e=this,f=a(this.$tip),g=a.Event("hide.bs."+this.type);if(this.$element.trigger(g),!g.isDefaultPrevented())return f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one("bsTransitionEnd",d).emulateTransitionEnd(c.TRANSITION_DURATION):d(),this.hoverState=null,this},c.prototype.fixTitle=function(){var a=this.$element;!a.attr("title")&&"string"==typeof a.attr("data-original-title")||a.attr("data-original-title",a.attr("title")||"").attr("title","")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(b){var c=(b=b||this.$element)[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=window.SVGElement&&c instanceof window.SVGElement,g=d?{top:0,left:0}:f?null:b.offset(),h={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},i=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,h,i,g)},c.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},c.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.right&&(e.left=g.left+g.width-k)}return e},c.prototype.getTitle=function(){var b=this.$element,c=this.options;return b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},c.prototype.getUID=function(a){for(;a+=~~(1e6*Math.random()),document.getElementById(a););return a},c.prototype.tip=function(){if(!this.$tip&&(this.$tip=a(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(b){var c=this;b&&((c=a(b.currentTarget).data("bs."+this.type))||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),b?(c.inState.click=!c.inState.click,c.isInStateTrue()?c.enter(c):c.leave(c)):c.tip().hasClass("in")?c.leave(c):c.enter(c)},c.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type),a.$tip&&a.$tip.detach(),a.$tip=null,a.$arrow=null,a.$viewport=null,a.$element=null})};var d=a.fn.tooltip;a.fn.tooltip=function(b){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof b&&b;!e&&/destroy|hide/.test(b)||(e||d.data("bs.tooltip",e=new c(this,f)),"string"==typeof b&&e[b]())})},a.fn.tooltip.Constructor=c,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=d,this}}(jQuery),function(a){"use strict";function c(a,b){this.init("popover",a,b)}if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");c.VERSION="3.3.7",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),((c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype)).constructor=c).prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof c?"html":"append":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var d=a.fn.popover;a.fn.popover=function(b){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof b&&b;!e&&/destroy|hide/.test(b)||(e||d.data("bs.popover",e=new c(this,f)),"string"==typeof b&&e[b]())})},a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery),function(a){"use strict";function b(c,d){this.$body=a(document.body),this.$scrollElement=a(a(c).is(document.body)?window:c),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",a.proxy(this.process,this)),this.refresh(),this.process()}function c(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})}b.VERSION="3.3.7",b.DEFAULTS={offset:10},b.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},b.prototype.refresh=function(){var b=this,c="offset",d=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),a.isWindow(this.$scrollElement[0])||(c="position",d=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var b=a(this),e=b.data("target")||b.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[c]().top+d,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),d<=b)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(void 0===e[a+1]||b<e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){this.activeTarget=b,this.clear();var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")},b.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var d=a.fn.scrollspy;a.fn.scrollspy=c,a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=d,this},a(window).on("load.bs.scrollspy.data-api",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery),function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new c(this)),"string"==typeof b&&e[b]()})}function c(b){this.element=a(b)}c.VERSION="3.3.7",c.TRANSITION_DURATION=150,c.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=(d=b.attr("href"))&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a"),f=a.Event("hide.bs.tab",{relatedTarget:b[0]}),g=a.Event("show.bs.tab",{relatedTarget:e[0]});if(e.trigger(f),b.trigger(g),!g.isDefaultPrevented()&&!f.isDefaultPrevented()){var h=a(d);this.activate(b.closest("li"),c),this.activate(h,h.parent(),function(){e.trigger({type:"hidden.bs.tab",relatedTarget:b[0]}),b.trigger({type:"shown.bs.tab",relatedTarget:e[0]})})}}},c.prototype.activate=function(b,d,e){function f(){g.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),b.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),h?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu").length&&b.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),e&&e()}var g=d.find("> .active"),h=e&&a.support.transition&&(g.length&&g.hasClass("fade")||!!d.find("> .fade").length);g.length&&h?g.one("bsTransitionEnd",f).emulateTransitionEnd(c.TRANSITION_DURATION):f(),g.removeClass("in")};var d=a.fn.tab;a.fn.tab=b,a.fn.tab.Constructor=c,a.fn.tab.noConflict=function(){return a.fn.tab=d,this};function e(c){c.preventDefault(),b.call(a(this),"show")}a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',e).on("click.bs.tab.data-api",'[data-toggle="pill"]',e)}(jQuery),function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.affix"),f="object"==typeof b&&b;e||d.data("bs.affix",e=new c(this,f)),"string"==typeof b&&e[b]()})}var c=function(b,d){this.options=a.extend({},c.DEFAULTS,d),this.$target=a(this.options.target).on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};c.VERSION="3.3.7",c.RESET="affix affix-top affix-bottom",c.DEFAULTS={offset:0,target:window},c.prototype.getState=function(a,b,c,d){var e=this.$target.scrollTop(),f=this.$element.offset(),g=this.$target.height();if(null!=c&&"top"==this.affixed)return e<c&&"top";if("bottom"==this.affixed)return null!=c?!(e+this.unpin<=f.top)&&"bottom":!(e+g<=a-d)&&"bottom";var h=null==this.affixed,i=h?e:f.top;return null!=c&&e<=c?"top":null!=d&&a-d<=i+(h?g:b)&&"bottom"},c.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(c.RESET).addClass("affix");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},c.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},c.prototype.checkPosition=function(){if(this.$element.is(":visible")){var b=this.$element.height(),d=this.options.offset,e=d.top,f=d.bottom,g=Math.max(a(document).height(),a(document.body).height());"object"!=typeof d&&(f=e=d),"function"==typeof e&&(e=d.top(this.$element)),"function"==typeof f&&(f=d.bottom(this.$element));var h=this.getState(g,b,e,f);if(this.affixed!=h){null!=this.unpin&&this.$element.css("top","");var i="affix"+(h?"-"+h:""),j=a.Event(i+".bs.affix");if(this.$element.trigger(j),j.isDefaultPrevented())return;this.affixed=h,this.unpin="bottom"==h?this.getPinnedOffset():null,this.$element.removeClass(c.RESET).addClass(i).trigger(i.replace("affix","affixed")+".bs.affix")}"bottom"==h&&this.$element.offset({top:g-b-f})}};var d=a.fn.affix;a.fn.affix=b,a.fn.affix.Constructor=c,a.fn.affix.noConflict=function(){return a.fn.affix=d,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var c=a(this),d=c.data();d.offset=d.offset||{},null!=d.offsetBottom&&(d.offset.bottom=d.offsetBottom),null!=d.offsetTop&&(d.offset.top=d.offsetTop),b.call(c,d)})})}(jQuery),function(a){"use strict";var b=3;try{b=parseInt(a.fn.dropdown.Constructor.VERSION,10)}catch(c){}function f(a){var b=arguments,c=!0,d=1;return a=a.replace(/%s/g,function(){var a=b[d++];return void 0===a?(c=!1,""):a}),c?a:""}function i(){if(null===e){var b,c,d=a("<p/>").addClass("fixed-table-scroll-inner"),f=a("<div/>").addClass("fixed-table-scroll-outer");f.append(d),a("body").append(f),b=d[0].offsetWidth,f.css("overflow","scroll"),b===(c=d[0].offsetWidth)&&(c=f[0].clientWidth),f.remove(),e=b-c}return e}function j(b,c,d,e){var g=c;if("string"==typeof c){var h=c.split(".");1<h.length?(g=window,a.each(h,function(a,b){g=g[b]})):g=window[c]}return"object"==typeof g?g:"function"==typeof g?g.apply(b,d||[]):!g&&"string"==typeof c&&f.apply(this,[c].concat(d))?f.apply(this,[c].concat(d)):e}function k(b,c,d){var e=Object.getOwnPropertyNames||function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},f=e(b),g=e(c),h="";if(d&&f.length!==g.length)return!1;for(var i=0;i<f.length;i++)if(h=f[i],-1<a.inArray(h,g)&&b[h]!==c[h])return!1;return!0}function l(a){return"string"==typeof a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/`/g,"&#x60;"):a}function m(a){for(var b in a){var c=b.split(/(?=[A-Z])/).join("-").toLowerCase();c!==b&&(a[c]=a[b],delete a[b])}return a}function n(a,b,c){var d=a;if("string"!=typeof b||a.hasOwnProperty(b))return c?l(a[b]):a[b];var e=b.split(".");for(var f in e)e.hasOwnProperty(f)&&(d=d&&d[e[f]]);return c?l(d):d}function o(){return!!(0<navigator.userAgent.indexOf("MSIE ")||navigator.userAgent.match(/Trident.*rv\:11\./))}function q(b,c){this.options=c,this.$el=a(b),this.$el_=this.$el.clone(),this.timeoutId_=0,this.timeoutFooter_=0,this.init()}var d={3:{buttonsClass:"default",iconsPrefix:"glyphicon",icons:{paginationSwitchDown:"glyphicon-collapse-down icon-chevron-down",paginationSwitchUp:"glyphicon-collapse-up icon-chevron-up",refresh:"glyphicon-refresh icon-refresh",toggleOff:"glyphicon-list-alt icon-list-alt",toggleOn:"glyphicon-list-alt icon-list-alt",columns:"glyphicon-th icon-th",detailOpen:"glyphicon-plus icon-plus",detailClose:"glyphicon-minus icon-minus",fullscreen:"glyphicon-fullscreen"},pullClass:"pull",toobarDropdowHtml:['<ul class="dropdown-menu" role="menu">',"</ul>"],toobarDropdowItemHtml:'<li role="menuitem"><label>%s</label></li>',pageDropdownHtml:['<ul class="dropdown-menu" role="menu">',"</ul>"],pageDropdownItemHtml:'<li role="menuitem" class="%s"><a href="#">%s</a></li>'},4:{buttonsClass:"secondary",iconsPrefix:"fa",icons:{paginationSwitchDown:"fa-toggle-down",paginationSwitchUp:"fa-toggle-up",refresh:"fa-refresh",toggleOff:"fa-toggle-off",toggleOn:"fa-toggle-on",columns:"fa-th-list",detailOpen:"fa-plus",detailClose:"fa-minus",fullscreen:"fa-arrows-alt"},pullClass:"float",toobarDropdowHtml:['<div class="dropdown-menu dropdown-menu-right">',"</div>"],toobarDropdowItemHtml:'<label class="dropdown-item">%s</label>',pageDropdownHtml:['<div class="dropdown-menu">',"</div>"],pageDropdownItemHtml:'<a class="dropdown-item %s" href="#">%s</a>'}}[b],e=null;q.DEFAULTS={classes:"table table-hover",sortClass:void 0,locale:void 0,height:void 0,undefinedText:"-",sortName:void 0,sortOrder:"asc",sortStable:!1,rememberOrder:!1,striped:!1,columns:[[]],data:[],totalField:"total",dataField:"rows",method:"get",url:void 0,ajax:void 0,cache:!0,contentType:"application/json",dataType:"json",ajaxOptions:{},queryParams:function(a){return a},queryParamsType:"limit",responseHandler:function(a){return a},pagination:!1,onlyInfoPagination:!1,paginationLoop:!0,sidePagination:"client",totalRows:0,pageNumber:1,pageSize:10,pageList:[10,25,50,100],paginationHAlign:"right",paginationVAlign:"bottom",paginationDetailHAlign:"left",paginationPreText:"&lsaquo;",paginationNextText:"&rsaquo;",search:!1,searchOnEnterKey:!1,strictSearch:!1,searchAlign:"right",selectItemName:"btSelectItem",showHeader:!0,showFooter:!1,showColumns:!1,showPaginationSwitch:!1,showRefresh:!1,showToggle:!1,showFullscreen:!1,smartDisplay:!0,escape:!1,minimumCountColumns:1,idField:void 0,uniqueId:void 0,cardView:!1,detailView:!1,detailFormatter:function(){return""},detailFilter:function(){return!0},trimOnSearch:!0,clickToSelect:!1,singleSelect:!1,toolbar:void 0,toolbarAlign:"left",buttonsToolbar:void 0,buttonsAlign:"right",checkboxHeader:!0,sortable:!0,silentSort:!0,maintainSelected:!1,searchTimeOut:500,searchText:"",iconSize:void 0,buttonsClass:d.buttonsClass,iconsPrefix:d.iconsPrefix,icons:d.icons,customSearch:a.noop,customSort:a.noop,ignoreClickToSelectOn:function(b){return a.inArray(b.tagName,["A","BUTTON"])},rowStyle:function(){return{}},rowAttributes:function(){return{}},footerStyle:function(){return{}},onAll:function(){return!1},onClickCell:function(){return!1},onDblClickCell:function(){return!1},onClickRow:function(){return!1},onDblClickRow:function(){return!1},onSort:function(){return!1},onCheck:function(){return!1},onUncheck:function(){return!1},onCheckAll:function(){return!1},onUncheckAll:function(){return!1},onCheckSome:function(){return!1},onUncheckSome:function(){return!1},onLoadSuccess:function(){return!1},onLoadError:function(){return!1},onColumnSwitch:function(){return!1},onPageChange:function(){return!1},onSearch:function(){return!1},onToggle:function(){return!1},onPreBody:function(){return!1},onPostBody:function(){return!1},onPostHeader:function(){return!1},onExpandRow:function(){return!1},onCollapseRow:function(){return!1},onRefreshOptions:function(){return!1},onRefresh:function(){return!1},onResetView:function(){return!1},onScrollBody:function(){return!1}},(q.LOCALES={})["en-US"]=q.LOCALES.en={formatLoadingMessage:function(){return"Loading, please wait..."},formatRecordsPerPage:function(a){return f("%s rows per page",a)},formatShowingRows:function(a,b,c){return f("Showing %s to %s of %s rows",a,b,c)},formatDetailPagination:function(a){return f("Showing %s rows",a)},formatSearch:function(){return"Search"},formatNoMatches:function(){return"No matching records found"},formatPaginationSwitch:function(){return"Hide/Show pagination"},formatRefresh:function(){return"Refresh"},formatToggle:function(){return"Toggle"},formatFullscreen:function(){return"Fullscreen"},formatColumns:function(){return"Columns"},formatAllRows:function(){return"All"}},a.extend(q.DEFAULTS,q.LOCALES["en-US"]),q.COLUMN_DEFAULTS={radio:!1,checkbox:!1,checkboxEnabled:!0,field:void 0,title:void 0,titleTooltip:void 0,class:void 0,align:void 0,halign:void 0,falign:void 0,valign:void 0,width:void 0,sortable:!1,order:"asc",visible:!0,switchable:!0,clickToSelect:!0,formatter:void 0,footerFormatter:void 0,events:void 0,sorter:void 0,sortName:void 0,cellStyle:void 0,searchable:!0,searchFormatter:!0,cardVisible:!0,escape:!1,showSelectTitle:!1},q.EVENTS={"all.bs.table":"onAll","click-cell.bs.table":"onClickCell","dbl-click-cell.bs.table":"onDblClickCell","click-row.bs.table":"onClickRow","dbl-click-row.bs.table":"onDblClickRow","sort.bs.table":"onSort","check.bs.table":"onCheck","uncheck.bs.table":"onUncheck","check-all.bs.table":"onCheckAll","uncheck-all.bs.table":"onUncheckAll","check-some.bs.table":"onCheckSome","uncheck-some.bs.table":"onUncheckSome","load-success.bs.table":"onLoadSuccess","load-error.bs.table":"onLoadError","column-switch.bs.table":"onColumnSwitch","page-change.bs.table":"onPageChange","search.bs.table":"onSearch","toggle.bs.table":"onToggle","pre-body.bs.table":"onPreBody","post-body.bs.table":"onPostBody","post-header.bs.table":"onPostHeader","expand-row.bs.table":"onExpandRow","collapse-row.bs.table":"onCollapseRow","refresh-options.bs.table":"onRefreshOptions","reset-view.bs.table":"onResetView","refresh.bs.table":"onRefresh","scroll-body.bs.table":"onScrollBody"},q.prototype.init=function(){this.initLocale(),this.initContainer(),this.initTable(),this.initHeader(),this.initData(),this.initHiddenRows(),this.initFooter(),this.initToolbar(),this.initPagination(),this.initBody(),this.initSearchText(),this.initServer()},q.prototype.initLocale=function(){if(this.options.locale){var b=this.options.locale.split(/-|_/);b[0].toLowerCase(),b[1]&&b[1].toUpperCase(),a.fn.bootstrapTable.locales[this.options.locale]?a.extend(this.options,a.fn.bootstrapTable.locales[this.options.locale]):a.fn.bootstrapTable.locales[b.join("-")]?a.extend(this.options,a.fn.bootstrapTable.locales[b.join("-")]):a.fn.bootstrapTable.locales[b[0]]&&a.extend(this.options,a.fn.bootstrapTable.locales[b[0]])}},q.prototype.initContainer=function(){this.$container=a(['<div class="bootstrap-table">','<div class="fixed-table-toolbar"></div>',"top"===this.options.paginationVAlign||"both"===this.options.paginationVAlign?'<div class="fixed-table-pagination" style="clear: both;"></div>':"",'<div class="fixed-table-container">','<div class="fixed-table-header"><table></table></div>','<div class="fixed-table-body">','<div class="fixed-table-loading">',this.options.formatLoadingMessage(),"</div>","</div>",'<div class="fixed-table-footer"><table><tr></tr></table></div>',"</div>","bottom"===this.options.paginationVAlign||"both"===this.options.paginationVAlign?'<div class="fixed-table-pagination"></div>':"","</div>"].join("")),this.$container.insertAfter(this.$el),this.$tableContainer=this.$container.find(".fixed-table-container"),this.$tableHeader=this.$container.find(".fixed-table-header"),this.$tableBody=this.$container.find(".fixed-table-body"),this.$tableLoading=this.$container.find(".fixed-table-loading"),this.$tableFooter=this.$container.find(".fixed-table-footer"),this.$toolbar=this.options.buttonsToolbar?a("body").find(this.options.buttonsToolbar):this.$container.find(".fixed-table-toolbar"),this.$pagination=this.$container.find(".fixed-table-pagination"),this.$tableBody.append(this.$el),this.$container.after('<div class="clearfix"></div>'),this.$el.addClass(this.options.classes),this.options.striped&&this.$el.addClass("table-striped"),-1!==a.inArray("table-no-bordered",this.options.classes.split(" "))&&this.$tableContainer.addClass("table-no-bordered")},q.prototype.initTable=function(){var b=this,c=[],d=[];if(this.$header=this.$el.find(">thead"),this.$header.length||(this.$header=a("<thead></thead>").appendTo(this.$el)),this.$header.find("tr").each(function(){var b=[];a(this).find("th").each(function(){void 0!==a(this).data("field")&&a(this).data("field",a(this).data("field")+""),b.push(a.extend({},{title:a(this).html(),class:a(this).attr("class"),titleTooltip:a(this).attr("title"),rowspan:a(this).attr("rowspan")?+a(this).attr("rowspan"):void 0,colspan:a(this).attr("colspan")?+a(this).attr("colspan"):void 0},a(this).data()))}),c.push(b)}),a.isArray(this.options.columns[0])||(this.options.columns=[this.options.columns]),this.options.columns=a.extend(!0,[],c,this.options.columns),this.columns=[],this.fieldsColumnsIndex=[],function(b){var c,d,e,f=0,g=[];for(c=0;c<b[0].length;c++)f+=b[0][c].colspan||1;for(c=0;c<b.length;c++)for(g[c]=[],d=0;d<f;d++)g[c][d]=!1;for(c=0;c<b.length;c++)for(d=0;d<b[c].length;d++){var h=b[c][d],i=h.rowspan||1,j=h.colspan||1,k=a.inArray(!1,g[c]);for(1===j&&(h.fieldIndex=k,void 0===h.field&&(h.field=k)),e=0;e<i;e++)g[c+e][k]=!0;for(e=0;e<j;e++)g[c][k+e]=!0}}(this.options.columns),a.each(this.options.columns,function(c,d){a.each(d,function(d,e){void 0!==(e=a.extend({},q.COLUMN_DEFAULTS,e)).fieldIndex&&(b.columns[e.fieldIndex]=e,b.fieldsColumnsIndex[e.field]=e.fieldIndex),b.options.columns[c][d]=e})}),!this.options.data.length){var e=[];this.$el.find(">tbody>tr").each(function(c){var f={};f._id=a(this).attr("id"),f._class=a(this).attr("class"),f._data=m(a(this).data()),a(this).find(">td").each(function(d){for(var g,h,i=a(this),j=+i.attr("colspan")||1,k=+i.attr("rowspan")||1;e[c]&&e[c][d];d++);for(g=d;g<d+j;g++)for(h=c;h<c+k;h++)e[h]||(e[h]=[]),e[h][g]=!0;var l=b.columns[d].field;f[l]=a(this).html(),f["_"+l+"_id"]=a(this).attr("id"),f["_"+l+"_class"]=a(this).attr("class"),f["_"+l+"_rowspan"]=a(this).attr("rowspan"),f["_"+l+"_colspan"]=a(this).attr("colspan"),f["_"+l+"_title"]=a(this).attr("title"),f["_"+l+"_data"]=m(a(this).data())}),d.push(f)}),(this.options.data=d).length&&(this.fromHtml=!0)}},q.prototype.initHeader=function(){var b=this,c={},d=[];this.header={fields:[],styles:[],classes:[],formatters:[],events:[],sorters:[],sortNames:[],cellStyles:[],searchables:[]},a.each(this.options.columns,function(e,g){d.push("<tr>"),0===e&&!b.options.cardView&&b.options.detailView&&d.push(f('<th class="detail" rowspan="%s"><div class="fht-cell"></div></th>',b.options.columns.length)),a.each(g,function(a,e){var h,i,g="",j="",k=f(' class="%s"',e.class),m=(b.options.sortOrder||e.order,"px"),n=e.width;if(void 0===e.width||b.options.cardView||"string"==typeof e.width&&-1!==e.width.indexOf("%")&&(m="%"),e.width&&"string"==typeof e.width&&(n=e.width.replace("%","").replace("px","")),h=f("text-align: %s; ",e.halign?e.halign:e.align),i=f("text-align: %s; ",e.align),j=f("vertical-align: %s; ",e.valign),j+=f("width: %s; ",!e.checkbox&&!e.radio||n?n?n+m:void 0:e.showSelectTitle?void 0:"36px"),void 0!==e.fieldIndex){if(b.header.fields[e.fieldIndex]=e.field,b.header.styles[e.fieldIndex]=i+j,b.header.classes[e.fieldIndex]=k,b.header.formatters[e.fieldIndex]=e.formatter,b.header.events[e.fieldIndex]=e.events,b.header.sorters[e.fieldIndex]=e.sorter,b.header.sortNames[e.fieldIndex]=e.sortName,b.header.cellStyles[e.fieldIndex]=e.cellStyle,b.header.searchables[e.fieldIndex]=e.searchable,!e.visible)return;if(b.options.cardView&&!e.cardVisible)return;c[e.field]=e}d.push("<th"+f(' title="%s"',e.titleTooltip),e.checkbox||e.radio?f(' class="bs-checkbox %s"',e.class||""):k,f(' style="%s"',h+j),f(' rowspan="%s"',e.rowspan),f(' colspan="%s"',e.colspan),f(' data-field="%s"',e.field),0===a&&e.fieldIndex?" data-not-first-th":"",">"),d.push(f('<div class="th-inner %s">',b.options.sortable&&e.sortable?"sortable both":""));var o=g=b.options.escape?l(e.title):e.title;e.checkbox&&(g="",!b.options.singleSelect&&b.options.checkboxHeader&&(g='<input name="btSelectAll" type="checkbox" />'),b.header.stateField=e.field),e.radio&&(g="",b.header.stateField=e.field,b.options.singleSelect=!0),!g&&e.showSelectTitle&&(g+=o),d.push(g),d.push("</div>"),d.push('<div class="fht-cell"></div>'),d.push("</div>"),d.push("</th>")}),d.push("</tr>")}),this.$header.html(d.join("")),this.$header.find("th[data-field]").each(function(){a(this).data(c[a(this).data("field")])}),this.$container.off("click",".th-inner").on("click",".th-inner",function(c){var d=a(this);return!(b.options.detailView&&!d.parent().hasClass("bs-checkbox")&&d.closest(".bootstrap-table")[0]!==b.$container[0])&&void(b.options.sortable&&d.parent().data().sortable&&b.onSort(c))}),this.$header.children().children().off("keypress").on("keypress",function(c){b.options.sortable&&a(this).data().sortable&&13==(c.keyCode||c.which)&&b.onSort(c)}),a(window).off("resize.bootstrap-table"),!this.options.showHeader||this.options.cardView?(this.$header.hide(),this.$tableHeader.hide(),this.$tableLoading.css("top",0)):(this.$header.show(),this.$tableHeader.show(),this.$tableLoading.css("top",this.$header.outerHeight()+1),this.getCaret(),a(window).on("resize.bootstrap-table",a.proxy(this.resetWidth,this))),this.$selectAll=this.$header.find('[name="btSelectAll"]'),this.$selectAll.off("click").on("click",function(){var c=a(this).prop("checked");b[c?"checkAll":"uncheckAll"](),b.updateSelected()})},q.prototype.initFooter=function(){!this.options.showFooter||this.options.cardView?this.$tableFooter.hide():this.$tableFooter.show()},q.prototype.initData=function(a,b){this.options.data="append"===b?this.options.data.concat(a):"prepend"===b?[].concat(a).concat(this.options.data):a||this.options.data,this.data=this.options.data,"server"!==this.options.sidePagination&&this.initSort()},q.prototype.initSort=function(){var b=this,c=this.options.sortName,d="desc"===this.options.sortOrder?-1:1,e=a.inArray(this.options.sortName,this.header.fields),g=0;return this.options.customSort!==a.noop?void this.options.customSort.apply(this,[this.options.sortName,this.options.sortOrder]):void(-1!==e&&(this.options.sortStable&&a.each(this.data,function(a,b){b._position=a}),this.data.sort(function(f,g){b.header.sortNames[e]&&(c=b.header.sortNames[e]);var h=n(f,c,b.options.escape),i=n(g,c,b.options.escape),k=j(b.header,b.header.sorters[e],[h,i,f,g]);return void 0!==k?b.options.sortStable&&0===k?f._position-g._position:d*k:(null==h&&(h=""),null==i&&(i=""),b.options.sortStable&&h===i?(h=f._position,i=g._position,f._position-g._position):a.isNumeric(h)&&a.isNumeric(i)?(h=parseFloat(h))<(i=parseFloat(i))?-1*d:d:h===i?0:("string"!=typeof h&&(h=h.toString()),-1===h.localeCompare(i)?-1*d:d))}),void 0!==this.options.sortClass&&(clearTimeout(g),g=setTimeout(function(){b.$el.removeClass(b.options.sortClass);var a=b.$header.find(f('[data-field="%s"]',b.options.sortName).index()+1);b.$el.find(f("tr td:nth-child(%s)",a)).addClass(b.options.sortClass)},250))))},q.prototype.onSort=function(b){var c="keypress"===b.type?a(b.currentTarget):a(b.currentTarget).parent(),d=this.$header.find("th").eq(c.index());return this.$header.add(this.$header_).find("span.order").remove(),this.options.sortName===c.data("field")?this.options.sortOrder="asc"===this.options.sortOrder?"desc":"asc":(this.options.sortName=c.data("field"),this.options.sortOrder=this.options.rememberOrder?"asc"===c.data("order")?"desc":"asc":this.columns[this.fieldsColumnsIndex[c.data("field")]].order),this.trigger("sort",this.options.sortName,this.options.sortOrder),c.add(d).data("order",this.options.sortOrder),this.getCaret(),"server"===this.options.sidePagination?void this.initServer(this.options.silentSort):(this.initSort(),void this.initBody())},q.prototype.initToolbar=function(){var b,c,e=this,g=[],h=0,i=0;this.$toolbar.find(".bs-bars").children().length&&a("body").append(a(this.options.toolbar)),this.$toolbar.html(""),"string"!=typeof this.options.toolbar&&"object"!=typeof this.options.toolbar||a(f('<div class="bs-bars %s-%s"></div>',d.pullClass,this.options.toolbarAlign)).appendTo(this.$toolbar).append(a(this.options.toolbar)),g=[f('<div class="columns columns-%s btn-group %s-%s">',this.options.buttonsAlign,d.pullClass,this.options.buttonsAlign)],"string"==typeof this.options.icons&&(this.options.icons=j(null,this.options.icons)),this.options.showPaginationSwitch&&g.push(f('<button class="btn'+f(" btn-%s",this.options.buttonsClass)+f(" btn-%s",this.options.iconSize)+'" type="button" name="paginationSwitch" aria-label="pagination Switch" title="%s">',this.options.formatPaginationSwitch()),f('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.paginationSwitchDown),"</button>"),this.options.showFullscreen&&this.$toolbar.find('button[name="fullscreen"]').off("click").on("click",a.proxy(this.toggleFullscreen,this)),this.options.showRefresh&&g.push(f('<button class="btn'+f(" btn-%s",this.options.buttonsClass)+f(" btn-%s",this.options.iconSize)+'" type="button" name="refresh" aria-label="refresh" title="%s">',this.options.formatRefresh()),f('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.refresh),"</button>"),this.options.showToggle&&g.push(f('<button class="btn'+f(" btn-%s",this.options.buttonsClass)+f(" btn-%s",this.options.iconSize)+'" type="button" name="toggle" aria-label="toggle" title="%s">',this.options.formatToggle()),f('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.toggle),"</button>"),this.options.showFullscreen&&g.push(f('<button class="btn'+f(" btn-%s",this.options.buttonsClass)+f(" btn-%s",this.options.iconSize)+'" type="button" name="fullscreen" aria-label="fullscreen" title="%s">',this.options.formatFullscreen()),f('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.fullscreen),"</button>"),this.options.showColumns&&(g.push(f('<div class="keep-open btn-group" title="%s">',this.options.formatColumns()),'<button type="button" aria-label="columns" class="btn'+f(" btn-%s",this.options.buttonsClass)+f(" btn-%s",this.options.iconSize)+' dropdown-toggle" data-toggle="dropdown">',f('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.columns),' <span class="caret"></span>',"</button>",d.toobarDropdowHtml[0]),a.each(this.columns,function(a,b){if(!(b.radio||b.checkbox||e.options.cardView&&!b.cardVisible)){var c=b.visible?' checked="checked"':"";b.switchable&&(g.push(f(d.toobarDropdowItemHtml,f('<input type="checkbox" data-field="%s" value="%s"%s> %s',b.field,a,c,b.title))),i++)}}),g.push(d.toobarDropdowHtml[1],"</div>")),g.push("</div>"),(this.showToolbar||2<g.length)&&this.$toolbar.append(g.join("")),this.options.showPaginationSwitch&&this.$toolbar.find('button[name="paginationSwitch"]').off("click").on("click",a.proxy(this.togglePagination,this)),this.options.showRefresh&&this.$toolbar.find('button[name="refresh"]').off("click").on("click",a.proxy(this.refresh,this)),this.options.showToggle&&this.$toolbar.find('button[name="toggle"]').off("click").on("click",function(){e.toggleView()}),this.options.showColumns&&(b=this.$toolbar.find(".keep-open"),i<=this.options.minimumCountColumns&&b.find("input").prop("disabled",!0),b.find("li").off("click").on("click",function(a){a.stopImmediatePropagation()}),b.find("input").off("click").on("click",function(){var b=a(this);e.toggleColumn(a(this).val(),b.prop("checked"),!1),e.trigger("column-switch",a(this).data("field"),b.prop("checked"))})),this.options.search&&((g=[]).push(f('<div class="%s-%s search">',d.pullClass,this.options.searchAlign),f('<input class="form-control'+f(" input-%s",this.options.iconSize)+'" type="text" placeholder="%s">',this.options.formatSearch()),"</div>"),this.$toolbar.append(g.join("")),(c=this.$toolbar.find(".search input")).off("keyup drop blur").on("keyup drop blur",function(b){e.options.searchOnEnterKey&&13!==b.keyCode||-1<a.inArray(b.keyCode,[37,38,39,40])||(clearTimeout(h),h=setTimeout(function(){e.onSearch(b)},e.options.searchTimeOut))}),o()&&c.off("mouseup").on("mouseup",function(a){clearTimeout(h),h=setTimeout(function(){e.onSearch(a)},e.options.searchTimeOut)}))},q.prototype.onSearch=function(b){var c=a.trim(a(b.currentTarget).val());this.options.trimOnSearch&&a(b.currentTarget).val()!==c&&a(b.currentTarget).val(c),c!==this.searchText&&(this.searchText=c,this.options.searchText=c,this.options.pageNumber=1,this.initSearch(),b.firedByInitSearchText?"client"===this.options.sidePagination&&this.updatePagination():this.updatePagination(),this.trigger("search",c))},q.prototype.initSearch=function(){var b=this;if("server"!==this.options.sidePagination){if(this.options.customSearch!==a.noop)return void window[this.options.customSearch].apply(this,[this.searchText]);var c=this.searchText&&(this.options.escape?l(this.searchText):this.searchText).toLowerCase(),d=a.isEmptyObject(this.filterColumns)?null:this.filterColumns;this.data=d?a.grep(this.options.data,function(b){for(var c in d)if(a.isArray(d[c])&&-1===a.inArray(b[c],d[c])||!a.isArray(d[c])&&b[c]!==d[c])return!1;return!0}):this.options.data,this.data=c?a.grep(this.data,function(d,e){for(var f=0;f<b.header.fields.length;f++)if(b.header.searchables[f]){var g,h=a.isNumeric(b.header.fields[f])?parseInt(b.header.fields[f],10):b.header.fields[f],i=b.columns[b.fieldsColumnsIndex[h]];if("string"==typeof h){g=d;for(var k=h.split("."),l=0;l<k.length;l++)null!=g[k[l]]&&(g=g[k[l]]);i&&i.searchFormatter&&(g=j(i,b.header.formatters[f],[g,d,e],g))}else g=d[h];if("string"==typeof g||"number"==typeof g)if(b.options.strictSearch){if((g+"").toLowerCase()===c)return!0}else if(-1!==(g+"").toLowerCase().indexOf(c))return!0}return!1}):this.data}},q.prototype.initPagination=function(){if(this.options.pagination){this.$pagination.show();var b,c,e,g,h,i,j,k=this,l=[],m=!1,n=this.getData(),o=this.options.pageList;if("server"!==this.options.sidePagination&&(this.options.totalRows=n.length),this.totalPages=0,this.options.totalRows){if(this.options.pageSize===this.options.formatAllRows())this.options.pageSize=this.options.totalRows,m=!0;else if(this.options.pageSize===this.options.totalRows){var p="string"==typeof this.options.pageList?this.options.pageList.replace("[","").replace("]","").replace(/ /g,"").toLowerCase().split(","):this.options.pageList;-1<a.inArray(this.options.formatAllRows().toLowerCase(),p)&&(m=!0)}this.totalPages=1+~~((this.options.totalRows-1)/this.options.pageSize),this.options.totalPages=this.totalPages}if(0<this.totalPages&&this.options.pageNumber>this.totalPages&&(this.options.pageNumber=this.totalPages),this.pageFrom=(this.options.pageNumber-1)*this.options.pageSize+1,this.pageTo=this.options.pageNumber*this.options.pageSize,this.pageTo>this.options.totalRows&&(this.pageTo=this.options.totalRows),l.push(f('<div class="%s-%s pagination-detail">',d.pullClass,this.options.paginationDetailHAlign),'<span class="pagination-info">',this.options.onlyInfoPagination?this.options.formatDetailPagination(this.options.totalRows):this.options.formatShowingRows(this.pageFrom,this.pageTo,this.options.totalRows),"</span>"),!this.options.onlyInfoPagination){l.push('<span class="page-list">');var q=[f('<span class="btn-group %s">',"top"===this.options.paginationVAlign||"both"===this.options.paginationVAlign?"dropdown":"dropup"),'<button type="button" class="btn'+f(" btn-%s",this.options.buttonsClass)+f(" btn-%s",this.options.iconSize)+' dropdown-toggle" data-toggle="dropdown">','<span class="page-size">',m?this.options.formatAllRows():this.options.pageSize,"</span>",' <span class="caret"></span>',"</button>",d.pageDropdownHtml[0]];if("string"==typeof this.options.pageList){var r=this.options.pageList.replace("[","").replace("]","").replace(/ /g,"").split(",");o=[],a.each(r,function(a,b){o.push(b.toUpperCase()===k.options.formatAllRows().toUpperCase()||"UNLIMITED"===b.toUpperCase()?k.options.formatAllRows():+b)})}for(a.each(o,function(a,b){var c;(!k.options.smartDisplay||0===a||o[a-1]<k.options.totalRows)&&(c=m?b===k.options.formatAllRows()?"active":"":b===k.options.pageSize?"active":"",q.push(f(d.pageDropdownItemHtml,c,b)))}),q.push(d.pageDropdownHtml[1]+"</span>"),l.push(this.options.formatRecordsPerPage(q.join(""))),l.push("</span>"),l.push("</div>",f('<div class="%s-%s pagination">',d.pullClass,this.options.paginationHAlign),'<ul class="pagination'+f(" pagination-%s",this.options.iconSize)+'">',f('<li class="page-item page-pre"><a class="page-link" href="#">%s</a></li>',this.options.paginationPreText)),this.totalPages<5?(c=1,e=this.totalPages):(e=(c=this.options.pageNumber-2)+4,c<1&&(c=1,e=5),e>this.totalPages&&(c=(e=this.totalPages)-4)),6<=this.totalPages&&(3<=this.options.pageNumber&&(l.push(f('<li class="page-item page-first%s">',1===this.options.pageNumber?" active":""),'<a class="page-link" href="#">',1,"</a>","</li>"),c++),4<=this.options.pageNumber&&(4==this.options.pageNumber||6==this.totalPages||7==this.totalPages?c--:l.push('<li class="page-item page-first-separator disabled">','<a class="page-link" href="#">...</a>',"</li>"),e--)),7<=this.totalPages&&this.options.pageNumber>=this.totalPages-2&&c--,6==this.totalPages?this.options.pageNumber>=this.totalPages-2&&e++:7<=this.totalPages&&(7==this.totalPages||this.options.pageNumber>=this.totalPages-3)&&e++,b=c;b<=e;b++)l.push(f('<li class="page-item%s">',b===this.options.pageNumber?" active":""),'<a class="page-link" href="#">',b,"</a>","</li>");8<=this.totalPages&&this.options.pageNumber<=this.totalPages-4&&l.push('<li class="page-item page-last-separator disabled">','<a class="page-link" href="#">...</a>',"</li>"),6<=this.totalPages&&this.options.pageNumber<=this.totalPages-3&&l.push(f('<li class="page-item page-last%s">',this.totalPages===this.options.pageNumber?" active":""),'<a class="page-link" href="#">',this.totalPages,"</a>","</li>"),l.push(f('<li class="page-item page-next"><a class="page-link" href="#">%s</a></li>',this.options.paginationNextText),"</ul>","</div>")}this.$pagination.html(l.join("")),this.options.onlyInfoPagination||(g=this.$pagination.find(".page-list a"),h=this.$pagination.find(".page-pre"),i=this.$pagination.find(".page-next"),j=this.$pagination.find(".page-item").not(".page-next, .page-pre"),this.options.smartDisplay&&(this.totalPages<=1&&this.$pagination.find("div.pagination").hide(),(o.length<2||this.options.totalRows<=o[0])&&this.$pagination.find("span.page-list").hide(),this.$pagination[this.getData().length?"show":"hide"]()),this.options.paginationLoop||(1===this.options.pageNumber&&h.addClass("disabled"),this.options.pageNumber===this.totalPages&&i.addClass("disabled")),m&&(this.options.pageSize=this.options.formatAllRows()),g.off("click").on("click",a.proxy(this.onPageListChange,this)),h.off("click").on("click",a.proxy(this.onPagePre,this)),i.off("click").on("click",a.proxy(this.onPageNext,this)),j.off("click").on("click",a.proxy(this.onPageNumber,this)))}else this.$pagination.hide()},q.prototype.updatePagination=function(b){b&&a(b.currentTarget).hasClass("disabled")||(this.options.maintainSelected||this.resetRows(),this.initPagination(),"server"===this.options.sidePagination?this.initServer():this.initBody(),this.trigger("page-change",this.options.pageNumber,this.options.pageSize))},q.prototype.onPageListChange=function(b){b.preventDefault();var c=a(b.currentTarget);return c.parent().addClass("active").siblings().removeClass("active"),this.options.pageSize=c.text().toUpperCase()===this.options.formatAllRows().toUpperCase()?this.options.formatAllRows():+c.text(),this.$toolbar.find(".page-size").text(this.options.pageSize),this.updatePagination(b),!1},q.prototype.onPagePre=function(a){return a.preventDefault(),this.options.pageNumber-1==0?this.options.pageNumber=this.options.totalPages:this.options.pageNumber--,this.updatePagination(a),!1},q.prototype.onPageNext=function(a){return a.preventDefault(),this.options.pageNumber+1>this.options.totalPages?this.options.pageNumber=1:this.options.pageNumber++,this.updatePagination(a),!1},q.prototype.onPageNumber=function(b){return b.preventDefault(),this.options.pageNumber!==+a(b.currentTarget).text()?(this.options.pageNumber=+a(b.currentTarget).text(),this.updatePagination(b),!1):void 0},q.prototype.initRow=function(b,c){var d,e=this,h=[],i={},k=[],m="",o={},p=[];if(!(-1<a.inArray(b,this.hiddenRows))){if((i=j(this.options,this.options.rowStyle,[b,c],i))&&i.css)for(d in i.css)k.push(d+": "+i.css[d]);if(o=j(this.options,this.options.rowAttributes,[b,c],o))for(d in o)p.push(f('%s="%s"',d,l(o[d])));return b._data&&!a.isEmptyObject(b._data)&&a.each(b._data,function(a,b){"index"!==a&&(m+=f(' data-%s="%s"',a,b))}),h.push("<tr",f(" %s",p.join(" ")),f(' id="%s"',a.isArray(b)?void 0:b._id),f(' class="%s"',i.classes||(a.isArray(b)?void 0:b._class)),f(' data-index="%s"',c),f(' data-uniqueid="%s"',b[this.options.uniqueId]),f("%s",m),">"),this.options.cardView&&h.push(f('<td colspan="%s"><div class="card-views">',this.header.fields.length)),!this.options.cardView&&this.options.detailView&&(h.push("<td>"),j(null,this.options.detailFilter,[c,b])&&h.push('<a class="detail-icon" href="#">',f('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.detailOpen),"</a>"),h.push("</td>")),a.each(this.header.fields,function(d,m){var o="",p=n(b,m,e.options.escape),q="",r="",s={},t="",u=e.header.classes[d],v="",w="",x="",y="",z=e.columns[d];if((!e.fromHtml||void 0!==p||z.checkbox||z.radio)&&z.visible&&(!e.options.cardView||z.cardVisible)){if(z.escape&&(p=l(p)),i=f('style="%s"',k.concat(e.header.styles[d]).join("; ")),b["_"+m+"_id"]&&(t=f(' id="%s"',b["_"+m+"_id"])),b["_"+m+"_class"]&&(u=f(' class="%s"',b["_"+m+"_class"])),b["_"+m+"_rowspan"]&&(w=f(' rowspan="%s"',b["_"+m+"_rowspan"])),b["_"+m+"_colspan"]&&(x=f(' colspan="%s"',b["_"+m+"_colspan"])),b["_"+m+"_title"]&&(y=f(' title="%s"',b["_"+m+"_title"])),(s=j(e.header,e.header.cellStyles[d],[p,b,c,m],s)).classes&&(u=f(' class="%s"',s.classes)),s.css){var A=[];for(var B in s.css)A.push(B+": "+s.css[B]);i=f('style="%s"',A.concat(e.header.styles[d]).join("; "))}q=j(z,e.header.formatters[d],[p,b,c,m],p),b["_"+m+"_data"]&&!a.isEmptyObject(b["_"+m+"_data"])&&a.each(b["_"+m+"_data"],function(a,b){"index"!==a&&(v+=f(' data-%s="%s"',a,b))}),z.checkbox||z.radio?(r=z.checkbox?"checkbox":r,r=z.radio?"radio":r,o=[f(e.options.cardView?'<div class="card-view %s">':'<td class="bs-checkbox %s">',z.class||""),"<input"+f(' data-index="%s"',c)+f(' name="%s"',e.options.selectItemName)+f(' type="%s"',r)+f(' value="%s"',b[e.options.idField])+f(' checked="%s"',!0===q||p||q&&q.checked?"checked":void 0)+f(' disabled="%s"',!z.checkboxEnabled||q&&q.disabled?"disabled":void 0)+" />",e.header.formatters[d]&&"string"==typeof q?q:"",e.options.cardView?"</div>":"</td>"].join(""),b[e.header.stateField]=!0===q||!!p||q&&q.checked):(q=null==q?e.options.undefinedText:q,o=e.options.cardView?['<div class="card-view">',e.options.showHeader?f('<span class="title" %s>%s</span>',i,function(b,c,d,e){var f="";return a.each(b,function(a,b){return b[c]!==e||(f=b[d],!1)}),f}(e.columns,"field","title",m)):"",f('<span class="value">%s</span>',q),"</div>"].join(""):[f("<td%s %s %s %s %s %s %s>",t,u,i,v,w,x,y),q,"</td>"].join(""),e.options.cardView&&e.options.smartDisplay&&""===q&&(o='<div class="card-view"></div>')),h.push(o)}}),this.options.cardView&&h.push("</div></td>"),h.push("</tr>"),h.join(" ")}},q.prototype.initBody=function(b){var c=this,d=this.getData();this.trigger("pre-body",d),this.$body=this.$el.find(">tbody"),this.$body.length||(this.$body=a("<tbody></tbody>").appendTo(this.$el)),this.options.pagination&&"server"!==this.options.sidePagination||(this.pageFrom=1,this.pageTo=d.length);for(var e,g=a(document.createDocumentFragment()),h=this.pageFrom-1;h<this.pageTo;h++){var i=d[h],k=this.initRow(i,h,d,g);e=e||!!k,k&&!0!==k&&g.append(k)}e||g.append('<tr class="no-records-found">'+f('<td colspan="%s">%s</td>',this.$header.find("th").length,this.options.formatNoMatches())+"</tr>"),this.$body.html(g),b||this.scrollTo(0),this.$body.find("> tr[data-index] > td").off("click dblclick").on("click dblclick",function(b){var d=a(this),e=d.parent(),g=c.data[e.data("index")],h=d[0].cellIndex,j=c.getVisibleFields()[c.options.detailView&&!c.options.cardView?h-1:h],k=c.columns[c.fieldsColumnsIndex[j]],l=n(g,j,c.options.escape);if(!d.find(".detail-icon").length&&(c.trigger("click"===b.type?"click-cell":"dbl-click-cell",j,l,g,d),c.trigger("click"===b.type?"click-row":"dbl-click-row",g,e,j),"click"===b.type&&c.options.clickToSelect&&k.clickToSelect&&c.options.ignoreClickToSelectOn(b.target))){var m=e.find(f('[name="%s"]',c.options.selectItemName));m.length&&m[0].click()}}),this.$body.find("> tr[data-index] > td > .detail-icon").off("click").on("click",function(b){b.preventDefault();var e=a(this),g=e.parent().parent(),h=g.data("index"),i=d[h];if(g.next().is("tr.detail-view"))e.find("i").attr("class",f("%s %s",c.options.iconsPrefix,c.options.icons.detailOpen)),c.trigger("collapse-row",h,i,g.next()),g.next().remove();else{e.find("i").attr("class",f("%s %s",c.options.iconsPrefix,c.options.icons.detailClose)),g.after(f('<tr class="detail-view"><td colspan="%s"></td></tr>',g.find("td").length));var k=g.next().find("td"),l=j(c.options,c.options.detailFormatter,[h,i,k],"");1===k.length&&k.append(l),c.trigger("expand-row",h,i,k)}return c.resetView(),!1}),this.$selectItem=this.$body.find(f('[name="%s"]',this.options.selectItemName)),this.$selectItem.off("click").on("click",function(b){b.stopImmediatePropagation();var d=a(this),e=d.prop("checked"),f=c.data[d.data("index")];(a(this).is(":radio")||c.options.singleSelect)&&a.each(c.options.data,function(a,b){b[c.header.stateField]=!1}),f[c.header.stateField]=e,c.options.singleSelect&&(c.$selectItem.not(this).each(function(){c.data[a(this).data("index")][c.header.stateField]=!1}),c.$selectItem.filter(":checked").not(this).prop("checked",!1)),c.updateSelected(),c.trigger(e?"check":"uncheck",f,d)}),a.each(this.header.events,function(b,d){if(d){"string"==typeof d&&(d=j(null,d));var e=c.header.fields[b],f=a.inArray(e,c.getVisibleFields());if(-1!==f)for(var g in c.options.detailView&&!c.options.cardView&&(f+=1),d)c.$body.find(">tr:not(.no-records-found)").each(function(){var b=a(this),h=b.find(c.options.cardView?".card-view":"td").eq(f),i=g.indexOf(" "),j=g.substring(0,i),k=g.substring(i+1),l=d[g];h.find(k).off(j).on(j,function(a){var d=b.data("index"),f=c.data[d],g=f[e];l.apply(this,[a,g,f,d])})})}}),this.updateSelected(),this.resetView(),this.trigger("post-body",d)},q.prototype.initServer=function(b,c,d){var e,f=this,g={},h=a.inArray(this.options.sortName,this.header.fields),i={searchText:this.searchText,sortName:this.options.sortName,sortOrder:this.options.sortOrder};this.header.sortNames[h]&&(i.sortName=this.header.sortNames[h]),this.options.pagination&&"server"===this.options.sidePagination&&(i.pageSize=this.options.pageSize===this.options.formatAllRows()?this.options.totalRows:this.options.pageSize,i.pageNumber=this.options.pageNumber),(d||this.options.url||this.options.ajax)&&("limit"===this.options.queryParamsType&&(i={search:i.searchText,sort:i.sortName,order:i.sortOrder},this.options.pagination&&"server"===this.options.sidePagination&&(i.offset=this.options.pageSize===this.options.formatAllRows()?0:this.options.pageSize*(this.options.pageNumber-1),i.limit=this.options.pageSize===this.options.formatAllRows()?this.options.totalRows:this.options.pageSize,0===i.limit&&delete i.limit)),a.isEmptyObject(this.filterColumnsPartial)||(i.filter=JSON.stringify(this.filterColumnsPartial,null)),g=j(this.options,this.options.queryParams,[i],g),a.extend(g,c||{}),!1!==g&&(b||this.$tableLoading.show(),e=a.extend({},j(null,this.options.ajaxOptions),{type:this.options.method,url:d||this.options.url,data:"application/json"===this.options.contentType&&"post"===this.options.method?JSON.stringify(g):g,cache:this.options.cache,contentType:this.options.contentType,dataType:this.options.dataType,success:function(a){a=j(f.options,f.options.responseHandler,[a],a),f.load(a),f.trigger("load-success",a),b||f.$tableLoading.hide()},error:function(a){var c=[];"server"===f.options.sidePagination&&((c={})[f.options.totalField]=0,c[f.options.dataField]=[]),f.load(c),f.trigger("load-error",a.status,a),b||f.$tableLoading.hide()}}),this.options.ajax?j(this,this.options.ajax,[e],null):(this._xhr&&4!==this._xhr.readyState&&this._xhr.abort(),this._xhr=a.ajax(e))))},q.prototype.initSearchText=function(){if(this.options.search&&(this.searchText="")!==this.options.searchText){var a=this.$toolbar.find(".search input");a.val(this.options.searchText),this.onSearch({currentTarget:a,firedByInitSearchText:!0})}},q.prototype.getCaret=function(){var b=this;a.each(this.$header.find("th"),function(c,d){a(d).find(".sortable").removeClass("desc asc").addClass(a(d).data("field")===b.options.sortName?b.options.sortOrder:"both")})},q.prototype.updateSelected=function(){var b=this.$selectItem.filter(":enabled").length&&this.$selectItem.filter(":enabled").length===this.$selectItem.filter(":enabled").filter(":checked").length;this.$selectAll.add(this.$selectAll_).prop("checked",b),this.$selectItem.each(function(){a(this).closest("tr")[a(this).prop("checked")?"addClass":"removeClass"]("selected")})},q.prototype.updateRows=function(){var b=this;this.$selectItem.each(function(){b.data[a(this).data("index")][b.header.stateField]=a(this).prop("checked")})},q.prototype.resetRows=function(){var b=this;a.each(this.data,function(a,c){b.$selectAll.prop("checked",!1),b.$selectItem.prop("checked",!1),b.header.stateField&&(c[b.header.stateField]=!1)}),this.initHiddenRows()},q.prototype.trigger=function(b){var c=Array.prototype.slice.call(arguments,1);b+=".bs.table",this.options[q.EVENTS[b]].apply(this.options,c),this.$el.trigger(a.Event(b),c),this.options.onAll(b,c),this.$el.trigger(a.Event("all.bs.table"),[b,c])},q.prototype.resetHeader=function(){clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(a.proxy(this.fitHeader,this),this.$el.is(":hidden")?100:0)},q.prototype.fitHeader=function(){var b,c,d,e,g=this;if(g.$el.is(":hidden"))g.timeoutId_=setTimeout(a.proxy(g.fitHeader,g),100);else{if(c=(b=this.$tableBody.get(0)).scrollWidth>b.clientWidth&&b.scrollHeight>b.clientHeight+this.$header.outerHeight()?i():0,this.$el.css("margin-top",-this.$header.outerHeight()),0<(d=a(":focus")).length){var h=d.parents("th");if(0<h.length){var j=h.attr("data-field");if(void 0!==j){var k=this.$header.find("[data-field='"+j+"']");0<k.length&&k.find(":input").addClass("focus-temp")}}}this.$header_=this.$header.clone(!0,!0),this.$selectAll_=this.$header_.find('[name="btSelectAll"]'),this.$tableHeader.css({"margin-right":c}).find("table").css("width",this.$el.outerWidth()).html("").attr("class",this.$el.attr("class")).append(this.$header_),0<(e=a(".focus-temp:visible:eq(0)")).length&&(e.focus(),this.$header.find(".focus-temp").removeClass("focus-temp")),this.$header.find("th[data-field]").each(function(){g.$header_.find(f('th[data-field="%s"]',a(this).data("field"))).data(a(this).data())});var l=this.getVisibleFields(),m=this.$header_.find("th");this.$body.find(">tr:first-child:not(.no-records-found) > *").each(function(b){var c=a(this),d=b;if(g.options.detailView&&!g.options.cardView&&(0===b&&g.$header_.find("th.detail").find(".fht-cell").width(c.innerWidth()),d=b-1),-1!==d){var e=g.$header_.find(f('th[data-field="%s"]',l[d]));1<e.length&&(e=a(m[c[0].cellIndex]));var h=e.width()-e.find(".fht-cell").width();e.find(".fht-cell").width(c.innerWidth()-h)}}),this.horizontalScroll(),this.trigger("post-header")}},q.prototype.resetFooter=function(){var b=this,c=b.getData(),d=[];this.options.showFooter&&!this.options.cardView&&(!this.options.cardView&&this.options.detailView&&d.push('<td><div class="th-inner">&nbsp;</div><div class="fht-cell"></div></td>'),a.each(this.columns,function(a,e){var g,h="",i="",k=[],l={},m=f(' class="%s"',e.class);if(e.visible&&(!b.options.cardView||e.cardVisible)){if(h=f("text-align: %s; ",e.falign?e.falign:e.align),i=f("vertical-align: %s; ",e.valign),(l=j(null,b.options.footerStyle))&&l.css)for(g in l.css)k.push(g+": "+l.css[g]);d.push("<td",m,f(' style="%s"',h+i+k.concat().join("; ")),">"),d.push('<div class="th-inner">'),d.push(j(e,e.footerFormatter,[c],"&nbsp;")||"&nbsp;"),d.push("</div>"),d.push('<div class="fht-cell"></div>'),d.push("</div>"),d.push("</td>")}}),this.$tableFooter.find("tr").html(d.join("")),this.$tableFooter.show(),clearTimeout(this.timeoutFooter_),this.timeoutFooter_=setTimeout(a.proxy(this.fitFooter,this),this.$el.is(":hidden")?100:0))},q.prototype.fitFooter=function(){var b,c,d;return clearTimeout(this.timeoutFooter_),this.$el.is(":hidden")?void(this.timeoutFooter_=setTimeout(a.proxy(this.fitFooter,this),100)):(d=(c=this.$el.css("width"))>this.$tableBody.width()?i():0,this.$tableFooter.css({"margin-right":d}).find("table").css("width",c).attr("class",this.$el.attr("class")),b=this.$tableFooter.find("td"),this.$body.find(">tr:first-child:not(.no-records-found) > *").each(function(c){var d=a(this);b.eq(c).find(".fht-cell").width(d.innerWidth())}),void this.horizontalScroll())},q.prototype.horizontalScroll=function(){var b=this;b.trigger("scroll-body"),this.$tableBody.off("scroll").on("scroll",function(){b.options.showHeader&&b.options.height&&b.$tableHeader.scrollLeft(a(this).scrollLeft()),b.options.showFooter&&!b.options.cardView&&b.$tableFooter.scrollLeft(a(this).scrollLeft())})},q.prototype.toggleColumn=function(a,b,c){if(-1!==a&&(this.columns[a].visible=b,this.initHeader(),this.initSearch(),this.initPagination(),this.initBody(),this.options.showColumns)){var d=this.$toolbar.find(".keep-open input").prop("disabled",!1);c&&d.filter(f('[value="%s"]',a)).prop("checked",b),d.filter(":checked").length<=this.options.minimumCountColumns&&d.filter(":checked").prop("disabled",!0)}},q.prototype.getVisibleFields=function(){var b=this,c=[];return a.each(this.header.fields,function(a,d){b.columns[b.fieldsColumnsIndex[d]].visible&&c.push(d)}),c},q.prototype.resetView=function(a){var b=0;if(a&&a.height&&(this.options.height=a.height),this.$selectAll.prop("checked",0<this.$selectItem.length&&this.$selectItem.length===this.$selectItem.filter(":checked").length),this.options.height){var c=this.$toolbar.outerHeight(!0),d=this.$pagination.outerHeight(!0),e=this.options.height-c-d;this.$tableContainer.css("height",e+"px")}return this.options.cardView?(this.$el.css("margin-top","0"),this.$tableContainer.css("padding-bottom","0"),void this.$tableFooter.hide()):(this.options.showHeader&&this.options.height?(this.$tableHeader.show(),this.resetHeader(),b+=this.$header.outerHeight()):(this.$tableHeader.hide(),this.trigger("post-header")),this.options.showFooter&&(this.resetFooter(),this.options.height&&(b+=this.$tableFooter.outerHeight()+1)),this.getCaret(),this.$tableContainer.css("padding-bottom",b+"px"),void this.trigger("reset-view"))},q.prototype.getData=function(b){var c=this.options.data;return!this.searchText&&!this.options.sortName&&a.isEmptyObject(this.filterColumns)&&a.isEmptyObject(this.filterColumnsPartial)||(c=this.data),b?c.slice(this.pageFrom-1,this.pageTo):c},q.prototype.load=function(b){var c=!1;this.options.pagination&&"server"===this.options.sidePagination?(this.options.totalRows=b[this.options.totalField],c=b.fixedScroll,b=b[this.options.dataField]):a.isArray(b)||(c=b.fixedScroll,b=b.data),this.initData(b),this.initSearch(),this.initPagination(),this.initBody(c)},q.prototype.append=function(a){this.initData(a,"append"),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)},q.prototype.prepend=function(a){this.initData(a,"prepend"),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)},q.prototype.remove=function(b){var c,d,e=this.options.data.length;if(b.hasOwnProperty("field")&&b.hasOwnProperty("values")){for(c=e-1;0<=c;c--)(d=this.options.data[c]).hasOwnProperty(b.field)&&-1!==a.inArray(d[b.field],b.values)&&(this.options.data.splice(c,1),"server"===this.options.sidePagination&&(this.options.totalRows-=1));e!==this.options.data.length&&(this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0))}},q.prototype.removeAll=function(){0<this.options.data.length&&(this.options.data.splice(0,this.options.data.length),this.initSearch(),this.initPagination(),this.initBody(!0))},q.prototype.getRowByUniqueId=function(a){var b,c,d,e=this.options.uniqueId,g=null;for(b=this.options.data.length-1;0<=b;b--){if((c=this.options.data[b]).hasOwnProperty(e))d=c[e];else{if(!c._data.hasOwnProperty(e))continue;d=c._data[e]}if("string"==typeof d?a=a.toString():"number"==typeof d&&(Number(d)===d&&d%1==0?a=parseInt(a):d===Number(d)&&0!==d&&(a=parseFloat(a))),d===a){g=c;break}}return g},q.prototype.removeByUniqueId=function(a){var b=this.options.data.length,c=this.getRowByUniqueId(a);c&&this.options.data.splice(this.options.data.indexOf(c),1),b!==this.options.data.length&&(this.initSearch(),this.initPagination(),this.initBody(!0))},q.prototype.updateByUniqueId=function(b){var c=this,d=a.isArray(b)?b:[b];a.each(d,function(b,d){var e;d.hasOwnProperty("id")&&d.hasOwnProperty("row")&&(-1!==(e=a.inArray(c.getRowByUniqueId(d.id),c.options.data))&&a.extend(c.options.data[e],d.row))}),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)},q.prototype.refreshColumnTitle=function(b){b.hasOwnProperty("field")&&b.hasOwnProperty("title")&&(this.columns[this.fieldsColumnsIndex[b.field]].title=this.options.escape?l(b.title):b.title,this.columns[this.fieldsColumnsIndex[b.field]].visible)&&(void 0!==this.options.height?this.$tableHeader:this.$header).find("th[data-field]").each(function(){return a(this).data("field")===b.field?(a(a(this).find(".th-inner")[0]).text(b.title),!1):void 0})},q.prototype.insertRow=function(a){a.hasOwnProperty("index")&&a.hasOwnProperty("row")&&(this.options.data.splice(a.index,0,a.row),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0))},q.prototype.updateRow=function(b){var c=this,d=a.isArray(b)?b:[b];a.each(d,function(b,d){d.hasOwnProperty("index")&&d.hasOwnProperty("row")&&a.extend(c.options.data[d.index],d.row)}),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)},q.prototype.initHiddenRows=function(){this.hiddenRows=[]},q.prototype.showRow=function(a){this.toggleRow(a,!0)},q.prototype.hideRow=function(a){this.toggleRow(a,!1)},q.prototype.toggleRow=function(b,c){var d,e;b.hasOwnProperty("index")?d=this.getData()[b.index]:b.hasOwnProperty("uniqueId")&&(d=this.getRowByUniqueId(b.uniqueId)),d&&(e=a.inArray(d,this.hiddenRows),c||-1!==e?c&&-1<e&&this.hiddenRows.splice(e,1):this.hiddenRows.push(d),this.initBody(!0))},q.prototype.getHiddenRows=function(){var b=this,c=this.getData(),d=[];return a.each(c,function(c,e){-1<a.inArray(e,b.hiddenRows)&&d.push(e)}),this.hiddenRows=d},q.prototype.mergeCells=function(b){var c,d,e,f=b.index,g=a.inArray(b.field,this.getVisibleFields()),h=b.rowspan||1,i=b.colspan||1,j=this.$body.find(">tr");if(this.options.detailView&&!this.options.cardView&&(g+=1),e=j.eq(f).find(">td").eq(g),!(f<0||g<0||f>=this.data.length)){for(c=f;c<f+h;c++)for(d=g;d<g+i;d++)j.eq(c).find(">td").eq(d).hide();e.attr("rowspan",h).attr("colspan",i).show()}},q.prototype.updateCell=function(a){a.hasOwnProperty("index")&&a.hasOwnProperty("field")&&a.hasOwnProperty("value")&&(this.data[a.index][a.field]=a.value,!1!==a.reinit&&(this.initSort(),this.initBody(!0)))},q.prototype.updateCellById=function(b){var c=this;if(b.hasOwnProperty("id")&&b.hasOwnProperty("field")&&b.hasOwnProperty("value")){var d=a.isArray(b)?b:[b];a.each(d,function(b,d){var e;-1!==(e=a.inArray(c.getRowByUniqueId(d.id),c.options.data))&&(c.data[e][d.field]=d.value)}),!1!==b.reinit&&(this.initSort(),this.initBody(!0))}},q.prototype.getOptions=function(){return a.extend(!0,{},this.options)},q.prototype.getSelections=function(){var b=this;return a.grep(this.options.data,function(a){return!0===a[b.header.stateField]})},q.prototype.getAllSelections=function(){var b=this;return a.grep(this.options.data,function(a){return a[b.header.stateField]})},q.prototype.checkAll=function(){this.checkAll_(!0)},q.prototype.uncheckAll=function(){this.checkAll_(!1)},q.prototype.checkInvert=function(){var b=this,c=b.$selectItem.filter(":enabled"),d=c.filter(":checked");c.each(function(){a(this).prop("checked",!a(this).prop("checked"))}),b.updateRows(),b.updateSelected(),b.trigger("uncheck-some",d),d=b.getSelections(),b.trigger("check-some",d)},q.prototype.checkAll_=function(a){var b;a||(b=this.getSelections()),this.$selectAll.add(this.$selectAll_).prop("checked",a),this.$selectItem.filter(":enabled").prop("checked",a),this.updateRows(),a&&(b=this.getSelections()),this.trigger(a?"check-all":"uncheck-all",b)},q.prototype.check=function(a){this.check_(!0,a)},q.prototype.uncheck=function(a){this.check_(!1,a)},q.prototype.check_=function(a,b){var c=this.$selectItem.filter(f('[data-index="%s"]',b)).prop("checked",a);this.data[b][this.header.stateField]=a,this.updateSelected(),this.trigger(a?"check":"uncheck",this.data[b],c)},q.prototype.checkBy=function(a){this.checkBy_(!0,a)},q.prototype.uncheckBy=function(a){this.checkBy_(!1,a)},q.prototype.checkBy_=function(b,c){if(c.hasOwnProperty("field")&&c.hasOwnProperty("values")){var d=this,e=[];a.each(this.options.data,function(g,h){if(!h.hasOwnProperty(c.field))return!1;if(-1!==a.inArray(h[c.field],c.values)){var i=d.$selectItem.filter(":enabled").filter(f('[data-index="%s"]',g)).prop("checked",b);h[d.header.stateField]=b,e.push(h),d.trigger(b?"check":"uncheck",h,i)}}),this.updateSelected(),this.trigger(b?"check-some":"uncheck-some",e)}},q.prototype.destroy=function(){this.$el.insertBefore(this.$container),a(this.options.toolbar).insertBefore(this.$el),this.$container.next().remove(),this.$container.remove(),this.$el.html(this.$el_.html()).css("margin-top","0").attr("class",this.$el_.attr("class")||"")},q.prototype.showLoading=function(){this.$tableLoading.show()},q.prototype.hideLoading=function(){this.$tableLoading.hide()},q.prototype.togglePagination=function(){this.options.pagination=!this.options.pagination;var a=this.$toolbar.find('button[name="paginationSwitch"] i');this.options.pagination?a.attr("class",this.options.iconsPrefix+" "+this.options.icons.paginationSwitchDown):a.attr("class",this.options.iconsPrefix+" "+this.options.icons.paginationSwitchUp),this.updatePagination()},q.prototype.toggleFullscreen=function(){this.$el.closest(".bootstrap-table").toggleClass("fullscreen")},q.prototype.refresh=function(a){a&&a.url&&(this.options.url=a.url),a&&a.pageNumber&&(this.options.pageNumber=a.pageNumber),a&&a.pageSize&&(this.options.pageSize=a.pageSize),this.initServer(a&&a.silent,a&&a.query,a&&a.url),this.trigger("refresh",a)},q.prototype.resetWidth=function(){this.options.showHeader&&this.options.height&&this.fitHeader(),this.options.showFooter&&!this.options.cardView&&this.fitFooter()},q.prototype.showColumn=function(a){this.toggleColumn(this.fieldsColumnsIndex[a],!0,!0)},q.prototype.hideColumn=function(a){this.toggleColumn(this.fieldsColumnsIndex[a],!1,!0)},q.prototype.getHiddenColumns=function(){return a.grep(this.columns,function(a){return!a.visible})},q.prototype.getVisibleColumns=function(){return a.grep(this.columns,function(a){return a.visible})},q.prototype.toggleAllColumns=function(b){var c=this;if(a.each(this.columns,function(a){c.columns[a].visible=b}),this.initHeader(),this.initSearch(),this.initPagination(),this.initBody(),this.options.showColumns){var d=this.$toolbar.find(".keep-open input").prop("disabled",!1);d.filter(":checked").length<=this.options.minimumCountColumns&&d.filter(":checked").prop("disabled",!0)}},q.prototype.showAllColumns=function(){this.toggleAllColumns(!0)},q.prototype.hideAllColumns=function(){this.toggleAllColumns(!1)},q.prototype.filterBy=function(b){this.filterColumns=a.isEmptyObject(b)?{}:b,this.options.pageNumber=1,this.initSearch(),this.updatePagination()},q.prototype.scrollTo=function(a){return"string"==typeof a&&(a="bottom"===a?this.$tableBody[0].scrollHeight:0),"number"==typeof a&&this.$tableBody.scrollTop(a),void 0===a?this.$tableBody.scrollTop():void 0},q.prototype.getScrollPosition=function(){return this.scrollTo()},q.prototype.selectPage=function(a){0<a&&a<=this.options.totalPages&&(this.options.pageNumber=a,this.updatePagination())},q.prototype.prevPage=function(){1<this.options.pageNumber&&(this.options.pageNumber--,this.updatePagination())},q.prototype.nextPage=function(){this.options.pageNumber<this.options.totalPages&&(this.options.pageNumber++,this.updatePagination())},q.prototype.toggleView=function(){this.options.cardView=!this.options.cardView,this.initHeader();var a=this.$toolbar.find('button[name="toggle"] i');this.options.cardView?(a.removeClass(this.options.icons.toggleOff),a.addClass(this.options.icons.toggleOn)):(a.removeClass(this.options.icons.toggleOn),a.addClass(this.options.icons.toggleOff)),this.initBody(),this.trigger("toggle",this.options.cardView)},q.prototype.refreshOptions=function(b){k(this.options,b,!0)||(this.options=a.extend(this.options,b),this.trigger("refresh-options",this.options),this.destroy(),this.init())},q.prototype.resetSearch=function(a){var b=this.$toolbar.find(".search input");b.val(a||""),this.onSearch({currentTarget:b})},q.prototype.expandRow_=function(a,b){var c=this.$body.find(f('> tr[data-index="%s"]',b));c.next().is("tr.detail-view")===!a&&c.find("> td > .detail-icon").click()},q.prototype.expandRow=function(a){this.expandRow_(!0,a)},q.prototype.collapseRow=function(a){this.expandRow_(!1,a)},q.prototype.expandAllRows=function(b){if(b){var c=this.$body.find(f('> tr[data-index="%s"]',0)),d=this,e=null,g=!1,h=-1;if(c.next().is("tr.detail-view")?c.next().next().is("tr.detail-view")||(c.next().find(".detail-icon").click(),g=!0):(c.find("> td > .detail-icon").click(),g=!0),g)try{h=setInterval(function(){0<(e=d.$body.find("tr.detail-view").last().find(".detail-icon")).length?e.click():clearInterval(h)},1)}catch(i){clearInterval(h)}}else for(var j=this.$body.children(),k=0;k<j.length;k++)this.expandRow_(!0,a(j[k]).data("index"))},q.prototype.collapseAllRows=function(b){if(b)this.expandRow_(!1,0);else for(var c=this.$body.children(),d=0;d<c.length;d++)this.expandRow_(!1,a(c[d]).data("index"))},q.prototype.updateFormatText=function(a,b){this.options[f("format%s",a)]&&("string"==typeof b?this.options[f("format%s",a)]=function(){return b}:"function"==typeof b&&(this.options[f("format%s",a)]=b)),this.initToolbar(),this.initPagination(),this.initBody()};var r=["getOptions","getSelections","getAllSelections","getData","load","append","prepend","remove","removeAll","insertRow","updateRow","updateCell","updateByUniqueId","removeByUniqueId","getRowByUniqueId","showRow","hideRow","getHiddenRows","mergeCells","refreshColumnTitle","checkAll","uncheckAll","checkInvert","check","uncheck","checkBy","uncheckBy","refresh","resetView","resetWidth","destroy","showLoading","hideLoading","showColumn","hideColumn","getHiddenColumns","getVisibleColumns","showAllColumns","hideAllColumns","filterBy","scrollTo","getScrollPosition","selectPage","prevPage","nextPage","togglePagination","toggleView","refreshOptions","resetSearch","expandRow","collapseRow","expandAllRows","collapseAllRows","updateFormatText","updateCellById"];a.fn.bootstrapTable=function(b){var c,d=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=a(this),f=e.data("bootstrap.table"),g=a.extend({},q.DEFAULTS,e.data(),"object"==typeof b&&b);if("string"==typeof b){if(a.inArray(b,r)<0)throw new Error("Unknown method: "+b);if(!f)return;c=f[b].apply(f,d),"destroy"===b&&e.removeData("bootstrap.table")}f||e.data("bootstrap.table",f=new q(this,g))}),void 0===c?this:c},a.fn.bootstrapTable.Constructor=q,a.fn.bootstrapTable.defaults=q.DEFAULTS,a.fn.bootstrapTable.columnDefaults=q.COLUMN_DEFAULTS,a.fn.bootstrapTable.locales=q.LOCALES,a.fn.bootstrapTable.methods=r,a.fn.bootstrapTable.utils={bootstrapVersion:b,sprintf:f,compareObjects:k,calculateObjectValue:j,getItemField:n,objectKeys:function(){var a,b,c,d;Object.keys||(Object.keys=(a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),d=(c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var f,g,h=[];for(f in e)a.call(e,f)&&h.push(f);if(b)for(g=0;g<d;g++)a.call(e,c[g])&&h.push(c[g]);return h}))},isIEBrowser:o},a(function(){a('[data-toggle="table"]').bootstrapTable()})}(jQuery),function(e,t){"use strict";"function"==typeof define&&define.amd?define("tinysort",function(){return t}):e.tinysort=t}(this,function(){"use strict";function t(e,t){for(var r,n=e.length,o=n;o--;)t(e[r=n-o-1],r)}function r(e,t,r){for(var n in t)!r&&e[n]!==o||(e[n]=t[n]);return e}function n(e,t,r){h.push({prepare:e,sort:t,sortBy:r})}var o,a=!1,l=null,s=window,c=s.document,i=parseFloat,u=/(-?\d+\.?\d*)\s*$/g,f=/(\d+\.?\d*)\s*$/g,h=[],d=0,p=0,g=String.fromCharCode(4095),m={selector:l,order:"asc",attr:l,data:l,useVal:a,place:"org",returns:a,cases:a,natural:a,forceStrings:a,ignoreDashes:a,sortFunction:l,useFlex:a,emptyEnd:a};return s.Element&&function(e){e.matchesSelector=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector||function(e){for(var t=this,r=(t.parentNode||t.document).querySelectorAll(e),n=-1;r[++n]&&r[n]!=t;);return!!r[n]}}(Element.prototype),r(n,{loop:t}),r(function(e,n){function v(e){var t=!!e.selector,n=t&&":"===e.selector[0],o=r(e||{},m);$.push(r({hasSelector:t,hasAttr:!(o.attr===l||""===o.attr),hasData:o.data!==l,hasFilter:n,sortReturnNumber:"asc"===o.order?1:-1},o))}function y(e,t,r){for(var n=r(e.toString()),o=r(t.toString()),a=0;n[a]&&o[a];a++)if(n[a]!==o[a]){var l=Number(n[a]),s=Number(o[a]);return l==n[a]&&s==o[a]?l-s:n[a]>o[a]?1:-1}return n.length-o.length}function N(e){for(var t,r,n=[],o=0,a=-1,l=0;t=(r=e.charAt(o++)).charCodeAt(0);){var s=46==t||48<=t&&t<=57;s!==l&&(n[++a]="",l=s),n[a]+=r}return n}function A(){return R.forEach(function(e){q.appendChild(e.elm)}),q}function F(e){var t=e.elm,r=c.createElement("div");return e.ghost=r,t.parentNode.insertBefore(r,t),e}function E(e,t){var r=e.ghost,n=r.parentNode;n.insertBefore(t,r),n.removeChild(r),delete e.ghost}function w(e,t){var r,n=e.elm;return t.selector&&(t.hasFilter?n.matchesSelector(t.selector)||(n=l):n=n.querySelector(t.selector)),t.hasAttr?r=n.getAttribute(t.attr):t.useVal?r=n.value||n.getAttribute("value"):t.hasData?r=n.getAttribute("data-"+t.data):n&&(r=n.textContent),x(r)&&(t.cases||(r=r.toLowerCase()),r=r.replace(/\s+/g," ")),null===r&&(r=g),r}function x(e){return"string"==typeof e}x(e)&&(e=c.querySelectorAll(e)),0===e.length&&console.warn("No elements to sort");var D,M,q=c.createDocumentFragment(),B=[],R=[],V=[],$=[],k=!0,z=e.length&&e[0].parentNode,L=z.rootNode!==document,O=e.length&&(n===o||!1!==n.useFlex)&&!L&&-1!==getComputedStyle(z,null).display.indexOf("flex");return function(){0===arguments.length?v({}):t(arguments,function(e){v(x(e)?{selector:e}:e)}),d=$.length}.apply(l,Array.prototype.slice.call(arguments,1)),t(e,function(e,t){M?M!==e.parentNode&&(k=!1):M=e.parentNode;var r=$[0],n=r.hasFilter,o=r.selector,l=!o||n&&e.matchesSelector(o)||o&&e.querySelector(o)?R:V,s={elm:e,pos:t,posn:l.length};B.push(s),l.push(s)}),D=R.slice(0),R.sort(function(e,r){var n=0;for(0!==p&&(p=0);0===n&&p<d;){var l=$[p],s=l.ignoreDashes?f:u;if(t(h,function(e){var t=e.prepare;t&&t(l)}),l.sortFunction)n=l.sortFunction(e,r);else if("rand"==l.order)n=Math.random()<.5?1:-1;else{var c=a,g=w(e,l),m=w(r,l),v=""===g||g===o,S=""===m||m===o;if(g===m)n=0;else if(l.emptyEnd&&(v||S))n=v&&S?0:v?1:-1;else{if(!l.forceStrings){var C=x(g)?g&&g.match(s):a,b=x(m)?m&&m.match(s):a;if(C&&b)g.substr(0,g.length-C[0].length)==m.substr(0,m.length-b[0].length)&&(c=!0,g=i(C[0]),m=i(b[0]))}n=g===o||m===o?0:l.natural&&(isNaN(g)||isNaN(m))?y(g,m,N):g<m?-1:m<g?1:0}}t(h,function(e){var t=e.sort;t&&(n=t(l,c,g,m,n))}),0===(n*=l.sortReturnNumber)&&p++}return 0===n&&(n=e.pos>r.pos?1:-1),n}),function(){var e=R.length===B.length;if(k&&e)O?R.forEach(function(e,t){e.elm.style.order=t}):M?M.appendChild(A()):console.warn("parentNode has been removed");else{var r=$[0].place,o="start"===r,a="end"===r,l="first"===r,s="last"===r;if("org"===r)R.forEach(F),R.forEach(function(e,t){E(D[t],e.elm)});else if(o||a){var c=D[o?0:D.length-1],i=c&&c.elm.parentNode,u=i&&(o&&i.firstChild||i.lastChild);u&&(u!==c.elm&&(c={elm:u}),F(c),a&&i.appendChild(c.ghost),E(c,A()))}else if(l||s){E(F(D[l?0:D.length-1]),A())}}}(),R.map(function(e){return e.elm})},{plugin:n,defaults:m})}()),function(global,factory){"function"==typeof define&&define.amd?define(["jquery","tinysort","moment"],factory):factory(global.jQuery,global.tinysort,global.moment||void 0)}(this,function($,tinysort,moment){var signClass,sortEngine,emptyEnd,$document=$(document);function initialize(options){var momentJsAvailable=void 0!==moment;signClass=options.sign?options.sign:"arrow","default"==options.customSort&&(options.customSort=defaultSortEngine),sortEngine=options.customSort||sortEngine||defaultSortEngine,emptyEnd=options.emptyEnd,$("table.sortable").each(function(){var $this=$(this),applyLast=!0===options.applyLast;$this.find("span.sign").remove(),$this.find("> thead [colspan]").each(function(){for(var colspan=parseFloat($(this).attr("colspan")),i=1;i<colspan;i++)$(this).after('<th class="colspan-compensate">')}),$this.find("> thead [rowspan]").each(function(){for(var $cell=$(this),rowspan=parseFloat($cell.attr("rowspan")),i=1;i<rowspan;i++){var parentRow=$cell.parent("tr"),nextRow=parentRow.next("tr"),index=parentRow.children().index($cell);nextRow.children().eq(index).before('<th class="rowspan-compensate">')}}),$this.find("> thead tr").each(function(rowIndex){$(this).find("th").each(function(columnIndex){var $header=$(this);$header.addClass("nosort").removeClass("up down"),$header.attr("data-sortcolumn",columnIndex),$header.attr("data-sortkey",columnIndex+"-"+rowIndex)})}),$this.find("> thead .rowspan-compensate, .colspan-compensate").remove(),$this.find("th").each(function(){var $header=$(this);if(void 0!==$header.attr("data-dateformat")&&momentJsAvailable){var colNumber=parseFloat($header.attr("data-sortcolumn"));$this.find("td:nth-child("+(colNumber+1)+")").each(function(){var $cell=$(this);$cell.attr("data-value",moment($cell.text(),$header.attr("data-dateformat")).format("YYYY/MM/DD/HH/mm/ss"))})}else if(void 0!==$header.attr("data-valueprovider")){colNumber=parseFloat($header.attr("data-sortcolumn"));$this.find("td:nth-child("+(colNumber+1)+")").each(function(){var $cell=$(this);$cell.attr("data-value",new RegExp($header.attr("data-valueprovider")).exec($cell.text())[0])})}}),$this.find("td").each(function(){var $cell=$(this);void 0!==$cell.attr("data-dateformat")&&momentJsAvailable?$cell.attr("data-value",moment($cell.text(),$cell.attr("data-dateformat")).format("YYYY/MM/DD/HH/mm/ss")):void 0!==$cell.attr("data-valueprovider")?$cell.attr("data-value",new RegExp($cell.attr("data-valueprovider")).exec($cell.text())[0]):void 0===$cell.attr("data-value")&&$cell.attr("data-value",$cell.text())});var context=lookupSortContext($this),bsSort=context.bsSort;$this.find('> thead th[data-defaultsort!="disabled"]').each(function(index){var $header=$(this),$sortTable=$header.closest("table.sortable");$header.data("sortTable",$sortTable);var sortKey=$header.attr("data-sortkey"),thisLastSort=applyLast?context.lastSort:-1;bsSort[sortKey]=applyLast?bsSort[sortKey]:$header.attr("data-defaultsort"),void 0!==bsSort[sortKey]&&applyLast==(sortKey===thisLastSort)&&(bsSort[sortKey]="asc"===bsSort[sortKey]?"desc":"asc",doSort($header,$sortTable))})})}function addRowspanPlaceholders(table){table.find("> tbody [rowspan]").each(function(){var $cell=$(this),rowspan=parseFloat($cell.attr("rowspan"));$cell.removeAttr("rowspan");var rowSpanId=$cell.attr("rowspan-group")||function(){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}();$cell.attr("rowspan-group",rowSpanId),$cell.attr("rowspan-value",rowspan);for(var parentRow=$cell.parent("tr"),index=parentRow.children().index($cell),i=1;i<rowspan;i++){var compemnsationCell=$cell.clone(!1),nextRow=parentRow.next("tr");nextRow.children().eq(index).before(compemnsationCell),parentRow=nextRow}})}function sortByColumn(element){var $this=$(element),$table=$this.data("sortTable")||$this.closest("table.sortable");doSort($this,$table)}function lookupSortContext($table){var context=$table.data("bootstrap-sortable-context");return void 0===context&&(context={bsSort:[],lastSort:void 0},$table.find('> thead th[data-defaultsort!="disabled"]').each(function(index){var $this=$(this),sortKey=$this.attr("data-sortkey");context.bsSort[sortKey]=$this.attr("data-defaultsort"),void 0!==context.bsSort[sortKey]&&(context.lastSort=sortKey)}),$table.data("bootstrap-sortable-context",context)),context}function defaultSortEngine(rows,sortingParams){tinysort(rows,sortingParams)}function doSort($this,$table){$table.trigger("before-sort"),addRowspanPlaceholders($table);var sortColumn=parseFloat($this.attr("data-sortcolumn")),context=lookupSortContext($table),bsSort=context.bsSort;if($this.attr("colspan")){var mainSort=parseFloat($this.data("mainsort"))||0,rowIndex=parseFloat($this.data("sortkey").split("-").pop());if($table.find("> thead tr").length-1>rowIndex)return void doSort($table.find('[data-sortkey="'+(sortColumn+mainSort)+"-"+(rowIndex+1)+'"]'),$table);sortColumn+=mainSort}var localSignClass=$this.attr("data-defaultsign")||signClass;if($table.find("> thead th").each(function(){$(this).removeClass("up").removeClass("down").addClass("nosort")}),$.browser.mozilla){var moz_arrow=$table.find("> thead div.mozilla");void 0!==moz_arrow&&(moz_arrow.find(".sign").remove(),moz_arrow.parent().html(moz_arrow.html())),$this.wrapInner('<div class="mozilla"></div>'),$this.children().eq(0).append('<span class="sign '+localSignClass+'"></span>')}else $table.find("> thead span.sign").remove(),$this.append('<span class="sign '+localSignClass+'"></span>');var sortKey=$this.attr("data-sortkey"),initialDirection="desc"!==$this.attr("data-firstsort")?"desc":"asc",newDirection=bsSort[sortKey]||initialDirection;context.lastSort!==sortKey&&void 0!==bsSort[sortKey]||(newDirection="asc"===newDirection?"desc":"asc"),bsSort[sortKey]=newDirection,"desc"===bsSort[context.lastSort=sortKey]?($this.find("span.sign").addClass("up"),$this.addClass("up").removeClass("down nosort")):$this.addClass("down").removeClass("up nosort");var rows=$table.children("tbody").children("tr"),fixedRows=[];$(rows.filter('[data-disablesort="true"]').get().reverse()).each(function(index,fixedRow){var $fixedRow=$(fixedRow);fixedRows.push({index:rows.index($fixedRow),row:$fixedRow}),$fixedRow.remove()});var rowsToSort=rows.not('[data-disablesort="true"]');if(0!=rowsToSort.length){var emptySorting="asc"===bsSort[sortKey]&&emptyEnd;sortEngine(rowsToSort,{emptyEnd:emptySorting,selector:"td:nth-child("+(sortColumn+1)+")",order:bsSort[sortKey],data:"value"})}$(fixedRows.reverse()).each(function(index,row){0===row.index?$table.children("tbody").prepend(row.row):$table.children("tbody").children("tr").eq(row.index-1).after(row.row)}),$table.find("> tbody > tr > td.sorted,> thead th.sorted").removeClass("sorted"),rowsToSort.find("td:eq("+sortColumn+")").addClass("sorted"),$this.addClass("sorted"),function(table){table.find("> tbody [rowspan-group]").each(function(){for(var $this=$(this),id=$this.attr("rowspan-group"),parentRow=$this.parent("tr"),index=parentRow.children().index($this);;){var nextRow=parentRow.next("tr");if(!nextRow.is("tr"))break;var nextCell=nextRow.children().eq(index);if(nextCell.attr("rowspan-group")!==id)break;var rowspan=parseFloat($this.attr("rowspan"))||1;$this.attr("rowspan",rowspan+1),nextCell.remove(),parentRow=nextRow}})}($table),$table.trigger("sorted")}if($.bootstrapSortable=function(options){null==options?initialize({}):options.constructor===Boolean?initialize({applyLast:options}):void 0!==options.sortingHeader?sortByColumn(options.sortingHeader):initialize(options)},$document.on("click",'table.sortable>thead th[data-defaultsort!="disabled"]',function(e){sortByColumn(this)}),!$.browser){$.browser={chrome:!1,mozilla:!1,opera:!1,msie:!1,safari:!1};var ua=navigator.userAgent;$.each($.browser,function(c){$.browser[c]=!!new RegExp(c,"i").test(ua),$.browser.mozilla&&"mozilla"===c&&($.browser.mozilla=!!new RegExp("firefox","i").test(ua)),$.browser.chrome&&"safari"===c&&($.browser.safari=!1)})}$($.bootstrapSortable)}),function(a){"use strict";if("function"==typeof define&&define.amd)define(["jquery","moment"],a);else if("object"==typeof exports)module.exports=a(require("jquery"),require("moment"));else{if("undefined"==typeof jQuery)throw"bootstrap-datetimepicker requires jQuery to be loaded first";if("undefined"==typeof moment)throw"bootstrap-datetimepicker requires Moment.js to be loaded first";a(jQuery,moment)}}(function(a,b){"use strict";if(!b)throw new Error("bootstrap-datetimepicker requires Moment.js to be loaded first");var c=function(c,d){function x(){return void 0!==b.tz&&void 0!==d.timeZone&&null!==d.timeZone&&""!==d.timeZone}function y(a){var c;return c=null==a?b():b.isDate(a)||b.isMoment(a)?b(a):x()?b.tz(a,j,d.useStrict,d.timeZone):b(a,j,d.useStrict),x()&&c.tz(d.timeZone),c}function z(a){if("string"!=typeof a||1<a.length)throw new TypeError("isEnabled expects a single character string parameter");switch(a){case"y":return-1!==i.indexOf("Y");case"M":return-1!==i.indexOf("M");case"d":return-1!==i.toLowerCase().indexOf("d");case"h":case"H":return-1!==i.toLowerCase().indexOf("h");case"m":return-1!==i.indexOf("m");case"s":return-1!==i.indexOf("s");default:return!1}}function A(){return z("h")||z("m")||z("s")}function B(){return z("y")||z("M")||z("d")}function D(){var b=a("<tr>"),c=a("<tr>"),e=a("<tr>");return z("h")&&(b.append(a("<td>").append(a("<a>").attr({href:"#",tabindex:"-1",title:d.tooltips.incrementHour}).addClass("btn").attr("data-action","incrementHours").append(a("<span>").addClass(d.icons.up)))),c.append(a("<td>").append(a("<span>").addClass("timepicker-hour").attr({"data-time-component":"hours",title:d.tooltips.pickHour}).attr("data-action","showHours"))),e.append(a("<td>").append(a("<a>").attr({href:"#",tabindex:"-1",title:d.tooltips.decrementHour}).addClass("btn").attr("data-action","decrementHours").append(a("<span>").addClass(d.icons.down))))),z("m")&&(z("h")&&(b.append(a("<td>").addClass("separator")),c.append(a("<td>").addClass("separator").html(":")),e.append(a("<td>").addClass("separator"))),b.append(a("<td>").append(a("<a>").attr({href:"#",tabindex:"-1",title:d.tooltips.incrementMinute}).addClass("btn").attr("data-action","incrementMinutes").append(a("<span>").addClass(d.icons.up)))),c.append(a("<td>").append(a("<span>").addClass("timepicker-minute").attr({"data-time-component":"minutes",title:d.tooltips.pickMinute}).attr("data-action","showMinutes"))),e.append(a("<td>").append(a("<a>").attr({href:"#",tabindex:"-1",title:d.tooltips.decrementMinute}).addClass("btn").attr("data-action","decrementMinutes").append(a("<span>").addClass(d.icons.down))))),z("s")&&(z("m")&&(b.append(a("<td>").addClass("separator")),c.append(a("<td>").addClass("separator").html(":")),e.append(a("<td>").addClass("separator"))),b.append(a("<td>").append(a("<a>").attr({href:"#",tabindex:"-1",title:d.tooltips.incrementSecond}).addClass("btn").attr("data-action","incrementSeconds").append(a("<span>").addClass(d.icons.up)))),c.append(a("<td>").append(a("<span>").addClass("timepicker-second").attr({"data-time-component":"seconds",title:d.tooltips.pickSecond}).attr("data-action","showSeconds"))),e.append(a("<td>").append(a("<a>").attr({href:"#",tabindex:"-1",title:d.tooltips.decrementSecond}).addClass("btn").attr("data-action","decrementSeconds").append(a("<span>").addClass(d.icons.down))))),h||(b.append(a("<td>").addClass("separator")),c.append(a("<td>").append(a("<button>").addClass("btn btn-primary").attr({"data-action":"togglePeriod",tabindex:"-1",title:d.tooltips.togglePeriod}))),e.append(a("<td>").addClass("separator"))),a("<div>").addClass("timepicker-picker").append(a("<table>").addClass("table-condensed").append([b,c,e]))}function G(){var b=a("<div>").addClass("bootstrap-datetimepicker-widget dropdown-menu"),c=a("<div>").addClass("datepicker").append(function(){var b=a("<thead>").append(a("<tr>").append(a("<th>").addClass("prev").attr("data-action","previous").append(a("<span>").addClass(d.icons.previous))).append(a("<th>").addClass("picker-switch").attr("data-action","pickerSwitch").attr("colspan",d.calendarWeeks?"6":"5")).append(a("<th>").addClass("next").attr("data-action","next").append(a("<span>").addClass(d.icons.next)))),c=a("<tbody>").append(a("<tr>").append(a("<td>").attr("colspan",d.calendarWeeks?"8":"7")));return[a("<div>").addClass("datepicker-days").append(a("<table>").addClass("table-condensed").append(b).append(a("<tbody>"))),a("<div>").addClass("datepicker-months").append(a("<table>").addClass("table-condensed").append(b.clone()).append(c.clone())),a("<div>").addClass("datepicker-years").append(a("<table>").addClass("table-condensed").append(b.clone()).append(c.clone())),a("<div>").addClass("datepicker-decades").append(a("<table>").addClass("table-condensed").append(b.clone()).append(c.clone()))]}()),e=a("<div>").addClass("timepicker").append(function(){var b=a("<div>").addClass("timepicker-hours").append(a("<table>").addClass("table-condensed")),c=a("<div>").addClass("timepicker-minutes").append(a("<table>").addClass("table-condensed")),d=a("<div>").addClass("timepicker-seconds").append(a("<table>").addClass("table-condensed")),e=[D()];return z("h")&&e.push(b),z("m")&&e.push(c),z("s")&&e.push(d),e}()),f=a("<ul>").addClass("list-unstyled"),g=a("<li>").addClass("picker-switch"+(d.collapse?" accordion-toggle":"")).append(function(){var b=[];return d.showTodayButton&&b.push(a("<td>").append(a("<a>").attr({"data-action":"today",title:d.tooltips.today}).append(a("<span>").addClass(d.icons.today)))),!d.sideBySide&&B()&&A()&&b.push(a("<td>").append(a("<a>").attr({"data-action":"togglePicker",title:d.tooltips.selectTime}).append(a("<span>").addClass(d.icons.time)))),d.showClear&&b.push(a("<td>").append(a("<a>").attr({"data-action":"clear",title:d.tooltips.clear}).append(a("<span>").addClass(d.icons.clear)))),d.showClose&&b.push(a("<td>").append(a("<a>").attr({"data-action":"close",title:d.tooltips.close}).append(a("<span>").addClass(d.icons.close)))),a("<table>").addClass("table-condensed").append(a("<tbody>").append(a("<tr>").append(b)))}());return d.inline&&b.removeClass("dropdown-menu"),h&&b.addClass("usetwentyfour"),z("s")&&!h&&b.addClass("wider"),d.sideBySide&&B()&&A()?(b.addClass("timepicker-sbs"),"top"===d.toolbarPlacement&&b.append(g),b.append(a("<div>").addClass("row").append(c.addClass("col-md-6")).append(e.addClass("col-md-6"))),"bottom"===d.toolbarPlacement&&b.append(g),b):("top"===d.toolbarPlacement&&f.append(g),B()&&f.append(a("<li>").addClass(d.collapse&&A()?"collapse in":"").append(c)),"default"===d.toolbarPlacement&&f.append(g),A()&&f.append(a("<li>").addClass(d.collapse&&B()?"collapse":"").append(e)),"bottom"===d.toolbarPlacement&&f.append(g),b.append(f))}function I(){var b,e=(n||c).position(),f=(n||c).offset(),g=d.widgetPositioning.vertical,h=d.widgetPositioning.horizontal;if(d.widgetParent)b=d.widgetParent.append(o);else if(c.is("input"))b=c.after(o).parent();else{if(d.inline)return void c.append(o);(b=c).children().first().after(o)}if("auto"===g&&(g=f.top+1.5*o.height()>=a(window).height()+a(window).scrollTop()&&o.height()+c.outerHeight()<f.top?"top":"bottom"),"auto"===h&&(h=b.width()<f.left+o.outerWidth()/2&&f.left+o.outerWidth()>a(window).width()?"right":"left"),"top"===g?o.addClass("top").removeClass("bottom"):o.addClass("bottom").removeClass("top"),"right"===h?o.addClass("pull-right"):o.removeClass("pull-right"),"static"===b.css("position")&&(b=b.parents().filter(function(){return"static"!==a(this).css("position")}).first()),0===b.length)throw new Error("datetimepicker component should be placed within a non-static positioned container");o.css({top:"top"===g?"auto":e.top+c.outerHeight(),bottom:"top"===g?b.outerHeight()-(b===c?0:e.top):"auto",left:"left"===h?b===c?0:e.left:"auto",right:"left"===h?"auto":b.outerWidth()-c.outerWidth()-(b===c?0:e.left)})}function J(a){"dp.change"===a.type&&(a.date&&a.date.isSame(a.oldDate)||!a.date&&!a.oldDate)||c.trigger(a)}function K(a){"y"===a&&(a="YYYY"),J({type:"dp.update",change:a,viewDate:f.clone()})}function L(a){o&&(a&&(k=Math.max(p,Math.min(3,k+a))),o.find(".datepicker > div").hide().filter(".datepicker-"+q[k].clsName).show())}function R(b,c){if(!b.isValid())return!1;if(d.disabledDates&&"d"===c&&function(a){return!0===d.disabledDates[a.format("YYYY-MM-DD")]}(b))return!1;if(d.enabledDates&&"d"===c&&!function(a){return!0===d.enabledDates[a.format("YYYY-MM-DD")]}(b))return!1;if(d.minDate&&b.isBefore(d.minDate,c))return!1;if(d.maxDate&&b.isAfter(d.maxDate,c))return!1;if(d.daysOfWeekDisabled&&"d"===c&&-1!==d.daysOfWeekDisabled.indexOf(b.day()))return!1;if(d.disabledHours&&("h"===c||"m"===c||"s"===c)&&function(a){return!0===d.disabledHours[a.format("H")]}(b))return!1;if(d.enabledHours&&("h"===c||"m"===c||"s"===c)&&!function(a){return!0===d.enabledHours[a.format("H")]}(b))return!1;if(d.disabledTimeIntervals&&("h"===c||"m"===c||"s"===c)){var e=!1;if(a.each(d.disabledTimeIntervals,function(){if(b.isBetween(this[0],this[1]))return!(e=!0)}),e)return!1}return!0}function V(){var a,c=o.find(".datepicker-decades"),g=c.find("th"),h=b({y:f.year()-f.year()%100-1}),i=h.clone().add(100,"y"),j=h.clone(),k=!1,l=!1,m="";for(g.eq(0).find("span").attr("title",d.tooltips.prevCentury),g.eq(2).find("span").attr("title",d.tooltips.nextCentury),c.find(".disabled").removeClass("disabled"),(h.isSame(b({y:1900}))||d.minDate&&d.minDate.isAfter(h,"y"))&&g.eq(0).addClass("disabled"),g.eq(1).text(h.year()+"-"+i.year()),(h.isSame(b({y:2e3}))||d.maxDate&&d.maxDate.isBefore(i,"y"))&&g.eq(2).addClass("disabled");!h.isAfter(i,"y");)a=h.year()+12,k=d.minDate&&d.minDate.isAfter(h,"y")&&d.minDate.year()<=a,l=d.maxDate&&d.maxDate.isAfter(h,"y")&&d.maxDate.year()<=a,m+='<span data-action="selectDecade" class="decade'+(e.isAfter(h)&&e.year()<=a?" active":"")+(R(h,"y")||k||l?"":" disabled")+'" data-selection="'+(h.year()+6)+'">'+(h.year()+1)+" - "+(h.year()+12)+"</span>",h.add(12,"y");m+="<span></span><span></span><span></span>",c.find("td").html(m),g.eq(1).text(j.year()+1+"-"+h.year())}function W(){var b,c,g,h=o.find(".datepicker-days"),i=h.find("th"),j=[],k=[];if(B()){for(i.eq(0).find("span").attr("title",d.tooltips.prevMonth),i.eq(1).attr("title",d.tooltips.selectMonth),i.eq(2).find("span").attr("title",d.tooltips.nextMonth),h.find(".disabled").removeClass("disabled"),i.eq(1).text(f.format(d.dayViewHeaderFormat)),R(f.clone().subtract(1,"M"),"M")||i.eq(0).addClass("disabled"),R(f.clone().add(1,"M"),"M")||i.eq(2).addClass("disabled"),b=f.clone().startOf("M").startOf("w").startOf("d"),g=0;g<42;g++)0===b.weekday()&&(c=a("<tr>"),d.calendarWeeks&&c.append('<td class="cw">'+b.week()+"</td>"),j.push(c)),k=["day"],b.isBefore(f,"M")&&k.push("old"),b.isAfter(f,"M")&&k.push("new"),b.isSame(e,"d")&&!m&&k.push("active"),R(b,"d")||k.push("disabled"),b.isSame(y(),"d")&&k.push("today"),0!==b.day()&&6!==b.day()||k.push("weekend"),J({type:"dp.classify",date:b,classNames:k}),c.append('<td data-action="selectDay" data-day="'+b.format("L")+'" class="'+k.join(" ")+'">'+b.date()+"</td>"),b.add(1,"d");h.find("tbody").empty().append(j),function(){var b=o.find(".datepicker-months"),c=b.find("th"),g=b.find("tbody").find("span");c.eq(0).find("span").attr("title",d.tooltips.prevYear),c.eq(1).attr("title",d.tooltips.selectYear),c.eq(2).find("span").attr("title",d.tooltips.nextYear),b.find(".disabled").removeClass("disabled"),R(f.clone().subtract(1,"y"),"y")||c.eq(0).addClass("disabled"),c.eq(1).text(f.year()),R(f.clone().add(1,"y"),"y")||c.eq(2).addClass("disabled"),g.removeClass("active"),e.isSame(f,"y")&&!m&&g.eq(e.month()).addClass("active"),g.each(function(b){R(f.clone().month(b),"M")||a(this).addClass("disabled")})}(),function(){var a=o.find(".datepicker-years"),b=a.find("th"),c=f.clone().subtract(5,"y"),g=f.clone().add(6,"y"),h="";for(b.eq(0).find("span").attr("title",d.tooltips.prevDecade),b.eq(1).attr("title",d.tooltips.selectDecade),b.eq(2).find("span").attr("title",d.tooltips.nextDecade),a.find(".disabled").removeClass("disabled"),d.minDate&&d.minDate.isAfter(c,"y")&&b.eq(0).addClass("disabled"),b.eq(1).text(c.year()+"-"+g.year()),d.maxDate&&d.maxDate.isBefore(g,"y")&&b.eq(2).addClass("disabled");!c.isAfter(g,"y");)h+='<span data-action="selectYear" class="year'+(c.isSame(e,"y")&&!m?" active":"")+(R(c,"y")?"":" disabled")+'">'+c.year()+"</span>",c.add(1,"y");a.find("td").html(h)}(),V()}}function X(){var b=o.find(".timepicker-hours table"),c=f.clone().startOf("d"),d=[],e=a("<tr>");for(11<f.hour()&&!h&&c.hour(12);c.isSame(f,"d")&&(h||f.hour()<12&&c.hour()<12||11<f.hour());)c.hour()%4==0&&(e=a("<tr>"),d.push(e)),e.append('<td data-action="selectHour" class="hour'+(R(c,"h")?"":" disabled")+'">'+c.format(h?"HH":"hh")+"</td>"),c.add(1,"h");b.empty().append(d)}function Y(){for(var b=o.find(".timepicker-minutes table"),c=f.clone().startOf("h"),e=[],g=a("<tr>"),h=1===d.stepping?5:d.stepping;f.isSame(c,"h");)c.minute()%(4*h)==0&&(g=a("<tr>"),e.push(g)),g.append('<td data-action="selectMinute" class="minute'+(R(c,"m")?"":" disabled")+'">'+c.format("mm")+"</td>"),c.add(h,"m");b.empty().append(e)}function Z(){for(var b=o.find(".timepicker-seconds table"),c=f.clone().startOf("m"),d=[],e=a("<tr>");f.isSame(c,"m");)c.second()%20==0&&(e=a("<tr>"),d.push(e)),e.append('<td data-action="selectSecond" class="second'+(R(c,"s")?"":" disabled")+'">'+c.format("ss")+"</td>"),c.add(5,"s");b.empty().append(d)}function _(){o&&(W(),function(){var a,b,c=o.find(".timepicker span[data-time-component]");h||(a=o.find(".timepicker [data-action=togglePeriod]"),b=e.clone().add(12<=e.hours()?-12:12,"h"),a.text(e.format("A")),R(b,"h")?a.removeClass("disabled"):a.addClass("disabled")),c.filter("[data-time-component=hours]").text(e.format(h?"HH":"hh")),c.filter("[data-time-component=minutes]").text(e.format("mm")),c.filter("[data-time-component=seconds]").text(e.format("ss")),X(),Y(),Z()}())}function aa(a){var b=m?null:e;if(!a)return m=!0,g.val(""),c.data("date",""),J({type:"dp.change",date:!1,oldDate:b}),void _();if(a=a.clone().locale(d.locale),x()&&a.tz(d.timeZone),1!==d.stepping)for(a.minutes(Math.round(a.minutes()/d.stepping)*d.stepping).seconds(0);d.minDate&&a.isBefore(d.minDate);)a.add(d.stepping,"minutes");R(a)?(f=(e=a).clone(),g.val(e.format(i)),c.data("date",e.format(i)),m=!1,_(),J({type:"dp.change",date:e.clone(),oldDate:b})):(d.keepInvalid?J({type:"dp.change",date:a,oldDate:b}):g.val(m?"":e.format(i)),J({type:"dp.error",date:a,oldDate:b}))}function ba(){var b=!1;return o&&(o.find(".collapse").each(function(){var c=a(this).data("collapse");return!c||!c.transitioning||!(b=!0)}),b||(n&&n.hasClass("btn")&&n.toggleClass("active"),o.hide(),a(window).off("resize",I),o.off("click","[data-action]"),o.off("mousedown",!1),o.remove(),o=!1,J({type:"dp.hide",date:e.clone()}),g.blur(),f=e.clone())),l}function ca(){aa(null)}function da(a){return void 0===d.parseInputDate?(!b.isMoment(a)||a instanceof Date)&&(a=y(a)):a=d.parseInputDate(a),a}function fa(b){return!a(b.currentTarget).is(".disabled")&&(ea[a(b.currentTarget).data("action")].apply(l,arguments),!1)}function ga(){var b;return g.prop("disabled")||!d.ignoreReadonly&&g.prop("readonly")||o||(void 0!==g.val()&&0!==g.val().trim().length?aa(da(g.val().trim())):m&&d.useCurrent&&(d.inline||g.is("input")&&0===g.val().trim().length)&&(b=y(),"string"==typeof d.useCurrent&&(b={year:function(a){return a.month(0).date(1).hours(0).seconds(0).minutes(0)},month:function(a){return a.date(1).hours(0).seconds(0).minutes(0)},day:function(a){return a.hours(0).seconds(0).minutes(0)},hour:function(a){return a.seconds(0).minutes(0)},minute:function(a){return a.seconds(0)}}[d.useCurrent](b)),aa(b)),o=G(),function(){var b=a("<tr>"),c=f.clone().startOf("w").startOf("d");for(!0===d.calendarWeeks&&b.append(a("<th>").addClass("cw").text("#"));c.isBefore(f.clone().endOf("w"));)b.append(a("<th>").addClass("dow").text(c.format("dd"))),c.add(1,"d");o.find(".datepicker-days thead").append(b)}(),function(){for(var b=[],c=f.clone().startOf("y").startOf("d");c.isSame(f,"y");)b.push(a("<span>").attr("data-action","selectMonth").addClass("month").text(c.format("MMM"))),c.add(1,"M");o.find(".datepicker-months td").empty().append(b)}(),o.find(".timepicker-hours").hide(),o.find(".timepicker-minutes").hide(),o.find(".timepicker-seconds").hide(),_(),L(),a(window).on("resize",I),o.on("click","[data-action]",fa),o.on("mousedown",!1),n&&n.hasClass("btn")&&n.toggleClass("active"),I(),o.show(),d.focusOnShow&&!g.is(":focus")&&g.focus(),J({type:"dp.show"})),l}function ha(){return o?ba():ga()}function ia(a){var b,c,e,f,g=null,h=[],i={},j=a.which;for(b in w[j]="p",w)w.hasOwnProperty(b)&&"p"===w[b]&&(h.push(b),parseInt(b,10)!==j&&(i[b]=!0));for(b in d.keyBinds)if(d.keyBinds.hasOwnProperty(b)&&"function"==typeof d.keyBinds[b]&&((e=b.split(" ")).length===h.length&&v[j]===e[e.length-1])){for(f=!0,c=e.length-2;0<=c;c--)if(!(v[e[c]]in i)){f=!1;break}if(f){g=d.keyBinds[b];break}}g&&(g.call(l,o),a.stopPropagation(),a.preventDefault())}function ja(a){w[a.which]="r",a.stopPropagation(),a.preventDefault()}function ka(b){var c=a(b.target).val().trim(),d=c?da(c):null;return aa(d),b.stopImmediatePropagation(),!1}function na(b){var c={};return a.each(b,function(){var a=da(this);a.isValid()&&(c[a.format("YYYY-MM-DD")]=!0)}),!!Object.keys(c).length&&c}function oa(b){var c={};return a.each(b,function(){c[this]=!0}),!!Object.keys(c).length&&c}function pa(){var a=d.format||"L LT";i=a.replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,function(a){return(e.localeData().longDateFormat(a)||a).replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,function(a){return e.localeData().longDateFormat(a)||a})}),(j=d.extraFormats?d.extraFormats.slice():[]).indexOf(a)<0&&j.indexOf(i)<0&&j.push(i),h=i.toLowerCase().indexOf("a")<1&&i.replace(/\[.*?\]/g,"").indexOf("h")<1,z("y")&&(p=2),z("M")&&(p=1),z("d")&&(p=0),k=Math.max(p,k),m||aa(e)}var e,f,g,h,i,j,k,l={},m=!0,n=!1,o=!1,p=0,q=[{clsName:"days",navFnc:"M",navStep:1},{clsName:"months",navFnc:"y",navStep:1},{clsName:"years",navFnc:"y",navStep:10},{clsName:"decades",navFnc:"y",navStep:100}],r=["days","months","years","decades"],s=["top","bottom","auto"],t=["left","right","auto"],u=["default","top","bottom"],v={up:38,38:"up",down:40,40:"down",left:37,37:"left",right:39,39:"right",tab:9,9:"tab",escape:27,27:"escape",enter:13,13:"enter",pageUp:33,33:"pageUp",pageDown:34,34:"pageDown",shift:16,16:"shift",control:17,17:"control",space:32,32:"space",t:84,84:"t",delete:46,46:"delete"},w={},ea={next:function(){var a=q[k].navFnc;f.add(q[k].navStep,a),W(),K(a)},previous:function(){var a=q[k].navFnc;f.subtract(q[k].navStep,a),W(),K(a)},pickerSwitch:function(){L(1)},selectMonth:function(b){var c=a(b.target).closest("tbody").find("span").index(a(b.target));f.month(c),k===p?(aa(e.clone().year(f.year()).month(f.month())),d.inline||ba()):(L(-1),W()),K("M")},selectYear:function(b){var c=parseInt(a(b.target).text(),10)||0;f.year(c),k===p?(aa(e.clone().year(f.year())),d.inline||ba()):(L(-1),W()),K("YYYY")},selectDecade:function(b){var c=parseInt(a(b.target).data("selection"),10)||0;f.year(c),k===p?(aa(e.clone().year(f.year())),d.inline||ba()):(L(-1),W()),K("YYYY")},selectDay:function(b){var c=f.clone();a(b.target).is(".old")&&c.subtract(1,"M"),a(b.target).is(".new")&&c.add(1,"M"),aa(c.date(parseInt(a(b.target).text(),10))),A()||d.keepOpen||d.inline||ba()},incrementHours:function(){var a=e.clone().add(1,"h");R(a,"h")&&aa(a)},incrementMinutes:function(){var a=e.clone().add(d.stepping,"m");R(a,"m")&&aa(a)},incrementSeconds:function(){var a=e.clone().add(1,"s");R(a,"s")&&aa(a)},decrementHours:function(){var a=e.clone().subtract(1,"h");R(a,"h")&&aa(a)},decrementMinutes:function(){var a=e.clone().subtract(d.stepping,"m");R(a,"m")&&aa(a)},decrementSeconds:function(){var a=e.clone().subtract(1,"s");R(a,"s")&&aa(a)},togglePeriod:function(){aa(e.clone().add(12<=e.hours()?-12:12,"h"))},togglePicker:function(b){var c,e=a(b.target),f=e.closest("ul"),g=f.find(".in"),h=f.find(".collapse:not(.in)");if(g&&g.length){if((c=g.data("collapse"))&&c.transitioning)return;g.collapse?(g.collapse("hide"),h.collapse("show")):(g.removeClass("in"),h.addClass("in")),e.is("span")?e.toggleClass(d.icons.time+" "+d.icons.date):e.find("span").toggleClass(d.icons.time+" "+d.icons.date)}},showPicker:function(){o.find(".timepicker > div:not(.timepicker-picker)").hide(),o.find(".timepicker .timepicker-picker").show()},showHours:function(){o.find(".timepicker .timepicker-picker").hide(),o.find(".timepicker .timepicker-hours").show()},showMinutes:function(){o.find(".timepicker .timepicker-picker").hide(),o.find(".timepicker .timepicker-minutes").show()},showSeconds:function(){o.find(".timepicker .timepicker-picker").hide(),o.find(".timepicker .timepicker-seconds").show()},selectHour:function(b){var c=parseInt(a(b.target).text(),10);h||(12<=e.hours()?12!==c&&(c+=12):12===c&&(c=0)),aa(e.clone().hours(c)),ea.showPicker.call(l)},selectMinute:function(b){aa(e.clone().minutes(parseInt(a(b.target).text(),10))),ea.showPicker.call(l)},selectSecond:function(b){aa(e.clone().seconds(parseInt(a(b.target).text(),10))),ea.showPicker.call(l)},clear:ca,today:function(){var a=y();R(a,"d")&&aa(a)},close:ba};if(l.destroy=function(){ba(),g.off({change:ka,blur:blur,keydown:ia,keyup:ja,focus:d.allowInputToggle?ba:""}),c.is("input")?g.off({focus:ga}):n&&(n.off("click",ha),n.off("mousedown",!1)),c.removeData("DateTimePicker"),c.removeData("date")},l.toggle=ha,l.show=ga,l.hide=ba,l.disable=function(){return ba(),n&&n.hasClass("btn")&&n.addClass("disabled"),g.prop("disabled",!0),l},l.enable=function(){return n&&n.hasClass("btn")&&n.removeClass("disabled"),g.prop("disabled",!1),l},l.ignoreReadonly=function(a){if(0===arguments.length)return d.ignoreReadonly;if("boolean"!=typeof a)throw new TypeError("ignoreReadonly () expects a boolean parameter");return d.ignoreReadonly=a,l},l.options=function(b){if(0===arguments.length)return a.extend(!0,{},d);if(!(b instanceof Object))throw new TypeError("options() options parameter should be an object");return a.extend(!0,d,b),a.each(d,function(a,b){if(void 0===l[a])throw new TypeError("option "+a+" is not recognized!");l[a](b)}),l},l.date=function(a){if(0===arguments.length)return m?null:e.clone();if(!(null===a||"string"==typeof a||b.isMoment(a)||a instanceof Date))throw new TypeError("date() parameter must be one of [null, string, moment or Date]");return aa(null===a?null:da(a)),l},l.format=function(a){if(0===arguments.length)return d.format;if("string"!=typeof a&&("boolean"!=typeof a||!1!==a))throw new TypeError("format() expects a string or boolean:false parameter "+a);return d.format=a,i&&pa(),l},l.timeZone=function(a){if(0===arguments.length)return d.timeZone;if("string"!=typeof a)throw new TypeError("newZone() expects a string parameter");return d.timeZone=a,l},l.dayViewHeaderFormat=function(a){if(0===arguments.length)return d.dayViewHeaderFormat;if("string"!=typeof a)throw new TypeError("dayViewHeaderFormat() expects a string parameter");return d.dayViewHeaderFormat=a,l},l.extraFormats=function(a){if(0===arguments.length)return d.extraFormats;if(!1!==a&&!(a instanceof Array))throw new TypeError("extraFormats() expects an array or false parameter");return d.extraFormats=a,j&&pa(),l},l.disabledDates=function(b){if(0===arguments.length)return d.disabledDates?a.extend({},d.disabledDates):d.disabledDates;if(!b)return d.disabledDates=!1,_(),l;if(!(b instanceof Array))throw new TypeError("disabledDates() expects an array parameter");return d.disabledDates=na(b),d.enabledDates=!1,_(),l},l.enabledDates=function(b){if(0===arguments.length)return d.enabledDates?a.extend({},d.enabledDates):d.enabledDates;if(!b)return d.enabledDates=!1,_(),l;if(!(b instanceof Array))throw new TypeError("enabledDates() expects an array parameter");return d.enabledDates=na(b),d.disabledDates=!1,_(),l},l.daysOfWeekDisabled=function(a){if(0===arguments.length)return d.daysOfWeekDisabled.splice(0);if("boolean"==typeof a&&!a)return d.daysOfWeekDisabled=!1,_(),l;if(!(a instanceof Array))throw new TypeError("daysOfWeekDisabled() expects an array parameter");if(d.daysOfWeekDisabled=a.reduce(function(a,b){return 6<(b=parseInt(b,10))||b<0||isNaN(b)||-1===a.indexOf(b)&&a.push(b),a},[]).sort(),d.useCurrent&&!d.keepInvalid){for(var b=0;!R(e,"d");){if(e.add(1,"d"),31===b)throw"Tried 31 times to find a valid date";b++}aa(e)}return _(),l},l.maxDate=function(a){if(0===arguments.length)return d.maxDate?d.maxDate.clone():d.maxDate;if("boolean"==typeof a&&!1===a)return d.maxDate=!1,_(),l;"string"==typeof a&&("now"!==a&&"moment"!==a||(a=y()));var b=da(a);if(!b.isValid())throw new TypeError("maxDate() Could not parse date parameter: "+a);if(d.minDate&&b.isBefore(d.minDate))throw new TypeError("maxDate() date parameter is before options.minDate: "+b.format(i));return d.maxDate=b,d.useCurrent&&!d.keepInvalid&&e.isAfter(a)&&aa(d.maxDate),f.isAfter(b)&&(f=b.clone().subtract(d.stepping,"m")),_(),l},l.minDate=function(a){if(0===arguments.length)return d.minDate?d.minDate.clone():d.minDate;if("boolean"==typeof a&&!1===a)return d.minDate=!1,_(),l;"string"==typeof a&&("now"!==a&&"moment"!==a||(a=y()));var b=da(a);if(!b.isValid())throw new TypeError("minDate() Could not parse date parameter: "+a);if(d.maxDate&&b.isAfter(d.maxDate))throw new TypeError("minDate() date parameter is after options.maxDate: "+b.format(i));return d.minDate=b,d.useCurrent&&!d.keepInvalid&&e.isBefore(a)&&aa(d.minDate),f.isBefore(b)&&(f=b.clone().add(d.stepping,"m")),_(),l},l.defaultDate=function(a){if(0===arguments.length)return d.defaultDate?d.defaultDate.clone():d.defaultDate;if(!a)return d.defaultDate=!1,l;"string"==typeof a&&(a="now"===a||"moment"===a?y():y(a));var b=da(a);if(!b.isValid())throw new TypeError("defaultDate() Could not parse date parameter: "+a);if(!R(b))throw new TypeError("defaultDate() date passed is invalid according to component setup validations");return d.defaultDate=b,(d.defaultDate&&d.inline||""===g.val().trim())&&aa(d.defaultDate),l},l.locale=function(a){if(0===arguments.length)return d.locale;if(!b.localeData(a))throw new TypeError("locale() locale "+a+" is not loaded from moment locales!");return d.locale=a,e.locale(d.locale),f.locale(d.locale),i&&pa(),o&&(ba(),ga()),l},l.stepping=function(a){return 0===arguments.length?d.stepping:(a=parseInt(a,10),(isNaN(a)||a<1)&&(a=1),d.stepping=a,l)},l.useCurrent=function(a){var b=["year","month","day","hour","minute"];if(0===arguments.length)return d.useCurrent;if("boolean"!=typeof a&&"string"!=typeof a)throw new TypeError("useCurrent() expects a boolean or string parameter");if("string"==typeof a&&-1===b.indexOf(a.toLowerCase()))throw new TypeError("useCurrent() expects a string parameter of "+b.join(", "));return d.useCurrent=a,l},l.collapse=function(a){if(0===arguments.length)return d.collapse;if("boolean"!=typeof a)throw new TypeError("collapse() expects a boolean parameter");return d.collapse===a||(d.collapse=a,o&&(ba(),ga())),l},l.icons=function(b){if(0===arguments.length)return a.extend({},d.icons);if(!(b instanceof Object))throw new TypeError("icons() expects parameter to be an Object");return a.extend(d.icons,b),o&&(ba(),ga()),l},l.tooltips=function(b){if(0===arguments.length)return a.extend({},d.tooltips);if(!(b instanceof Object))throw new TypeError("tooltips() expects parameter to be an Object");return a.extend(d.tooltips,b),o&&(ba(),ga()),l},l.useStrict=function(a){if(0===arguments.length)return d.useStrict;if("boolean"!=typeof a)throw new TypeError("useStrict() expects a boolean parameter");return d.useStrict=a,l},l.sideBySide=function(a){if(0===arguments.length)return d.sideBySide;if("boolean"!=typeof a)throw new TypeError("sideBySide() expects a boolean parameter");return d.sideBySide=a,o&&(ba(),ga()),l},l.viewMode=function(a){if(0===arguments.length)return d.viewMode;if("string"!=typeof a)throw new TypeError("viewMode() expects a string parameter");if(-1===r.indexOf(a))throw new TypeError("viewMode() parameter must be one of ("+r.join(", ")+") value");return d.viewMode=a,k=Math.max(r.indexOf(a),p),L(),l},l.toolbarPlacement=function(a){if(0===arguments.length)return d.toolbarPlacement;if("string"!=typeof a)throw new TypeError("toolbarPlacement() expects a string parameter");if(-1===u.indexOf(a))throw new TypeError("toolbarPlacement() parameter must be one of ("+u.join(", ")+") value");return d.toolbarPlacement=a,o&&(ba(),ga()),l},l.widgetPositioning=function(b){if(0===arguments.length)return a.extend({},d.widgetPositioning);if("[object Object]"!=={}.toString.call(b))throw new TypeError("widgetPositioning() expects an object variable");if(b.horizontal){if("string"!=typeof b.horizontal)throw new TypeError("widgetPositioning() horizontal variable must be a string");if(b.horizontal=b.horizontal.toLowerCase(),-1===t.indexOf(b.horizontal))throw new TypeError("widgetPositioning() expects horizontal parameter to be one of ("+t.join(", ")+")");d.widgetPositioning.horizontal=b.horizontal}if(b.vertical){if("string"!=typeof b.vertical)throw new TypeError("widgetPositioning() vertical variable must be a string");if(b.vertical=b.vertical.toLowerCase(),-1===s.indexOf(b.vertical))throw new TypeError("widgetPositioning() expects vertical parameter to be one of ("+s.join(", ")+")");d.widgetPositioning.vertical=b.vertical}return _(),l},l.calendarWeeks=function(a){if(0===arguments.length)return d.calendarWeeks;if("boolean"!=typeof a)throw new TypeError("calendarWeeks() expects parameter to be a boolean value");return d.calendarWeeks=a,_(),l},l.showTodayButton=function(a){if(0===arguments.length)return d.showTodayButton;if("boolean"!=typeof a)throw new TypeError("showTodayButton() expects a boolean parameter");return d.showTodayButton=a,o&&(ba(),ga()),l},l.showClear=function(a){if(0===arguments.length)return d.showClear;if("boolean"!=typeof a)throw new TypeError("showClear() expects a boolean parameter");return d.showClear=a,o&&(ba(),ga()),l},l.widgetParent=function(b){if(0===arguments.length)return d.widgetParent;if("string"==typeof b&&(b=a(b)),null!==b&&"string"!=typeof b&&!(b instanceof a))throw new TypeError("widgetParent() expects a string or a jQuery object parameter");return d.widgetParent=b,o&&(ba(),ga()),l},l.keepOpen=function(a){if(0===arguments.length)return d.keepOpen;if("boolean"!=typeof a)throw new TypeError("keepOpen() expects a boolean parameter");return d.keepOpen=a,l},l.focusOnShow=function(a){if(0===arguments.length)return d.focusOnShow;if("boolean"!=typeof a)throw new TypeError("focusOnShow() expects a boolean parameter");return d.focusOnShow=a,l},l.inline=function(a){if(0===arguments.length)return d.inline;if("boolean"!=typeof a)throw new TypeError("inline() expects a boolean parameter");return d.inline=a,l},l.clear=function(){return ca(),l},l.keyBinds=function(a){return 0===arguments.length?d.keyBinds:(d.keyBinds=a,l)},l.getMoment=function(a){return y(a)},l.debug=function(a){if("boolean"!=typeof a)throw new TypeError("debug() expects a boolean parameter");return d.debug=a,l},l.allowInputToggle=function(a){if(0===arguments.length)return d.allowInputToggle;if("boolean"!=typeof a)throw new TypeError("allowInputToggle() expects a boolean parameter");return d.allowInputToggle=a,l},l.showClose=function(a){if(0===arguments.length)return d.showClose;if("boolean"!=typeof a)throw new TypeError("showClose() expects a boolean parameter");return d.showClose=a,l},l.keepInvalid=function(a){if(0===arguments.length)return d.keepInvalid;if("boolean"!=typeof a)throw new TypeError("keepInvalid() expects a boolean parameter");return d.keepInvalid=a,l},l.datepickerInput=function(a){if(0===arguments.length)return d.datepickerInput;if("string"!=typeof a)throw new TypeError("datepickerInput() expects a string parameter");return d.datepickerInput=a,l},l.parseInputDate=function(a){if(0===arguments.length)return d.parseInputDate;if("function"!=typeof a)throw new TypeError("parseInputDate() sholud be as function");return d.parseInputDate=a,l},l.disabledTimeIntervals=function(b){if(0===arguments.length)return d.disabledTimeIntervals?a.extend({},d.disabledTimeIntervals):d.disabledTimeIntervals;if(!b)return d.disabledTimeIntervals=!1,_(),l;if(!(b instanceof Array))throw new TypeError("disabledTimeIntervals() expects an array parameter");return d.disabledTimeIntervals=b,_(),l},l.disabledHours=function(b){if(0===arguments.length)return d.disabledHours?a.extend({},d.disabledHours):d.disabledHours;if(!b)return d.disabledHours=!1,_(),l;if(!(b instanceof Array))throw new TypeError("disabledHours() expects an array parameter");if(d.disabledHours=oa(b),d.enabledHours=!1,d.useCurrent&&!d.keepInvalid){for(var c=0;!R(e,"h");){if(e.add(1,"h"),24===c)throw"Tried 24 times to find a valid date";c++}aa(e)}return _(),l},l.enabledHours=function(b){if(0===arguments.length)return d.enabledHours?a.extend({},d.enabledHours):d.enabledHours;if(!b)return d.enabledHours=!1,_(),l;if(!(b instanceof Array))throw new TypeError("enabledHours() expects an array parameter");if(d.enabledHours=oa(b),d.disabledHours=!1,d.useCurrent&&!d.keepInvalid){for(var c=0;!R(e,"h");){if(e.add(1,"h"),24===c)throw"Tried 24 times to find a valid date";c++}aa(e)}return _(),l},l.viewDate=function(a){if(0===arguments.length)return f.clone();if(!a)return f=e.clone(),l;if(!("string"==typeof a||b.isMoment(a)||a instanceof Date))throw new TypeError("viewDate() parameter must be one of [string, moment or Date]");return f=da(a),K(),l},c.is("input"))g=c;else if(0===(g=c.find(d.datepickerInput)).length)g=c.find("input");else if(!g.is("input"))throw new Error('CSS class "'+d.datepickerInput+'" cannot be applied to non input element');if(c.hasClass("input-group")&&(n=0===c.find(".datepickerbutton").length?c.find(".input-group-addon"):c.find(".datepickerbutton")),!d.inline&&!g.is("input"))throw new Error("Could not initialize DateTimePicker without an input element");return e=y(),f=e.clone(),a.extend(!0,d,function(){var b,e={};return(b=c.is("input")||d.inline?c.data():c.find("input").data()).dateOptions&&b.dateOptions instanceof Object&&(e=a.extend(!0,e,b.dateOptions)),a.each(d,function(a){var c="date"+a.charAt(0).toUpperCase()+a.slice(1);void 0!==b[c]&&(e[a]=b[c])}),e}()),l.options(d),pa(),g.on({change:ka,blur:d.debug?"":ba,keydown:ia,keyup:ja,focus:d.allowInputToggle?ga:""}),c.is("input")?g.on({focus:ga}):n&&(n.on("click",ha),n.on("mousedown",!1)),g.prop("disabled")&&l.disable(),g.is("input")&&0!==g.val().trim().length?aa(da(g.val().trim())):d.defaultDate&&void 0===g.attr("placeholder")&&aa(d.defaultDate),d.inline&&ga(),l};return a.fn.datetimepicker=function(b){b=b||{};var d,e=Array.prototype.slice.call(arguments,1),f=!0;if("object"==typeof b)return this.each(function(){var d,e=a(this);e.data("DateTimePicker")||(d=a.extend(!0,{},a.fn.datetimepicker.defaults,b),e.data("DateTimePicker",c(e,d)))});if("string"==typeof b)return this.each(function(){var g=a(this).data("DateTimePicker");if(!g)throw new Error('bootstrap-datetimepicker("'+b+'") method was called on an element that is not using DateTimePicker');d=g[b].apply(g,e),f=d===g}),f||-1<a.inArray(b,["destroy","hide","show","toggle"])?this:d;throw new TypeError("Invalid arguments for DateTimePicker: "+b)},a.fn.datetimepicker.defaults={timeZone:"",format:!1,dayViewHeaderFormat:"MMMM YYYY",extraFormats:!1,stepping:1,minDate:!1,maxDate:!1,useCurrent:!0,collapse:!0,locale:b.locale(),defaultDate:!1,disabledDates:!1,enabledDates:!1,icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down",previous:"glyphicon glyphicon-chevron-left",next:"glyphicon glyphicon-chevron-right",today:"glyphicon glyphicon-screenshot",clear:"glyphicon glyphicon-trash",close:"glyphicon glyphicon-remove"},tooltips:{today:"Go to today",clear:"Clear selection",close:"Close the picker",selectMonth:"Select Month",prevMonth:"Previous Month",nextMonth:"Next Month",selectYear:"Select Year",prevYear:"Previous Year",nextYear:"Next Year",selectDecade:"Select Decade",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevCentury:"Previous Century",nextCentury:"Next Century",pickHour:"Pick Hour",incrementHour:"Increment Hour",decrementHour:"Decrement Hour",pickMinute:"Pick Minute",incrementMinute:"Increment Minute",decrementMinute:"Decrement Minute",pickSecond:"Pick Second",incrementSecond:"Increment Second",decrementSecond:"Decrement Second",togglePeriod:"Toggle Period",selectTime:"Select Time"},useStrict:!1,sideBySide:!1,daysOfWeekDisabled:!1,calendarWeeks:!1,viewMode:"days",toolbarPlacement:"default",showTodayButton:!1,showClear:!1,showClose:!1,widgetPositioning:{horizontal:"auto",vertical:"auto"},widgetParent:null,ignoreReadonly:!1,keepOpen:!1,focusOnShow:!0,inline:!1,keepInvalid:!1,datepickerInput:".datepickerinput",keyBinds:{up:function(a){if(a){var b=this.date()||this.getMoment();a.find(".datepicker").is(":visible")?this.date(b.clone().subtract(7,"d")):this.date(b.clone().add(this.stepping(),"m"))}},down:function(a){if(a){var b=this.date()||this.getMoment();a.find(".datepicker").is(":visible")?this.date(b.clone().add(7,"d")):this.date(b.clone().subtract(this.stepping(),"m"))}else this.show()},"control up":function(a){if(a){var b=this.date()||this.getMoment();a.find(".datepicker").is(":visible")?this.date(b.clone().subtract(1,"y")):this.date(b.clone().add(1,"h"))}},"control down":function(a){if(a){var b=this.date()||this.getMoment();a.find(".datepicker").is(":visible")?this.date(b.clone().add(1,"y")):this.date(b.clone().subtract(1,"h"))}},left:function(a){if(a){var b=this.date()||this.getMoment();a.find(".datepicker").is(":visible")&&this.date(b.clone().subtract(1,"d"))}},right:function(a){if(a){var b=this.date()||this.getMoment();a.find(".datepicker").is(":visible")&&this.date(b.clone().add(1,"d"))}},pageUp:function(a){if(a){var b=this.date()||this.getMoment();a.find(".datepicker").is(":visible")&&this.date(b.clone().subtract(1,"M"))}},pageDown:function(a){if(a){var b=this.date()||this.getMoment();a.find(".datepicker").is(":visible")&&this.date(b.clone().add(1,"M"))}},enter:function(){this.hide()},escape:function(){this.hide()},"control space":function(a){a&&a.find(".timepicker").is(":visible")&&a.find('.btn[data-action="togglePeriod"]').click()},t:function(){this.date(this.getMoment())},delete:function(){this.clear()}},debug:!1,allowInputToggle:!1,disabledTimeIntervals:!1,disabledHours:!1,enabledHours:!1,viewDate:!1},a.fn.datetimepicker}),function($){"use strict";function Multiselect(select,options){this.$select=$(select),this.$select.attr("data-placeholder")&&(options.nonSelectedText=this.$select.data("placeholder")),this.options=this.mergeOptions($.extend({},options,this.$select.data())),this.originalOptions=this.$select.clone()[0].options,this.query="",this.searchTimeout=null,this.lastToggledInput=null,this.options.multiple="multiple"===this.$select.attr("multiple"),this.options.onChange=$.proxy(this.options.onChange,this),this.options.onDropdownShow=$.proxy(this.options.onDropdownShow,this),this.options.onDropdownHide=$.proxy(this.options.onDropdownHide,this),this.options.onDropdownShown=$.proxy(this.options.onDropdownShown,this),this.options.onDropdownHidden=$.proxy(this.options.onDropdownHidden,this),this.buildContainer(),this.buildButton(),this.buildDropdown(),this.buildSelectAll(),this.buildDropdownOptions(),this.buildFilter(),this.updateButtonText(),this.updateSelectAll(),this.options.disableIfEmpty&&$("option",this.$select).length<=0&&this.disable(),this.$select.hide().after(this.$container)}"undefined"!=typeof ko&&ko.bindingHandlers&&!ko.bindingHandlers.multiselect&&(ko.bindingHandlers.multiselect={after:["options","value","selectedOptions"],init:function(element,valueAccessor,allBindings,viewModel,bindingContext){var $element=$(element),config=ko.toJS(valueAccessor());if($element.multiselect(config),allBindings.has("options")){var options=allBindings.get("options");ko.isObservable(options)&&ko.computed({read:function(){options(),setTimeout(function(){var ms=$element.data("multiselect");ms&&ms.updateOriginalOptions(),$element.multiselect("rebuild")},1)},disposeWhenNodeIsRemoved:element})}if(allBindings.has("value")){var value=allBindings.get("value");ko.isObservable(value)&&ko.computed({read:function(){value(),setTimeout(function(){$element.multiselect("refresh")},1)},disposeWhenNodeIsRemoved:element}).extend({rateLimit:100,notifyWhenChangesStop:!0})}if(allBindings.has("selectedOptions")){var selectedOptions=allBindings.get("selectedOptions");ko.isObservable(selectedOptions)&&ko.computed({read:function(){selectedOptions(),setTimeout(function(){$element.multiselect("refresh")},1)},disposeWhenNodeIsRemoved:element}).extend({rateLimit:100,notifyWhenChangesStop:!0})}ko.utils.domNodeDisposal.addDisposeCallback(element,function(){$element.multiselect("destroy")})},update:function(element,valueAccessor,allBindings,viewModel,bindingContext){var $element=$(element),config=ko.toJS(valueAccessor());$element.multiselect("setOptions",config),$element.multiselect("rebuild")}}),Multiselect.prototype={defaults:{buttonText:function(options,select){if(0===options.length)return this.nonSelectedText;if(this.allSelectedText&&options.length===$("option",$(select)).length&&1!==$("option",$(select)).length&&this.multiple)return this.selectAllNumber?this.allSelectedText+" ("+options.length+")":this.allSelectedText;if(options.length>this.numberDisplayed)return options.length+" "+this.nSelectedText;var selected="",delimiter=this.delimiterText;return options.each(function(){var label=void 0!==$(this).attr("label")?$(this).attr("label"):$(this).text();selected+=label+delimiter}),selected.substr(0,selected.length-2)},buttonTitle:function(options,select){if(0===options.length)return this.nonSelectedText;var selected="",delimiter=this.delimiterText;return options.each(function(){var label=void 0!==$(this).attr("label")?$(this).attr("label"):$(this).text();selected+=label+delimiter}),selected.substr(0,selected.length-2)},optionLabel:function(element){return $(element).attr("label")||$(element).text()},onChange:function(option,checked){},onDropdownShow:function(event){},onDropdownHide:function(event){},onDropdownShown:function(event){},onDropdownHidden:function(event){},onSelectAll:function(){},enableHTML:!1,buttonClass:"btn btn-default",inheritClass:!1,buttonWidth:"auto",buttonContainer:'<div class="btn-group" />',dropRight:!1,selectedClass:"active",maxHeight:!1,checkboxName:!1,includeSelectAllOption:!1,includeSelectAllIfMoreThan:0,selectAllText:" Select all",selectAllValue:"multiselect-all",selectAllName:!1,selectAllNumber:!0,enableFiltering:!1,enableCaseInsensitiveFiltering:!1,enableClickableOptGroups:!1,filterPlaceholder:"Search",filterBehavior:"text",includeFilterClearBtn:!0,preventInputChangeEvent:!1,nonSelectedText:"None selected",nSelectedText:"selected",allSelectedText:"All selected",numberDisplayed:3,disableIfEmpty:!1,delimiterText:", ",templates:{button:'<button type="button" class="multiselect dropdown-toggle" data-toggle="dropdown"><span class="multiselect-selected-text"></span> <b class="caret"></b></button>',ul:'<ul class="multiselect-container dropdown-menu"></ul>',filter:'<li class="multiselect-item filter"><div class="input-group"><span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span><input class="form-control multiselect-search" type="text"></div></li>',filterClearBtn:'<span class="input-group-btn"><button class="btn btn-default multiselect-clear-filter" type="button"><i class="glyphicon glyphicon-remove-circle"></i></button></span>',li:'<li><a tabindex="0"><label></label></a></li>',divider:'<li class="multiselect-item divider"></li>',liGroup:'<li class="multiselect-item multiselect-group"><label></label></li>'}},constructor:Multiselect,buildContainer:function(){this.$container=$(this.options.buttonContainer),this.$container.on("show.bs.dropdown",this.options.onDropdownShow),this.$container.on("hide.bs.dropdown",this.options.onDropdownHide),this.$container.on("shown.bs.dropdown",this.options.onDropdownShown),this.$container.on("hidden.bs.dropdown",this.options.onDropdownHidden)},buildButton:function(){this.$button=$(this.options.templates.button).addClass(this.options.buttonClass),this.$select.attr("class")&&this.options.inheritClass&&this.$button.addClass(this.$select.attr("class")),this.$select.prop("disabled")?this.disable():this.enable(),this.options.buttonWidth&&"auto"!==this.options.buttonWidth&&(this.$button.css({width:this.options.buttonWidth,overflow:"hidden","text-overflow":"ellipsis"}),this.$container.css({width:this.options.buttonWidth}));var tabindex=this.$select.attr("tabindex");tabindex&&this.$button.attr("tabindex",tabindex),this.$container.prepend(this.$button)},buildDropdown:function(){this.$ul=$(this.options.templates.ul),this.options.dropRight&&this.$ul.addClass("pull-right"),this.options.maxHeight&&this.$ul.css({"max-height":this.options.maxHeight+"px","overflow-y":"auto","overflow-x":"hidden"}),this.$container.append(this.$ul)},buildDropdownOptions:function(){this.$select.children().each($.proxy(function(index,element){var $element=$(element),tag=$element.prop("tagName").toLowerCase();$element.prop("value")!==this.options.selectAllValue&&("optgroup"===tag?this.createOptgroup(element):"option"===tag&&("divider"===$element.data("role")?this.createDivider():this.createOptionValue(element)))},this)),$("li input",this.$ul).on("change",$.proxy(function(event){var $target=$(event.target),checked=$target.prop("checked")||!1,isSelectAllOption=$target.val()===this.options.selectAllValue;this.options.selectedClass&&(checked?$target.closest("li").addClass(this.options.selectedClass):$target.closest("li").removeClass(this.options.selectedClass));var value=$target.val(),$option=this.getOptionByValue(value),$optionsNotThis=$("option",this.$select).not($option),$checkboxesNotThis=$("input",this.$container).not($target);if(isSelectAllOption&&(checked?this.selectAll():this.deselectAll()),isSelectAllOption||(checked?($option.prop("selected",!0),this.options.multiple?$option.prop("selected",!0):(this.options.selectedClass&&$($checkboxesNotThis).closest("li").removeClass(this.options.selectedClass),$($checkboxesNotThis).prop("checked",!1),$optionsNotThis.prop("selected",!1),this.$button.click()),"active"===this.options.selectedClass&&$optionsNotThis.closest("a").css("outline","")):$option.prop("selected",!1)),this.$select.change(),this.updateButtonText(),this.updateSelectAll(),this.options.onChange($option,checked),this.options.preventInputChangeEvent)return!1},this)),$("li a",this.$ul).on("mousedown",function(e){if(e.shiftKey)return!1}),$("li a",this.$ul).on("touchstart click",$.proxy(function(event){event.stopPropagation();var $target=$(event.target);if(event.shiftKey&&this.options.multiple){$target.is("label")&&(event.preventDefault(),($target=$target.find("input")).prop("checked",!$target.prop("checked")));var checked=$target.prop("checked")||!1;if(null!==this.lastToggledInput&&this.lastToggledInput!==$target){var from=$target.closest("li").index(),to=this.lastToggledInput.closest("li").index();if(to<from){var tmp=to;to=from,from=tmp}++to;var range=this.$ul.find("li").slice(from,to).find("input");range.prop("checked",checked),this.options.selectedClass&&range.closest("li").toggleClass(this.options.selectedClass,checked);for(var i=0,j=range.length;i<j;i++){var $checkbox=$(range[i]);this.getOptionByValue($checkbox.val()).prop("selected",checked)}}$target.trigger("change")}$target.is("input")&&!$target.closest("li").is(".multiselect-item")&&(this.lastToggledInput=$target),$target.blur()},this)),this.$container.off("keydown.multiselect").on("keydown.multiselect",$.proxy(function(event){if(!$('input[type="text"]',this.$container).is(":focus"))if(9===event.keyCode&&this.$container.hasClass("open"))this.$button.click();else{var $items=$(this.$container).find("li:not(.divider):not(.disabled) a").filter(":visible");if(!$items.length)return;var index=$items.index($items.filter(":focus"));38===event.keyCode&&0<index?index--:40===event.keyCode&&index<$items.length-1?index++:~index||(index=0);var $current=$items.eq(index);if($current.focus(),32===event.keyCode||13===event.keyCode){var $checkbox=$current.find("input");$checkbox.prop("checked",!$checkbox.prop("checked")),$checkbox.change()}event.stopPropagation(),event.preventDefault()}},this)),this.options.enableClickableOptGroups&&this.options.multiple&&$("li.multiselect-group",this.$ul).on("click",$.proxy(function(event){event.stopPropagation();var $visibleOptions=$(event.target).parent().nextUntil("li.multiselect-group").filter(":visible:not(.disabled)"),allChecked=!0,optionInputs=$visibleOptions.find("input");optionInputs.each(function(){allChecked=allChecked&&$(this).prop("checked")}),optionInputs.prop("checked",!allChecked).trigger("change")},this))},createOptionValue:function(element){var $element=$(element);$element.is(":selected")&&$element.prop("selected",!0);var label=this.options.optionLabel(element),value=$element.val(),inputType=this.options.multiple?"checkbox":"radio",$li=$(this.options.templates.li),$label=$("label",$li);$label.addClass(inputType),this.options.enableHTML?$label.html(" "+label):$label.text(" "+label);var $checkbox=$("<input/>").attr("type",inputType);this.options.checkboxName&&$checkbox.attr("name",this.options.checkboxName),$label.prepend($checkbox);var selected=$element.prop("selected")||!1;$checkbox.val(value),value===this.options.selectAllValue&&($li.addClass("multiselect-item multiselect-all"),$checkbox.parent().parent().addClass("multiselect-all")),$label.attr("title",$element.attr("title")),this.$ul.append($li),$element.is(":disabled")&&$checkbox.attr("disabled","disabled").prop("disabled",!0).closest("a").attr("tabindex","-1").closest("li").addClass("disabled"),$checkbox.prop("checked",selected),selected&&this.options.selectedClass&&$checkbox.closest("li").addClass(this.options.selectedClass)},createDivider:function(element){var $divider=$(this.options.templates.divider);this.$ul.append($divider)},createOptgroup:function(group){var groupName=$(group).prop("label"),$li=$(this.options.templates.liGroup);this.options.enableHTML?$("label",$li).html(groupName):$("label",$li).text(groupName),this.options.enableClickableOptGroups&&$li.addClass("multiselect-group-clickable"),this.$ul.append($li),$(group).is(":disabled")&&$li.addClass("disabled"),$("option",group).each($.proxy(function(index,element){this.createOptionValue(element)},this))},buildSelectAll:function(){if("number"==typeof this.options.selectAllValue&&(this.options.selectAllValue=this.options.selectAllValue.toString()),!this.hasSelectAll()&&this.options.includeSelectAllOption&&this.options.multiple&&$("option",this.$select).length>this.options.includeSelectAllIfMoreThan){this.options.includeSelectAllDivider&&this.$ul.prepend($(this.options.templates.divider));var $li=$(this.options.templates.li);$("label",$li).addClass("checkbox"),this.options.enableHTML?$("label",$li).html(" "+this.options.selectAllText):$("label",$li).text(" "+this.options.selectAllText),this.options.selectAllName?$("label",$li).prepend('<input type="checkbox" name="'+this.options.selectAllName+'" />'):$("label",$li).prepend('<input type="checkbox" />');var $checkbox=$("input",$li);$checkbox.val(this.options.selectAllValue),$li.addClass("multiselect-item multiselect-all"),$checkbox.parent().parent().addClass("multiselect-all"),this.$ul.prepend($li),$checkbox.prop("checked",!1)}},buildFilter:function(){if(this.options.enableFiltering||this.options.enableCaseInsensitiveFiltering){var enableFilterLength=Math.max(this.options.enableFiltering,this.options.enableCaseInsensitiveFiltering);if(this.$select.find("option").length>=enableFilterLength){if(this.$filter=$(this.options.templates.filter),$("input",this.$filter).attr("placeholder",this.options.filterPlaceholder),this.options.includeFilterClearBtn){var clearBtn=$(this.options.templates.filterClearBtn);clearBtn.on("click",$.proxy(function(event){clearTimeout(this.searchTimeout),this.$filter.find(".multiselect-search").val(""),$("li",this.$ul).show().removeClass("filter-hidden"),this.updateSelectAll()},this)),this.$filter.find(".input-group").append(clearBtn)}this.$ul.prepend(this.$filter),this.$filter.val(this.query).on("click",function(event){event.stopPropagation()}).on("input keydown",$.proxy(function(event){13===event.which&&event.preventDefault(),clearTimeout(this.searchTimeout),this.searchTimeout=this.asyncFunction($.proxy(function(){var currentGroup,currentGroupVisible;this.query!==event.target.value&&(this.query=event.target.value,$.each($("li",this.$ul),$.proxy(function(index,element){var value=0<$("input",element).length?$("input",element).val():"",text=$("label",element).text(),filterCandidate="";if("text"===this.options.filterBehavior?filterCandidate=text:"value"===this.options.filterBehavior?filterCandidate=value:"both"===this.options.filterBehavior&&(filterCandidate=text+"\n"+value),value!==this.options.selectAllValue&&text){var showElement=!1;this.options.enableCaseInsensitiveFiltering&&-1<filterCandidate.toLowerCase().indexOf(this.query.toLowerCase())?showElement=!0:-1<filterCandidate.indexOf(this.query)&&(showElement=!0),$(element).toggle(showElement).toggleClass("filter-hidden",!showElement),$(element).hasClass("multiselect-group")?(currentGroup=element,currentGroupVisible=showElement):(showElement&&$(currentGroup).show().removeClass("filter-hidden"),!showElement&&currentGroupVisible&&$(element).show().removeClass("filter-hidden"))}},this)));this.updateSelectAll()},this),300,this)},this))}}},destroy:function(){this.$container.remove(),this.$select.show(),this.$select.data("multiselect",null)},refresh:function(){$("option",this.$select).each($.proxy(function(index,element){var $input=$("li input",this.$ul).filter(function(){return $(this).val()===$(element).val()});$(element).is(":selected")?($input.prop("checked",!0),this.options.selectedClass&&$input.closest("li").addClass(this.options.selectedClass)):($input.prop("checked",!1),this.options.selectedClass&&$input.closest("li").removeClass(this.options.selectedClass)),$(element).is(":disabled")?$input.attr("disabled","disabled").prop("disabled",!0).closest("li").addClass("disabled"):$input.prop("disabled",!1).closest("li").removeClass("disabled")},this)),this.updateButtonText(),this.updateSelectAll()},select:function(selectValues,triggerOnChange){$.isArray(selectValues)||(selectValues=[selectValues]);for(var i=0;i<selectValues.length;i++){var value=selectValues[i];if(null!=value){var $option=this.getOptionByValue(value),$checkbox=this.getInputByValue(value);void 0!==$option&&void 0!==$checkbox&&(this.options.multiple||this.deselectAll(!1),this.options.selectedClass&&$checkbox.closest("li").addClass(this.options.selectedClass),$checkbox.prop("checked",!0),$option.prop("selected",!0),triggerOnChange&&this.options.onChange($option,!0))}}this.updateButtonText(),this.updateSelectAll()},clearSelection:function(){this.deselectAll(!1),this.updateButtonText(),this.updateSelectAll()},deselect:function(deselectValues,triggerOnChange){$.isArray(deselectValues)||(deselectValues=[deselectValues]);for(var i=0;i<deselectValues.length;i++){var value=deselectValues[i];if(null!=value){var $option=this.getOptionByValue(value),$checkbox=this.getInputByValue(value);void 0!==$option&&void 0!==$checkbox&&(this.options.selectedClass&&$checkbox.closest("li").removeClass(this.options.selectedClass),$checkbox.prop("checked",!1),$option.prop("selected",!1),triggerOnChange&&this.options.onChange($option,!1))}}this.updateButtonText(),this.updateSelectAll()},selectAll:function(justVisible,triggerOnSelectAll){justVisible=void 0===justVisible||justVisible;var allCheckboxes=$("li input[type='checkbox']:enabled",this.$ul),visibleCheckboxes=allCheckboxes.filter(":visible"),allCheckboxesCount=allCheckboxes.length,visibleCheckboxesCount=visibleCheckboxes.length;if(justVisible?(visibleCheckboxes.prop("checked",!0),$("li:not(.divider):not(.disabled)",this.$ul).filter(":visible").addClass(this.options.selectedClass)):(allCheckboxes.prop("checked",!0),$("li:not(.divider):not(.disabled)",this.$ul).addClass(this.options.selectedClass)),allCheckboxesCount===visibleCheckboxesCount||!1===justVisible)$("option:enabled",this.$select).prop("selected",!0);else{var values=visibleCheckboxes.map(function(){return $(this).val()}).get();$("option:enabled",this.$select).filter(function(index){return-1!==$.inArray($(this).val(),values)}).prop("selected",!0)}triggerOnSelectAll&&this.options.onSelectAll()},deselectAll:function(justVisible){if(justVisible=void 0===justVisible||justVisible){var visibleCheckboxes=$("li input[type='checkbox']:not(:disabled)",this.$ul).filter(":visible");visibleCheckboxes.prop("checked",!1);var values=visibleCheckboxes.map(function(){return $(this).val()}).get();$("option:enabled",this.$select).filter(function(index){return-1!==$.inArray($(this).val(),values)}).prop("selected",!1),this.options.selectedClass&&$("li:not(.divider):not(.disabled)",this.$ul).filter(":visible").removeClass(this.options.selectedClass)}else $("li input[type='checkbox']:enabled",this.$ul).prop("checked",!1),$("option:enabled",this.$select).prop("selected",!1),this.options.selectedClass&&$("li:not(.divider):not(.disabled)",this.$ul).removeClass(this.options.selectedClass)},rebuild:function(){this.$ul.html(""),this.options.multiple="multiple"===this.$select.attr("multiple"),this.buildSelectAll(),this.buildDropdownOptions(),this.buildFilter(),this.updateButtonText(),this.updateSelectAll(),this.options.disableIfEmpty&&$("option",this.$select).length<=0?this.disable():this.enable(),this.options.dropRight&&this.$ul.addClass("pull-right")},dataprovider:function(dataprovider){var groupCounter=0,$select=this.$select.empty();$.each(dataprovider,function(index,option){var $tag;$.isArray(option.children)?(groupCounter++,$tag=$("<optgroup/>").attr({label:option.label||"Group "+groupCounter,disabled:!!option.disabled}),function(array,callback){for(var index=0;index<array.length;++index)callback(array[index],index)}(option.children,function(subOption){$tag.append($("<option/>").attr({value:subOption.value,label:subOption.label||subOption.value,title:subOption.title,selected:!!subOption.selected,disabled:!!subOption.disabled}))})):$tag=$("<option/>").attr({value:option.value,label:option.label||option.value,title:option.title,selected:!!option.selected,disabled:!!option.disabled}),$select.append($tag)}),this.rebuild()},enable:function(){this.$select.prop("disabled",!1),this.$button.prop("disabled",!1).removeClass("disabled")},disable:function(){this.$select.prop("disabled",!0),this.$button.prop("disabled",!0).addClass("disabled")},setOptions:function(options){this.options=this.mergeOptions(options)},mergeOptions:function(options){return $.extend(!0,{},this.defaults,this.options,options)},hasSelectAll:function(){return 0<$("li.multiselect-all",this.$ul).length},updateSelectAll:function(){if(this.hasSelectAll()){var allBoxes=$("li:not(.multiselect-item):not(.filter-hidden) input:enabled",this.$ul),allBoxesLength=allBoxes.length,checkedBoxesLength=allBoxes.filter(":checked").length,selectAllLi=$("li.multiselect-all",this.$ul),selectAllInput=selectAllLi.find("input");0<checkedBoxesLength&&checkedBoxesLength===allBoxesLength?(selectAllInput.prop("checked",!0),selectAllLi.addClass(this.options.selectedClass),this.options.onSelectAll()):(selectAllInput.prop("checked",!1),selectAllLi.removeClass(this.options.selectedClass))}},updateButtonText:function(){var options=this.getSelected();this.options.enableHTML?$(".multiselect .multiselect-selected-text",this.$container).html(this.options.buttonText(options,this.$select)):$(".multiselect .multiselect-selected-text",this.$container).text(this.options.buttonText(options,this.$select)),$(".multiselect",this.$container).attr("title",this.options.buttonTitle(options,this.$select))},getSelected:function(){return $("option",this.$select).filter(":selected")},getOptionByValue:function(value){for(var options=$("option",this.$select),valueToCompare=value.toString(),i=0;i<options.length;i+=1){var option=options[i];if(option.value===valueToCompare)return $(option)}},getInputByValue:function(value){for(var checkboxes=$("li input",this.$ul),valueToCompare=value.toString(),i=0;i<checkboxes.length;i+=1){var checkbox=checkboxes[i];if(checkbox.value===valueToCompare)return $(checkbox)}},updateOriginalOptions:function(){this.originalOptions=this.$select.clone()[0].options},asyncFunction:function(callback,timeout,self){var args=Array.prototype.slice.call(arguments,3);return setTimeout(function(){callback.apply(self||window,args)},timeout)},setAllSelectedText:function(allSelectedText){this.options.allSelectedText=allSelectedText,this.updateButtonText()}},$.fn.multiselect=function(option,parameter,extraOptions){return this.each(function(){var data=$(this).data("multiselect");data||(data=new Multiselect(this,"object"==typeof option&&option),$(this).data("multiselect",data)),"string"==typeof option&&(data[option](parameter,extraOptions),"destroy"===option&&$(this).data("multiselect",!1))})},$.fn.multiselect.Constructor=Multiselect,$(function(){$("select[data-role=multiselect]").multiselect()})}(window.jQuery),function(){var e;(e=jQuery).bootstrapGrowl=function(t,n){var r,i,s;switch(n=e.extend({},e.bootstrapGrowl.default_options,n),(r=e("<div>")).attr("class","bootstrap-growl alert"),n.type&&r.addClass("alert-"+n.type),n.allow_dismiss&&r.append('<a class="close" data-dismiss="alert" href="#">&times;</a>'),r.append(t),n.top_offset&&(n.offset={from:"top",amount:n.top_offset}),s=n.offset.amount,e(".bootstrap-growl").each(function(){return s=Math.max(s,parseInt(e(this).css(n.offset.from))+e(this).outerHeight()+n.stackup_spacing)}),(i={position:"body"===n.ele?"fixed":"absolute",margin:0,"z-index":"9999",display:"none"})[n.offset.from]=s+"px",r.css(i),"auto"!==n.width&&r.css("width",n.width+"px"),e(n.ele).append(r),n.align){case"center":r.css({left:"50%","margin-left":"-"+r.outerWidth()/2+"px"});break;case"left":r.css("left","20px");break;default:r.css("right","20px")}if(r.fadeIn(),0<n.delay)return r.delay(n.delay).fadeOut(function(){return e(this).remove()})},e.bootstrapGrowl.default_options={ele:"body",type:null,offset:{from:"top",amount:20},align:"right",width:250,delay:4e3,allow_dismiss:!0,stackup_spacing:10}}.call(this),function(expose){var Markdown=expose.Markdown=function(dialect){switch(typeof dialect){case"undefined":this.dialect=Markdown.dialects.Gruber;break;case"object":this.dialect=dialect;break;default:if(!(dialect in Markdown.dialects))throw new Error("Unknown Markdown dialect '"+String(dialect)+"'");this.dialect=Markdown.dialects[dialect]}this.em_state=[],this.strong_state=[],this.debug_indent=""};function mk_block_toSource(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function mk_block_inspect(){var util=require("util");return"Markdown.mk_block( "+util.inspect(this.toString())+", "+util.inspect(this.trailing)+", "+util.inspect(this.lineNumber)+" )"}expose.parse=function(source,dialect){return new Markdown(dialect).toTree(source)},expose.toHTML=function(source,dialect,options){var input=expose.toHTMLTree(source,dialect,options);return expose.renderJsonML(input)},expose.toHTMLTree=function(input,dialect,options){"string"==typeof input&&(input=this.parse(input,dialect));var attrs=extract_attr(input),refs={};attrs&&attrs.references&&(refs=attrs.references);var html=function convert_tree_to_html(tree,references,options){var i;options=options||{};var jsonml=tree.slice(0);"function"==typeof options.preprocessTreeNode&&(jsonml=options.preprocessTreeNode(jsonml,references));var attrs=extract_attr(jsonml);if(attrs){for(i in jsonml[1]={},attrs)jsonml[1][i]=attrs[i];attrs=jsonml[1]}if("string"==typeof jsonml)return jsonml;switch(jsonml[0]){case"header":jsonml[0]="h"+jsonml[1].level,delete jsonml[1].level;break;case"bulletlist":jsonml[0]="ul";break;case"numberlist":jsonml[0]="ol";break;case"listitem":jsonml[0]="li";break;case"para":jsonml[0]="p";break;case"markdown":jsonml[0]="html",attrs&&delete attrs.references;break;case"code_block":jsonml[0]="pre",i=attrs?2:1;var code=["code"];code.push.apply(code,jsonml.splice(i,jsonml.length-i)),jsonml[i]=code;break;case"inlinecode":jsonml[0]="code";break;case"img":jsonml[1].src=jsonml[1].href,delete jsonml[1].href;break;case"linebreak":jsonml[0]="br";break;case"link":jsonml[0]="a";break;case"link_ref":jsonml[0]="a";var ref=references[attrs.ref];if(!ref)return attrs.original;delete attrs.ref,attrs.href=ref.href,ref.title&&(attrs.title=ref.title),delete attrs.original;break;case"img_ref":jsonml[0]="img";var ref=references[attrs.ref];if(!ref)return attrs.original;delete attrs.ref,attrs.src=ref.href,ref.title&&(attrs.title=ref.title),delete attrs.original}i=1;if(attrs){for(var key in jsonml[1]){i=2;break}1===i&&jsonml.splice(i,1)}for(;i<jsonml.length;++i)jsonml[i]=convert_tree_to_html(jsonml[i],references,options);return jsonml}(input,refs,options);return function merge_text_nodes(jsonml){var i=extract_attr(jsonml)?2:1;for(;i<jsonml.length;)"string"==typeof jsonml[i]?i+1<jsonml.length&&"string"==typeof jsonml[i+1]?jsonml[i]+=jsonml.splice(i+1,1)[0]:++i:(merge_text_nodes(jsonml[i]),++i)}(html),html};var any_list,bullet_list,is_list_re,indent_re,mk_block=Markdown.mk_block=function(block,trail,line){1==arguments.length&&(trail="\n\n");var s=new String(block);return s.trailing=trail,s.inspect=mk_block_inspect,s.toSource=mk_block_toSource,null!=line&&(s.lineNumber=line),s};function count_lines(str){for(var n=0,i=-1;-1!==(i=str.indexOf("\n",i+1));)n++;return n}function add(li,loose,inline,nl){if(loose)li.push(["para"].concat(inline));else{var add_to=li[li.length-1]instanceof Array&&"para"==li[li.length-1][0]?li[li.length-1]:li;nl&&1<li.length&&inline.unshift(nl);for(var i=0;i<inline.length;i++){var what=inline[i];"string"==typeof what&&1<add_to.length&&"string"==typeof add_to[add_to.length-1]?add_to[add_to.length-1]+=what:add_to.push(what)}}}function get_contained_blocks(depth,blocks){for(var re=new RegExp("^("+indent_re+"{"+depth+"}.*?\\n?)*$"),replace=new RegExp("^"+indent_re+"{"+depth+"}","gm"),ret=[];0<blocks.length&&re.exec(blocks[0]);){var b=blocks.shift(),x=b.replace(replace,"");ret.push(mk_block(x,b.trailing,b.lineNumber))}return ret}function paragraphify(s,i,stack){var list=s.list,last_li=list[list.length-1];if(!(last_li[1]instanceof Array&&"para"==last_li[1][0]))if(i+1==stack.length)last_li.push(["para"].concat(last_li.splice(1,last_li.length-1)));else{var sublist=last_li.pop();last_li.push(["para"].concat(last_li.splice(1,last_li.length-1)),sublist)}}function strong_em(tag,md){var state_slot=tag+"_state",other_slot="strong"==tag?"em_state":"strong_state";function CloseTag(len){this.len_after=len,this.name="close_"+md}return function(text,orig_match){if(this[state_slot][0]==md)return this[state_slot].shift(),[text.length,new CloseTag(text.length-md.length)];var other=this[other_slot].slice(),state=this[state_slot].slice();this[state_slot].unshift(md);var res=this.processInline(text.substr(md.length)),last=res[res.length-1];this[state_slot].shift();return last instanceof CloseTag?(res.pop(),[text.length-last.len_after,[tag].concat(res)]):(this[other_slot]=other,this[state_slot]=state,[md.length,md])}}Markdown.prototype.split_blocks=function(input,startLine){input=input.replace(/(\r\n|\n|\r)/g,"\n");var m,re=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,blocks=[],line_no=1;for(null!=(m=/^(\s*\n)/.exec(input))&&(line_no+=count_lines(m[0]),re.lastIndex=m[0].length);null!==(m=re.exec(input));)"\n#"==m[2]&&(m[2]="\n",re.lastIndex--),blocks.push(mk_block(m[1],m[2],line_no)),line_no+=count_lines(m[0]);return blocks},Markdown.prototype.processBlock=function(block,next){var cbs=this.dialect.block,ord=cbs.__order__;if("__call__"in cbs)return cbs.__call__.call(this,block,next);for(var i=0;i<ord.length;i++){var res=cbs[ord[i]].call(this,block,next);if(res)return(!isArray(res)||0<res.length&&!isArray(res[0]))&&this.debug(ord[i],"didn't return a proper array"),res}return[]},Markdown.prototype.processInline=function(block){return this.dialect.inline.__call__.call(this,String(block))},Markdown.prototype.toTree=function(source,custom_root){var blocks=source instanceof Array?source:this.split_blocks(source),old_tree=this.tree;try{for(this.tree=custom_root||this.tree||["markdown"];blocks.length;){var b=this.processBlock(blocks.shift(),blocks);b.length&&this.tree.push.apply(this.tree,b)}return this.tree}finally{custom_root&&(this.tree=old_tree)}},Markdown.prototype.debug=function(){var args=Array.prototype.slice.call(arguments);args.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,args),"undefined"!=typeof console&&void 0!==console.log&&console.log.apply(null,args)},Markdown.prototype.loop_re_over_block=function(re,block,cb){for(var m,b=block.valueOf();b.length&&null!=(m=re.exec(b));)b=b.substr(m[0].length),cb.call(this,m);return b},Markdown.dialects={},Markdown.dialects.Gruber={block:{atxHeader:function(block,next){var m=block.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(m){var header=["header",{level:m[1].length}];return Array.prototype.push.apply(header,this.processInline(m[2])),m[0].length<block.length&&next.unshift(mk_block(block.substr(m[0].length),block.trailing,block.lineNumber+2)),[header]}},setextHeader:function(block,next){var m=block.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(m){var header=["header",{level:"="===m[2]?1:2},m[1]];return m[0].length<block.length&&next.unshift(mk_block(block.substr(m[0].length),block.trailing,block.lineNumber+2)),[header]}},code:function(block,next){var ret=[],re=/^(?: {0,3}\t| {4})(.*)\n?/;if(block.match(re)){block_search:for(;;){var b=this.loop_re_over_block(re,block.valueOf(),function(m){ret.push(m[1])});if(b.length){next.unshift(mk_block(b,block.trailing));break block_search}if(!next.length)break block_search;if(!next[0].match(re))break block_search;ret.push(block.trailing.replace(/[^\n]/g,"").substring(2)),block=next.shift()}return[["code_block",ret.join("\n")]]}},horizRule:function(block,next){var m=block.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(m){var jsonml=[["hr"]];return m[1]&&jsonml.unshift.apply(jsonml,this.processBlock(m[1],[])),m[3]&&next.unshift(mk_block(m[3])),jsonml}},lists:(any_list="[*+-]|\\d+\\.",bullet_list=/[*+-]/,is_list_re=new RegExp("^( {0,3})("+any_list+")[ \t]+"),indent_re="(?: {0,3}\\t| {4})",function(block,next){var m=block.match(is_list_re);if(m){for(var last_li,i,depth,stack=[],list=make_list(m),loose=!1,ret=[stack[0].list];;){for(var lines=block.split(/(?=\n)/),li_accumulate="",line_no=0;line_no<lines.length;line_no++){var nl="",l=lines[line_no].replace(/^\n/,function(n){return nl=n,""}),line_re=(depth=stack.length,new RegExp("(?:^("+indent_re+"{0,"+depth+"} {0,3})("+any_list+")\\s+)|(^"+indent_re+"{0,"+(depth-1)+"}[ ]{0,4})"));if(void 0!==(m=l.match(line_re))[1]){li_accumulate.length&&(add(last_li,loose,this.processInline(li_accumulate),nl),loose=!1,li_accumulate=""),m[1]=m[1].replace(/ {0,3}\t/g,"    ");var wanted_depth=Math.floor(m[1].length/4)+1;if(wanted_depth>stack.length)list=make_list(m),last_li.push(list),last_li=list[1]=["listitem"];else{var found=!1;for(i=0;i<stack.length;i++)if(stack[i].indent==m[1]){list=stack[i].list,stack.splice(i+1,stack.length-(i+1)),found=!0;break}found||(++wanted_depth<=stack.length?(stack.splice(wanted_depth,stack.length-wanted_depth),list=stack[wanted_depth-1].list):(list=make_list(m),last_li.push(list))),last_li=["listitem"],list.push(last_li)}nl=""}l.length>m[0].length&&(li_accumulate+=nl+l.substr(m[0].length))}li_accumulate.length&&(add(last_li,loose,this.processInline(li_accumulate),nl),loose=!1,li_accumulate="");var contained=get_contained_blocks(stack.length,next);0<contained.length&&(forEach(stack,paragraphify,this),last_li.push.apply(last_li,this.toTree(contained,[])));var next_block=next[0]&&next[0].valueOf()||"";if(!next_block.match(is_list_re)&&!next_block.match(/^ /))break;block=next.shift();var hr=this.dialect.block.horizRule(block,next);if(hr){ret.push.apply(ret,hr);break}forEach(stack,paragraphify,this),loose=!0}return ret}function make_list(m){var list=bullet_list.exec(m[2])?["bulletlist"]:["numberlist"];return stack.push({list:list,indent:m[1]}),list}}),blockquote:function(block,next){if(block.match(/^>/m)){var jsonml=[];if(">"!=block[0]){for(var lines=block.split(/\n/),prev=[],line_no=block.lineNumber;lines.length&&">"!=lines[0][0];)prev.push(lines.shift()),line_no++;var abutting=mk_block(prev.join("\n"),"\n",block.lineNumber);jsonml.push.apply(jsonml,this.processBlock(abutting,[])),block=mk_block(lines.join("\n"),block.trailing,line_no)}for(;next.length&&">"==next[0][0];){var b=next.shift();block=mk_block(block+block.trailing+b,b.trailing,block.lineNumber)}var input=block.replace(/^> ?/gm,""),processedBlock=(this.tree,this.toTree(input,["blockquote"])),attr=extract_attr(processedBlock);return attr&&attr.references&&(delete attr.references,isEmpty(attr)&&processedBlock.splice(1,1)),jsonml.push(processedBlock),jsonml}},referenceDefn:function(block,next){var re=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(block.match(re)){extract_attr(this.tree)||this.tree.splice(1,0,{});var attrs=extract_attr(this.tree);void 0===attrs.references&&(attrs.references={});var b=this.loop_re_over_block(re,block,function(m){m[2]&&"<"==m[2][0]&&">"==m[2][m[2].length-1]&&(m[2]=m[2].substring(1,m[2].length-1));var ref=attrs.references[m[1].toLowerCase()]={href:m[2]};void 0!==m[4]?ref.title=m[4]:void 0!==m[5]&&(ref.title=m[5])});return b.length&&next.unshift(mk_block(b,block.trailing)),[]}},para:function(block,next){return[["para"].concat(this.processInline(block))]}}},Markdown.dialects.Gruber.inline={__oneElement__:function(text,patterns_or_re,previous_nodes){var m,res;return patterns_or_re=patterns_or_re||this.dialect.inline.__patterns__,(m=new RegExp("([\\s\\S]*?)("+(patterns_or_re.source||patterns_or_re)+")").exec(text))?m[1]?[m[1].length,m[1]]:(m[2]in this.dialect.inline&&(res=this.dialect.inline[m[2]].call(this,text.substr(m.index),m,previous_nodes||[])),res=res||[m[2].length,m[2]]):[text.length,text]},__call__:function(text,patterns){var res,out=[];function add(x){"string"==typeof x&&"string"==typeof out[out.length-1]?out[out.length-1]+=x:out.push(x)}for(;0<text.length;)res=this.dialect.inline.__oneElement__.call(this,text,patterns,out),text=text.substr(res.shift()),forEach(res,add);return out},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function(text){return this.dialect.inline.__escape__.exec(text)?[2,text.charAt(1)]:[1,"\\"]},"![":function(text){var m=text.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(m){m[2]&&"<"==m[2][0]&&">"==m[2][m[2].length-1]&&(m[2]=m[2].substring(1,m[2].length-1)),m[2]=this.dialect.inline.__call__.call(this,m[2],/\\/)[0];var attrs={alt:m[1],href:m[2]||""};return void 0!==m[4]&&(attrs.title=m[4]),[m[0].length,["img",attrs]]}return(m=text.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/))?[m[0].length,["img_ref",{alt:m[1],ref:m[2].toLowerCase(),original:m[0]}]]:[2,"!["]},"[":function(text){var orig=String(text),res=Markdown.DialectHelpers.inline_until_char.call(this,text.substr(1),"]");if(!res)return[1,"["];var link,attrs,consumed=1+res[0],children=res[1],m=(text=text.substr(consumed)).match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(m){var url=m[1];if(consumed+=m[0].length,url&&"<"==url[0]&&">"==url[url.length-1]&&(url=url.substring(1,url.length-1)),!m[3])for(var open_parens=1,len=0;len<url.length;len++)switch(url[len]){case"(":open_parens++;break;case")":0==--open_parens&&(consumed-=url.length-len,url=url.substring(0,len))}return attrs={href:(url=this.dialect.inline.__call__.call(this,url,/\\/)[0])||""},void 0!==m[3]&&(attrs.title=m[3]),link=["link",attrs].concat(children),[consumed,link]}return(m=text.match(/^\s*\[(.*?)\]/))?(consumed+=m[0].length,link=["link_ref",attrs={ref:(m[1]||String(children)).toLowerCase(),original:orig.substr(0,consumed)}].concat(children),[consumed,link]):1==children.length&&"string"==typeof children[0]?(link=["link_ref",attrs={ref:children[0].toLowerCase(),original:orig.substr(0,consumed)},children[0]],[consumed,link]):[1,"["]},"<":function(text){var m;return null!=(m=text.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?m[3]?[m[0].length,["link",{href:"mailto:"+m[3]},m[3]]]:"mailto"==m[2]?[m[0].length,["link",{href:m[1]},m[1].substr("mailto:".length)]]:[m[0].length,["link",{href:m[1]},m[1]]]:[1,"<"]},"`":function(text){var m=text.match(/(`+)(([\s\S]*?)\1)/);return m&&m[2]?[m[1].length+m[2].length,["inlinecode",m[3]]]:[1,"`"]},"  \n":function(text){return[3,["linebreak"]]}},Markdown.dialects.Gruber.inline["**"]=strong_em("strong","**"),Markdown.dialects.Gruber.inline.__=strong_em("strong","__"),Markdown.dialects.Gruber.inline["*"]=strong_em("em","*"),Markdown.dialects.Gruber.inline._=strong_em("em","_"),Markdown.buildBlockOrder=function(d){var ord=[];for(var i in d)"__order__"!=i&&"__call__"!=i&&ord.push(i);d.__order__=ord},Markdown.buildInlinePatterns=function(d){var patterns=[];for(var i in d)if(!i.match(/^__.*__$/)){var l=i.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");patterns.push(1==i.length?l:"(?:"+l+")")}patterns=patterns.join("|"),d.__patterns__=patterns;var fn=d.__call__;d.__call__=function(text,pattern){return null!=pattern?fn.call(this,text,pattern):fn.call(this,text,patterns)}},Markdown.DialectHelpers={},Markdown.DialectHelpers.inline_until_char=function(text,want){for(var consumed=0,nodes=[];;){if(text.charAt(consumed)==want)return[++consumed,nodes];if(consumed>=text.length)return null;var res=this.dialect.inline.__oneElement__.call(this,text.substr(consumed));consumed+=res[0],nodes.push.apply(nodes,res.slice(1))}},Markdown.subclassDialect=function(d){function Block(){}function Inline(){}return Block.prototype=d.block,Inline.prototype=d.inline,{block:new Block,inline:new Inline}},Markdown.buildBlockOrder(Markdown.dialects.Gruber.block),Markdown.buildInlinePatterns(Markdown.dialects.Gruber.inline),Markdown.dialects.Maruku=Markdown.subclassDialect(Markdown.dialects.Gruber),Markdown.dialects.Maruku.processMetaHash=function(meta_string){for(var meta=function(meta_string){var meta=meta_string.split(""),parts=[""],in_quotes=!1;for(;meta.length;){var letter=meta.shift();switch(letter){case" ":in_quotes?parts[parts.length-1]+=letter:parts.push("");break;case"'":case'"':in_quotes=!in_quotes;break;case"\\":letter=meta.shift();default:parts[parts.length-1]+=letter}}return parts}(meta_string),attr={},i=0;i<meta.length;++i)if(/^#/.test(meta[i]))attr.id=meta[i].substring(1);else if(/^\./.test(meta[i]))attr.class?attr.class=attr.class+meta[i].replace(/./," "):attr.class=meta[i].substring(1);else if(/\=/.test(meta[i])){var s=meta[i].split(/\=/);attr[s[0]]=s[1]}return attr},Markdown.dialects.Maruku.block.document_meta=function(block,next){if(!(1<block.lineNumber)&&block.match(/^(?:\w+:.*\n)*\w+:.*$/)){extract_attr(this.tree)||this.tree.splice(1,0,{});var pairs=block.split(/\n/);for(p in pairs){var m=pairs[p].match(/(\w+):\s*(.*)$/),key=m[1].toLowerCase(),value=m[2];this.tree[1][key]=value}return[]}},Markdown.dialects.Maruku.block.block_meta=function(block,next){var m=block.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(m){var hash,attr=this.dialect.processMetaHash(m[2]);if(""===m[1]){var node=this.tree[this.tree.length-1];if(hash=extract_attr(node),"string"==typeof node)return;for(a in hash||(hash={},node.splice(1,0,hash)),attr)hash[a]=attr[a];return[]}var b=block.replace(/\n.*$/,""),result=this.processBlock(b,[]);for(a in(hash=extract_attr(result[0]))||(hash={},result[0].splice(1,0,hash)),attr)hash[a]=attr[a];return result}},Markdown.dialects.Maruku.block.definition_list=function(block,next){var i,tight=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,list=["dl"];if(m=block.match(tight)){for(var blocks=[block];next.length&&tight.exec(next[0]);)blocks.push(next.shift());for(var b=0;b<blocks.length;++b){var m,terms=(m=blocks[b].match(tight))[1].replace(/\n$/,"").split(/\n/),defns=m[2].split(/\n:\s+/);for(i=0;i<terms.length;++i)list.push(["dt",terms[i]]);for(i=0;i<defns.length;++i)list.push(["dd"].concat(this.processInline(defns[i].replace(/(\n)\s+/,"$1"))))}return[list]}},Markdown.dialects.Maruku.block.table=function(block,next){function _split_on_unescaped(s,ch){(ch=ch||"\\s").match(/^[\\|\[\]{}?*.+^$]$/)&&(ch="\\"+ch);for(var m,res=[],r=new RegExp("^((?:\\\\.|[^\\\\"+ch+"])*)"+ch+"(.*)");m=s.match(r);)res.push(m[1]),s=m[2];return res.push(s),res}var i,m;if(m=block.match(/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/))m[3]=m[3].replace(/^\s*\|/gm,"");else if(!(m=block.match(/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/)))return;var table=["table",["thead",["tr"]],["tbody"]];m[2]=m[2].replace(/\|\s*$/,"").split("|");var html_attrs=[];for(forEach(m[2],function(s){s.match(/^\s*-+:\s*$/)?html_attrs.push({align:"right"}):s.match(/^\s*:-+\s*$/)?html_attrs.push({align:"left"}):s.match(/^\s*:-+:\s*$/)?html_attrs.push({align:"center"}):html_attrs.push({})}),m[1]=_split_on_unescaped(m[1].replace(/\|\s*$/,""),"|"),i=0;i<m[1].length;i++)table[1][1].push(["th",html_attrs[i]||{}].concat(this.processInline(m[1][i].trim())));return forEach(m[3].replace(/\|\s*$/gm,"").split("\n"),function(row){var html_row=["tr"];for(row=_split_on_unescaped(row,"|"),i=0;i<row.length;i++)html_row.push(["td",html_attrs[i]||{}].concat(this.processInline(row[i].trim())));table[2].push(html_row)},this),[table]},Markdown.dialects.Maruku.inline["{:"]=function(text,matches,out){if(!out.length)return[2,"{:"];var before=out[out.length-1];if("string"==typeof before)return[2,"{:"];var m=text.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!m)return[2,"{:"];var meta=this.dialect.processMetaHash(m[1]),attr=extract_attr(before);for(var k in attr||(attr={},before.splice(1,0,attr)),meta)attr[k]=meta[k];return[m[0].length,""]},Markdown.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,Markdown.buildBlockOrder(Markdown.dialects.Maruku.block),Markdown.buildInlinePatterns(Markdown.dialects.Maruku.inline);var forEach,isArray=Array.isArray||function(obj){return"[object Array]"==Object.prototype.toString.call(obj)};forEach=Array.prototype.forEach?function(arr,cb,thisp){return arr.forEach(cb,thisp)}:function(arr,cb,thisp){for(var i=0;i<arr.length;i++)cb.call(thisp||arr,arr[i],i,arr)};var isEmpty=function(obj){for(var key in obj)if(hasOwnProperty.call(obj,key))return!1;return!0};function extract_attr(jsonml){return isArray(jsonml)&&1<jsonml.length&&"object"==typeof jsonml[1]&&!isArray(jsonml[1])?jsonml[1]:void 0}function escapeHTML(text){return text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function render_tree(jsonml){if("string"==typeof jsonml)return escapeHTML(jsonml);var tag=jsonml.shift(),attributes={},content=[];for(!jsonml.length||"object"!=typeof jsonml[0]||jsonml[0]instanceof Array||(attributes=jsonml.shift());jsonml.length;)content.push(render_tree(jsonml.shift()));var tag_attrs="";for(var a in attributes)tag_attrs+=" "+a+'="'+escapeHTML(attributes[a])+'"';return"img"==tag||"br"==tag||"hr"==tag?"<"+tag+tag_attrs+"/>":"<"+tag+tag_attrs+">"+content.join("")+"</"+tag+">"}expose.renderJsonML=function(jsonml,options){(options=options||{}).root=options.root||!1;var content=[];if(options.root)content.push(render_tree(jsonml));else for(jsonml.shift(),!jsonml.length||"object"!=typeof jsonml[0]||jsonml[0]instanceof Array||jsonml.shift();jsonml.length;)content.push(render_tree(jsonml.shift()));return content.join("\n\n")}}("undefined"==typeof exports?(window.markdown={},window.markdown):exports),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){"use strict";var t,i;e.fn.fileinputLocales={},e.fn.fileinputThemes={},String.prototype.setTokens=function(e){var t,i,a=this.toString();for(t in e)e.hasOwnProperty(t)&&(i=new RegExp("{"+t+"}","g"),a=a.replace(i,e[t]));return a},t={FRAMES:".kv-preview-thumb",SORT_CSS:"file-sortable",OBJECT_PARAMS:'<param name="controller" value="true" />\n<param name="allowFullScreen" value="true" />\n<param name="allowScriptAccess" value="always" />\n<param name="autoPlay" value="false" />\n<param name="autoStart" value="false" />\n<param name="quality" value="high" />\n',DEFAULT_PREVIEW:'<div class="file-preview-other">\n<span class="{previewFileIconClass}">{previewFileIcon}</span>\n</div>',MODAL_ID:"kvFileinputModal",MODAL_EVENTS:["show","shown","hide","hidden","loaded"],objUrl:window.URL||window.webkitURL,compare:function(e,t,i){return void 0!==e&&(i?e===t:e.match(t))},isIE:function(e){if("Microsoft Internet Explorer"!==navigator.appName)return!1;if(10===e)return new RegExp("msie\\s"+e,"i").test(navigator.userAgent);var t,i=document.createElement("div");return i.innerHTML="\x3c!--[if IE "+e+"]> <i></i> <![endif]--\x3e",t=i.getElementsByTagName("i").length,document.body.appendChild(i),i.parentNode.removeChild(i),t},canAssignFilesToInput:function(){var e=document.createElement("input");try{return e.type="file",!(e.files=null)}catch(e){return!1}},getDragDropFolders:function(e){var t,i,a=e.length,r=0;if(0<a&&e[0].webkitGetAsEntry())for(t=0;t<a;t++)(i=e[t].webkitGetAsEntry())&&i.isDirectory&&r++;return r},initModal:function(t){var i=e("body");i.length&&t.appendTo(i)},isEmpty:function(t,i){return null==t||0===t.length||i&&""===e.trim(t)},isArray:function(e){return Array.isArray(e)||"[object Array]"===Object.prototype.toString.call(e)},ifSet:function(e,t,i){return i=i||"",t&&"object"==typeof t&&e in t?t[e]:i},cleanArray:function(e){return e instanceof Array||(e=[]),e.filter(function(e){return null!=e})},spliceArray:function(t,i,a){var r,n,s=0,o=[];if(!(t instanceof Array))return[];for(n=e.extend(!0,[],t),a&&n.reverse(),r=0;r<n.length;r++)r!==i&&(o[s]=n[r],s++);return a&&o.reverse(),o},getNum:function(e,t){return t=t||0,"number"==typeof e?e:("string"==typeof e&&(e=parseFloat(e)),isNaN(e)?t:e)},hasFileAPISupport:function(){return!(!window.File||!window.FileReader)},hasDragDropSupport:function(){var e=document.createElement("div");return!t.isIE(9)&&(void 0!==e.draggable||void 0!==e.ondragstart&&void 0!==e.ondrop)},hasFileUploadSupport:function(){return t.hasFileAPISupport()&&window.FormData},hasBlobSupport:function(){try{return!!window.Blob&&Boolean(new Blob)}catch(e){return!1}},hasArrayBufferViewSupport:function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}},dataURI2Blob:function(e){var i,a,r,n,s,o,l=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,d=t.hasBlobSupport();if(!((d||l)&&window.atob&&window.ArrayBuffer&&window.Uint8Array))return null;for(i=0<=e.split(",")[0].indexOf("base64")?atob(e.split(",")[1]):decodeURIComponent(e.split(",")[1]),a=new ArrayBuffer(i.length),r=new Uint8Array(a),n=0;n<i.length;n+=1)r[n]=i.charCodeAt(n);return s=e.split(",")[0].split(":")[1].split(";")[0],d?new Blob([t.hasArrayBufferViewSupport()?r:a],{type:s}):((o=new l).append(a),o.getBlob(s))},arrayBuffer2String:function(e){if(window.TextDecoder)return new TextDecoder("utf-8").decode(e);var t,i,a,r,n=Array.prototype.slice.apply(new Uint8Array(e)),s="",o=0;for(t=n.length;o<t;)switch((i=n[o++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:s+=String.fromCharCode(i);break;case 12:case 13:a=n[o++],s+=String.fromCharCode((31&i)<<6|63&a);break;case 14:a=n[o++],r=n[o++],s+=String.fromCharCode((15&i)<<12|(63&a)<<6|(63&r)<<0)}return s},isHtml:function(e){var t=document.createElement("div");t.innerHTML=e;for(var i=t.childNodes,a=i.length;a--;)if(1===i[a].nodeType)return!0;return!1},isSvg:function(e){return e.match(/^\s*<\?xml/i)&&(e.match(/<!DOCTYPE svg/i)||e.match(/<svg/i))},getMimeType:function(e,t,i){switch(e){case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":return"image/jpeg";case"89504E47":return"image/png";case"47494638":return"image/gif";case"49492a00":return"image/tiff";case"52494646":return"image/webp";case"66747970":return"video/3gp";case"4f676753":return"video/ogg";case"1a45dfa3":return"video/mkv";case"000001ba":case"000001b3":return"video/mpeg";case"3026b275":return"video/wmv";case"25504446":return"application/pdf";case"25215053":return"application/ps";case"504b0304":case"504b0506":case"504b0508":return"application/zip";case"377abcaf":return"application/7z";case"75737461":return"application/tar";case"7801730d":return"application/dmg";default:switch(e.substring(0,6)){case"435753":return"application/x-shockwave-flash";case"494433":return"audio/mp3";case"425a68":return"application/bzip";default:switch(e.substring(0,4)){case"424d":return"image/bmp";case"fffb":return"audio/mp3";case"4d5a":return"application/exe";case"1f9d":case"1fa0":return"application/zip";case"1f8b":return"application/gzip";default:return t&&!t.match(/[^\u0000-\u007f]/)?"application/text-plain":i}}}},addCss:function(e,t){e.removeClass(t).addClass(t)},getElement:function(i,a,r){return t.isEmpty(i)||t.isEmpty(i[a])?r:e(i[a])},uniqId:function(){return Math.round((new Date).getTime())+"_"+Math.round(100*Math.random())},htmlEncode:function(e,t){return void 0===e?t||null:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},replaceTags:function(t,i){var a=t;return i&&e.each(i,function(e,t){"function"==typeof t&&(t=t()),a=a.split(e).join(t)}),a},cleanMemory:function(e){var i=e.is("img")?e.attr("src"):e.find("source").attr("src");t.objUrl.revokeObjectURL(i)},findFileName:function(e){var t=e.lastIndexOf("/");return-1===t&&(t=e.lastIndexOf("\\")),e.split(e.substring(t,t+1)).pop()},checkFullScreen:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},toggleFullScreen:function(e){var i=document,a=i.documentElement;a&&e&&!t.checkFullScreen()?a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):i.exitFullscreen?i.exitFullscreen():i.msExitFullscreen?i.msExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.webkitExitFullscreen&&i.webkitExitFullscreen()},moveArray:function(t,i,a,r){var n=e.extend(!0,[],t);if(r&&n.reverse(),a>=n.length)for(var s=a-n.length;1+s--;)n.push(void 0);return n.splice(a,0,n.splice(i,1)[0]),r&&n.reverse(),n},cleanZoomCache:function(e){var t=e.closest(".kv-zoom-cache-theme");t.length||(t=e.closest(".kv-zoom-cache")),t.remove()},closeButton:function(e){return'<button type="button" class="'+(e=e?"close "+e:"close")+'" aria-label="Close">\n  <span aria-hidden="true">&times;</span>\n</button>'},getRotation:function(e){switch(e){case 2:return"rotateY(180deg)";case 3:return"rotate(180deg)";case 4:return"rotate(180deg) rotateY(180deg)";case 5:return"rotate(270deg) rotateY(180deg)";case 6:return"rotate(90deg)";case 7:return"rotate(90deg) rotateY(180deg)";case 8:return"rotate(270deg)";default:return""}},setTransform:function(e,t){e&&(e.style.transform=t,e.style.webkitTransform=t,e.style["-moz-transform"]=t,e.style["-ms-transform"]=t,e.style["-o-transform"]=t)},setImageOrientation:function(e,i,a){if(e&&e.length){var r="load.fileinputimageorient";e.off(r).on(r,function(){var r=e.get(0),n=i&&i.length?i.get(0):null,s=r.offsetHeight,o=r.offsetWidth,l=t.getRotation(a);if(e.data("orientation",a),n&&i.data("orientation",a),a<5)return t.setTransform(r,l),void t.setTransform(n,l);var d=Math.atan(o/s),c=Math.sqrt(Math.pow(s,2)+Math.pow(o,2)),h=c?s/Math.cos(Math.PI/2+d)/c:1,p=" scale("+Math.abs(h)+")";t.setTransform(r,l+p),t.setTransform(n,l+p)})}}},(i=function(i,a){this.$element=e(i),this.$parent=this.$element.parent(),this._validate()&&(this.isPreviewable=t.hasFileAPISupport(),this.isIE9=t.isIE(9),this.isIE10=t.isIE(10),(this.isPreviewable||this.isIE9)&&(this._init(a),this._listen()),this.$element.removeClass("file-loading"))}).prototype={constructor:i,_cleanup:function(){this.reader=null,this.formdata={},this.uploadCount=0,this.uploadStatus={},this.uploadLog=[],this.uploadAsyncCount=0,this.loadedImages=[],this.totalImagesCount=0,this.ajaxRequests=[],this.clearStack(),this.fileBatchCompleted=!0,this.isPreviewable||(this.showPreview=!1),this.isError=!1,this.ajaxAborted=!1,this.cancelling=!1},_init:function(i,a){var r,n,s,o,l=this,d=l.$element;l.options=i,e.each(i,function(e,i){switch(e){case"minFileCount":case"maxFileCount":case"minFileSize":case"maxFileSize":case"maxFilePreviewSize":case"resizeImageQuality":case"resizeIfSizeMoreThan":case"progressUploadThreshold":case"initialPreviewCount":case"zoomModalHeight":case"minImageHeight":case"maxImageHeight":case"minImageWidth":case"maxImageWidth":l[e]=t.getNum(i);break;default:l[e]=i}}),l.rtl&&(o=l.previewZoomButtonIcons.prev,l.previewZoomButtonIcons.prev=l.previewZoomButtonIcons.next,l.previewZoomButtonIcons.next=o),a||l._cleanup(),l.$form=d.closest("form"),l._initTemplateDefaults(),l.uploadFileAttr=t.isEmpty(d.attr("name"))?"file_data":d.attr("name"),s=l._getLayoutTemplate("progress"),l.progressTemplate=s.replace("{class}",l.progressClass),l.progressCompleteTemplate=s.replace("{class}",l.progressCompleteClass),l.progressErrorTemplate=s.replace("{class}",l.progressErrorClass),l.isDisabled=d.attr("disabled")||d.attr("readonly"),l.isDisabled&&d.attr("disabled",!0),l.isClickable=l.browseOnZoneClick&&l.showPreview&&(l.dropZoneEnabled||!t.isEmpty(l.defaultPreviewContent)),l.isAjaxUpload=t.hasFileUploadSupport()&&!t.isEmpty(l.uploadUrl),l.dropZoneEnabled=t.hasDragDropSupport()&&l.dropZoneEnabled,l.isAjaxUpload||(l.dropZoneEnabled=l.dropZoneEnabled&&t.canAssignFilesToInput()),l.slug="function"==typeof i.slugCallback?i.slugCallback:l._slugDefault,l.mainTemplate=l.showCaption?l._getLayoutTemplate("main1"):l._getLayoutTemplate("main2"),l.captionTemplate=l._getLayoutTemplate("caption"),l.previewGenericTemplate=l._getPreviewTemplate("generic"),!l.imageCanvas&&l.resizeImage&&(l.maxImageWidth||l.maxImageHeight)&&(l.imageCanvas=document.createElement("canvas"),l.imageCanvasContext=l.imageCanvas.getContext("2d")),t.isEmpty(d.attr("id"))&&d.attr("id",t.uniqId()),l.namespace=".fileinput_"+d.attr("id").replace(/-/g,"_"),void 0===l.$container?l.$container=l._createContainer():l._refreshContainer(),n=l.$container,l.$dropZone=n.find(".file-drop-zone"),l.$progress=n.find(".kv-upload-progress"),l.$btnUpload=n.find(".fileinput-upload"),l.$captionContainer=t.getElement(i,"elCaptionContainer",n.find(".file-caption")),l.$caption=t.getElement(i,"elCaptionText",n.find(".file-caption-name")),t.isEmpty(l.msgPlaceholder)||(r=d.attr("multiple")?l.filePlural:l.fileSingle,l.$caption.attr("placeholder",l.msgPlaceholder.replace("{files}",r))),l.$captionIcon=l.$captionContainer.find(".file-caption-icon"),l.$previewContainer=t.getElement(i,"elPreviewContainer",n.find(".file-preview")),l.$preview=t.getElement(i,"elPreviewImage",n.find(".file-preview-thumbnails")),l.$previewStatus=t.getElement(i,"elPreviewStatus",n.find(".file-preview-status")),l.$errorContainer=t.getElement(i,"elErrorContainer",l.$previewContainer.find(".kv-fileinput-error")),l._validateDisabled(),t.isEmpty(l.msgErrorClass)||t.addCss(l.$errorContainer,l.msgErrorClass),a?l._errorsExist()||l.$errorContainer.hide():(l.$errorContainer.hide(),l.previewInitId="preview-"+t.uniqId(),l._initPreviewCache(),l._initPreview(!0),l._initPreviewActions(),l.$parent.hasClass("file-loading")&&(l.$container.insertBefore(l.$parent),l.$parent.remove())),l._setFileDropZoneTitle(),d.attr("disabled")&&l.disable(),l._initZoom(),l.hideThumbnailContent&&t.addCss(l.$preview,"hide-content")},_initTemplateDefaults:function(){var i,a,n,s,o,l,d,c,h=this;i=t.closeButton("fileinput-remove"),a='<div id="'+t.MODAL_ID+'" class="file-zoom-dialog modal fade" tabindex="-1" aria-labelledby="'+t.MODAL_ID+'Label"></div>',n='<video class="kv-preview-data file-preview-video" controls {style}>\n<source src="{data}" type="{type}">\n'+t.DEFAULT_PREVIEW+"\n</video>\n",s='\x3c!--suppress ALL --\x3e<audio class="kv-preview-data file-preview-audio" controls {style}>\n<source src="{data}" type="{type}">\n'+t.DEFAULT_PREVIEW+"\n</audio>\n",l='<embed class="kv-preview-data file-preview-pdf" src="{data}" type="application/pdf" {style}>\n',o='<object class="kv-preview-data file-preview-object file-object {typeCss}" data="{data}" type="{type}" {style}>\n<param name="movie" value="{caption}" />\n'+t.OBJECT_PARAMS+" "+t.DEFAULT_PREVIEW+"\n</object>\n",d='<div class="kv-preview-data file-preview-other-frame" {style}>\n'+t.DEFAULT_PREVIEW+"\n</div>\n",c={width:"100%",height:"100%","min-height":"480px"},h._isPdfRendered()&&(l=h.pdfRendererTemplate.replace("{renderer}",h.pdfRendererUrl)),h.defaults={layoutTemplates:{main1:'{preview}\n<div class="kv-upload-progress kv-hidden"></div><div class="clearfix"></div>\n<div class="input-group {class}">\n  {caption}\n<div class="input-group-btn input-group-append">\n      {remove}\n      {cancel}\n      {upload}\n      {browse}\n    </div>\n</div>',main2:'{preview}\n<div class="kv-upload-progress kv-hidden"></div>\n<div class="clearfix"></div>\n{remove}\n{cancel}\n{upload}\n{browse}\n',preview:'<div class="file-preview {class}">\n    {close}    <div class="{dropClass}">\n    <div class="file-preview-thumbnails">\n    </div>\n    <div class="clearfix"></div>    <div class="file-preview-status text-center text-success"></div>\n    <div class="kv-fileinput-error"></div>\n    </div>\n</div>',close:i,fileIcon:'<i class="glyphicon glyphicon-file"></i>',caption:'<div class="file-caption form-control {class}" tabindex="500">\n  <span class="file-caption-icon"></span>\n  <input class="file-caption-name" onkeydown="return false;" onpaste="return false;">\n</div>',modalMain:a,modal:'<div class="modal-dialog modal-lg{rtl}" role="document">\n  <div class="modal-content">\n    <div class="modal-header">\n      <h5 class="modal-title">{heading}</h5>\n      <span class="kv-zoom-title"></span>\n      <div class="kv-zoom-actions">{toggleheader}{fullscreen}{borderless}{close}</div>\n    </div>\n    <div class="modal-body">\n      <div class="floating-buttons"></div>\n      <div class="kv-zoom-body file-zoom-content {zoomFrameClass}"></div>\n{prev} {next}\n    </div>\n  </div>\n</div>\n',progress:'<div class="progress">\n    <div class="{class}" role="progressbar" aria-valuenow="{percent}" aria-valuemin="0" aria-valuemax="100" style="width:{percent}%;">\n        {status}\n     </div>\n</div>',size:" <samp>({sizeText})</samp>",footer:'<div class="file-thumbnail-footer">\n    <div class="file-footer-caption" title="{caption}">\n        <div class="file-caption-info">{caption}</div>\n        <div class="file-size-info">{size}</div>\n    </div>\n    {progress}\n{indicator}\n{actions}\n</div>',indicator:'<div class="file-upload-indicator" title="{indicatorTitle}">{indicator}</div>',actions:'<div class="file-actions">\n    <div class="file-footer-buttons">\n        {download} {upload} {delete} {zoom} {other}    </div>\n</div>\n{drag}\n<div class="clearfix"></div>',actionDelete:'<button type="button" class="kv-file-remove {removeClass}" title="{removeTitle}" {dataUrl}{dataKey}>{removeIcon}</button>\n',actionUpload:'<button type="button" class="kv-file-upload {uploadClass}" title="{uploadTitle}">{uploadIcon}</button>',actionDownload:'<a class="kv-file-download {downloadClass}" title="{downloadTitle}" href="{downloadUrl}" download="{caption}" target="_blank">{downloadIcon}</a>',actionZoom:'<button type="button" class="kv-file-zoom {zoomClass}" title="{zoomTitle}">{zoomIcon}</button>',actionDrag:'<span class="file-drag-handle {dragClass}" title="{dragTitle}">{dragIcon}</span>',btnDefault:'<button type="{type}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</button>',btnLink:'<a href="{href}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</a>',btnBrowse:'<div tabindex="500" class="{css}" {status}>{icon} {label}</div>',zoomCache:'<div class="kv-zoom-cache" style="display:none">{zoomContent}</div>'},previewMarkupTags:{tagBefore1:'<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}"><div class="kv-file-content">\n',tagBefore2:'<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}" title="{caption}"><div class="kv-file-content">\n',tagAfter:"</div>{footer}\n</div>\n"},previewContentTemplates:{generic:"{content}\n",html:'<div class="kv-preview-data file-preview-html" title="{caption}" {style}>{data}</div>\n',image:'<img src="{data}" class="file-preview-image kv-preview-data" title="{caption}" alt="{caption}" {style}>\n',text:'<textarea class="kv-preview-data file-preview-text" title="{caption}" readonly {style}>{data}</textarea>\n',office:'<iframe class="kv-preview-data file-preview-office" src="https://view.officeapps.live.com/op/embed.aspx?src={data}" {style}></iframe>',gdocs:'<iframe class="kv-preview-data file-preview-gdocs" src="https://docs.google.com/gview?url={data}&embedded=true" {style}></iframe>',video:n,audio:s,flash:'<embed class="kv-preview-data file-preview-flash" src="{data}" type="application/x-shockwave-flash" {style}>\n',object:o,pdf:l,other:d},allowedPreviewTypes:["image","html","text","video","audio","flash","pdf","object"],previewTemplates:{},previewSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:{width:"213px",height:"160px"},text:{width:"213px",height:"160px"},office:{width:"213px",height:"160px"},gdocs:{width:"213px",height:"160px"},video:{width:"213px",height:"160px"},audio:{width:"100%",height:"30px"},flash:{width:"213px",height:"160px"},object:{width:"213px",height:"160px"},pdf:{width:"100%",height:"160px"},other:{width:"213px",height:"160px"}},previewSettingsSmall:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:{width:"100%",height:"160px"},text:{width:"100%",height:"160px"},office:{width:"100%",height:"160px"},gdocs:{width:"100%",height:"160px"},video:{width:"100%",height:"auto"},audio:{width:"100%",height:"30px"},flash:{width:"100%",height:"auto"},object:{width:"100%",height:"auto"},pdf:{width:"100%",height:"160px"},other:{width:"100%",height:"160px"}},previewZoomSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:c,text:c,office:{width:"100%",height:"100%","max-width":"100%","min-height":"480px"},gdocs:{width:"100%",height:"100%","max-width":"100%","min-height":"480px"},video:{width:"auto",height:"100%","max-width":"100%"},audio:{width:"100%",height:"30px"},flash:{width:"auto",height:"480px"},object:{width:"auto",height:"100%","max-width":"100%","min-height":"480px"},pdf:c,other:{width:"auto",height:"100%","min-height":"480px"}},fileTypeSettings:{image:function(e,i){return t.compare(e,"image.*")&&!t.compare(e,/(tiff?|wmf)$/i)||t.compare(i,/\.(gif|png|jpe?g)$/i)},html:function(e,i){return t.compare(e,"text/html")||t.compare(i,/\.(htm|html)$/i)},office:function(e,i){return t.compare(e,/(word|excel|powerpoint|office)$/i)||t.compare(i,/\.(docx?|xlsx?|pptx?|pps|potx?)$/i)},gdocs:function(e,i){return t.compare(e,/(word|excel|powerpoint|office|iwork-pages|tiff?)$/i)||t.compare(i,/\.(docx?|xlsx?|pptx?|pps|potx?|rtf|ods|odt|pages|ai|dxf|ttf|tiff?|wmf|e?ps)$/i)},text:function(e,i){return t.compare(e,"text.*")||t.compare(i,/\.(xml|javascript)$/i)||t.compare(i,/\.(txt|md|csv|nfo|ini|json|php|js|css)$/i)},video:function(e,i){return t.compare(e,"video.*")&&(t.compare(e,/(ogg|mp4|mp?g|mov|webm|3gp)$/i)||t.compare(i,/\.(og?|mp4|webm|mp?g|mov|3gp)$/i))},audio:function(e,i){return t.compare(e,"audio.*")&&(t.compare(i,/(ogg|mp3|mp?g|wav)$/i)||t.compare(i,/\.(og?|mp3|mp?g|wav)$/i))},flash:function(e,i){return t.compare(e,"application/x-shockwave-flash",!0)||t.compare(i,/\.(swf)$/i)},pdf:function(e,i){return t.compare(e,"application/pdf",!0)||t.compare(i,/\.(pdf)$/i)},object:function(){return!0},other:function(){return!0}},fileActionSettings:{showRemove:!0,showUpload:!0,showDownload:!0,showZoom:!0,showDrag:!0,removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",removeErrorClass:"btn btn-sm btn-kv btn-danger",removeTitle:"Remove file",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",uploadTitle:"Upload file",uploadRetryIcon:'<i class="glyphicon glyphicon-repeat"></i>',uploadRetryTitle:"Retry upload",downloadIcon:'<i class="glyphicon glyphicon-download"></i>',downloadClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",downloadTitle:"Download file",zoomIcon:'<i class="glyphicon glyphicon-zoom-in"></i>',zoomClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",zoomTitle:"View Details",dragIcon:'<i class="glyphicon glyphicon-move"></i>',dragClass:"text-info",dragTitle:"Move / Rearrange",dragSettings:{},indicatorNew:'<i class="glyphicon glyphicon-plus-sign text-warning"></i>',indicatorSuccess:'<i class="glyphicon glyphicon-ok-sign text-success"></i>',indicatorError:'<i class="glyphicon glyphicon-exclamation-sign text-danger"></i>',indicatorLoading:'<i class="glyphicon glyphicon-hourglass text-muted"></i>',indicatorNewTitle:"Not uploaded yet",indicatorSuccessTitle:"Uploaded",indicatorErrorTitle:"Upload Error",indicatorLoadingTitle:"Uploading ..."}},e.each(h.defaults,function(t,i){"allowedPreviewTypes"!==t?h[t]=e.extend(!0,{},i,h[t]):void 0===h.allowedPreviewTypes&&(h.allowedPreviewTypes=i)}),h._initPreviewTemplates()},_initPreviewTemplates:function(){var i,a=this,r=a.previewMarkupTags,n=r.tagAfter;e.each(a.previewContentTemplates,function(e,s){t.isEmpty(a.previewTemplates[e])&&(i=r.tagBefore2,"generic"!==e&&"image"!==e&&"html"!==e&&"text"!==e||(i=r.tagBefore1),a._isPdfRendered()&&"pdf"===e&&(i=i.replace("kv-file-content","kv-file-content kv-pdf-rendered")),a.previewTemplates[e]=i+s+n)})},_initPreviewCache:function(){var i=this;i.previewCache={data:{},init:function(){var e=i.initialPreview;0<e.length&&!t.isArray(e)&&(e=e.split(i.initialPreviewDelimiter)),i.previewCache.data={content:e,config:i.initialPreviewConfig,tags:i.initialPreviewThumbTags}},count:function(){return i.previewCache.data&&i.previewCache.data.content?i.previewCache.data.content.length:0},get:function(a,r){function w(e,a,r,n,s,o,l,d,c){return d=" file-preview-initial "+t.SORT_CSS+(d?" "+d:""),i._generatePreviewTemplate(e,a,r,n,s,!1,null,d,o,l,c)}var n,s,o,l,d,c,h,p="init_"+a,u=i.previewCache.data,f=u.config[a],m=u.content[a],g=i.previewInitId+"-"+p,v=t.ifSet("previewAsData",f,i.initialPreviewAsData);return m?(r=void 0===r||r,o=t.ifSet("type",f,i.initialPreviewFileType||"generic"),d=t.ifSet("filename",f,t.ifSet("caption",f)),c=t.ifSet("filetype",f,o),l=i.previewCache.footer(a,r,f&&f.size||null),h=t.ifSet("frameClass",f),n=v?w(o,m,d,c,g,l,p,h):w("generic",m,d,c,g,l,p,h,o).setTokens({content:u.content[a]}),u.tags.length&&u.tags[a]&&(n=t.replaceTags(n,u.tags[a])),t.isEmpty(f)||t.isEmpty(f.frameAttr)||((s=e(document.createElement("div")).html(n)).find(".file-preview-initial").attr(f.frameAttr),n=s.html(),s.remove()),n):""},add:function(e,a,r,n){var s,o=i.previewCache.data;return t.isArray(e)||(e=e.split(i.initialPreviewDelimiter)),n?(s=o.content.push(e)-1,o.config[s]=a,o.tags[s]=r):(s=e.length-1,o.content=e,o.config=a,o.tags=r),i.previewCache.data=o,s},set:function(e,a,r,n){var s,o=i.previewCache.data;if(e&&e.length&&(t.isArray(e)||(e=e.split(i.initialPreviewDelimiter)),e.filter(function(e){return null!==e}).length)){if(void 0===o.content&&(o.content=[]),void 0===o.config&&(o.config=[]),void 0===o.tags&&(o.tags=[]),n){for(s=0;s<e.length;s++)e[s]&&o.content.push(e[s]);for(s=0;s<a.length;s++)a[s]&&o.config.push(a[s]);for(s=0;s<r.length;s++)r[s]&&o.tags.push(r[s])}else o.content=e,o.config=a,o.tags=r;i.previewCache.data=o}},unset:function(e){var a=i.previewCache.count(),r=i.reversePreviewOrder;if(a){if(1===a)return i.previewCache.data.content=[],i.previewCache.data.config=[],i.previewCache.data.tags=[],i.initialPreview=[],i.initialPreviewConfig=[],void(i.initialPreviewThumbTags=[]);i.previewCache.data.content=t.spliceArray(i.previewCache.data.content,e,r),i.previewCache.data.config=t.spliceArray(i.previewCache.data.config,e,r),i.previewCache.data.tags=t.spliceArray(i.previewCache.data.tags,e,r)}},out:function(){var e,t,a="",r=i.previewCache.count();if(0===r)return{content:"",caption:""};for(e=0;e<r;e++)t=i.previewCache.get(e),a=i.reversePreviewOrder?t+a:a+t;return{content:a,caption:i._getMsgSelected(r)}},footer:function(e,a,r){var n=i.previewCache.data||{};if(t.isEmpty(n.content))return"";(t.isEmpty(n.config)||t.isEmpty(n.config[e]))&&(n.config[e]={}),a=void 0===a||a;var s,o=n.config[e],l=t.ifSet("caption",o),d=t.ifSet("width",o,"auto"),c=t.ifSet("url",o,!1),h=t.ifSet("key",o,null),p=i.fileActionSettings,u=i.initialPreviewShowDelete||!1,f=o.downloadUrl||i.initialPreviewDownloadUrl||"",m=o.filename||o.caption||"",g=!!f,v=t.ifSet("showRemove",o,t.ifSet("showRemove",p,u)),w=t.ifSet("showDownload",o,t.ifSet("showDownload",p,g)),_=t.ifSet("showZoom",o,t.ifSet("showZoom",p,!0)),b=t.ifSet("showDrag",o,t.ifSet("showDrag",p,!0)),C=!1===c&&a;return w=w&&!1!==o.downloadUrl&&!!f,s=i._renderFileActions(!1,w,v,_,b,C,c,h,!0,f,m),i._getLayoutTemplate("footer").setTokens({progress:i._renderThumbProgress(),actions:s,caption:l,size:i._getSize(r),width:d,indicator:""})}},i.previewCache.init()},_isPdfRendered:function(){var e=this.usePdfRenderer;return("function"==typeof e?e():!!e)&&this.pdfRendererUrl},_handler:function(e,t,i){var a=this.namespace,r=t.split(" ").join(a+" ")+a;e&&e.length&&e.off(r).on(r,i)},_log:function(e){var t=this.$element.attr("id");t&&(e='"'+t+'": '+e),e="bootstrap-fileinput: "+e,void 0!==window.console.log?window.console.log(e):window.alert(e)},_validate:function(){var e="file"===this.$element.attr("type");return e||this._log('The input "type" must be set to "file" for initializing the "bootstrap-fileinput" plugin.'),e},_errorsExist:function(){var t;return!!this.$errorContainer.find("li").length||((t=e(document.createElement("div")).html(this.$errorContainer.html())).find(".kv-error-close").remove(),t.find("ul").remove(),!!e.trim(t.text()).length)},_errorHandler:function(e,t){function r(e){i._showError(e.replace("{name}",t))}var i=this,a=e.target.error;a.code===a.NOT_FOUND_ERR?r(i.msgFileNotFound):a.code===a.SECURITY_ERR?r(i.msgFileSecured):a.code===a.NOT_READABLE_ERR?r(i.msgFileNotReadable):a.code===a.ABORT_ERR?r(i.msgFilePreviewAborted):r(i.msgFilePreviewError)},_addError:function(e){var t=this,i=t.$errorContainer;e&&i.length&&(i.html(t.errorCloseButton+e),t._handler(i.find(".kv-error-close"),"click",function(){setTimeout(function(){t.showPreview&&!t.getFrames().length&&t.clear(),i.fadeOut("slow")},10)}))},_setValidationError:function(e){e=(e?e+" ":"")+"has-error",this.$container.removeClass(e).addClass("has-error"),t.addCss(this.$captionContainer,"is-invalid")},_resetErrors:function(e){var t=this.$errorContainer;this.isError=!1,this.$container.removeClass("has-error"),this.$captionContainer.removeClass("is-invalid"),t.html(""),e?t.fadeOut("slow"):t.hide()},_showFolderError:function(e){var t,i=this.$errorContainer;e&&(this.isAjaxUpload||this._clearFileInput(),t=this.msgFoldersNotAllowed.replace("{n}",e),this._addError(t),this._setValidationError(),i.fadeIn(800),this._raise("filefoldererror",[e,t]))},_showUploadError:function(e,t,i){var a=this.$errorContainer,r=i||"fileuploaderror",n=t&&t.id?'<li data-file-id="'+t.id+'">'+e+"</li>":"<li>"+e+"</li>";return 0===a.find("ul").length?this._addError("<ul>"+n+"</ul>"):a.find("ul").append(n),a.fadeIn(800),this._raise(r,[t,e]),this._setValidationError("file-input-new"),!0},_showError:function(e,t,i){var a=this.$errorContainer,r=i||"fileerror";return(t=t||{}).reader=this.reader,this._addError(e),a.fadeIn(800),this._raise(r,[t,e]),this.isAjaxUpload||this._clearFileInput(),this._setValidationError("file-input-new"),this.$btnUpload.attr("disabled",!0),!0},_noFilesError:function(e){var t=1<this.minFileCount?this.filePlural:this.fileSingle,i=this.msgFilesTooLess.replace("{n}",this.minFileCount).replace("{files}",t),a=this.$errorContainer;this._addError(i),this.isError=!0,this._updateFileDetails(0),a.fadeIn(800),this._raise("fileerror",[e,i]),this._clearFileInput(),this._setValidationError()},_parseError:function(t,i,a,r){var n,s=e.trim(a+""),o=void 0!==i.responseJSON&&void 0!==i.responseJSON.error?i.responseJSON.error:i.responseText;return this.cancelling&&this.msgUploadAborted&&(s=this.msgUploadAborted),this.showAjaxErrorDetails&&o&&(n=(o=e.trim(o.replace(/\n\s*\n/g,"\n"))).length?"<pre>"+o+"</pre>":"",s+=s?n:o),s=s||this.msgAjaxError.replace("{operation}",t),this.cancelling=!1,r?"<b>"+r+": </b>"+s:s},_parseFileType:function(e,i){var a,r,n,s=this.allowedPreviewTypes||[];if("application/text-plain"===e)return"text";for(n=0;n<s.length;n++)if(r=s[n],a=(0,this.fileTypeSettings[r])(e,i)?r:"",!t.isEmpty(a))return a;return"other"},_getPreviewIcon:function(t){var i,a=this,r=null;return t&&-1<t.indexOf(".")&&(i=t.split(".").pop(),a.previewFileIconSettings&&(r=a.previewFileIconSettings[i]||a.previewFileIconSettings[i.toLowerCase()]||null),a.previewFileExtSettings&&e.each(a.previewFileExtSettings,function(e,t){a.previewFileIconSettings[e]&&t(i)&&(r=a.previewFileIconSettings[e])})),r},_parseFilePreviewIcon:function(e,t){var i=this._getPreviewIcon(t)||this.previewFileIcon,a=e;return-1<a.indexOf("{previewFileIcon}")&&(a=a.setTokens({previewFileIconClass:this.previewFileIconClass,previewFileIcon:i})),a},_raise:function(t,i){var a=e.Event(t);if(void 0!==i?this.$element.trigger(a,i):this.$element.trigger(a),a.isDefaultPrevented()||!1===a.result)return!1;switch(t){case"filebatchuploadcomplete":case"filebatchuploadsuccess":case"fileuploaded":case"fileclear":case"filecleared":case"filereset":case"fileerror":case"filefoldererror":case"fileuploaderror":case"filebatchuploaderror":case"filedeleteerror":case"filecustomerror":case"filesuccessremove":break;default:this.ajaxAborted||(this.ajaxAborted=a.result)}return!0},_listenFullScreen:function(e){var t,i,a=this.$modal;a&&a.length&&(t=a&&a.find(".btn-fullscreen"),i=a&&a.find(".btn-borderless"),t.length&&i.length&&(t.removeClass("active").attr("aria-pressed","false"),i.removeClass("active").attr("aria-pressed","false"),e?t.addClass("active").attr("aria-pressed","true"):i.addClass("active").attr("aria-pressed","true"),a.hasClass("file-zoom-fullscreen")?this._maximizeZoomDialog():e?this._maximizeZoomDialog():i.removeClass("active").attr("aria-pressed","false")))},_listen:function(){var i=this,a=i.$element,r=i.$form,n=i.$container;i._handler(a,"click",function(e){a.hasClass("file-no-browse")&&(a.data("zoneClicked")?a.data("zoneClicked",!1):e.preventDefault())}),i._handler(a,"change",e.proxy(i._change,i)),i.showBrowse&&i._handler(i.$btnFile,"click",e.proxy(i._browse,i)),i._handler(n.find(".fileinput-remove:not([disabled])"),"click",e.proxy(i.clear,i)),i._handler(n.find(".fileinput-cancel"),"click",e.proxy(i.cancel,i)),i._initDragDrop(),i._handler(r,"reset",e.proxy(i.clear,i)),i.isAjaxUpload||i._handler(r,"submit",e.proxy(i._submitForm,i)),i._handler(i.$container.find(".fileinput-upload"),"click",e.proxy(i._uploadClick,i)),i._handler(e(window),"resize",function(){i._listenFullScreen(screen.width===window.innerWidth&&screen.height===window.innerHeight)}),i._handler(e(document),"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(){i._listenFullScreen(t.checkFullScreen())}),i._autoFitContent(),i._initClickable(),i._refreshPreview()},_autoFitContent:function(){var t,i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=this,r=i<400?a.previewSettingsSmall||a.defaults.previewSettingsSmall:a.previewSettings||a.defaults.previewSettings;e.each(r,function(e,i){t=".file-preview-frame .file-preview-"+e,a.$preview.find(t+".kv-preview-data,"+t+" .kv-preview-data").css(i)})},_scanDroppedItems:function(e,t,i){i=i||"";function o(e){s._log("Error scanning dropped files!"),s._log(e)}var a,r,n,s=this;e.isFile?e.file(function(e){t.push(e)},o):e.isDirectory&&(r=e.createReader(),(n=function(){r.readEntries(function(r){if(r&&0<r.length){for(a=0;a<r.length;a++)s._scanDroppedItems(r[a],t,i+e.name+"/");n()}return null},o)})())},_initDragDrop:function(){var t=this.$dropZone;this.dropZoneEnabled&&this.showPreview&&(this._handler(t,"dragenter dragover",e.proxy(this._zoneDragEnter,this)),this._handler(t,"dragleave",e.proxy(this._zoneDragLeave,this)),this._handler(t,"drop",e.proxy(this._zoneDrop,this)),this._handler(e(document),"dragenter dragover drop",this._zoneDragDropInit))},_zoneDragDropInit:function(e){e.stopPropagation(),e.preventDefault()},_zoneDragEnter:function(i){var a=-1<e.inArray("Files",i.originalEvent.dataTransfer.types);if(this._zoneDragDropInit(i),this.isDisabled||!a)return i.originalEvent.dataTransfer.effectAllowed="none",void(i.originalEvent.dataTransfer.dropEffect="none");t.addCss(this.$dropZone,"file-highlighted")},_zoneDragLeave:function(e){this._zoneDragDropInit(e),this.isDisabled||this.$dropZone.removeClass("file-highlighted")},_zoneDrop:function(e){function d(){a.isAjaxUpload?a._change(e,s):(a.changeTriggered=!0,r.get(0).files=s,setTimeout(function(){a.changeTriggered=!1,r.trigger("change"+a.namespace)},10)),a.$dropZone.removeClass("file-highlighted")}var i,a=this,r=a.$element,n=e.originalEvent.dataTransfer,s=n.files,o=n.items,l=t.getDragDropFolders(o);if(e.preventDefault(),!a.isDisabled&&!t.isEmpty(s))if(0<l){if(!a.isAjaxUpload)return void a._showFolderError(l);for(s=[],i=0;i<o.length;i++){var c=o[i].webkitGetAsEntry();c&&a._scanDroppedItems(c,s)}setTimeout(function(){d()},500)}else d()},_uploadClick:function(e){var i,a=this.$container.find(".fileinput-upload"),r=!a.hasClass("disabled")&&t.isEmpty(a.attr("disabled"));e&&e.isDefaultPrevented()||(this.isAjaxUpload?(e.preventDefault(),r&&this.upload()):r&&"submit"!==a.attr("type")&&((i=a.closest("form")).length&&i.trigger("submit"),e.preventDefault()))},_submitForm:function(){return this._isFileSelectionValid()&&!this._abort({})},_clearPreview:function(){var i=this.$preview;(this.showUploadedThumbs?this.getFrames(":not(.file-preview-success)"):this.getFrames()).each(function(){var a=e(this);a.remove(),t.cleanZoomCache(i.find("#zoom-"+a.attr("id")))}),this.getFrames().length&&this.showPreview||this._resetUpload(),this._validateDefaultPreview()},_initSortable:function(){var i,a=this,r=a.$preview,n="."+t.SORT_CSS,s=a.reversePreviewOrder;window.KvSortable&&0!==r.find(n).length&&(i={handle:".drag-handle-init",dataIdAttr:"data-preview-id",scroll:!1,draggable:n,onSort:function(i){var r=i.oldIndex,n=i.newIndex,o=0;a.initialPreview=t.moveArray(a.initialPreview,r,n,s),a.initialPreviewConfig=t.moveArray(a.initialPreviewConfig,r,n,s),a.previewCache.init(),a.getFrames(".file-preview-initial").each(function(){e(this).attr("data-fileindex","init_"+o),o++}),a._raise("filesorted",{previewId:e(i.item).attr("id"),oldIndex:r,newIndex:n,stack:a.initialPreviewConfig})}},r.data("kvsortable")&&r.kvsortable("destroy"),e.extend(!0,i,a.fileActionSettings.dragSettings),r.kvsortable(i))},_setPreviewContent:function(e){this.$preview.html(e),this._autoFitContent()},_initPreview:function(e){var i,a=this.initialCaption||"";if(!this.previewCache.count())return this._clearPreview(),void(e?this._setCaption(a):this._initCaption());i=this.previewCache.out(),a=e&&this.initialCaption?this.initialCaption:i.caption,this._setPreviewContent(i.content),this._setInitThumbAttr(),this._setCaption(a),this._initSortable(),t.isEmpty(i.content)||this.$container.removeClass("file-input-new")},_getZoomButton:function(e){var t=this.previewZoomButtonIcons[e],i=this.previewZoomButtonClasses[e],a=' title="'+(this.previewZoomButtonTitles[e]||"")+'" '+("close"===e?' data-dismiss="modal" aria-hidden="true"':"");return"fullscreen"!==e&&"borderless"!==e&&"toggleheader"!==e||(a+=' data-toggle="button" aria-pressed="false" autocomplete="off"'),'<button type="button" class="'+i+" btn-"+e+'"'+a+">"+t+"</button>"},_getModalContent:function(){return this._getLayoutTemplate("modal").setTokens({rtl:this.rtl?" kv-rtl":"",zoomFrameClass:this.frameClass,heading:this.msgZoomModalHeading,prev:this._getZoomButton("prev"),next:this._getZoomButton("next"),toggleheader:this._getZoomButton("toggleheader"),fullscreen:this._getZoomButton("fullscreen"),borderless:this._getZoomButton("borderless"),close:this._getZoomButton("close")})},_listenModalEvent:function(e){var i=this,a=i.$modal;a.on(e+".bs.modal",function(r){var n=a.find(".btn-fullscreen"),s=a.find(".btn-borderless");i._raise("filezoom"+e,{sourceEvent:r,previewId:a.data("previewId"),modal:a}),"shown"===e&&(s.removeClass("active").attr("aria-pressed","false"),n.removeClass("active").attr("aria-pressed","false"),a.hasClass("file-zoom-fullscreen")&&(i._maximizeZoomDialog(),t.checkFullScreen()?n.addClass("active").attr("aria-pressed","true"):s.addClass("active").attr("aria-pressed","true")))})},_initZoom:function(){var i,a=this,r=a._getLayoutTemplate("modalMain"),n="#"+t.MODAL_ID;a.showPreview&&(a.$modal=e(n),a.$modal&&a.$modal.length||(i=e(document.createElement("div")).html(r).insertAfter(a.$container),a.$modal=e(n).insertBefore(i),i.remove()),t.initModal(a.$modal),a.$modal.html(a._getModalContent()),e.each(t.MODAL_EVENTS,function(e,t){a._listenModalEvent(t)}))},_initZoomButtons:function(){var t,i,a=this.$modal.data("previewId")||"",r=this.getFrames().toArray(),n=r.length,s=this.$modal.find(".btn-prev"),o=this.$modal.find(".btn-next");if(r.length<2)return s.hide(),void o.hide();s.show(),o.show(),n&&(t=e(r[0]),i=e(r[n-1]),s.removeAttr("disabled"),o.removeAttr("disabled"),t.length&&t.attr("id")===a&&s.attr("disabled",!0),i.length&&i.attr("id")===a&&o.attr("disabled",!0))},_maximizeZoomDialog:function(){var t=this.$modal,i=t.find(".modal-header:visible"),a=t.find(".modal-footer:visible"),r=t.find(".modal-body"),n=e(window).height();t.addClass("file-zoom-fullscreen"),i&&i.length&&(n-=i.outerHeight(!0)),a&&a.length&&(n-=a.outerHeight(!0)),r&&r.length&&(n-=r.outerHeight(!0)-r.height()),t.find(".kv-zoom-body").height(n)},_resizeZoomDialog:function(e){var i=this.$modal,a=i.find(".btn-fullscreen"),r=i.find(".btn-borderless");if(i.hasClass("file-zoom-fullscreen"))t.toggleFullScreen(!1),e?a.hasClass("active")||(i.removeClass("file-zoom-fullscreen"),this._resizeZoomDialog(!0),r.hasClass("active")&&r.removeClass("active").attr("aria-pressed","false")):a.hasClass("active")?a.removeClass("active").attr("aria-pressed","false"):(i.removeClass("file-zoom-fullscreen"),this.$modal.find(".kv-zoom-body").css("height",this.zoomModalHeight));else{if(!e)return void this._maximizeZoomDialog();t.toggleFullScreen(!0)}i.focus()},_setZoomContent:function(i,a){var r,n,s,o,l,d,c,h,p=this,u=i.attr("id"),f=p.$modal,m=f.find(".btn-prev"),g=f.find(".btn-next"),v=f.find(".btn-fullscreen"),w=f.find(".btn-borderless"),_=f.find(".btn-toggleheader"),b=p.$preview.find("#zoom-"+u);n=b.attr("data-template")||"generic",s=(r=b.find(".kv-file-content")).length?r.html():"",o=(i.data("caption")||"")+" "+(i.data("size")||""),f.find(".kv-zoom-title").attr("title",e("<div/>").html(o).text()).html(o),l=f.find(".kv-zoom-body"),f.removeClass("kv-single-content"),a?(h=l.addClass("file-thumb-loading").clone().insertAfter(l),l.html(s).hide(),h.fadeOut("fast",function(){l.fadeIn("fast",function(){l.removeClass("file-thumb-loading")}),h.remove()})):l.html(s),(c=p.previewZoomSettings[n])&&(d=l.find(".kv-preview-data"),t.addCss(d,"file-zoom-detail"),e.each(c,function(e,t){d.css(e,t),(d.attr("width")&&"width"===e||d.attr("height")&&"height"===e)&&d.removeAttr(e)})),f.data("previewId",u),p._handler(m,"click",function(){p._zoomSlideShow("prev",u)}),p._handler(g,"click",function(){p._zoomSlideShow("next",u)}),p._handler(v,"click",function(){p._resizeZoomDialog(!0)}),p._handler(w,"click",function(){p._resizeZoomDialog(!1)}),p._handler(_,"click",function(){function r(e){var i=p.$modal.find(".kv-zoom-body"),a=p.zoomModalHeight;f.hasClass("file-zoom-fullscreen")&&(a=i.outerHeight(!0),e||(a-=t.outerHeight(!0))),i.css("height",e?a+e:a)}var e,t=f.find(".modal-header"),i=f.find(".modal-body .floating-buttons"),a=t.find(".kv-zoom-actions");t.is(":visible")?(e=t.outerHeight(!0),t.slideUp("slow",function(){a.find(".btn").appendTo(i),r(e)})):(i.find(".btn").appendTo(a),t.slideDown("slow",function(){r()})),f.focus()}),p._handler(f,"keydown",function(e){var t=e.which||e.keyCode;37!==t||m.attr("disabled")||p._zoomSlideShow("prev",u),39!==t||g.attr("disabled")||p._zoomSlideShow("next",u)})},_zoomPreview:function(e){var i,a=this.$modal;if(!e.length)throw"Cannot zoom to detailed preview!";t.initModal(a),a.html(this._getModalContent()),i=e.closest(t.FRAMES),this._setZoomContent(i),a.modal("show"),this._initZoomButtons()},_zoomSlideShow:function(t,i){var a,r,n,s=this.$modal.find(".kv-zoom-actions .btn-"+t),o=this.getFrames().toArray(),l=o.length;if(!s.attr("disabled")){for(r=0;r<l;r++)if(e(o[r]).attr("id")===i){n="prev"===t?r-1:r+1;break}n<0||l<=n||!o[n]||((a=e(o[n])).length&&this._setZoomContent(a,!0),this._initZoomButtons(),this._raise("filezoom"+t,{previewId:i,modal:this.$modal}))}},_initZoomButton:function(){var t=this;t.$preview.find(".kv-file-zoom").each(function(){var i=e(this);t._handler(i,"click",function(){t._zoomPreview(i)})})},_inputFileCount:function(){return this.$element.get(0).files.length},_refreshPreview:function(){var e;this._inputFileCount()&&this.showPreview&&this.isPreviewable&&(this.isAjaxUpload?(e=this.getFileStack(),this.filestack=[],e.length?this._clearFileInput():e=this.$element.get(0).files):e=this.$element.get(0).files,e&&e.length&&(this.readFiles(e),this._setFileDropZoneTitle()))},_clearObjects:function(t){t.find("video audio").each(function(){this.pause(),e(this).remove()}),t.find("img object div").each(function(){e(this).remove()})},_clearFileInput:function(){var t,i,a,r=this.$element;this._inputFileCount()&&(t=r.closest("form"),i=e(document.createElement("form")),a=e(document.createElement("div")),r.before(a),t.length?t.after(i):a.after(i),i.append(r).trigger("reset"),a.before(r).remove(),i.remove())},_resetUpload:function(){this.uploadCache={content:[],config:[],tags:[],append:!0},this.uploadCount=0,this.uploadStatus={},this.uploadLog=[],this.uploadAsyncCount=0,this.loadedImages=[],this.totalImagesCount=0,this.$btnUpload.removeAttr("disabled"),this._setProgress(0),this.$progress.hide(),this._resetErrors(!1),this.ajaxAborted=!1,this.ajaxRequests=[],this._resetCanvas(),this.cacheInitialPreview={},this.overwriteInitial&&(this.initialPreview=[],this.initialPreviewConfig=[],this.initialPreviewThumbTags=[],this.previewCache.data={content:[],config:[],tags:[]})},_resetCanvas:function(){this.canvas&&this.imageCanvasContext&&this.imageCanvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},_hasInitialPreview:function(){return!this.overwriteInitial&&this.previewCache.count()},_resetPreview:function(){var e,t;this.previewCache.count()?(e=this.previewCache.out(),this._setPreviewContent(e.content),this._setInitThumbAttr(),t=this.initialCaption?this.initialCaption:e.caption,this._setCaption(t)):(this._clearPreview(),this._initCaption()),this.showPreview&&(this._initZoom(),this._initSortable())},_clearDefaultPreview:function(){this.$preview.find(".file-default-preview").remove()},_validateDefaultPreview:function(){this.showPreview&&!t.isEmpty(this.defaultPreviewContent)&&(this._setPreviewContent('<div class="file-default-preview">'+this.defaultPreviewContent+"</div>"),this.$container.removeClass("file-input-new"),this._initClickable())},_resetPreviewThumbs:function(e){var t;if(e)return this._clearPreview(),void this.clearStack();this._hasInitialPreview()?(t=this.previewCache.out(),this._setPreviewContent(t.content),this._setInitThumbAttr(),this._setCaption(t.caption),this._initPreviewActions()):this._clearPreview()},_getLayoutTemplate:function(e){var i=this.layoutTemplates[e];return t.isEmpty(this.customLayoutTags)?i:t.replaceTags(i,this.customLayoutTags)},_getPreviewTemplate:function(e){var i=this.previewTemplates[e];return t.isEmpty(this.customPreviewTags)?i:t.replaceTags(i,this.customPreviewTags)},_getOutData:function(e,t,i){return e=e||{},t=t||{},i=i||this.filestack.slice(0)||{},{form:this.formdata,files:i,filenames:this.filenames,filescount:this.getFilesCount(),extra:this._getExtraData(),response:t,reader:this.reader,jqXHR:e}},_getMsgSelected:function(e){var t=1===e?this.fileSingle:this.filePlural;return 0<e?this.msgSelected.replace("{n}",e).replace("{files}",t):this.msgNoFilesSelected},_getFrame:function(t){var i=e("#"+t);return i.length?i:(this._log('Invalid thumb frame with id: "'+t+'".'),null)},_getThumbs:function(e){return e=e||"",this.getFrames(":not(.file-preview-initial)"+e)},_getExtraData:function(e,t){var i=this.uploadExtraData;return"function"==typeof this.uploadExtraData&&(i=this.uploadExtraData(e,t)),i},_initXhr:function(e,t,i){var a=this;return e.upload&&e.upload.addEventListener("progress",function(e){var r=0,n=e.total,s=e.loaded||e.position;e.lengthComputable&&(r=Math.floor(s/n*100)),t?a._setAsyncUploadStatus(t,r,i):a._setProgress(r)},!1),e},_initAjaxSettings:function(){this._ajaxSettings=e.extend(!0,{},this.ajaxSettings),this._ajaxDeleteSettings=e.extend(!0,{},this.ajaxDeleteSettings)},_mergeAjaxCallback:function(e,t,i){var a,r=this._ajaxSettings,n=this.mergeAjaxCallbacks;"delete"===i&&(r=this._ajaxDeleteSettings,n=this.mergeAjaxDeleteCallbacks),a=r[e],r[e]=n&&"function"==typeof a?"before"===n?function(){a.apply(this,arguments),t.apply(this,arguments)}:function(){t.apply(this,arguments),a.apply(this,arguments)}:t},_ajaxSubmit:function(t,i,a,r,n,s){var o,l=this;l._raise("filepreajax",[n,s])&&(l._uploadExtra(n,s),l._initAjaxSettings(),l._mergeAjaxCallback("beforeSend",t),l._mergeAjaxCallback("success",i),l._mergeAjaxCallback("complete",a),l._mergeAjaxCallback("error",r),o=e.extend(!0,{},{xhr:function(){var t=e.ajaxSettings.xhr();return l._initXhr(t,n,l.getFileStack().length)},url:s&&l.uploadUrlThumb?l.uploadUrlThumb:l.uploadUrl,type:"POST",dataType:"json",data:l.formdata,cache:!1,processData:!1,contentType:!1},l._ajaxSettings),l.ajaxRequests.push(e.ajax(o)))},_mergeArray:function(e,i){var a=t.cleanArray(this[e]),r=t.cleanArray(i);this[e]=a.concat(r)},_initUploadSuccess:function(i,a,r){var n,s,o,l,d,c,h,p,u,f=this;f.showPreview&&"object"==typeof i&&!e.isEmptyObject(i)&&void 0!==i.initialPreview&&0<i.initialPreview.length&&(f.hasInitData=!0,c=i.initialPreview||[],h=i.initialPreviewConfig||[],p=i.initialPreviewThumbTags||[],n=void 0===i.append||i.append,0<c.length&&!t.isArray(c)&&(c=c.split(f.initialPreviewDelimiter)),f._mergeArray("initialPreview",c),f._mergeArray("initialPreviewConfig",h),f._mergeArray("initialPreviewThumbTags",p),void 0!==a?r?(u=a.attr("data-fileindex"),f.uploadCache.content[u]=c[0],f.uploadCache.config[u]=h[0]||[],f.uploadCache.tags[u]=p[0]||[],f.uploadCache.append=n):(o=f.previewCache.add(c,h[0],p[0],n),s=f.previewCache.get(o,!1),(d=(l=e(document.createElement("div")).html(s).hide().insertAfter(a)).find(".kv-zoom-cache"))&&d.length&&d.insertAfter(a),a.fadeOut("slow",function(){var e=l.find(".file-preview-frame");e&&e.length&&e.insertBefore(a).fadeIn("slow").css("display:inline-block"),f._initPreviewActions(),f._clearFileInput(),t.cleanZoomCache(f.$preview.find("#zoom-"+a.attr("id"))),a.remove(),l.remove(),f._initSortable()})):(f.previewCache.set(c,h,p,n),f._initPreview(),f._initPreviewActions()))},_initSuccessThumbs:function(){var i=this;i.showPreview&&i._getThumbs(t.FRAMES+".file-preview-success").each(function(){var a=e(this),r=i.$preview,n=a.find(".kv-file-remove");n.removeAttr("disabled"),i._handler(n,"click",function(){var e=a.attr("id"),n=i._raise("filesuccessremove",[e,a.attr("data-fileindex")]);t.cleanMemory(a),!1!==n&&a.fadeOut("slow",function(){t.cleanZoomCache(r.find("#zoom-"+e)),a.remove(),i.getFrames().length||i.reset()})})})},_checkAsyncComplete:function(){var t,i;for(i=0;i<this.filestack.length;i++)if(this.filestack[i]&&(t=this.previewInitId+"-"+i,-1===e.inArray(t,this.uploadLog)))return!1;return this.uploadAsyncCount===this.uploadLog.length},_uploadExtra:function(t,i){var a=this,r=a._getExtraData(t,i);0!==r.length&&e.each(r,function(e,t){a.formdata.append(e,t)})},_uploadSingle:function(i,a){var r,n,s,o,l,d,c,h,p,u,f,m=this,g=m.getFileStack().length,v=new FormData,w=m.previewInitId+"-"+i,_=0<m.filestack.length||!e.isEmptyObject(m.uploadExtraData),b=e("#"+w).find(".file-thumb-progress"),C={id:w,index:i};m.formdata=v,m.showPreview&&(n=e("#"+w+":not(.file-preview-initial)"),o=n.find(".kv-file-upload"),l=n.find(".kv-file-remove"),b.show()),0===g||!_||o&&o.hasClass("disabled")||m._abort(C)||(f=function(e,t){d||m.updateStack(e,void 0),m.uploadLog.push(t),m._checkAsyncComplete()&&(m.fileBatchCompleted=!0)},s=function(){var e,i,a,r=m.uploadCache,n=0,s=m.cacheInitialPreview;m.fileBatchCompleted&&(s&&s.content&&(n=s.content.length),setTimeout(function(){var o=0===m.getFileStack(!0).length;if(m.showPreview){if(m.previewCache.set(r.content,r.config,r.tags,r.append),n){for(i=0;i<r.content.length;i++)a=i+n,s.content[a]=r.content[i],s.config.length&&(s.config[a]=r.config[i]),s.tags.length&&(s.tags[a]=r.tags[i]);m.initialPreview=t.cleanArray(s.content),m.initialPreviewConfig=t.cleanArray(s.config),m.initialPreviewThumbTags=t.cleanArray(s.tags)}else m.initialPreview=r.content,m.initialPreviewConfig=r.config,m.initialPreviewThumbTags=r.tags;m.cacheInitialPreview={},m.hasInitData&&(m._initPreview(),m._initPreviewActions())}m.unlock(o),o&&m._clearFileInput(),e=m.$preview.find(".file-preview-initial"),m.uploadAsync&&e.length&&(t.addCss(e,t.SORT_CSS),m._initSortable()),m._raise("filebatchuploadcomplete",[m.filestack,m._getExtraData()]),m.uploadCount=0,m.uploadStatus={},m.uploadLog=[],m._setProgress(101),m.ajaxAborted=!1},100))},c=function(s){r=m._getOutData(s),m.fileBatchCompleted=!1,a||(m.ajaxAborted=!1),m.showPreview&&(n.hasClass("file-preview-success")||(m._setThumbStatus(n,"Loading"),t.addCss(n,"file-uploading")),o.attr("disabled",!0),l.attr("disabled",!0)),a||m.lock(),m._raise("filepreupload",[r,w,i]),e.extend(!0,C,r),m._abort(C)&&(s.abort(),a||(m._setThumbStatus(n,"New"),n.removeClass("file-uploading"),o.removeAttr("disabled"),l.removeAttr("disabled"),m.unlock()),m._setProgressCancelled())},h=function(s,l,c){var h=m.showPreview&&n.attr("id")?n.attr("id"):w;r=m._getOutData(c,s),e.extend(!0,C,r),setTimeout(function(){t.isEmpty(s)||t.isEmpty(s.error)?(m.showPreview&&(m._setThumbStatus(n,"Success"),o.hide(),m._initUploadSuccess(s,n,a),m._setProgress(101,b)),m._raise("fileuploaded",[r,h,i]),a?f(i,h):m.updateStack(i,void 0)):(d=!0,m._showUploadError(s.error,C),m._setPreviewError(n,i,m.filestack[i],m.retryErrorUploads),m.retryErrorUploads||o.hide(),a&&f(i,h),m._setProgress(101,e("#"+h).find(".file-thumb-progress"),m.msgUploadError))},100)},p=function(){setTimeout(function(){m.showPreview&&(o.removeAttr("disabled"),l.removeAttr("disabled"),n.removeClass("file-uploading")),a?s():(m.unlock(!1),m._clearFileInput()),m._initSuccessThumbs()},100)},u=function(t,r,s){var l=m.ajaxOperations.uploadThumb,c=m._parseError(l,t,s,a&&m.filestack[i].name?m.filestack[i].name:null);d=!0,setTimeout(function(){a&&f(i,w),m.uploadStatus[w]=100,m._setPreviewError(n,i,m.filestack[i],m.retryErrorUploads),m.retryErrorUploads||o.hide(),e.extend(!0,C,m._getOutData(t)),m._setProgress(101,b,m.msgAjaxProgressError.replace("{operation}",l)),m._setProgress(101,e("#"+w).find(".file-thumb-progress"),m.msgUploadError),m._showUploadError(c,C)},100)},v.append(m.uploadFileAttr,m.filestack[i],m.filenames[i]),v.append("file_id",i),m._ajaxSubmit(c,h,p,u,w,i))},_uploadBatch:function(){var i,a,r,n,s,o=this,l=o.filestack,d=l.length,c=0<o.filestack.length||!e.isEmptyObject(o.uploadExtraData);o.formdata=new FormData,0!==d&&c&&!o._abort({})&&(s=function(){e.each(l,function(e){o.updateStack(e,void 0)}),o._clearFileInput()},i=function(i){o.lock();var a=o._getOutData(i);o.ajaxAborted=!1,o.showPreview&&o._getThumbs().each(function(){var i=e(this),a=i.find(".kv-file-upload"),r=i.find(".kv-file-remove");i.hasClass("file-preview-success")||(o._setThumbStatus(i,"Loading"),t.addCss(i,"file-uploading")),a.attr("disabled",!0),r.attr("disabled",!0)}),o._raise("filebatchpreupload",[a]),o._abort(a)&&(i.abort(),o._getThumbs().each(function(){var t=e(this),i=t.find(".kv-file-upload"),a=t.find(".kv-file-remove");t.hasClass("file-preview-loading")&&(o._setThumbStatus(t,"New"),t.removeClass("file-uploading")),i.removeAttr("disabled"),a.removeAttr("disabled")}),o._setProgressCancelled())},a=function(i,a,r){var n=o._getOutData(r,i),l=0,d=o._getThumbs(":not(.file-preview-success)"),c=t.isEmpty(i)||t.isEmpty(i.errorkeys)?[]:i.errorkeys;t.isEmpty(i)||t.isEmpty(i.error)?(o._raise("filebatchuploadsuccess",[n]),s(),o.showPreview?(d.each(function(){var t=e(this);o._setThumbStatus(t,"Success"),t.removeClass("file-uploading"),t.find(".kv-file-upload").hide().removeAttr("disabled")}),o._initUploadSuccess(i)):o.reset(),o._setProgress(101)):(o.showPreview&&(d.each(function(){var t=e(this),i=t.attr("data-fileindex");t.removeClass("file-uploading"),t.find(".kv-file-upload").removeAttr("disabled"),t.find(".kv-file-remove").removeAttr("disabled"),0===c.length||-1!==e.inArray(l,c)?(o._setPreviewError(t,i,o.filestack[i],o.retryErrorUploads),o.retryErrorUploads||(t.find(".kv-file-upload").hide(),o.updateStack(i,void 0))):(t.find(".kv-file-upload").hide(),o._setThumbStatus(t,"Success"),o.updateStack(i,void 0)),t.hasClass("file-preview-error")&&!o.retryErrorUploads||l++}),o._initUploadSuccess(i)),o._showUploadError(i.error,n,"filebatchuploaderror"),o._setProgress(101,o.$progress,o.msgUploadError))},n=function(){o.unlock(),o._initSuccessThumbs(),o._clearFileInput(),o._raise("filebatchuploadcomplete",[o.filestack,o._getExtraData()])},r=function(t,i,a){var r=o._getOutData(t),n=o.ajaxOperations.uploadBatch,s=o._parseError(n,t,a);o._showUploadError(s,r,"filebatchuploaderror"),o.uploadFileCount=d-1,o.showPreview&&(o._getThumbs().each(function(){var t=e(this),i=t.attr("data-fileindex");t.removeClass("file-uploading"),void 0!==o.filestack[i]&&o._setPreviewError(t)}),o._getThumbs().removeClass("file-uploading"),o._getThumbs(" .kv-file-upload").removeAttr("disabled"),o._getThumbs(" .kv-file-delete").removeAttr("disabled"),o._setProgress(101,o.$progress,o.msgAjaxProgressError.replace("{operation}",n)))},e.each(l,function(e,i){t.isEmpty(l[e])||o.formdata.append(o.uploadFileAttr,i,o.filenames[e])}),o._ajaxSubmit(i,a,n,r))},_uploadExtraOnly:function(){var e,i,a,r,n=this,s={};n.formdata=new FormData,n._abort(s)||(e=function(e){n.lock();var t=n._getOutData(e);n._raise("filebatchpreupload",[t]),n._setProgress(50),s.data=t,s.xhr=e,n._abort(s)&&(e.abort(),n._setProgressCancelled())},i=function(e,i,a){var r=n._getOutData(a,e);t.isEmpty(e)||t.isEmpty(e.error)?(n._raise("filebatchuploadsuccess",[r]),n._clearFileInput(),n._initUploadSuccess(e),n._setProgress(101)):n._showUploadError(e.error,r,"filebatchuploaderror")},a=function(){n.unlock(),n._clearFileInput(),n._raise("filebatchuploadcomplete",[n.filestack,n._getExtraData()])},r=function(e,t,i){var a=n._getOutData(e),r=n.ajaxOperations.uploadExtra,o=n._parseError(r,e,i);s.data=a,n._showUploadError(o,a,"filebatchuploaderror"),n._setProgress(101,n.$progress,n.msgAjaxProgressError.replace("{operation}",r))},n._ajaxSubmit(e,i,a,r))},_deleteFileIndex:function(i){var a=i.attr("data-fileindex"),r=this.reversePreviewOrder;"init_"===a.substring(0,5)&&(a=parseInt(a.replace("init_","")),this.initialPreview=t.spliceArray(this.initialPreview,a,r),this.initialPreviewConfig=t.spliceArray(this.initialPreviewConfig,a,r),this.initialPreviewThumbTags=t.spliceArray(this.initialPreviewThumbTags,a,r),this.getFrames().each(function(){var t=e(this),i=t.attr("data-fileindex");"init_"===i.substring(0,5)&&(i=parseInt(i.replace("init_","")))>a&&(i--,t.attr("data-fileindex","init_"+i))}),this.uploadAsync&&(this.cacheInitialPreview=this.getPreview()))},_initFileActions:function(){var i=this,a=i.$preview;i.showPreview&&(i._initZoomButton(),i.getFrames(" .kv-file-remove").each(function(){var r,n,s,o=e(this),l=o.closest(t.FRAMES),d=l.attr("id"),c=l.attr("data-fileindex");i._handler(o,"click",function(){if(!1===i._raise("filepreremove",[d,c])||!i._validateMinCount())return!1;r=l.hasClass("file-preview-error"),t.cleanMemory(l),l.fadeOut("slow",function(){t.cleanZoomCache(a.find("#zoom-"+d)),i.updateStack(c,void 0),i._clearObjects(l),l.remove(),d&&r&&i.$errorContainer.find('li[data-file-id="'+d+'"]').fadeOut("fast",function(){e(this).remove(),i._errorsExist()||i._resetErrors()}),i._clearFileInput();var o=i.getFileStack(!0),h=i.previewCache.count(),p=o.length,u=i.showPreview&&i.getFrames().length;0!==p||0!==h||u?(s=1<(n=h+p)?i._getMsgSelected(n):o[0]?i._getFileNames()[0]:"",i._setCaption(s)):i.reset(),i._raise("fileremoved",[d,c])})})}),i.getFrames(" .kv-file-upload").each(function(){var a=e(this);i._handler(a,"click",function(){var e=a.closest(t.FRAMES),r=e.attr("data-fileindex");i.$progress.hide(),e.hasClass("file-preview-error")&&!i.retryErrorUploads||i._uploadSingle(r,!1)})}))},_initPreviewActions:function(){function d(){var e=i.isAjaxUpload?i.previewCache.count():i._inputFileCount();a.find(t.FRAMES).length||e||(i._setCaption(""),i.reset(),i.initialCaption="")}var i=this,a=i.$preview,r=i.deleteExtraData||{},n=t.FRAMES+" .kv-file-remove",s=i.fileActionSettings,o=s.removeClass,l=s.removeErrorClass;i._initZoomButton(),a.find(n).each(function(){var n,s,c,h=e(this),p=h.data("url")||i.deleteUrl,u=h.data("key");if(!t.isEmpty(p)&&void 0!==u){var f,m,g,v,w=h.closest(t.FRAMES),_=i.previewCache.data,b=w.attr("data-fileindex");b=parseInt(b.replace("init_","")),g=t.isEmpty(_.config)&&t.isEmpty(_.config[b])?null:_.config[b],"function"==typeof(v=t.isEmpty(g)||t.isEmpty(g.extra)?r:g.extra)&&(v=v()),m={id:h.attr("id"),key:u,extra:v},n=function(e){i.ajaxAborted=!1,i._raise("filepredelete",[u,e,v]),i._abort()?e.abort():(h.removeClass(l),t.addCss(w,"file-uploading"),t.addCss(h,"disabled "+o))},s=function(e,r,n){var s,c;if(!t.isEmpty(e)&&!t.isEmpty(e.error))return m.jqXHR=n,m.response=e,i._showError(e.error,m,"filedeleteerror"),w.removeClass("file-uploading"),h.removeClass("disabled "+o).addClass(l),void d();w.removeClass("file-uploading").addClass("file-deleted"),w.fadeOut("slow",function(){b=parseInt(w.attr("data-fileindex").replace("init_","")),i.previewCache.unset(b),i._deleteFileIndex(w),s=i.previewCache.count(),c=0<s?i._getMsgSelected(s):"",i._setCaption(c),i._raise("filedeleted",[u,n,v]),t.cleanZoomCache(a.find("#zoom-"+w.attr("id"))),i._clearObjects(w),w.remove(),d()})},c=function(e,t,a){var r=i.ajaxOperations.deleteThumb,n=i._parseError(r,e,a);m.jqXHR=e,m.response={},i._showError(n,m,"filedeleteerror"),w.removeClass("file-uploading"),h.removeClass("disabled "+o).addClass(l),d()},i._initAjaxSettings(),i._mergeAjaxCallback("beforeSend",n,"delete"),i._mergeAjaxCallback("success",s,"delete"),i._mergeAjaxCallback("error",c,"delete"),f=e.extend(!0,{},{url:p,type:"POST",dataType:"json",data:e.extend(!0,{},{key:u},v)},i._ajaxDeleteSettings),i._handler(h,"click",function(){if(!i._validateMinCount())return!1;i.ajaxAborted=!1,i._raise("filebeforedelete",[u,v]),i.ajaxAborted instanceof Promise?i.ajaxAborted.then(function(t){t||e.ajax(f)}):i.ajaxAborted||e.ajax(f)})}})},_hideFileIcon:function(){this.overwriteInitial&&this.$captionContainer.removeClass("icon-visible")},_showFileIcon:function(){t.addCss(this.$captionContainer,"icon-visible")},_getSize:function(t){var i,a,r,n=parseFloat(t),s=this.fileSizeGetter;return e.isNumeric(t)&&e.isNumeric(n)?(r="function"==typeof s?s(n):0===n?"0.00 B":(i=Math.floor(Math.log(n)/Math.log(1024)),a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],1*(n/Math.pow(1024,i)).toFixed(2)+" "+a[i]),this._getLayoutTemplate("size").replace("{sizeText}",r)):""},_generatePreviewTemplate:function(i,a,r,n,s,o,l,d,c,h,p){var u,f=this,m=f.slug(r),g="",v="",w=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<400?f.previewSettingsSmall[i]||f.defaults.previewSettingsSmall[i]:f.previewSettings[i]||f.defaults.previewSettings[i],_=c||f._renderFileFooter(m,l,"auto",o),b=f._getPreviewIcon(r),C="type-default",y=b&&f.preferIconicPreview,x=b&&f.preferIconicZoomPreview;return w&&e.each(w,function(e,t){v+=e+":"+t+";"}),u=function(a,o,l,c){var u=l?"zoom-"+s:s,g=f._getPreviewTemplate(a),w=(d||"")+" "+c;return f.frameClass&&(w=f.frameClass+" "+w),l&&(w=w.replace(" "+t.SORT_CSS,"")),g=f._parseFilePreviewIcon(g,r),"text"===a&&(o=t.htmlEncode(o)),"object"!==i||n||e.each(f.defaults.fileTypeSettings,function(e,t){"object"!==e&&"other"!==e&&t(r,n)&&(C="type-"+e)}),g.setTokens({previewId:u,caption:m,frameClass:w,type:n,fileindex:h,typeCss:C,footer:_,data:o,template:p||i,style:v?'style="'+v+'"':""})},h=h||s.slice(s.lastIndexOf("-")+1),f.fileActionSettings.showZoom&&(g=u(x?"other":i,a,!0,"kv-zoom-thumb")),g="\n"+f._getLayoutTemplate("zoomCache").replace("{zoomContent}",g),u(y?"other":i,a,!1,"kv-preview-thumb")+g},_addToPreview:function(e,t){return this.reversePreviewOrder?e.prepend(t):e.append(t)},_previewDefault:function(i,a,r){var n=this.$preview;if(this.showPreview){var s,o=i?i.name:"",l=i?i.type:"",d=i.size||0,c=this.slug(o),h=!0===r&&!this.isAjaxUpload,p=t.objUrl.createObjectURL(i);this._clearDefaultPreview(),s=this._generatePreviewTemplate("other",p,o,l,a,h,d),this._addToPreview(n,s),this._setThumbAttr(a,c,d),!0===r&&this.isAjaxUpload&&this._setThumbStatus(e("#"+a),"Error")}},_previewFile:function(e,t,i,a,r,n){if(this.showPreview){var s,o=t?t.name:"",l=n.type,d=n.name,c=this._parseFileType(l,o),h=this.allowedPreviewTypes,p=this.allowedPreviewMimeTypes,u=this.$preview,f=t.size||0,m=h&&0<=h.indexOf(c),g=p&&-1!==p.indexOf(l),v="text"===c||"html"===c||"image"===c?i.target.result:r;if("html"===c&&this.purifyHtml&&window.DOMPurify&&(v=window.DOMPurify.sanitize(v)),m||g){s=this._generatePreviewTemplate(c,v,o,l,a,!1,f),this._clearDefaultPreview(),this._addToPreview(u,s);var w=u.find("#"+a+" img");this._validateImageOrientation(w,t,a,d,l,f,v)}else this._previewDefault(t,a);this._setThumbAttr(a,d,f),this._initSortable()}},_setThumbAttr:function(t,i,a){var r=e("#"+t);r.length&&(a=a&&0<a?this._getSize(a):"",r.data({caption:i,size:a}))},_setInitThumbAttr:function(){var e,i,a,r,n=this.previewCache.data,s=this.previewCache.count();if(0!==s)for(var o=0;o<s;o++)e=n.config[o],r=this.previewInitId+"-init_"+o,i=t.ifSet("caption",e,t.ifSet("filename",e)),a=t.ifSet("size",e),this._setThumbAttr(r,i,a)},_slugDefault:function(e){return t.isEmpty(e)?"":String(e).replace(/[\[\]\/\{}:;#%=\(\)\*\+\?\\\^\$\|<>&"']/g,"_")},_updateFileDetails:function(e){var i=this.$element,a=this.getFileStack(),r=t.isIE(9)&&t.findFileName(i.val())||i[0].files[0]&&i[0].files[0].name||a.length&&a[0].name||"",n=this.slug(r),s=this.isAjaxUpload?a.length:e,o=this.previewCache.count()+s,l=1===s?n:this._getMsgSelected(o);this.isError?(this.$previewContainer.removeClass("file-thumb-loading"),this.$previewStatus.html(""),this.$captionContainer.removeClass("icon-visible")):this._showFileIcon(),this._setCaption(l,this.isError),this.$container.removeClass("file-input-new file-input-ajax-new"),1===arguments.length&&this._raise("fileselect",[e,n]),this.previewCache.count()&&this._initPreviewActions()},_setThumbStatus:function(e,t){if(this.showPreview){var i="indicator"+t,a=i+"Title",r="file-preview-"+t.toLowerCase(),n=e.find(".file-upload-indicator"),s=this.fileActionSettings;e.removeClass("file-preview-success file-preview-error file-preview-loading"),"Success"===t&&e.find(".file-drag-handle").remove(),n.html(s[i]),n.attr("title",s[a]),e.addClass(r),"Error"!==t||this.retryErrorUploads||e.find(".kv-file-upload").attr("disabled",!0)}},_setProgressCancelled:function(){this._setProgress(101,this.$progress,this.msgCancelled)},_setProgress:function(e,i,a){var r,n=Math.min(e,100),s=this.progressUploadThreshold,o=e<=100?this.progressTemplate:this.progressCompleteTemplate,l=n<100?this.progressTemplate:a?this.progressErrorTemplate:o;i=i||this.$progress,t.isEmpty(l)||(r=s&&s<n&&e<=100?l.setTokens({percent:s,status:this.msgUploadThreshold}):l.setTokens({percent:n,status:100<e?this.msgUploadEnd:n+"%"}),i.html(r),a&&i.find('[role="progressbar"]').html(a))},_setFileDropZoneTitle:function(){var e,i=this.$container.find(".file-drop-zone"),a=this.dropZoneTitle;this.isClickable&&(e=t.isEmpty(this.$element.attr("multiple"))?this.fileSingle:this.filePlural,a+=this.dropZoneClickTitle.replace("{files}",e)),i.find("."+this.dropZoneTitleClass).remove(),!this.showPreview||0===i.length||0<this.getFileStack().length||!this.dropZoneEnabled||!this.isAjaxUpload&&this.$element.files||(0===i.find(t.FRAMES).length&&t.isEmpty(this.defaultPreviewContent)&&i.prepend('<div class="'+this.dropZoneTitleClass+'">'+a+"</div>"),this.$container.removeClass("file-input-new"),t.addCss(this.$container,"file-input-ajax-new"))},_setAsyncUploadStatus:function(t,i,a){var r=0;this._setProgress(i,e("#"+t).find(".file-thumb-progress")),this.uploadStatus[t]=i,e.each(this.uploadStatus,function(e,t){r+=t}),this._setProgress(Math.floor(r/a))},_validateMinCount:function(){var e=this.isAjaxUpload?this.getFileStack().length:this._inputFileCount();return!(this.validateInitialCount&&0<this.minFileCount&&this._getFileCount(e-1)<this.minFileCount&&(this._noFilesError({}),1))},_getFileCount:function(e){return this.validateInitialCount&&!this.overwriteInitial&&(e+=this.previewCache.count()),e},_getFileId:function(e){var t,i=this.generateFileId;return"function"==typeof i?i(e,event):e&&(t=String(e.webkitRelativePath||e.fileName||e.name||null))?e.size+"-"+t.replace(/[^0-9a-zA-Z_-]/gim,""):null},_getFileName:function(e){return e&&e.name?this.slug(e.name):void 0},_getFileIds:function(e){return this.fileids.filter(function(t){return e?void 0!==t:null!=t})},_getFileNames:function(e){return this.filenames.filter(function(t){return e?void 0!==t:null!=t})},_setPreviewError:function(e,t,i,a){void 0!==t&&this.updateStack(t,i),this.showPreview&&(!this.removeFromPreviewOnError||a?(this._setThumbStatus(e,"Error"),this._refreshUploadButton(e,a)):e.remove())},_refreshUploadButton:function(e,t){var i=e.find(".kv-file-upload"),a=this.fileActionSettings,r=a.uploadIcon,n=a.uploadTitle;i.length&&(t&&(r=a.uploadRetryIcon,n=a.uploadRetryTitle),i.attr("title",n).html(r))},_checkDimensions:function(e,i,a,r,n,s,o){var l,d,c,h=this[("Small"===i?"min":"max")+"Image"+s];!t.isEmpty(h)&&a.length&&(c=a[0],d="Width"===s?c.naturalWidth||c.width:c.naturalHeight||c.height,("Small"===i?h<=d:d<=h)||(l=this["msgImage"+s+i].setTokens({name:n,size:h}),this._showUploadError(l,o),this._setPreviewError(r,e,null)))},_getExifObj:function(e){var t=null;try{t=window.piexif?window.piexif.load(e):null}catch(e){t=null}return t||this._log("Error loading the piexif.js library."),t},_validateImageOrientation:function(e,i,a,r,n,s,o){var l,d;(d=(l=e.length&&this.autoOrientImage?this._getExifObj(o):null)?l["0th"][piexif.ImageIFD.Orientation]:null)&&(t.setImageOrientation(e,this.$preview.find("#zoom-"+a+" img"),d),this._raise("fileimageoriented",{$img:e,file:i})),this._validateImage(a,r,n,s,o,l)},_validateImage:function(t,i,a,r,n,s){var o,l,c=this,h=c.$preview,p=h.find("#"+t),u=p.attr("data-fileindex"),f=p.find("img");i=i||"Untitled",f.one("load",function(){l=p.width(),h.width()<l&&f.css("width","100%"),o={ind:u,id:t},c._checkDimensions(u,"Small",f,p,i,"Width",o),c._checkDimensions(u,"Small",f,p,i,"Height",o),c.resizeImage||(c._checkDimensions(u,"Large",f,p,i,"Width",o),c._checkDimensions(u,"Large",f,p,i,"Height",o)),c._raise("fileimageloaded",[t]),c.loadedImages.push({ind:u,img:f,thumb:p,pid:t,typ:a,siz:r,validated:!1,imgData:n,exifObj:s}),p.data("exif",s),c._validateAllImages()}).one("error",function(){c._raise("fileimageloaderror",[t])}).each(function(){this.complete?e(this).trigger("load"):this.error&&e(this).trigger("error")})},_validateAllImages:function(){var e,t,i,a={val:0},r=this.loadedImages.length,n=this.resizeIfSizeMoreThan;if(r===this.totalImagesCount&&(this._raise("fileimagesloaded"),this.resizeImage))for(e=0;e<this.loadedImages.length;e++)(t=this.loadedImages[e]).validated||((i=t.siz)&&1e3*n<i&&this._getResizedImage(t,a,r),this.loadedImages[e].validated=!0)},_getResizedImage:function(i,a,r){var n,s,o,l,d,c,h=this,p=e(i.img)[0],u=p.naturalWidth,f=p.naturalHeight,m=1,g=h.maxImageWidth||u,v=h.maxImageHeight||f,w=!(!u||!f),_=h.imageCanvas,b=h.imageCanvasContext,C=i.typ,y=i.pid,x=i.ind,T=i.thumb,E=i.exifObj;if(d=function(e,t,i){h.isAjaxUpload?h._showUploadError(e,t,i):h._showError(e,t,i),h._setPreviewError(T,x)},h.filestack[x]&&w&&!(u<=g&&f<=v)||(w&&h.filestack[x]&&h._raise("fileimageresized",[y,x]),a.val++,a.val===r&&h._raise("fileimagesresized"),w)){C=C||h.resizeDefaultImageType,s=g<u,o=v<f,m="width"===h.resizePreference?s?g/u:o?v/f:1:o?v/f:s?g/u:1,h._resetCanvas(),u*=m,f*=m,_.width=u,_.height=f;try{b.drawImage(p,0,0,u,f),l=_.toDataURL(C,h.resizeQuality),E&&(c=window.piexif.dump(E),l=window.piexif.insert(c,l)),n=t.dataURI2Blob(l),h.filestack[x]=n,h._raise("fileimageresized",[y,x]),a.val++,a.val===r&&h._raise("fileimagesresized",[void 0,void 0]),n instanceof Blob||d(h.msgImageResizeError,{id:y,index:x},"fileimageresizeerror")}catch(e){a.val++,a.val===r&&h._raise("fileimagesresized",[void 0,void 0]),d(h.msgImageResizeException.replace("{errors}",e.message),{id:y,index:x},"fileimageresizeexception")}}else d(h.msgImageResizeError,{id:y,index:x},"fileimageresizeerror")},_initBrowse:function(e){var i=this.$element;this.showBrowse?this.$btnFile=e.find(".btn-file").append(i):(i.appendTo(e).attr("tabindex",-1),t.addCss(i,"file-no-browse"))},_initClickable:function(){var i,a,r=this;r.isClickable&&(i=r.$dropZone,r.isAjaxUpload||(a=r.$preview.find(".file-default-preview")).length&&(i=a),t.addCss(i,"clickable"),i.attr("tabindex",-1),r._handler(i,"click",function(t){var a=e(t.target);e(r.elErrorContainer+":visible").length||a.parents(".file-preview-thumbnails").length&&!a.parents(".file-default-preview").length||(r.$element.data("zoneClicked",!0).trigger("click"),i.blur())}))},_initCaption:function(){var e=this.initialCaption||"";return this.overwriteInitial||t.isEmpty(e)?(this.$caption.val(""),!1):(this._setCaption(e),!0)},_setCaption:function(i,a){var r,n,s,o,l,d=this.getFileStack();if(this.$caption.length){if(this.$captionContainer.removeClass("icon-visible"),a)r=e("<div>"+this.msgValidationError+"</div>").text(),l=(o=d.length)?1===o&&d[0]?this._getFileNames()[0]:this._getMsgSelected(o):this._getMsgSelected(this.msgNo),n=t.isEmpty(i)?l:i,s='<span class="'+this.msgValidationErrorClass+'">'+this.msgValidationErrorIcon+"</span>";else{if(t.isEmpty(i))return;n=r=e("<div>"+i+"</div>").text(),s=this._getLayoutTemplate("fileIcon")}this.$captionContainer.addClass("icon-visible"),this.$caption.attr("title",r).val(n),this.$captionIcon.html(s)}},_createContainer:function(){var t={class:"file-input file-input-new"+(this.rtl?" kv-rtl":"")},i=e(document.createElement("div")).attr(t).html(this._renderMain());return i.insertBefore(this.$element),this._initBrowse(i),this.theme&&i.addClass("theme-"+this.theme),i},_refreshContainer:function(){var e=this.$container;this.$element.insertAfter(e),e.html(this._renderMain()),this._initBrowse(e),this._validateDisabled()},_validateDisabled:function(){this.$caption.attr({readonly:this.isDisabled})},_renderMain:function(){var e=this.dropZoneEnabled?" file-drop-zone":"file-drop-disabled",t=this.showClose?this._getLayoutTemplate("close"):"",i=this.showPreview?this._getLayoutTemplate("preview").setTokens({class:this.previewClass,dropClass:e}):"",a=this.isDisabled?this.captionClass+" file-caption-disabled":this.captionClass,r=this.captionTemplate.setTokens({class:a+" kv-fileinput-caption"});return this.mainTemplate.setTokens({class:this.mainClass+(!this.showBrowse&&this.showCaption?" no-browse":""),preview:i,close:t,caption:r,upload:this._renderButton("upload"),remove:this._renderButton("remove"),cancel:this._renderButton("cancel"),browse:this._renderButton("browse")})},_renderButton:function(e){var i=this._getLayoutTemplate("btnDefault"),a=this[e+"Class"],r=this[e+"Title"],n=this[e+"Icon"],s=this[e+"Label"],o=this.isDisabled?" disabled":"",l="button";switch(e){case"remove":if(!this.showRemove)return"";break;case"cancel":if(!this.showCancel)return"";a+=" kv-hidden";break;case"upload":if(!this.showUpload)return"";this.isAjaxUpload&&!this.isDisabled?i=this._getLayoutTemplate("btnLink").replace("{href}",this.uploadUrl):l="submit";break;case"browse":if(!this.showBrowse)return"";i=this._getLayoutTemplate("btnBrowse");break;default:return""}return a+="browse"===e?" btn-file":" fileinput-"+e+" fileinput-"+e+"-button",t.isEmpty(s)||(s=' <span class="'+this.buttonLabelClass+'">'+s+"</span>"),i.setTokens({type:l,css:a,title:r,status:o,icon:n,label:s})},_renderThumbProgress:function(){return'<div class="file-thumb-progress kv-hidden">'+this.progressTemplate.setTokens({percent:"0",status:this.msgUploadBegin})+"</div>"},_renderFileFooter:function(e,i,a,r){var n,s=this.fileActionSettings,o=s.showRemove,l=s.showDrag,d=s.showUpload,c=s.showZoom,h=this._getLayoutTemplate("footer"),p=this._getLayoutTemplate("indicator"),u=r?s.indicatorError:s.indicatorNew,f=r?s.indicatorErrorTitle:s.indicatorNewTitle,m=p.setTokens({indicator:u,indicatorTitle:f});return i=this._getSize(i),n=this.isAjaxUpload?h.setTokens({actions:this._renderFileActions(d,!1,o,c,l,!1,!1,!1),caption:e,size:i,width:a,progress:this._renderThumbProgress(),indicator:m}):h.setTokens({actions:this._renderFileActions(!1,!1,!1,c,l,!1,!1,!1),caption:e,size:i,width:a,progress:"",indicator:m}),t.replaceTags(n,this.previewThumbTags)},_renderFileActions:function(e,t,i,a,r,n,s,o,l,d,c){if(!(e||t||i||a||r))return"";var h,p=!1===s?"":' data-url="'+s+'"',u=!1===o?"":' data-key="'+o+'"',f="",m="",g="",v="",w="",_=this._getLayoutTemplate("actions"),b=this.fileActionSettings,C=this.otherActionButtons.setTokens({dataKey:u,key:o}),y=n?b.removeClass+" disabled":b.removeClass;return i&&(f=this._getLayoutTemplate("actionDelete").setTokens({removeClass:y,removeIcon:b.removeIcon,removeTitle:b.removeTitle,dataUrl:p,dataKey:u,key:o})),e&&(m=this._getLayoutTemplate("actionUpload").setTokens({uploadClass:b.uploadClass,uploadIcon:b.uploadIcon,uploadTitle:b.uploadTitle})),t&&(g=(g=this._getLayoutTemplate("actionDownload").setTokens({downloadClass:b.downloadClass,downloadIcon:b.downloadIcon,downloadTitle:b.downloadTitle,downloadUrl:d||this.initialPreviewDownloadUrl})).setTokens({filename:c,key:o})),a&&(v=this._getLayoutTemplate("actionZoom").setTokens({zoomClass:b.zoomClass,zoomIcon:b.zoomIcon,zoomTitle:b.zoomTitle})),r&&l&&(h="drag-handle-init "+b.dragClass,w=this._getLayoutTemplate("actionDrag").setTokens({dragClass:h,dragTitle:b.dragTitle,dragIcon:b.dragIcon})),_.setTokens({delete:f,upload:m,download:g,zoom:v,drag:w,other:C})},_browse:function(e){e&&e.isDefaultPrevented()||!this._raise("filebrowse")||(this.isError&&!this.isAjaxUpload&&this.clear(),this.$captionContainer.focus())},_filterDuplicate:function(e,t,i){var a=this._getFileId(e);a&&i&&-1<i.indexOf(a)||(i=i||[],t.push(e),i.push(a))},_change:function(i){var a=this;if(!a.changeTriggered){var r,n,s,o,l,p,u,f,m=a.$element,g=1<arguments.length,v=a.isAjaxUpload,w=[],_=g?arguments[1]:m.get(0).files,b=!v&&t.isEmpty(m.attr("multiple"))?1:a.maxFileCount,C=a.filestack.length,y=t.isEmpty(m.attr("multiple"))&&0<C,x=a._getFileIds();if(a.reader=null,a._resetUpload(),a._hideFileIcon(),a.dropZoneEnabled&&a.$container.find(".file-drop-zone ."+a.dropZoneTitleClass).remove(),v?e.each(_,function(e,t){a._filterDuplicate(t,w,x)}):(_=i.target&&void 0===i.target.files?i.target.value?[{name:i.target.value.replace(/^.+\\/,"")}]:[]:i.target.files||{},w=_),t.isEmpty(w)||0===w.length)return v||a.clear(),void a._raise("fileselectnone");if(a._resetErrors(),n=w.length,r=a._getFileCount(v?a.getFileStack().length+n:n),0<b&&b<r){if(!a.autoReplace||b<n)return s=a.autoReplace&&b<n?n:r,o=b,f=a.msgFilesTooMany.replace("{m}",o).replace("{n}",s),a.isError=(l=f,null,p=e.extend(!0,{},a._getOutData({},{},_),{id:null,index:null}),u={id:null,index:null,file:null,files:_},v?a._showUploadError(l,p):a._showError(l,u)),a.$captionContainer.removeClass("icon-visible"),a._setCaption("",!0),void a.$container.removeClass("file-input-new file-input-ajax-new");b<r&&a._resetPreviewThumbs(v)}else!v||y?(a._resetPreviewThumbs(!1),y&&a.clearStack()):!v||0!==C||a.previewCache.count()&&!a.overwriteInitial||a._resetPreviewThumbs(!0);a.isPreviewable?a.readFiles(w):a._updateFileDetails(1)}},_abort:function(t){var i;return this.ajaxAborted&&"object"==typeof this.ajaxAborted&&void 0!==this.ajaxAborted.message?((i=e.extend(!0,{},this._getOutData(),t)).abortData=this.ajaxAborted.data||{},i.abortMessage=this.ajaxAborted.message,this._setProgress(101,this.$progress,this.msgCancelled),this._showUploadError(this.ajaxAborted.message,i,"filecustomerror"),this.cancel(),!0):!!this.ajaxAborted},_resetFileStack:function(){var i=this,a=0,r=[],n=[],s=[];i._getThumbs().each(function(){var o=e(this),l=o.attr("data-fileindex"),d=i.filestack[l],c=o.attr("id");"-1"!==l&&-1!==l&&(void 0!==d?(r[a]=d,n[a]=i._getFileName(d),s[a]=i._getFileId(d),o.attr({id:i.previewInitId+"-"+a,"data-fileindex":a}),a++):o.attr({id:"uploaded-"+t.uniqId(),"data-fileindex":"-1"}),i.$preview.find("#zoom-"+c).attr({id:"zoom-"+o.attr("id"),"data-fileindex":o.attr("data-fileindex")}))}),i.filestack=r,i.filenames=n,i.fileids=s},_isFileSelectionValid:function(e){return e=e||0,this.required&&!this.getFilesCount()?(this.$errorContainer.html(""),this._showUploadError(this.msgFileRequired),!1):!(0<this.minFileCount&&this._getFileCount(e)<this.minFileCount&&(this._noFilesError({}),1))},clearStack:function(){return this.filestack=[],this.filenames=[],this.fileids=[],this.$element},updateStack:function(e,t){return this.filestack[e]=t,this.filenames[e]=this._getFileName(t),this.fileids[e]=t&&this._getFileId(t)||null,this.$element},addToStack:function(e){return this.filestack.push(e),this.filenames.push(this._getFileName(e)),this.fileids.push(this._getFileId(e)),this.$element},getFileStack:function(e){return this.filestack.filter(function(t){return e?void 0!==t:null!=t})},getFilesCount:function(){var e=this.isAjaxUpload?this.getFileStack().length:this._inputFileCount();return this._getFileCount(e)},readFiles:function(i){this.reader=new FileReader;function y(t,n,s,o){var l,d=e.extend(!0,{},r._getOutData({},{},i),{id:s,index:o}),c={id:s,index:o,file:n,files:i};r._previewDefault(n,s,!0),r.isAjaxUpload?(r.addToStack(void 0),setTimeout(function(){a(o+1)},100)):u=0,r._initFileActions(),(l=e("#"+s)).find(".kv-file-upload").hide(),r.removeFromPreviewOnError&&l.remove(),r.isError=r.isAjaxUpload?r._showUploadError(t,d):r._showError(t,c),r._updateFileDetails(u)}var a,r=this,n=r.$element,s=r.$preview,o=r.reader,l=r.$previewContainer,d=r.$previewStatus,c=r.msgLoading,h=r.msgProgress,p=r.previewInitId,u=i.length,f=r.fileTypeSettings,m=r.filestack.length,g=r.allowedFileTypes,v=g?g.length:0,w=r.allowedFileExtensions,_=t.isEmpty(w)?"":w.join(", "),b=r.maxFilePreviewSize&&parseFloat(r.maxFilePreviewSize),C=s.length&&(!b||isNaN(b));r.loadedImages=[],r.totalImagesCount=0,e.each(i,function(e,t){var i=r.fileTypeSettings.image;i&&i(t.type)&&r.totalImagesCount++}),(a=function(x){if(t.isEmpty(n.attr("multiple"))&&(u=1),u<=x)return r.isAjaxUpload&&0<r.filestack.length?r._raise("filebatchselected",[r.getFileStack()]):r._raise("filebatchselected",[i]),l.removeClass("file-thumb-loading"),void d.html("");function K(){var e=h.setTokens({index:x+1,files:u,percent:50,name:M});setTimeout(function(){d.html(e),r._updateFileDetails(u),a(x+1)},100),r._raise("fileloaded",[B,U,x,o])}var T,E,S,k,F,P,I,A,D,z,$,j,U=p+"-"+(m+x),B=i[x],R=f.text,O=f.image,L=f.html,M=B&&B.name?r.slug(B.name):"",Z=(B&&B.size||0)/1e3,N="",H=B?t.objUrl.createObjectURL(B):null,W=0,q="",V=0;if(B){if(0<v)for(E=0;E<v;E++)P=g[E],I=r.msgFileTypes[P]||P,q+=0===E?I:", "+I;if(!1!==M){if(0===M.length)return S=r.msgInvalidFileName.replace("{name}",t.htmlEncode(B.name,"[unknown]")),void y(S,B,U,x);if(t.isEmpty(w)||(N=new RegExp("\\.("+w.join("|")+")$","i")),T=Z.toFixed(2),0<r.maxFileSize&&Z>r.maxFileSize)return S=r.msgSizeTooLarge.setTokens({name:M,size:T,maxSize:r.maxFileSize}),void y(S,B,U,x);if(null!==r.minFileSize&&Z<=t.getNum(r.minFileSize))return S=r.msgSizeTooSmall.setTokens({name:M,size:T,minSize:r.minFileSize}),void y(S,B,U,x);if(!t.isEmpty(g)&&t.isArray(g)){for(E=0;E<g.length;E+=1)k=g[E],W+=(A=f[k])&&"function"==typeof A&&A(B.type,B.name)?1:0;if(0===W)return S=r.msgInvalidFileType.setTokens({name:M,types:q}),void y(S,B,U,x)}if(0===W&&!t.isEmpty(w)&&t.isArray(w)&&!t.isEmpty(N)&&(F=t.compare(M,N),0===(W+=t.isEmpty(F)?0:F.length)))return S=r.msgInvalidFileExtension.setTokens({name:M,extensions:_}),void y(S,B,U,x);if(!r.showPreview)return r.isAjaxUpload&&r.addToStack(B),setTimeout(function(){a(x+1),r._updateFileDetails(u)},100),void r._raise("fileloaded",[B,U,x,o]);if(!C&&b<Z)return r.addToStack(B),l.addClass("file-thumb-loading"),r._previewDefault(B,U),r._initFileActions(),r._updateFileDetails(u),void a(x+1);s.length&&void 0!==FileReader?(D=R(B.type,M),z=L(B.type,M),$=O(B.type,M),d.html(c.replace("{index}",x+1).replace("{files}",u)),l.addClass("file-thumb-loading"),o.onerror=function(e){r._errorHandler(e,M)},o.onload=function(i){var a,n,s,l,d,c,h,p,u=[];if(n={name:M,type:B.type},e.each(f,function(e,t){"object"!==e&&"other"!==e&&t(B.type,M)&&V++}),0===V){for(s=new Uint8Array(i.target.result),E=0;E<s.length;E++)l=s[E].toString(16),u.push(l);if(a=u.join("").toLowerCase().substring(0,8),c=t.getMimeType(a,"",""),t.isEmpty(c)&&(d=t.arrayBuffer2String(o.result),c=t.isSvg(d)?"image/svg+xml":t.getMimeType(a,d,B.type)),n={name:M,type:c},D=R(c,""),z=L(c,""),$=O(c,""),(j=D||z)||$)return h=j,(p=new FileReader).onerror=function(e){r._errorHandler(e,M)},p.onload=function(e){r._previewFile(x,B,e,U,H,n),r._initFileActions(),K()},void(h?p.readAsText(B,r.textEncoding):p.readAsDataURL(B))}r._previewFile(x,B,i,U,H,n),r._initFileActions(),K()},o.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100,i=Math.ceil(t);S=h.setTokens({index:x+1,files:u,percent:i,name:M}),setTimeout(function(){d.html(S)},100)}},D||z?o.readAsText(B,r.textEncoding):$?o.readAsDataURL(B):o.readAsArrayBuffer(B)):(r._previewDefault(B,U),setTimeout(function(){a(x+1),r._updateFileDetails(u)},100),r._raise("fileloaded",[B,U,x,o])),r.addToStack(B)}else a(x+1)}})(0),r._updateFileDetails(u,!1)},lock:function(){return this._resetErrors(),this.disable(),this.showRemove&&this.$container.find(".fileinput-remove").hide(),this.showCancel&&this.$container.find(".fileinput-cancel").show(),this._raise("filelock",[this.filestack,this._getExtraData()]),this.$element},unlock:function(e){return void 0===e&&(e=!0),this.enable(),this.showCancel&&this.$container.find(".fileinput-cancel").hide(),this.showRemove&&this.$container.find(".fileinput-remove").show(),e&&this._resetFileStack(),this._raise("fileunlock",[this.filestack,this._getExtraData()]),this.$element},cancel:function(){var t,i=this,a=i.ajaxRequests,r=a.length;if(0<r)for(t=0;t<r;t+=1)i.cancelling=!0,a[t].abort();return i._setProgressCancelled(),i._getThumbs().each(function(){var t=e(this),a=t.attr("data-fileindex");t.removeClass("file-uploading"),void 0!==i.filestack[a]&&(t.find(".kv-file-upload").removeClass("disabled").removeAttr("disabled"),t.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled")),i.unlock()}),i.$element},clear:function(){var i,a=this;if(a._raise("fileclear"))return a.$btnUpload.removeAttr("disabled"),a._getThumbs().find("video,audio,img").each(function(){t.cleanMemory(e(this))}),a._clearFileInput(),a._resetUpload(),a.clearStack(),a._resetErrors(!0),a._hasInitialPreview()?(a._showFileIcon(),a._resetPreview(),a._initPreviewActions(),a.$container.removeClass("file-input-new")):(a._getThumbs().each(function(){a._clearObjects(e(this))}),a.isAjaxUpload&&(a.previewCache.data={}),a.$preview.html(""),i=!a.overwriteInitial&&0<a.initialCaption.length?a.initialCaption:"",a.$caption.attr("title","").val(i),t.addCss(a.$container,"file-input-new"),a._validateDefaultPreview()),0===a.$container.find(t.FRAMES).length&&(a._initCaption()||a.$captionContainer.removeClass("icon-visible")),a._hideFileIcon(),a._raise("filecleared"),a.$captionContainer.focus(),a._setFileDropZoneTitle(),a.$element},reset:function(){if(this._raise("filereset"))return this._resetPreview(),this.$container.find(".fileinput-filename").text(""),t.addCss(this.$container,"file-input-new"),(this.getFrames().length||this.dropZoneEnabled)&&this.$container.removeClass("file-input-new"),this.clearStack(),this.formdata={},this._setFileDropZoneTitle(),this.$element},disable:function(){return this.isDisabled=!0,this._raise("filedisabled"),this.$element.attr("disabled","disabled"),this.$container.find(".kv-fileinput-caption").addClass("file-caption-disabled"),this.$container.find(".fileinput-remove, .fileinput-upload, .file-preview-frame button").attr("disabled",!0),t.addCss(this.$container.find(".btn-file"),"disabled"),this._initDragDrop(),this.$element},enable:function(){return this.isDisabled=!1,this._raise("fileenabled"),this.$element.removeAttr("disabled"),this.$container.find(".kv-fileinput-caption").removeClass("file-caption-disabled"),this.$container.find(".fileinput-remove, .fileinput-upload, .file-preview-frame button").removeAttr("disabled"),this.$container.find(".btn-file").removeClass("disabled"),this._initDragDrop(),this.$element},upload:function(){var i,a,r,n=this.getFileStack().length,s=!e.isEmptyObject(this._getExtraData());if(this.isAjaxUpload&&!this.isDisabled&&this._isFileSelectionValid(n))if(this._resetUpload(),0!==n||s)if(this.$progress.show(),this.uploadCount=0,this.uploadStatus={},this.uploadLog=[],this.lock(),this._setProgress(2),0===n&&s)this._uploadExtraOnly();else{if(r=this.filestack.length,this.hasInitData=!1,!this.uploadAsync)return this._uploadBatch(),this.$element;for(a=this._getOutData(),this._raise("filebatchpreupload",[a]),this.fileBatchCompleted=!1,this.uploadCache={content:[],config:[],tags:[],append:!0},this.uploadAsyncCount=this.getFileStack().length,i=0;i<r;i++)this.uploadCache.content[i]=null,this.uploadCache.config[i]=null,this.uploadCache.tags[i]=null;for(this.$preview.find(".file-preview-initial").removeClass(t.SORT_CSS),this._initSortable(),this.cacheInitialPreview=this.getPreview(),i=0;i<r;i++)this.filestack[i]&&this._uploadSingle(i,!0)}else this._showUploadError(this.msgUploadEmpty)},destroy:function(){var t=this.$form,i=this.$container,a=this.$element,r=this.namespace;return e(document).off(r),e(window).off(r),t&&t.length&&t.off(r),this.isAjaxUpload&&this._clearFileInput(),this._cleanup(),this._initPreviewCache(),a.insertBefore(i).off(r).removeData(),i.off().remove(),a},refresh:function(i){var a=this.$element;return i="object"!=typeof i||t.isEmpty(i)?this.options:e.extend(!0,{},this.options,i),this._init(i,!0),this._listen(),a},zoom:function(e){var i=this._getFrame(e),a=this.$modal;i&&(t.initModal(a),a.html(this._getModalContent()),this._setZoomContent(i),a.modal("show"),this._initZoomButtons())},getExif:function(e){var t=this._getFrame(e);return t&&t.data("exif")||null},getFrames:function(i){var a;return i=i||"",a=this.$preview.find(t.FRAMES+i),this.reversePreviewOrder&&(a=e(a.get().reverse())),a},getPreview:function(){return{content:this.initialPreview,config:this.initialPreviewConfig,tags:this.initialPreviewThumbTags}}},e.fn.fileinput=function(a){if(t.hasFileAPISupport()||t.isIE(9)){var r=Array.apply(null,arguments),n=[];switch(r.shift(),this.each(function(){var s,o=e(this),l=o.data("fileinput"),d="object"==typeof a&&a,c=d.theme||o.data("theme"),h={},p={},u=d.language||o.data("language")||e.fn.fileinput.defaults.language||"en";l||(c&&(p=e.fn.fileinputThemes[c]||{}),"en"===u||t.isEmpty(e.fn.fileinputLocales[u])||(h=e.fn.fileinputLocales[u]||{}),s=e.extend(!0,{},e.fn.fileinput.defaults,p,e.fn.fileinputLocales.en,h,d,o.data()),l=new i(this,s),o.data("fileinput",l)),"string"==typeof a&&n.push(l[a].apply(l,r))}),n.length){case 0:return this;case 1:return n[0];default:return n}}},e.fn.fileinput.defaults={language:"en",showCaption:!0,showBrowse:!0,showPreview:!0,showRemove:!0,showUpload:!0,showCancel:!0,showClose:!0,showUploadedThumbs:!0,browseOnZoneClick:!1,autoReplace:!1,autoOrientImage:!1,required:!1,rtl:!1,hideThumbnailContent:!1,generateFileId:null,previewClass:"",captionClass:"",frameClass:"krajee-default",mainClass:"file-caption-main",mainTemplate:null,purifyHtml:!0,fileSizeGetter:null,initialCaption:"",initialPreview:[],initialPreviewDelimiter:"*$$*",initialPreviewAsData:!1,initialPreviewFileType:"image",initialPreviewConfig:[],initialPreviewThumbTags:[],previewThumbTags:{},initialPreviewShowDelete:!0,initialPreviewDownloadUrl:"",removeFromPreviewOnError:!1,deleteUrl:"",deleteExtraData:{},overwriteInitial:!0,previewZoomButtonIcons:{prev:'<i class="glyphicon glyphicon-triangle-left"></i>',next:'<i class="glyphicon glyphicon-triangle-right"></i>',toggleheader:'<i class="glyphicon glyphicon-resize-vertical"></i>',fullscreen:'<i class="glyphicon glyphicon-fullscreen"></i>',borderless:'<i class="glyphicon glyphicon-resize-full"></i>',close:'<i class="glyphicon glyphicon-remove"></i>'},previewZoomButtonClasses:{prev:"btn btn-navigate",next:"btn btn-navigate",toggleheader:"btn btn-sm btn-kv btn-default btn-outline-secondary",fullscreen:"btn btn-sm btn-kv btn-default btn-outline-secondary",borderless:"btn btn-sm btn-kv btn-default btn-outline-secondary",close:"btn btn-sm btn-kv btn-default btn-outline-secondary"},previewTemplates:{},previewContentTemplates:{},preferIconicPreview:!1,preferIconicZoomPreview:!1,allowedPreviewTypes:void 0,allowedPreviewMimeTypes:null,allowedFileTypes:null,allowedFileExtensions:null,defaultPreviewContent:null,customLayoutTags:{},customPreviewTags:{},previewFileIcon:'<i class="glyphicon glyphicon-file"></i>',previewFileIconClass:"file-other-icon",previewFileIconSettings:{},previewFileExtSettings:{},buttonLabelClass:"hidden-xs",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i>&nbsp;',browseClass:"btn btn-primary",removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-default btn-secondary",cancelIcon:'<i class="glyphicon glyphicon-ban-circle"></i>',cancelClass:"btn btn-default btn-secondary",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-default btn-secondary",uploadUrl:null,uploadUrlThumb:null,uploadAsync:!0,uploadExtraData:{},zoomModalHeight:480,minImageWidth:null,minImageHeight:null,maxImageWidth:null,maxImageHeight:null,resizeImage:!1,resizePreference:"width",resizeQuality:.92,resizeDefaultImageType:"image/jpeg",resizeIfSizeMoreThan:0,minFileSize:0,maxFileSize:0,maxFilePreviewSize:25600,minFileCount:0,maxFileCount:0,validateInitialCount:!1,msgValidationErrorClass:"text-danger",msgValidationErrorIcon:'<i class="glyphicon glyphicon-exclamation-sign"></i> ',msgErrorClass:"file-error-message",progressThumbClass:"progress-bar bg-success progress-bar-success progress-bar-striped active",progressClass:"progress-bar bg-success progress-bar-success progress-bar-striped active",progressCompleteClass:"progress-bar bg-success progress-bar-success",progressErrorClass:"progress-bar bg-danger progress-bar-danger",progressUploadThreshold:99,previewFileType:"image",elCaptionContainer:null,elCaptionText:null,elPreviewContainer:null,elPreviewImage:null,elPreviewStatus:null,elErrorContainer:null,errorCloseButton:t.closeButton("kv-error-close"),slugCallback:null,dropZoneEnabled:!0,dropZoneTitleClass:"file-drop-zone-title",fileActionSettings:{},otherActionButtons:"",textEncoding:"UTF-8",ajaxSettings:{},ajaxDeleteSettings:{},showAjaxErrorDetails:!0,mergeAjaxCallbacks:!1,mergeAjaxDeleteCallbacks:!1,retryErrorUploads:!0,reversePreviewOrder:!1},e.fn.fileinputLocales.en={fileSingle:"file",filePlural:"files",browseLabel:"Browse &hellip;",removeLabel:"Remove",removeTitle:"Clear selected files",cancelLabel:"Cancel",cancelTitle:"Abort ongoing upload",uploadLabel:"Upload",uploadTitle:"Upload selected files",msgNo:"No",msgNoFilesSelected:"No files selected",msgCancelled:"Cancelled",msgPlaceholder:"Select {files}...",msgZoomModalHeading:"Detailed Preview",msgFileRequired:"You must select a file to upload.",msgSizeTooSmall:'File "{name}" (<b>{size} KB</b>) is too small and must be larger than <b>{minSize} KB</b>.',msgSizeTooLarge:'File "{name}" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',msgFilesTooLess:"You must select at least <b>{n}</b> {files} to upload.",msgFilesTooMany:"Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.",msgFileNotFound:'File "{name}" not found!',msgFileSecured:'Security restrictions prevent reading the file "{name}".',msgFileNotReadable:'File "{name}" is not readable.',msgFilePreviewAborted:'File preview aborted for "{name}".',msgFilePreviewError:'An error occurred while reading the file "{name}".',msgInvalidFileName:'Invalid or unsupported characters in file name "{name}".',msgInvalidFileType:'Invalid type for file "{name}". Only "{types}" files are supported.',msgInvalidFileExtension:'Invalid extension for file "{name}". Only "{extensions}" files are supported.',msgFileTypes:{image:"image",html:"HTML",text:"text",video:"video",audio:"audio",flash:"flash",pdf:"PDF",object:"object"},msgUploadAborted:"The file upload was aborted",msgUploadThreshold:"Processing...",msgUploadBegin:"Initializing...",msgUploadEnd:"Done",msgUploadEmpty:"No valid data available for upload.",msgUploadError:"Error",msgValidationError:"Validation Error",msgLoading:"Loading file {index} of {files} &hellip;",msgProgress:"Loading file {index} of {files} - {name} - {percent}% completed.",msgSelected:"{n} {files} selected",msgFoldersNotAllowed:"Drag & drop files only! {n} folder(s) dropped were skipped.",msgImageWidthSmall:'Width of image file "{name}" must be at least {size} px.',msgImageHeightSmall:'Height of image file "{name}" must be at least {size} px.',msgImageWidthLarge:'Width of image file "{name}" cannot exceed {size} px.',msgImageHeightLarge:'Height of image file "{name}" cannot exceed {size} px.',msgImageResizeError:"Could not get the image dimensions to resize.",msgImageResizeException:"Error while resizing the image.<pre>{errors}</pre>",msgAjaxError:"Something went wrong with the {operation} operation. Please try again later!",msgAjaxProgressError:"{operation} failed",ajaxOperations:{deleteThumb:"file delete",uploadThumb:"file upload",uploadBatch:"batch file upload",uploadExtra:"form data upload"},dropZoneTitle:"Drag & drop files here &hellip;",dropZoneClickTitle:"<br>(or click to select {files})",previewZoomButtonTitles:{prev:"View previous file",next:"View next file",toggleheader:"Toggle header",fullscreen:"Toggle full screen",borderless:"Toggle borderless mode",close:"Close detailed preview"},usePdfRenderer:function(){return!!navigator.userAgent.match(/(iPod|iPhone|iPad|Android)/i)},pdfRendererUrl:"",pdfRendererTemplate:'<iframe class="kv-preview-data file-preview-pdf" src="{renderer}?file={data}" {style}></iframe>'},e.fn.fileinput.Constructor=i,e(document).ready(function(){var t=e("input.file[type=file]");t.length&&t.fileinput()})}),function($){"use strict";var defaultOptions={tagClass:function(item){return"label label-info"},focusClass:"focus",itemValue:function(item){return item?item.toString():item},itemText:function(item){return this.itemValue(item)},itemTitle:function(item){return null},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],delimiter:",",delimiterRegex:null,cancelConfirmKeysOnEmpty:!1,onTagExists:function(item,$tag){$tag.hide().fadeIn()},trimValue:!1,allowDuplicates:!1,triggerChange:!0};function TagsInput(element,options){this.isInit=!0,this.itemsArray=[],this.$element=$(element),this.$element.hide(),this.isSelect="SELECT"===element.tagName,this.multiple=this.isSelect&&element.hasAttribute("multiple"),this.objectItems=options&&options.itemValue,this.placeholderText=element.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=$('<div class="bootstrap-tagsinput"></div>'),this.$input=$('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.before(this.$container),this.build(options),this.isInit=!1}function makeOptionItemFunction(options,key){if("function"!=typeof options[key]){var propertyName=options[key];options[key]=function(item){return item[propertyName]}}}function makeOptionFunction(options,key){if("function"!=typeof options[key]){var value=options[key];options[key]=function(){return value}}}TagsInput.prototype={constructor:TagsInput,add:function(item,dontPushVal,options){var self=this;if(!(self.options.maxTags&&self.itemsArray.length>=self.options.maxTags)&&(!1===item||item)){if("string"==typeof item&&self.options.trimValue&&(item=$.trim(item)),"object"==typeof item&&!self.objectItems)throw"Can't add objects when itemValue option is not set";if(!item.toString().match(/^\s*$/)){if(self.isSelect&&!self.multiple&&0<self.itemsArray.length&&self.remove(self.itemsArray[0]),"string"==typeof item&&"INPUT"===this.$element[0].tagName){var delimiter=self.options.delimiterRegex?self.options.delimiterRegex:self.options.delimiter,items=item.split(delimiter);if(1<items.length){for(var i=0;i<items.length;i++)this.add(items[i],!0);return void(dontPushVal||self.pushVal(self.options.triggerChange))}}var itemValue=self.options.itemValue(item),itemText=self.options.itemText(item),tagClass=self.options.tagClass(item),itemTitle=self.options.itemTitle(item),existing=$.grep(self.itemsArray,function(item){return self.options.itemValue(item)===itemValue})[0];if(!existing||self.options.allowDuplicates){if(!(self.items().toString().length+item.length+1>self.options.maxInputLength)){var beforeItemAddEvent=$.Event("beforeItemAdd",{item:item,cancel:!1,options:options});if(self.$element.trigger(beforeItemAddEvent),!beforeItemAddEvent.cancel){self.itemsArray.push(item);var $tag=$('<span class="tag '+htmlEncode(tagClass)+(null!==itemTitle?'" title="'+itemTitle:"")+'">'+htmlEncode(itemText)+'<span data-role="remove"></span></span>');$tag.data("item",item),self.findInputWrapper().before($tag),$tag.after(" ");var optionExists=$('option[value="'+encodeURIComponent(itemValue)+'"]',self.$element).length||$('option[value="'+htmlEncode(itemValue)+'"]',self.$element).length;if(self.isSelect&&!optionExists){var $option=$("<option selected>"+htmlEncode(itemText)+"</option>");$option.data("item",item),$option.attr("value",itemValue),self.$element.append($option)}dontPushVal||self.pushVal(self.options.triggerChange),self.options.maxTags!==self.itemsArray.length&&self.items().toString().length!==self.options.maxInputLength||self.$container.addClass("bootstrap-tagsinput-max"),$(".typeahead, .twitter-typeahead",self.$container).length&&self.$input.typeahead("val",""),this.isInit?self.$element.trigger($.Event("itemAddedOnInit",{item:item,options:options})):self.$element.trigger($.Event("itemAdded",{item:item,options:options}))}}}else if(self.options.onTagExists){var $existingTag=$(".tag",self.$container).filter(function(){return $(this).data("item")===existing});self.options.onTagExists(item,$existingTag)}}}},remove:function(item,dontPushVal,options){var self=this;if(self.objectItems&&(item=(item="object"==typeof item?$.grep(self.itemsArray,function(other){return self.options.itemValue(other)==self.options.itemValue(item)}):$.grep(self.itemsArray,function(other){return self.options.itemValue(other)==item}))[item.length-1]),item){var beforeItemRemoveEvent=$.Event("beforeItemRemove",{item:item,cancel:!1,options:options});if(self.$element.trigger(beforeItemRemoveEvent),beforeItemRemoveEvent.cancel)return;$(".tag",self.$container).filter(function(){return $(this).data("item")===item}).remove(),$("option",self.$element).filter(function(){return $(this).data("item")===item}).remove(),-1!==$.inArray(item,self.itemsArray)&&self.itemsArray.splice($.inArray(item,self.itemsArray),1)}dontPushVal||self.pushVal(self.options.triggerChange),self.options.maxTags>self.itemsArray.length&&self.$container.removeClass("bootstrap-tagsinput-max"),self.$element.trigger($.Event("itemRemoved",{item:item,options:options}))},removeAll:function(){for($(".tag",this.$container).remove(),$("option",this.$element).remove();0<this.itemsArray.length;)this.itemsArray.pop();this.pushVal(this.options.triggerChange)},refresh:function(){var self=this;$(".tag",self.$container).each(function(){var $tag=$(this),item=$tag.data("item"),itemValue=self.options.itemValue(item),itemText=self.options.itemText(item),tagClass=self.options.tagClass(item);$tag.attr("class",null),$tag.addClass("tag "+htmlEncode(tagClass)),$tag.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=htmlEncode(itemText),self.isSelect&&$("option",self.$element).filter(function(){return $(this).data("item")===item}).attr("value",itemValue)})},items:function(){return this.itemsArray},pushVal:function(){var self=this,val=$.map(self.items(),function(item){return self.options.itemValue(item).toString()});self.$element.val(val,!0),self.options.triggerChange&&self.$element.trigger("change")},build:function(options){var self=this;if(self.options=$.extend({},defaultOptions,options),self.objectItems&&(self.options.freeInput=!1),makeOptionItemFunction(self.options,"itemValue"),makeOptionItemFunction(self.options,"itemText"),makeOptionFunction(self.options,"tagClass"),self.options.typeahead){var typeahead=self.options.typeahead||{};makeOptionFunction(typeahead,"source"),self.$input.typeahead($.extend({},typeahead,{source:function(query,process){function processItems(items){for(var texts=[],i=0;i<items.length;i++){var text=self.options.itemText(items[i]);map[text]=items[i],texts.push(text)}process(texts)}this.map={};var map=this.map,data=typeahead.source(query);$.isFunction(data.success)?data.success(processItems):$.isFunction(data.then)?data.then(processItems):$.when(data).then(processItems)},updater:function(text){return self.add(this.map[text]),this.map[text]},matcher:function(text){return-1!==text.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(texts){return texts.sort()},highlighter:function(text){var regex=new RegExp("("+this.query+")","gi");return text.replace(regex,"<strong>$1</strong>")}}))}if(self.options.typeaheadjs){var typeaheadConfig=null,typeaheadDatasets={},typeaheadjs=self.options.typeaheadjs;typeaheadDatasets=$.isArray(typeaheadjs)?(typeaheadConfig=typeaheadjs[0],typeaheadjs[1]):typeaheadjs,self.$input.typeahead(typeaheadConfig,typeaheadDatasets).on("typeahead:selected",$.proxy(function(obj,datum){typeaheadDatasets.valueKey?self.add(datum[typeaheadDatasets.valueKey]):self.add(datum),self.$input.typeahead("val","")},self))}self.$container.on("click",$.proxy(function(event){self.$element.attr("disabled")||self.$input.removeAttr("disabled"),self.$input.focus()},self)),self.options.addOnBlur&&self.options.freeInput&&self.$input.on("focusout",$.proxy(function(event){0===$(".typeahead, .twitter-typeahead",self.$container).length&&(self.add(self.$input.val()),self.$input.val(""))},self)),self.$container.on({focusin:function(){self.$container.addClass(self.options.focusClass)},focusout:function(){self.$container.removeClass(self.options.focusClass)}}),self.$container.on("keydown","input",$.proxy(function(event){var $input=$(event.target),$inputWrapper=self.findInputWrapper();if(self.$element.attr("disabled"))self.$input.attr("disabled","disabled");else{switch(event.which){case 8:if(0===doGetCaretPosition($input[0])){var prev=$inputWrapper.prev();prev.length&&self.remove(prev.data("item"))}break;case 46:if(0===doGetCaretPosition($input[0])){var next=$inputWrapper.next();next.length&&self.remove(next.data("item"))}break;case 37:var $prevTag=$inputWrapper.prev();0===$input.val().length&&$prevTag[0]&&($prevTag.before($inputWrapper),$input.focus());break;case 39:var $nextTag=$inputWrapper.next();0===$input.val().length&&$nextTag[0]&&($nextTag.after($inputWrapper),$input.focus())}var textLength=$input.val().length;Math.ceil(textLength/5);$input.attr("size",Math.max(this.inputSize,$input.val().length))}},self)),self.$container.on("keypress","input",$.proxy(function(event){var $input=$(event.target);if(self.$element.attr("disabled"))self.$input.attr("disabled","disabled");else{var text=$input.val(),maxLengthReached=self.options.maxChars&&text.length>=self.options.maxChars;self.options.freeInput&&(function(keyPressEvent,lookupList){var found=!1;return $.each(lookupList,function(index,keyCombination){if("number"==typeof keyCombination&&keyPressEvent.which===keyCombination)return!(found=!0);if(keyPressEvent.which===keyCombination.which){var alt=!keyCombination.hasOwnProperty("altKey")||keyPressEvent.altKey===keyCombination.altKey,shift=!keyCombination.hasOwnProperty("shiftKey")||keyPressEvent.shiftKey===keyCombination.shiftKey,ctrl=!keyCombination.hasOwnProperty("ctrlKey")||keyPressEvent.ctrlKey===keyCombination.ctrlKey;if(alt&&shift&&ctrl)return!(found=!0)}}),found}(event,self.options.confirmKeys)||maxLengthReached)&&(0!==text.length&&(self.add(maxLengthReached?text.substr(0,self.options.maxChars):text),$input.val("")),!1===self.options.cancelConfirmKeysOnEmpty&&event.preventDefault());var textLength=$input.val().length;Math.ceil(textLength/5);$input.attr("size",Math.max(this.inputSize,$input.val().length))}},self)),self.$container.on("click","[data-role=remove]",$.proxy(function(event){self.$element.attr("disabled")||self.remove($(event.target).closest(".tag").data("item"))},self)),self.options.itemValue===defaultOptions.itemValue&&("INPUT"===self.$element[0].tagName?self.add(self.$element.val()):$("option",self.$element).each(function(){self.add($(this).attr("value"),!0)}))},destroy:function(){this.$container.off("keypress","input"),this.$container.off("click","[role=remove]"),this.$container.remove(),this.$element.removeData("tagsinput"),this.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var elt=this.$input[0],container=this.$container[0];elt&&elt.parentNode!==container;)elt=elt.parentNode;return $(elt)}},$.fn.tagsinput=function(arg1,arg2,arg3){var results=[];return this.each(function(){var tagsinput=$(this).data("tagsinput");if(tagsinput)if(arg1||arg2){if(void 0!==tagsinput[arg1]){if(3===tagsinput[arg1].length&&void 0!==arg3)var retVal=tagsinput[arg1](arg2,null,arg3);else retVal=tagsinput[arg1](arg2);void 0!==retVal&&results.push(retVal)}}else results.push(tagsinput);else tagsinput=new TagsInput(this,arg1),$(this).data("tagsinput",tagsinput),results.push(tagsinput),"SELECT"===this.tagName&&$("option",$(this)).attr("selected","selected"),$(this).val($(this).val())}),"string"==typeof arg1?1<results.length?results:results[0]:results},$.fn.tagsinput.Constructor=TagsInput;var htmlEncodeContainer=$("<div />");function htmlEncode(value){return value?htmlEncodeContainer.text(value).html():""}function doGetCaretPosition(oField){var iCaretPos=0;if(document.selection){oField.focus();var oSel=document.selection.createRange();oSel.moveStart("character",-oField.value.length),iCaretPos=oSel.text.length}else!oField.selectionStart&&"0"!=oField.selectionStart||(iCaretPos=oField.selectionStart);return iCaretPos}$(function(){$("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})}(window.jQuery),function(){if(null==twttr)var twttr={};twttr.txt={},twttr.txt.regexen={};var HTML_ENTITIES={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};function regexSupplant(regex,flags){return flags=flags||"","string"!=typeof regex&&(regex.global&&flags.indexOf("g")<0&&(flags+="g"),regex.ignoreCase&&flags.indexOf("i")<0&&(flags+="i"),regex.multiline&&flags.indexOf("m")<0&&(flags+="m"),regex=regex.source),new RegExp(regex.replace(/#\{(\w+)\}/g,function(match,name){var newRegex=twttr.txt.regexen[name]||"";return"string"!=typeof newRegex&&(newRegex=newRegex.source),newRegex}),flags)}function stringSupplant(str,values){return str.replace(/#\{(\w+)\}/g,function(match,name){return values[name]||""})}twttr.txt.htmlEscape=function(text){return text&&text.replace(/[&"'><]/g,function(character){return HTML_ENTITIES[character]})},twttr.txt.regexSupplant=regexSupplant,twttr.txt.stringSupplant=stringSupplant,twttr.txt.regexen.spaces_group=/\x09-\x0D\x20\x85\xA0\u1680\u180E\u2000-\u200A\u2028\u2029\u202F\u205F\u3000/,twttr.txt.regexen.spaces=regexSupplant(/[#{spaces_group}]/),twttr.txt.regexen.invalid_chars_group=/\uFFFE\uFEFF\uFFFF\u202A-\u202E/,twttr.txt.regexen.invalid_chars=regexSupplant(/[#{invalid_chars_group}]/),twttr.txt.regexen.punct=/\!'#%&'\(\)*\+,\\\-\.\/:;<=>\?@\[\]\^_{|}~\$/,twttr.txt.regexen.rtl_chars=/[\u0600-\u06FF]|[\u0750-\u077F]|[\u0590-\u05FF]|[\uFE70-\uFEFF]/gm,twttr.txt.regexen.non_bmp_code_pairs=/[\uD800-\uDBFF][\uDC00-\uDFFF]/gm,twttr.txt.regexen.latinAccentChars=/\xC0-\xD6\xD8-\xF6\xF8-\xFF\u0100-\u024F\u0253\u0254\u0256\u0257\u0259\u025B\u0263\u0268\u026F\u0272\u0289\u028B\u02BB\u0300-\u036F\u1E00-\u1EFF/,twttr.txt.regexen.bmpLetterAndMarks=/A-Za-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u065f\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06ef\u06fa-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07ca-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09f0\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a70-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u103f\u1050-\u108f\u109a-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16f1-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u180b-\u180d\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f\u1aa7\u1ab0-\u1abe\u1b00-\u1b4b\u1b6b-\u1b73\u1b80-\u1baf\u1bba-\u1bf3\u1c00-\u1c37\u1c4d-\u1c4f\u1c5a-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u20d0-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2183\u2184\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005\u3006\u302a-\u302f\u3031-\u3035\u303b\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua672\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6e5\ua6f0\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8e0-\ua8f7\ua8fb\ua90a-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf\ua9e0-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf870-\uf87f\uf882\uf884-\uf89f\uf8b8\uf8c1-\uf8d6\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc/,twttr.txt.regexen.astralLetterAndMarks=/\ud800[\udc00-\udc0b\udc0d-\udc26\udc28-\udc3a\udc3c\udc3d\udc3f-\udc4d\udc50-\udc5d\udc80-\udcfa\uddfd\ude80-\ude9c\udea0-\uded0\udee0\udf00-\udf1f\udf30-\udf40\udf42-\udf49\udf50-\udf7a\udf80-\udf9d\udfa0-\udfc3\udfc8-\udfcf]|\ud801[\udc00-\udc9d\udd00-\udd27\udd30-\udd63\ude00-\udf36\udf40-\udf55\udf60-\udf67]|\ud802[\udc00-\udc05\udc08\udc0a-\udc35\udc37\udc38\udc3c\udc3f-\udc55\udc60-\udc76\udc80-\udc9e\udd00-\udd15\udd20-\udd39\udd80-\uddb7\uddbe\uddbf\ude00-\ude03\ude05\ude06\ude0c-\ude13\ude15-\ude17\ude19-\ude33\ude38-\ude3a\ude3f\ude60-\ude7c\ude80-\ude9c\udec0-\udec7\udec9-\udee6\udf00-\udf35\udf40-\udf55\udf60-\udf72\udf80-\udf91]|\ud803[\udc00-\udc48]|\ud804[\udc00-\udc46\udc7f-\udcba\udcd0-\udce8\udd00-\udd34\udd50-\udd73\udd76\udd80-\uddc4\uddda\ude00-\ude11\ude13-\ude37\udeb0-\udeea\udf01-\udf03\udf05-\udf0c\udf0f\udf10\udf13-\udf28\udf2a-\udf30\udf32\udf33\udf35-\udf39\udf3c-\udf44\udf47\udf48\udf4b-\udf4d\udf57\udf5d-\udf63\udf66-\udf6c\udf70-\udf74]|\ud805[\udc80-\udcc5\udcc7\udd80-\uddb5\uddb8-\uddc0\ude00-\ude40\ude44\ude80-\udeb7]|\ud806[\udca0-\udcdf\udcff\udec0-\udef8]|\ud808[\udc00-\udf98]|\ud80c[\udc00-\udfff]|\ud80d[\udc00-\udc2e]|\ud81a[\udc00-\ude38\ude40-\ude5e\uded0-\udeed\udef0-\udef4\udf00-\udf36\udf40-\udf43\udf63-\udf77\udf7d-\udf8f]|\ud81b[\udf00-\udf44\udf50-\udf7e\udf8f-\udf9f]|\ud82c[\udc00\udc01]|\ud82f[\udc00-\udc6a\udc70-\udc7c\udc80-\udc88\udc90-\udc99\udc9d\udc9e]|\ud834[\udd65-\udd69\udd6d-\udd72\udd7b-\udd82\udd85-\udd8b\uddaa-\uddad\ude42-\ude44]|\ud835[\udc00-\udc54\udc56-\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd1e-\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd52-\udea5\udea8-\udec0\udec2-\udeda\udedc-\udefa\udefc-\udf14\udf16-\udf34\udf36-\udf4e\udf50-\udf6e\udf70-\udf88\udf8a-\udfa8\udfaa-\udfc2\udfc4-\udfcb]|\ud83a[\udc00-\udcc4\udcd0-\udcd6]|\ud83b[\ude00-\ude03\ude05-\ude1f\ude21\ude22\ude24\ude27\ude29-\ude32\ude34-\ude37\ude39\ude3b\ude42\ude47\ude49\ude4b\ude4d-\ude4f\ude51\ude52\ude54\ude57\ude59\ude5b\ude5d\ude5f\ude61\ude62\ude64\ude67-\ude6a\ude6c-\ude72\ude74-\ude77\ude79-\ude7c\ude7e\ude80-\ude89\ude8b-\ude9b\udea1-\udea3\udea5-\udea9\udeab-\udebb]|\ud840[\udc00-\udfff]|\ud841[\udc00-\udfff]|\ud842[\udc00-\udfff]|\ud843[\udc00-\udfff]|\ud844[\udc00-\udfff]|\ud845[\udc00-\udfff]|\ud846[\udc00-\udfff]|\ud847[\udc00-\udfff]|\ud848[\udc00-\udfff]|\ud849[\udc00-\udfff]|\ud84a[\udc00-\udfff]|\ud84b[\udc00-\udfff]|\ud84c[\udc00-\udfff]|\ud84d[\udc00-\udfff]|\ud84e[\udc00-\udfff]|\ud84f[\udc00-\udfff]|\ud850[\udc00-\udfff]|\ud851[\udc00-\udfff]|\ud852[\udc00-\udfff]|\ud853[\udc00-\udfff]|\ud854[\udc00-\udfff]|\ud855[\udc00-\udfff]|\ud856[\udc00-\udfff]|\ud857[\udc00-\udfff]|\ud858[\udc00-\udfff]|\ud859[\udc00-\udfff]|\ud85a[\udc00-\udfff]|\ud85b[\udc00-\udfff]|\ud85c[\udc00-\udfff]|\ud85d[\udc00-\udfff]|\ud85e[\udc00-\udfff]|\ud85f[\udc00-\udfff]|\ud860[\udc00-\udfff]|\ud861[\udc00-\udfff]|\ud862[\udc00-\udfff]|\ud863[\udc00-\udfff]|\ud864[\udc00-\udfff]|\ud865[\udc00-\udfff]|\ud866[\udc00-\udfff]|\ud867[\udc00-\udfff]|\ud868[\udc00-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|\ud86a[\udc00-\udfff]|\ud86b[\udc00-\udfff]|\ud86c[\udc00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d]|\ud87e[\udc00-\ude1d]|\udb40[\udd00-\uddef]/,twttr.txt.regexen.bmpNumerals=/0-9\u0660-\u0669\u06f0-\u06f9\u07c0-\u07c9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0de6-\u0def\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\u1946-\u194f\u19d0-\u19d9\u1a80-\u1a89\u1a90-\u1a99\u1b50-\u1b59\u1bb0-\u1bb9\u1c40-\u1c49\u1c50-\u1c59\ua620-\ua629\ua8d0-\ua8d9\ua900-\ua909\ua9d0-\ua9d9\ua9f0-\ua9f9\uaa50-\uaa59\uabf0-\uabf9\uff10-\uff19/,twttr.txt.regexen.astralNumerals=/\ud801[\udca0-\udca9]|\ud804[\udc66-\udc6f\udcf0-\udcf9\udd36-\udd3f\uddd0-\uddd9\udef0-\udef9]|\ud805[\udcd0-\udcd9\ude50-\ude59\udec0-\udec9]|\ud806[\udce0-\udce9]|\ud81a[\ude60-\ude69\udf50-\udf59]|\ud835[\udfce-\udfff]/,twttr.txt.regexen.hashtagSpecialChars=/_\u200c\u200d\ua67e\u05be\u05f3\u05f4\uff5e\u301c\u309b\u309c\u30a0\u30fb\u3003\u0f0b\u0f0c\xb7/,twttr.txt.regexen.hashSigns=/[#]/,twttr.txt.regexen.hashtagAlpha=regexSupplant(/(?:[#{bmpLetterAndMarks}]|(?=#{non_bmp_code_pairs})(?:#{astralLetterAndMarks}))/),twttr.txt.regexen.hashtagAlphaNumeric=regexSupplant(/(?:[#{bmpLetterAndMarks}#{bmpNumerals}#{hashtagSpecialChars}]|(?=#{non_bmp_code_pairs})(?:#{astralLetterAndMarks}|#{astralNumerals}))/),twttr.txt.regexen.endHashtagMatch=regexSupplant(/^(?:#{hashSigns}|:\/\/)/),twttr.txt.regexen.codePoint=/(?:[^\uD800-\uDFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF])/,twttr.txt.regexen.hashtagBoundary=regexSupplant(/(?:^|\uFE0E|\uFE0F|$|(?!#{hashtagAlphaNumeric}|&)#{codePoint})/),twttr.txt.regexen.validHashtag=regexSupplant(/(#{hashtagBoundary})(#{hashSigns})(?!\uFE0F|\u20E3)(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi),twttr.txt.regexen.validMentionPrecedingChars=/(?:^|[^a-zA-Z0-9_!#$%&*@]|(?:^|[^a-zA-Z0-9_+~.-])(?:rt|RT|rT|Rt):?)/,twttr.txt.regexen.atSigns=/[@]/,twttr.txt.regexen.validMentionOrList=regexSupplant("(#{validMentionPrecedingChars})(#{atSigns})([a-zA-Z0-9_]{1,20})(/[a-zA-Z][a-zA-Z0-9_-]{0,24})?","g"),twttr.txt.regexen.validReply=regexSupplant(/^(?:#{spaces})*#{atSigns}([a-zA-Z0-9_]{1,20})/),twttr.txt.regexen.endMentionMatch=regexSupplant(/^(?:#{atSigns}|[#{latinAccentChars}]|:\/\/)/),twttr.txt.regexen.validUrlPrecedingChars=regexSupplant(/(?:[^A-Za-z0-9@$##{invalid_chars_group}]|^)/),twttr.txt.regexen.invalidUrlWithoutProtocolPrecedingChars=/[-_.\/]$/,twttr.txt.regexen.invalidDomainChars=stringSupplant("#{punct}#{spaces_group}#{invalid_chars_group}",twttr.txt.regexen),twttr.txt.regexen.validDomainChars=regexSupplant(/[^#{invalidDomainChars}]/),twttr.txt.regexen.validSubdomain=regexSupplant(/(?:(?:#{validDomainChars}(?:[_-]|#{validDomainChars})*)?#{validDomainChars}\.)/),twttr.txt.regexen.validDomainName=regexSupplant(/(?:(?:#{validDomainChars}(?:-|#{validDomainChars})*)?#{validDomainChars}\.)/),twttr.txt.regexen.validGTLD=regexSupplant(RegExp("(?:(?:||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||zuerich|zone|zippo|zip|zero|zara|zappos|yun|youtube|you|yokohama|yoga|yodobashi|yandex|yamaxun|yahoo|yachts|xyz|xxx|xperia|xin|xihuan|xfinity|xerox|xbox|wtf|wtc|wow|world|works|work|woodside|wolterskluwer|wme|winners|wine|windows|win|williamhill|wiki|wien|whoswho|weir|weibo|wedding|wed|website|weber|webcam|weatherchannel|weather|watches|watch|warman|wanggou|wang|walter|walmart|wales|vuelos|voyage|voto|voting|vote|volvo|volkswagen|vodka|vlaanderen|vivo|viva|vistaprint|vista|vision|visa|virgin|vip|vin|villas|viking|vig|video|viajes|vet|versicherung|vermgensberatung|vermgensberater|verisign|ventures|vegas|vanguard|vana|vacations|ups|uol|uno|university|unicom|uconnect|ubs|ubank|tvs|tushu|tunes|tui|tube|trv|trust|travelersinsurance|travelers|travelchannel|travel|training|trading|trade|toys|toyota|town|tours|total|toshiba|toray|top|tools|tokyo|today|tmall|tkmaxx|tjx|tjmaxx|tirol|tires|tips|tiffany|tienda|tickets|tiaa|theatre|theater|thd|teva|tennis|temasek|telefonica|telecity|tel|technology|tech|team|tdk|tci|taxi|tax|tattoo|tatar|tatamotors|target|taobao|talk|taipei|tab|systems|symantec|sydney|swiss|swiftcover|swatch|suzuki|surgery|surf|support|supply|supplies|sucks|style|study|studio|stream|store|storage|stockholm|stcgroup|stc|statoil|statefarm|statebank|starhub|star|staples|stada|srt|srl|spreadbetting|spot|spiegel|space|soy|sony|song|solutions|solar|sohu|software|softbank|social|soccer|sncf|smile|smart|sling|skype|sky|skin|ski|site|singles|sina|silk|shriram|showtime|show|shouji|shopping|shop|shoes|shiksha|shia|shell|shaw|sharp|shangrila|sfr|sexy|sex|sew|seven|ses|services|sener|select|seek|security|secure|seat|search|scot|scor|scjohnson|science|schwarz|schule|school|scholarships|schmidt|schaeffler|scb|sca|sbs|sbi|saxo|save|sas|sarl|sapo|sap|sanofi|sandvikcoromant|sandvik|samsung|samsclub|salon|sale|sakura|safety|safe|saarland|ryukyu|rwe|run|ruhr|rugby|rsvp|room|rogers|rodeo|rocks|rocher|rmit|rip|rio|ril|rightathome|ricoh|richardli|rich|rexroth|reviews|review|restaurant|rest|republican|report|repair|rentals|rent|ren|reliance|reit|reisen|reise|rehab|redumbrella|redstone|red|recipes|realty|realtor|realestate|read|raid|radio|racing|qvc|quest|quebec|qpon|pwc|pub|prudential|pru|protection|property|properties|promo|progressive|prof|productions|prod|pro|prime|press|praxi|pramerica|post|porn|politie|poker|pohl|pnc|plus|plumbing|playstation|play|place|pizza|pioneer|pink|ping|pin|pid|pictures|pictet|pics|piaget|physio|photos|photography|photo|phone|philips|phd|pharmacy|pfizer|pet|pccw|pay|passagens|party|parts|partners|pars|paris|panerai|panasonic|pamperedchef|page|ovh|ott|otsuka|osaka|origins|orientexpress|organic|org|orange|oracle|open|ooo|onyourside|online|onl|ong|one|omega|ollo|oldnavy|olayangroup|olayan|okinawa|office|off|observer|obi|nyc|ntt|nrw|nra|nowtv|nowruz|now|norton|northwesternmutual|nokia|nissay|nissan|ninja|nikon|nike|nico|nhk|ngo|nfl|nexus|nextdirect|next|news|newholland|new|neustar|network|netflix|netbank|net|nec|nba|navy|natura|nationwide|name|nagoya|nadex|nab|mutuelle|mutual|museum|mtr|mtpc|mtn|msd|movistar|movie|mov|motorcycles|moto|moscow|mortgage|mormon|mopar|montblanc|monster|money|monash|mom|moi|moe|moda|mobily|mobile|mobi|mma|mls|mlb|mitsubishi|mit|mint|mini|mil|microsoft|miami|metlife|merckmsd|meo|menu|men|memorial|meme|melbourne|meet|media|med|mckinsey|mcdonalds|mcd|mba|mattel|maserati|marshalls|marriott|markets|marketing|market|map|mango|management|man|makeup|maison|maif|madrid|macys|luxury|luxe|lupin|lundbeck|ltda|ltd|lplfinancial|lpl|love|lotto|lotte|london|lol|loft|locus|locker|loans|loan|lixil|living|live|lipsy|link|linde|lincoln|limo|limited|lilly|like|lighting|lifestyle|lifeinsurance|life|lidl|liaison|lgbt|lexus|lego|legal|lefrak|leclerc|lease|lds|lawyer|law|latrobe|latino|lat|lasalle|lanxess|landrover|land|lancome|lancia|lancaster|lamer|lamborghini|ladbrokes|lacaixa|kyoto|kuokgroup|kred|krd|kpn|kpmg|kosher|komatsu|koeln|kiwi|kitchen|kindle|kinder|kim|kia|kfh|kerryproperties|kerrylogistics|kerryhotels|kddi|kaufen|juniper|juegos|jprs|jpmorgan|joy|jot|joburg|jobs|jnj|jmp|jll|jlc|jio|jewelry|jetzt|jeep|jcp|jcb|java|jaguar|iwc|iveco|itv|itau|istanbul|ist|ismaili|iselect|irish|ipiranga|investments|intuit|international|intel|int|insure|insurance|institute|ink|ing|info|infiniti|industries|immobilien|immo|imdb|imamat|ikano|iinet|ifm|ieee|icu|ice|icbc|ibm|hyundai|hyatt|hughes|htc|hsbc|how|house|hotmail|hotels|hoteles|hot|hosting|host|hospital|horse|honeywell|honda|homesense|homes|homegoods|homedepot|holiday|holdings|hockey|hkt|hiv|hitachi|hisamitsu|hiphop|hgtv|hermes|here|helsinki|help|healthcare|health|hdfcbank|hdfc|hbo|haus|hangout|hamburg|hair|guru|guitars|guide|guge|gucci|guardian|group|grocery|gripe|green|gratis|graphics|grainger|gov|got|gop|google|goog|goodyear|goodhands|goo|golf|goldpoint|gold|godaddy|gmx|gmo|gmbh|gmail|globo|global|gle|glass|glade|giving|gives|gifts|gift|ggee|george|genting|gent|gea|gdn|gbiz|garden|gap|games|game|gallup|gallo|gallery|gal|fyi|futbol|furniture|fund|fun|fujixerox|fujitsu|ftr|frontier|frontdoor|frogans|frl|fresenius|free|fox|foundation|forum|forsale|forex|ford|football|foodnetwork|food|foo|fly|flsmidth|flowers|florist|flir|flights|flickr|fitness|fit|fishing|fish|firmdale|firestone|fire|financial|finance|final|film|fido|fidelity|fiat|ferrero|ferrari|feedback|fedex|fast|fashion|farmers|farm|fans|fan|family|faith|fairwinds|fail|fage|extraspace|express|exposed|expert|exchange|everbank|events|eus|eurovision|etisalat|esurance|estate|esq|erni|ericsson|equipment|epson|epost|enterprises|engineering|engineer|energy|emerck|email|education|edu|edeka|eco|eat|earth|dvr|dvag|durban|dupont|duns|dunlop|duck|dubai|dtv|drive|download|dot|doosan|domains|doha|dog|dodge|doctor|docs|dnp|diy|dish|discover|discount|directory|direct|digital|diet|diamonds|dhl|dev|design|desi|dentist|dental|democrat|delta|deloitte|dell|delivery|degree|deals|dealer|deal|dds|dclk|day|datsun|dating|date|data|dance|dad|dabur|cyou|cymru|cuisinella|csc|cruises|cruise|crs|crown|cricket|creditunion|creditcard|credit|courses|coupons|coupon|country|corsica|coop|cool|cookingchannel|cooking|contractors|contact|consulting|construction|condos|comsec|computer|compare|company|community|commbank|comcast|com|cologne|college|coffee|codes|coach|clubmed|club|cloud|clothing|clinique|clinic|click|cleaning|claims|cityeats|city|citic|citi|citadel|cisco|circle|cipriani|church|chrysler|chrome|christmas|chloe|chintai|cheap|chat|chase|channel|chanel|cfd|cfa|cern|ceo|center|ceb|cbs|cbre|cbn|cba|catholic|catering|cat|casino|cash|caseih|case|casa|cartier|cars|careers|career|care|cards|caravan|car|capitalone|capital|capetown|canon|cancerresearch|camp|camera|cam|calvinklein|call|cal|cafe|cab|bzh|buzz|buy|business|builders|build|bugatti|budapest|brussels|brother|broker|broadway|bridgestone|bradesco|box|boutique|bot|boston|bostik|bosch|boots|booking|book|boo|bond|bom|bofa|boehringer|boats|bnpparibas|bnl|bmw|bms|blue|bloomberg|blog|blockbuster|blanco|blackfriday|black|biz|bio|bingo|bing|bike|bid|bible|bharti|bet|bestbuy|best|berlin|bentley|beer|beauty|beats|bcn|bcg|bbva|bbt|bbc|bayern|bauhaus|basketball|baseball|bargains|barefoot|barclays|barclaycard|barcelona|bar|bank|band|bananarepublic|banamex|baidu|baby|azure|axa|aws|avianca|autos|auto|author|auspost|audio|audible|audi|auction|attorney|athleta|associates|asia|asda|arte|art|arpa|army|archi|aramco|arab|aquarelle|apple|app|apartments|aol|anz|anquan|android|analytics|amsterdam|amica|amfam|amex|americanfamily|americanexpress|alstom|alsace|ally|allstate|allfinanz|alipay|alibaba|alfaromeo|akdn|airtel|airforce|airbus|aigo|aig|agency|agakhan|africa|afl|afamilycompany|aetna|aero|aeg|adult|ads|adac|actor|active|aco|accountants|accountant|accenture|academy|abudhabi|abogado|able|abc|abbvie|abbott|abb|abarth|aarp|aaa|onion)(?=[^0-9a-zA-Z@]|$))")),twttr.txt.regexen.validCCTLD=regexSupplant(RegExp("(?:(?:||||||||||||||||||||||||||||||||||||||||||||||||||||||||zw|zm|za|yt|ye|ws|wf|vu|vn|vi|vg|ve|vc|va|uz|uy|us|um|uk|ug|ua|tz|tw|tv|tt|tr|tp|to|tn|tm|tl|tk|tj|th|tg|tf|td|tc|sz|sy|sx|sv|su|st|ss|sr|so|sn|sm|sl|sk|sj|si|sh|sg|se|sd|sc|sb|sa|rw|ru|rs|ro|re|qa|py|pw|pt|ps|pr|pn|pm|pl|pk|ph|pg|pf|pe|pa|om|nz|nu|nr|np|no|nl|ni|ng|nf|ne|nc|na|mz|my|mx|mw|mv|mu|mt|ms|mr|mq|mp|mo|mn|mm|ml|mk|mh|mg|mf|me|md|mc|ma|ly|lv|lu|lt|ls|lr|lk|li|lc|lb|la|kz|ky|kw|kr|kp|kn|km|ki|kh|kg|ke|jp|jo|jm|je|it|is|ir|iq|io|in|im|il|ie|id|hu|ht|hr|hn|hm|hk|gy|gw|gu|gt|gs|gr|gq|gp|gn|gm|gl|gi|gh|gg|gf|ge|gd|gb|ga|fr|fo|fm|fk|fj|fi|eu|et|es|er|eh|eg|ee|ec|dz|do|dm|dk|dj|de|cz|cy|cx|cw|cv|cu|cr|co|cn|cm|cl|ck|ci|ch|cg|cf|cd|cc|ca|bz|by|bw|bv|bt|bs|br|bq|bo|bn|bm|bl|bj|bi|bh|bg|bf|be|bd|bb|ba|az|ax|aw|au|at|as|ar|aq|ao|an|am|al|ai|ag|af|ae|ad|ac)(?=[^0-9a-zA-Z@]|$))")),twttr.txt.regexen.validPunycode=/(?:xn--[0-9a-z]+)/,twttr.txt.regexen.validSpecialCCTLD=/(?:(?:co|tv)(?=[^0-9a-zA-Z@]|$))/,twttr.txt.regexen.validDomain=regexSupplant(/(?:#{validSubdomain}*#{validDomainName}(?:#{validGTLD}|#{validCCTLD}|#{validPunycode}))/),twttr.txt.regexen.validAsciiDomain=regexSupplant(/(?:(?:[\-a-z0-9#{latinAccentChars}]+)\.)+(?:#{validGTLD}|#{validCCTLD}|#{validPunycode})/gi),twttr.txt.regexen.invalidShortDomain=regexSupplant(/^#{validDomainName}#{validCCTLD}$/i),twttr.txt.regexen.validSpecialShortDomain=regexSupplant(/^#{validDomainName}#{validSpecialCCTLD}$/i),twttr.txt.regexen.validPortNumber=/[0-9]+/,twttr.txt.regexen.cyrillicLettersAndMarks=/\u0400-\u04FF/,twttr.txt.regexen.validGeneralUrlPathChars=regexSupplant(/[a-z#{cyrillicLettersAndMarks}0-9!\*';:=\+,\.\$\/%#\[\]\-_~@\|&#{latinAccentChars}]/i),twttr.txt.regexen.validUrlBalancedParens=regexSupplant("\\((?:#{validGeneralUrlPathChars}+|(?:#{validGeneralUrlPathChars}*\\(#{validGeneralUrlPathChars}+\\)#{validGeneralUrlPathChars}*))\\)","i"),twttr.txt.regexen.validUrlPathEndingChars=regexSupplant(/[\+\-a-z#{cyrillicLettersAndMarks}0-9=_#\/#{latinAccentChars}]|(?:#{validUrlBalancedParens})/i),twttr.txt.regexen.validUrlPath=regexSupplant("(?:(?:#{validGeneralUrlPathChars}*(?:#{validUrlBalancedParens}#{validGeneralUrlPathChars}*)*#{validUrlPathEndingChars})|(?:@#{validGeneralUrlPathChars}+/))","i"),twttr.txt.regexen.validUrlQueryChars=/[a-z0-9!?\*'@\(\);:&=\+\$\/%#\[\]\-_\.,~|]/i,twttr.txt.regexen.validUrlQueryEndingChars=/[a-z0-9_&=#\/]/i,twttr.txt.regexen.extractUrl=regexSupplant("((#{validUrlPrecedingChars})((https?:\\/\\/)?(#{validDomain})(?::(#{validPortNumber}))?(\\/#{validUrlPath}*)?(\\?#{validUrlQueryChars}*#{validUrlQueryEndingChars})?))","gi"),twttr.txt.regexen.validTcoUrl=/^https?:\/\/t\.co\/[a-z0-9]+/i,twttr.txt.regexen.urlHasProtocol=/^https?:\/\//i,twttr.txt.regexen.urlHasHttps=/^https:\/\//i,twttr.txt.regexen.cashtag=/[a-z]{1,6}(?:[._][a-z]{1,2})?/i,twttr.txt.regexen.validCashtag=regexSupplant("(^|#{spaces})(\\$)(#{cashtag})(?=$|\\s|[#{punct}])","gi"),twttr.txt.regexen.validateUrlUnreserved=/[a-z\u0400-\u04FF0-9\-._~]/i,twttr.txt.regexen.validateUrlPctEncoded=/(?:%[0-9a-f]{2})/i,twttr.txt.regexen.validateUrlSubDelims=/[!$&'()*+,;=]/i,twttr.txt.regexen.validateUrlPchar=regexSupplant("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|[:|@])","i"),twttr.txt.regexen.validateUrlScheme=/(?:[a-z][a-z0-9+\-.]*)/i,twttr.txt.regexen.validateUrlUserinfo=regexSupplant("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|:)*","i"),twttr.txt.regexen.validateUrlDecOctet=/(?:[0-9]|(?:[1-9][0-9])|(?:1[0-9]{2})|(?:2[0-4][0-9])|(?:25[0-5]))/i,twttr.txt.regexen.validateUrlIpv4=regexSupplant(/(?:#{validateUrlDecOctet}(?:\.#{validateUrlDecOctet}){3})/i),twttr.txt.regexen.validateUrlIpv6=/(?:\[[a-f0-9:\.]+\])/i,twttr.txt.regexen.validateUrlIp=regexSupplant("(?:#{validateUrlIpv4}|#{validateUrlIpv6})","i"),twttr.txt.regexen.validateUrlSubDomainSegment=/(?:[a-z0-9](?:[a-z0-9_\-]*[a-z0-9])?)/i,twttr.txt.regexen.validateUrlDomainSegment=/(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?)/i,twttr.txt.regexen.validateUrlDomainTld=/(?:[a-z](?:[a-z0-9\-]*[a-z0-9])?)/i,twttr.txt.regexen.validateUrlDomain=regexSupplant(/(?:(?:#{validateUrlSubDomainSegment}\.)*(?:#{validateUrlDomainSegment}\.)#{validateUrlDomainTld})/i),twttr.txt.regexen.validateUrlHost=regexSupplant("(?:#{validateUrlIp}|#{validateUrlDomain})","i"),twttr.txt.regexen.validateUrlUnicodeSubDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9_\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,twttr.txt.regexen.validateUrlUnicodeDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,twttr.txt.regexen.validateUrlUnicodeDomainTld=/(?:(?:[a-z]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,twttr.txt.regexen.validateUrlUnicodeDomain=regexSupplant(/(?:(?:#{validateUrlUnicodeSubDomainSegment}\.)*(?:#{validateUrlUnicodeDomainSegment}\.)#{validateUrlUnicodeDomainTld})/i),twttr.txt.regexen.validateUrlUnicodeHost=regexSupplant("(?:#{validateUrlIp}|#{validateUrlUnicodeDomain})","i"),twttr.txt.regexen.validateUrlPort=/[0-9]{1,5}/,twttr.txt.regexen.validateUrlUnicodeAuthority=regexSupplant("(?:(#{validateUrlUserinfo})@)?(#{validateUrlUnicodeHost})(?::(#{validateUrlPort}))?","i"),twttr.txt.regexen.validateUrlAuthority=regexSupplant("(?:(#{validateUrlUserinfo})@)?(#{validateUrlHost})(?::(#{validateUrlPort}))?","i"),twttr.txt.regexen.validateUrlPath=regexSupplant(/(\/#{validateUrlPchar}*)*/i),twttr.txt.regexen.validateUrlQuery=regexSupplant(/(#{validateUrlPchar}|\/|\?)*/i),twttr.txt.regexen.validateUrlFragment=regexSupplant(/(#{validateUrlPchar}|\/|\?)*/i),twttr.txt.regexen.validateUrlUnencoded=regexSupplant("^(?:([^:/?#]+):\\/\\/)?([^/?#]*)([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$","i");var OPTIONS_NOT_ATTRIBUTES={urlClass:!0,listClass:!0,usernameClass:!0,hashtagClass:!0,cashtagClass:!0,usernameUrlBase:!0,listUrlBase:!0,hashtagUrlBase:!0,cashtagUrlBase:!0,usernameUrlBlock:!0,listUrlBlock:!0,hashtagUrlBlock:!0,linkUrlBlock:!0,usernameIncludeSymbol:!0,suppressLists:!0,suppressNoFollow:!0,targetBlank:!0,suppressDataScreenName:!0,urlEntities:!0,symbolTag:!0,textWithSymbolTag:!0,urlTarget:!0,invisibleTagAttrs:!0,linkAttributeBlock:!0,linkTextBlock:!0,htmlEscapeNonEntities:!0},BOOLEAN_ATTRIBUTES={disabled:!0,readonly:!0,multiple:!0,checked:!0};function clone(o){var r={};for(var k in o)o.hasOwnProperty(k)&&(r[k]=o[k]);return r}twttr.txt.tagAttrs=function(attributes){var htmlAttrs="";for(var k in attributes){var v=attributes[k];BOOLEAN_ATTRIBUTES[k]&&(v=v?k:null),null!=v&&(htmlAttrs+=" "+twttr.txt.htmlEscape(k)+'="'+twttr.txt.htmlEscape(v.toString())+'"')}return htmlAttrs},twttr.txt.linkToText=function(entity,text,attributes,options){return options.suppressNoFollow||(attributes.rel="nofollow"),options.linkAttributeBlock&&options.linkAttributeBlock(entity,attributes),options.linkTextBlock&&(text=options.linkTextBlock(entity,text)),stringSupplant("<a#{attr}>#{text}</a>",{text:text,attr:twttr.txt.tagAttrs(attributes)})},twttr.txt.linkToTextWithSymbol=function(entity,symbol,text,attributes,options){var taggedSymbol=options.symbolTag?"<"+options.symbolTag+">"+symbol+"</"+options.symbolTag+">":symbol;text=twttr.txt.htmlEscape(text);var taggedText=options.textWithSymbolTag?"<"+options.textWithSymbolTag+">"+text+"</"+options.textWithSymbolTag+">":text;return options.usernameIncludeSymbol||!symbol.match(twttr.txt.regexen.atSigns)?twttr.txt.linkToText(entity,taggedSymbol+taggedText,attributes,options):taggedSymbol+twttr.txt.linkToText(entity,taggedText,attributes,options)},twttr.txt.linkToHashtag=function(entity,text,options){var hash=text.substring(entity.indices[0],entity.indices[0]+1),hashtag=twttr.txt.htmlEscape(entity.hashtag),attrs=clone(options.htmlAttrs||{});return attrs.href=options.hashtagUrlBase+hashtag,attrs.title="#"+hashtag,attrs.class=options.hashtagClass,hashtag.charAt(0).match(twttr.txt.regexen.rtl_chars)&&(attrs.class+=" rtl"),options.targetBlank&&(attrs.target="_blank"),twttr.txt.linkToTextWithSymbol(entity,hash,hashtag,attrs,options)},twttr.txt.linkToCashtag=function(entity,text,options){var cashtag=twttr.txt.htmlEscape(entity.cashtag),attrs=clone(options.htmlAttrs||{});return attrs.href=options.cashtagUrlBase+cashtag,attrs.title="$"+cashtag,attrs.class=options.cashtagClass,options.targetBlank&&(attrs.target="_blank"),twttr.txt.linkToTextWithSymbol(entity,"$",cashtag,attrs,options)},twttr.txt.linkToMentionAndList=function(entity,text,options){var at=text.substring(entity.indices[0],entity.indices[0]+1),user=twttr.txt.htmlEscape(entity.screenName),slashListname=twttr.txt.htmlEscape(entity.listSlug),isList=entity.listSlug&&!options.suppressLists,attrs=clone(options.htmlAttrs||{});return attrs.class=isList?options.listClass:options.usernameClass,attrs.href=isList?options.listUrlBase+user+slashListname:options.usernameUrlBase+user,isList||options.suppressDataScreenName||(attrs["data-screen-name"]=user),options.targetBlank&&(attrs.target="_blank"),twttr.txt.linkToTextWithSymbol(entity,at,isList?user+slashListname:user,attrs,options)},twttr.txt.linkToUrl=function(entity,text,options){var url=entity.url,displayUrl=url,linkText=twttr.txt.htmlEscape(displayUrl),urlEntity=options.urlEntities&&options.urlEntities[url]||entity;urlEntity.display_url&&(linkText=twttr.txt.linkTextWithEntity(urlEntity,options));var attrs=clone(options.htmlAttrs||{});return url.match(twttr.txt.regexen.urlHasProtocol)||(url="http://"+url),attrs.href=url,options.targetBlank&&(attrs.target="_blank"),options.urlClass&&(attrs.class=options.urlClass),options.urlTarget&&(attrs.target=options.urlTarget),!options.title&&urlEntity.display_url&&(attrs.title=urlEntity.expanded_url),twttr.txt.linkToText(entity,linkText,attrs,options)},twttr.txt.linkTextWithEntity=function(entity,options){var displayUrl=entity.display_url,expandedUrl=entity.expanded_url,displayUrlSansEllipses=displayUrl.replace(//g,"");if(-1==expandedUrl.indexOf(displayUrlSansEllipses))return displayUrl;var displayUrlIndex=expandedUrl.indexOf(displayUrlSansEllipses),v={displayUrlSansEllipses:displayUrlSansEllipses,beforeDisplayUrl:expandedUrl.substr(0,displayUrlIndex),afterDisplayUrl:expandedUrl.substr(displayUrlIndex+displayUrlSansEllipses.length),precedingEllipsis:displayUrl.match(/^/)?"":"",followingEllipsis:displayUrl.match(/$/)?"":""};for(var k in v)v.hasOwnProperty(k)&&(v[k]=twttr.txt.htmlEscape(v[k]));return v.invisible=options.invisibleTagAttrs,stringSupplant("<span class='tco-ellipsis'>#{precedingEllipsis}<span #{invisible}>&nbsp;</span></span><span #{invisible}>#{beforeDisplayUrl}</span><span class='js-display-url'>#{displayUrlSansEllipses}</span><span #{invisible}>#{afterDisplayUrl}</span><span class='tco-ellipsis'><span #{invisible}>&nbsp;</span>#{followingEllipsis}</span>",v)},twttr.txt.autoLinkEntities=function(text,entities,options){var urlEntities,len;if((options=clone(options||{})).hashtagClass=options.hashtagClass||"tweet-url hashtag",options.hashtagUrlBase=options.hashtagUrlBase||"https://twitter.com/#!/search?q=%23",options.cashtagClass=options.cashtagClass||"tweet-url cashtag",options.cashtagUrlBase=options.cashtagUrlBase||"https://twitter.com/#!/search?q=%24",options.listClass=options.listClass||"tweet-url list-slug",options.usernameClass=options.usernameClass||"tweet-url username",options.usernameUrlBase=options.usernameUrlBase||"https://twitter.com/",options.listUrlBase=options.listUrlBase||"https://twitter.com/",options.htmlAttrs=twttr.txt.extractHtmlAttrsFromOptions(options),options.invisibleTagAttrs=options.invisibleTagAttrs||"style='position:absolute;left:-9999px;'",options.urlEntities){for(urlEntities={},i=0,len=options.urlEntities.length;i<len;i++)urlEntities[options.urlEntities[i].url]=options.urlEntities[i];options.urlEntities=urlEntities}var result="",beginIndex=0;entities.sort(function(a,b){return a.indices[0]-b.indices[0]});for(var nonEntity=options.htmlEscapeNonEntities?twttr.txt.htmlEscape:function(text){return text},i=0;i<entities.length;i++){var entity=entities[i];result+=nonEntity(text.substring(beginIndex,entity.indices[0])),entity.url?result+=twttr.txt.linkToUrl(entity,text,options):entity.hashtag?result+=twttr.txt.linkToHashtag(entity,text,options):entity.screenName?result+=twttr.txt.linkToMentionAndList(entity,text,options):entity.cashtag&&(result+=twttr.txt.linkToCashtag(entity,text,options)),beginIndex=entity.indices[1]}return result+=nonEntity(text.substring(beginIndex,text.length))},twttr.txt.autoLinkWithJSON=function(text,json,options){if(json.user_mentions)for(var i=0;i<json.user_mentions.length;i++)json.user_mentions[i].screenName=json.user_mentions[i].screen_name;if(json.hashtags)for(i=0;i<json.hashtags.length;i++)json.hashtags[i].hashtag=json.hashtags[i].text;if(json.symbols)for(i=0;i<json.symbols.length;i++)json.symbols[i].cashtag=json.symbols[i].text;var entities=[];for(var key in json)entities=entities.concat(json[key]);return twttr.txt.modifyIndicesFromUnicodeToUTF16(text,entities),twttr.txt.autoLinkEntities(text,entities,options)},twttr.txt.extractHtmlAttrsFromOptions=function(options){var htmlAttrs={};for(var k in options){var v=options[k];OPTIONS_NOT_ATTRIBUTES[k]||(BOOLEAN_ATTRIBUTES[k]&&(v=v?k:null),null!=v&&(htmlAttrs[k]=v))}return htmlAttrs},twttr.txt.autoLink=function(text,options){var entities=twttr.txt.extractEntitiesWithIndices(text,{extractUrlsWithoutProtocol:!1});return twttr.txt.autoLinkEntities(text,entities,options)},twttr.txt.autoLinkUsernamesOrLists=function(text,options){var entities=twttr.txt.extractMentionsOrListsWithIndices(text);return twttr.txt.autoLinkEntities(text,entities,options)},twttr.txt.autoLinkHashtags=function(text,options){var entities=twttr.txt.extractHashtagsWithIndices(text);return twttr.txt.autoLinkEntities(text,entities,options)},twttr.txt.autoLinkCashtags=function(text,options){var entities=twttr.txt.extractCashtagsWithIndices(text);return twttr.txt.autoLinkEntities(text,entities,options)},twttr.txt.autoLinkUrlsCustom=function(text,options){var entities=twttr.txt.extractUrlsWithIndices(text,{extractUrlsWithoutProtocol:!1});return twttr.txt.autoLinkEntities(text,entities,options)},twttr.txt.removeOverlappingEntities=function(entities){entities.sort(function(a,b){return a.indices[0]-b.indices[0]});for(var prev=entities[0],i=1;i<entities.length;i++)prev.indices[1]>entities[i].indices[0]?(entities.splice(i,1),i--):prev=entities[i]},twttr.txt.extractEntitiesWithIndices=function(text,options){var entities=twttr.txt.extractUrlsWithIndices(text,options).concat(twttr.txt.extractMentionsOrListsWithIndices(text)).concat(twttr.txt.extractHashtagsWithIndices(text,{checkUrlOverlap:!1})).concat(twttr.txt.extractCashtagsWithIndices(text));return 0==entities.length?[]:(twttr.txt.removeOverlappingEntities(entities),entities)},twttr.txt.extractMentions=function(text){for(var screenNamesOnly=[],screenNamesWithIndices=twttr.txt.extractMentionsWithIndices(text),i=0;i<screenNamesWithIndices.length;i++){var screenName=screenNamesWithIndices[i].screenName;screenNamesOnly.push(screenName)}return screenNamesOnly},twttr.txt.extractMentionsWithIndices=function(text){for(var mentionOrList,mentions=[],mentionsOrLists=twttr.txt.extractMentionsOrListsWithIndices(text),i=0;i<mentionsOrLists.length;i++)""==(mentionOrList=mentionsOrLists[i]).listSlug&&mentions.push({screenName:mentionOrList.screenName,indices:mentionOrList.indices});return mentions},twttr.txt.extractMentionsOrListsWithIndices=function(text){if(!text||!text.match(twttr.txt.regexen.atSigns))return[];var possibleNames=[];return text.replace(twttr.txt.regexen.validMentionOrList,function(match,before,atSign,screenName,slashListname,offset,chunk){if(!chunk.slice(offset+match.length).match(twttr.txt.regexen.endMentionMatch)){slashListname=slashListname||"";var startPosition=offset+before.length,endPosition=startPosition+screenName.length+slashListname.length+1;possibleNames.push({screenName:screenName,listSlug:slashListname,indices:[startPosition,endPosition]})}}),possibleNames},twttr.txt.extractReplies=function(text){if(!text)return null;var possibleScreenName=text.match(twttr.txt.regexen.validReply);return!possibleScreenName||RegExp.rightContext.match(twttr.txt.regexen.endMentionMatch)?null:possibleScreenName[1]},twttr.txt.extractUrls=function(text,options){for(var urlsOnly=[],urlsWithIndices=twttr.txt.extractUrlsWithIndices(text,options),i=0;i<urlsWithIndices.length;i++)urlsOnly.push(urlsWithIndices[i].url);return urlsOnly},twttr.txt.extractUrlsWithIndices=function(text,options){if(options=options||{extractUrlsWithoutProtocol:!0},!text||(options.extractUrlsWithoutProtocol?!text.match(/\./):!text.match(/:/)))return[];for(var urls=[];twttr.txt.regexen.extractUrl.exec(text);){var before=RegExp.$2,url=RegExp.$3,protocol=RegExp.$4,domain=RegExp.$5,path=RegExp.$7,endPosition=twttr.txt.regexen.extractUrl.lastIndex,startPosition=endPosition-url.length;if(protocol)url.match(twttr.txt.regexen.validTcoUrl)&&(url=RegExp.lastMatch,endPosition=startPosition+url.length),urls.push({url:url,indices:[startPosition,endPosition]});else{if(!options.extractUrlsWithoutProtocol||before.match(twttr.txt.regexen.invalidUrlWithoutProtocolPrecedingChars))continue;var lastUrl=null,asciiEndPosition=0;if(domain.replace(twttr.txt.regexen.validAsciiDomain,function(asciiDomain){var asciiStartPosition=domain.indexOf(asciiDomain,asciiEndPosition);asciiEndPosition=asciiStartPosition+asciiDomain.length,lastUrl={url:asciiDomain,indices:[startPosition+asciiStartPosition,startPosition+asciiEndPosition]},!path&&!asciiDomain.match(twttr.txt.regexen.validSpecialShortDomain)&&asciiDomain.match(twttr.txt.regexen.invalidShortDomain)||urls.push(lastUrl)}),null==lastUrl)continue;path&&(lastUrl.url=url.replace(domain,lastUrl.url),lastUrl.indices[1]=endPosition)}}return urls},twttr.txt.extractHashtags=function(text){for(var hashtagsOnly=[],hashtagsWithIndices=twttr.txt.extractHashtagsWithIndices(text),i=0;i<hashtagsWithIndices.length;i++)hashtagsOnly.push(hashtagsWithIndices[i].hashtag);return hashtagsOnly},twttr.txt.extractHashtagsWithIndices=function(text,options){if(options=options||{checkUrlOverlap:!0},!text||!text.match(twttr.txt.regexen.hashSigns))return[];var tags=[];if(text.replace(twttr.txt.regexen.validHashtag,function(match,before,hash,hashText,offset,chunk){if(!chunk.slice(offset+match.length).match(twttr.txt.regexen.endHashtagMatch)){var startPosition=offset+before.length,endPosition=startPosition+hashText.length+1;tags.push({hashtag:hashText,indices:[startPosition,endPosition]})}}),options.checkUrlOverlap){var urls=twttr.txt.extractUrlsWithIndices(text);if(0<urls.length){var entities=tags.concat(urls);twttr.txt.removeOverlappingEntities(entities),tags=[];for(var i=0;i<entities.length;i++)entities[i].hashtag&&tags.push(entities[i])}}return tags},twttr.txt.extractCashtags=function(text){for(var cashtagsOnly=[],cashtagsWithIndices=twttr.txt.extractCashtagsWithIndices(text),i=0;i<cashtagsWithIndices.length;i++)cashtagsOnly.push(cashtagsWithIndices[i].cashtag);return cashtagsOnly},twttr.txt.extractCashtagsWithIndices=function(text){if(!text||-1==text.indexOf("$"))return[];var tags=[];return text.replace(twttr.txt.regexen.validCashtag,function(match,before,dollar,cashtag,offset,chunk){var startPosition=offset+before.length,endPosition=startPosition+cashtag.length+1;tags.push({cashtag:cashtag,indices:[startPosition,endPosition]})}),tags},twttr.txt.modifyIndicesFromUnicodeToUTF16=function(text,entities){twttr.txt.convertUnicodeIndices(text,entities,!1)},twttr.txt.modifyIndicesFromUTF16ToUnicode=function(text,entities){twttr.txt.convertUnicodeIndices(text,entities,!0)},twttr.txt.getUnicodeTextLength=function(text){return text.replace(twttr.txt.regexen.non_bmp_code_pairs," ").length},twttr.txt.convertUnicodeIndices=function(text,entities,indicesInUTF16){if(0!=entities.length){var charIndex=0,codePointIndex=0;entities.sort(function(a,b){return a.indices[0]-b.indices[0]});for(var entityIndex=0,entity=entities[0];charIndex<text.length;){if(entity.indices[0]==(indicesInUTF16?charIndex:codePointIndex)){var len=entity.indices[1]-entity.indices[0];if(entity.indices[0]=indicesInUTF16?codePointIndex:charIndex,entity.indices[1]=entity.indices[0]+len,++entityIndex==entities.length)break;entity=entities[entityIndex]}var c=text.charCodeAt(charIndex);55296<=c&&c<=56319&&charIndex<text.length-1&&56320<=(c=text.charCodeAt(charIndex+1))&&c<=57343&&charIndex++,codePointIndex++,charIndex++}}},twttr.txt.splitTags=function(text){for(var secondSplits,split,firstSplits=text.split("<"),allSplits=[],i=0;i<firstSplits.length;i+=1)if(split=firstSplits[i]){secondSplits=split.split(">");for(var j=0;j<secondSplits.length;j+=1)allSplits.push(secondSplits[j])}else allSplits.push("");return allSplits},twttr.txt.hitHighlight=function(text,hits,options){if(0===(hits=hits||[]).length)return text;var i,j,index,hit,tag,placed,hitSpot,tagName=(options=options||{}).tag||"em",tags=["<"+tagName+">","</"+tagName+">"],chunks=twttr.txt.splitTags(text),result="",chunkIndex=0,chunk=chunks[0],prevChunksLen=0,chunkCursor=0,startInChunk=!1,chunkChars=chunk,flatHits=[];for(i=0;i<hits.length;i+=1)for(j=0;j<hits[i].length;j+=1)flatHits.push(hits[i][j]);for(index=0;index<flatHits.length;index+=1){for(hit=flatHits[index],tag=tags[index%2],placed=!1;null!=chunk&&hit>=prevChunksLen+chunk.length;)result+=chunkChars.slice(chunkCursor),startInChunk&&hit===prevChunksLen+chunkChars.length&&(result+=tag,placed=!0),chunks[chunkIndex+1]&&(result+="<"+chunks[chunkIndex+1]+">"),prevChunksLen+=chunkChars.length,chunkCursor=0,chunkChars=chunk=chunks[chunkIndex+=2],startInChunk=!1;placed||null==chunk?placed||(placed=!0,result+=tag):(hitSpot=hit-prevChunksLen,result+=chunkChars.slice(chunkCursor,hitSpot)+tag,chunkCursor=hitSpot,startInChunk=index%2==0)}if(null!=chunk)for(chunkCursor<chunkChars.length&&(result+=chunkChars.slice(chunkCursor)),index=chunkIndex+1;index<chunks.length;index+=1)result+=index%2==0?chunks[index]:"<"+chunks[index]+">";return result};twttr.txt.getTweetLength=function(text,options){options=options||{short_url_length:23,short_url_length_https:23};var textLength=twttr.txt.getUnicodeTextLength(text),urlsWithIndices=twttr.txt.extractUrlsWithIndices(text);twttr.txt.modifyIndicesFromUTF16ToUnicode(text,urlsWithIndices);for(var i=0;i<urlsWithIndices.length;i++)textLength+=urlsWithIndices[i].indices[0]-urlsWithIndices[i].indices[1],urlsWithIndices[i].url.toLowerCase().match(twttr.txt.regexen.urlHasHttps)?textLength+=options.short_url_length_https:textLength+=options.short_url_length;return textLength},twttr.txt.isInvalidTweet=function(text){return text?140<twttr.txt.getTweetLength(text)?"too_long":!!twttr.txt.hasInvalidCharacters(text)&&"invalid_characters":"empty"},twttr.txt.hasInvalidCharacters=function(text){return twttr.txt.regexen.invalid_chars.test(text)},twttr.txt.isValidTweetText=function(text){return!twttr.txt.isInvalidTweet(text)},twttr.txt.isValidUsername=function(username){if(!username)return!1;var extracted=twttr.txt.extractMentions(username);return 1===extracted.length&&extracted[0]===username.slice(1)};var VALID_LIST_RE=regexSupplant(/^#{validMentionOrList}$/);function isValidMatch(string,regex,optional){return optional?!string||string.match(regex)&&RegExp["$&"]===string:"string"==typeof string&&string.match(regex)&&RegExp["$&"]===string}if(twttr.txt.isValidList=function(usernameList){var match=usernameList.match(VALID_LIST_RE);return!(!match||""!=match[1]||!match[4])},twttr.txt.isValidHashtag=function(hashtag){if(!hashtag)return!1;var extracted=twttr.txt.extractHashtags(hashtag);return 1===extracted.length&&extracted[0]===hashtag.slice(1)},twttr.txt.isValidUrl=function(url,unicodeDomains,requireProtocol){if(null==unicodeDomains&&(unicodeDomains=!0),null==requireProtocol&&(requireProtocol=!0),!url)return!1;var urlParts=url.match(twttr.txt.regexen.validateUrlUnencoded);if(!urlParts||urlParts[0]!==url)return!1;var scheme=urlParts[1],authority=urlParts[2],path=urlParts[3],query=urlParts[4],fragment=urlParts[5];return!!((!requireProtocol||isValidMatch(scheme,twttr.txt.regexen.validateUrlScheme)&&scheme.match(/^https?$/i))&&isValidMatch(path,twttr.txt.regexen.validateUrlPath)&&isValidMatch(query,twttr.txt.regexen.validateUrlQuery,!0)&&isValidMatch(fragment,twttr.txt.regexen.validateUrlFragment,!0))&&(unicodeDomains&&isValidMatch(authority,twttr.txt.regexen.validateUrlUnicodeAuthority)||!unicodeDomains&&isValidMatch(authority,twttr.txt.regexen.validateUrlAuthority))},"undefined"!=typeof module&&module.exports&&(module.exports=twttr.txt),"function"==typeof define&&define.amd&&define([],twttr.txt),"undefined"!=typeof window)if(window.twttr)for(var prop in twttr)window.twttr[prop]=twttr[prop];else window.twttr=twttr}(),function(root,factory){"function"==typeof define&&define.amd?define("bloodhound",["jquery"],function(a0){return root.Bloodhound=factory(a0)}):"object"==typeof exports?module.exports=factory(require("jquery")):root.Bloodhound=factory(jQuery)}(this,function($){var _=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(str){return!str||/^\s*$/.test(str)},escapeRegExChars:function(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(obj){return"string"==typeof obj},isNumber:function(obj){return"number"==typeof obj},isArray:$.isArray,isFunction:$.isFunction,isObject:$.isPlainObject,isUndefined:function(obj){return void 0===obj},isElement:function(obj){return!(!obj||1!==obj.nodeType)},isJQuery:function(obj){return obj instanceof $},toStr:function(s){return _.isUndefined(s)||null===s?"":s+""},bind:$.proxy,each:function(collection,cb){$.each(collection,function(index,value){return cb(value,index)})},map:$.map,filter:$.grep,every:function(obj,test){var result=!0;return obj?($.each(obj,function(key,val){if(!(result=test.call(null,val,key,obj)))return!1}),!!result):result},some:function(obj,test){var result=!1;return obj?($.each(obj,function(key,val){if(result=test.call(null,val,key,obj))return!1}),!!result):result},mixin:$.extend,identity:function(x){return x},clone:function(obj){return $.extend(!0,{},obj)},getIdGenerator:function(){var counter=0;return function(){return counter++}},templatify:function(obj){return $.isFunction(obj)?obj:function(){return String(obj)}},defer:function(fn){setTimeout(fn,0)},debounce:function(func,wait,immediate){var timeout,result;return function(){var later,callNow,context=this,args=arguments;return later=function(){timeout=null,immediate||(result=func.apply(context,args))},callNow=immediate&&!timeout,clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&(result=func.apply(context,args)),result}},throttle:function(func,wait){var context,args,timeout,result,previous,later;return previous=0,later=function(){previous=new Date,timeout=null,result=func.apply(context,args)},function(){var now=new Date,remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args)):timeout=timeout||setTimeout(later,remaining),result}},stringify:function(val){return _.isString(val)?val:JSON.stringify(val)},noop:function(){}}}(),tokenizers=function(){"use strict";return{nonword:nonword,whitespace:whitespace,obj:{nonword:getObjTokenizer(nonword),whitespace:getObjTokenizer(whitespace)}};function whitespace(str){return(str=_.toStr(str))?str.split(/\s+/):[]}function nonword(str){return(str=_.toStr(str))?str.split(/\W+/):[]}function getObjTokenizer(tokenizer){return function(keys){return keys=_.isArray(keys)?keys:[].slice.call(arguments,0),function(o){var tokens=[];return _.each(keys,function(k){tokens=tokens.concat(tokenizer(_.toStr(o[k])))}),tokens}}}}(),LruCache=function(){"use strict";function LruCache(maxSize){this.maxSize=_.isNumber(maxSize)?maxSize:100,this.reset(),this.maxSize<=0&&(this.set=this.get=$.noop)}function List(){this.head=this.tail=null}function Node(key,val){this.key=key,this.val=val,this.prev=this.next=null}return _.mixin(LruCache.prototype,{set:function(key,val){var node,tailItem=this.list.tail;this.size>=this.maxSize&&(this.list.remove(tailItem),delete this.hash[tailItem.key],this.size--),(node=this.hash[key])?(node.val=val,this.list.moveToFront(node)):(node=new Node(key,val),this.list.add(node),this.hash[key]=node,this.size++)},get:function(key){var node=this.hash[key];if(node)return this.list.moveToFront(node),node.val},reset:function(){this.size=0,this.hash={},this.list=new List}}),_.mixin(List.prototype,{add:function(node){this.head&&(node.next=this.head,this.head.prev=node),this.head=node,this.tail=this.tail||node},remove:function(node){node.prev?node.prev.next=node.next:this.head=node.next,node.next?node.next.prev=node.prev:this.tail=node.prev},moveToFront:function(node){this.remove(node),this.add(node)}}),LruCache}(),PersistentStorage=function(){"use strict";var LOCAL_STORAGE;try{(LOCAL_STORAGE=window.localStorage).setItem("~~~","!"),LOCAL_STORAGE.removeItem("~~~")}catch(err){LOCAL_STORAGE=null}function PersistentStorage(namespace,override){this.prefix=["__",namespace,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+_.escapeRegExChars(this.prefix)),this.ls=override||LOCAL_STORAGE,this.ls||this._noop()}return _.mixin(PersistentStorage.prototype,{_prefix:function(key){return this.prefix+key},_ttlKey:function(key){return this._prefix(key)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=_.noop},_safeSet:function(key,val){try{this.ls.setItem(key,val)}catch(err){"QuotaExceededError"===err.name&&(this.clear(),this._noop())}},get:function(key){return this.isExpired(key)&&this.remove(key),decode(this.ls.getItem(this._prefix(key)))},set:function(key,val,ttl){return _.isNumber(ttl)?this._safeSet(this._ttlKey(key),encode(now()+ttl)):this.ls.removeItem(this._ttlKey(key)),this._safeSet(this._prefix(key),encode(val))},remove:function(key){return this.ls.removeItem(this._ttlKey(key)),this.ls.removeItem(this._prefix(key)),this},clear:function(){var i,keys=function(keyMatcher){var i,key,keys=[],len=LOCAL_STORAGE.length;for(i=0;i<len;i++)(key=LOCAL_STORAGE.key(i)).match(keyMatcher)&&keys.push(key.replace(keyMatcher,""));return keys}(this.keyMatcher);for(i=keys.length;i--;)this.remove(keys[i]);return this},isExpired:function(key){var ttl=decode(this.ls.getItem(this._ttlKey(key)));return!!(_.isNumber(ttl)&&now()>ttl)}}),PersistentStorage;function now(){return(new Date).getTime()}function encode(val){return JSON.stringify(_.isUndefined(val)?null:val)}function decode(val){return $.parseJSON(val)}}(),Transport=function(){"use strict";var pendingRequestsCount=0,pendingRequests={},maxPendingRequests=6,sharedCache=new LruCache(10);function Transport(o){o=o||{},this.cancelled=!1,this.lastReq=null,this._send=o.transport,this._get=o.limiter?o.limiter(this._get):this._get,this._cache=!1===o.cache?new LruCache(0):sharedCache}return Transport.setMaxPendingRequests=function(num){maxPendingRequests=num},Transport.resetCache=function(){sharedCache.reset()},_.mixin(Transport.prototype,{_fingerprint:function(o){return(o=o||{}).url+o.type+$.param(o.data||{})},_get:function(o,cb){var fingerprint,jqXhr,that=this;function done(resp){cb(null,resp),that._cache.set(fingerprint,resp)}function fail(){cb(!0)}fingerprint=this._fingerprint(o),this.cancelled||fingerprint!==this.lastReq||((jqXhr=pendingRequests[fingerprint])?jqXhr.done(done).fail(fail):pendingRequestsCount<maxPendingRequests?(pendingRequestsCount++,pendingRequests[fingerprint]=this._send(o).done(done).fail(fail).always(function(){pendingRequestsCount--,delete pendingRequests[fingerprint],that.onDeckRequestArgs&&(that._get.apply(that,that.onDeckRequestArgs),that.onDeckRequestArgs=null)})):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(o,cb){var resp,fingerprint;cb=cb||$.noop,o=_.isString(o)?{url:o}:o||{},fingerprint=this._fingerprint(o),this.cancelled=!1,this.lastReq=fingerprint,(resp=this._cache.get(fingerprint))?cb(null,resp):this._get(o,cb)},cancel:function(){this.cancelled=!0}}),Transport}(),SearchIndex=window.SearchIndex=function(){"use strict";var CHILDREN="c",IDS="i";function SearchIndex(o){(o=o||{}).datumTokenizer&&o.queryTokenizer||$.error("datumTokenizer and queryTokenizer are both required"),this.identify=o.identify||_.stringify,this.datumTokenizer=o.datumTokenizer,this.queryTokenizer=o.queryTokenizer,this.reset()}return _.mixin(SearchIndex.prototype,{bootstrap:function(o){this.datums=o.datums,this.trie=o.trie},add:function(data){var that=this;data=_.isArray(data)?data:[data],_.each(data,function(datum){var id,tokens;that.datums[id=that.identify(datum)]=datum,tokens=normalizeTokens(that.datumTokenizer(datum)),_.each(tokens,function(token){var node,chars,ch;for(node=that.trie,chars=token.split("");ch=chars.shift();)(node=node[CHILDREN][ch]||(node[CHILDREN][ch]=newNode()))[IDS].push(id)})})},get:function(ids){var that=this;return _.map(ids,function(id){return that.datums[id]})},search:function(query){var tokens,matches,that=this;return tokens=normalizeTokens(this.queryTokenizer(query)),_.each(tokens,function(token){var node,chars,ch,ids;if(matches&&0===matches.length)return!1;for(node=that.trie,chars=token.split("");node&&(ch=chars.shift());)node=node[CHILDREN][ch];if(!node||0!==chars.length)return!(matches=[]);ids=node[IDS].slice(0),matches=matches?function(arrayA,arrayB){var ai=0,bi=0,intersection=[];arrayA=arrayA.sort(),arrayB=arrayB.sort();var lenArrayA=arrayA.length,lenArrayB=arrayB.length;for(;ai<lenArrayA&&bi<lenArrayB;)arrayA[ai]<arrayB[bi]?ai++:(arrayA[ai]>arrayB[bi]||(intersection.push(arrayA[ai]),ai++),bi++);return intersection}(matches,ids):ids}),matches?_.map(function(array){for(var seen={},uniques=[],i=0,len=array.length;i<len;i++)seen[array[i]]||(seen[array[i]]=!0,uniques.push(array[i]));return uniques}(matches),function(id){return that.datums[id]}):[]},all:function(){var values=[];for(var key in this.datums)values.push(this.datums[key]);return values},reset:function(){this.datums={},this.trie=newNode()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),SearchIndex;function normalizeTokens(tokens){return tokens=_.filter(tokens,function(token){return!!token}),tokens=_.map(tokens,function(token){return token.toLowerCase()})}function newNode(){var node={};return node[IDS]=[],node[CHILDREN]={},node}}(),Prefetch=function(){"use strict";var keys;function Prefetch(o){this.url=o.url,this.ttl=o.ttl,this.cache=o.cache,this.prepare=o.prepare,this.transform=o.transform,this.transport=o.transport,this.thumbprint=o.thumbprint,this.storage=new PersistentStorage(o.cacheKey)}return keys={data:"data",protocol:"protocol",thumbprint:"thumbprint"},_.mixin(Prefetch.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(data){this.cache&&(this.storage.set(keys.data,data,this.ttl),this.storage.set(keys.protocol,location.protocol,this.ttl),this.storage.set(keys.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var isExpired,stored={};return this.cache?(stored.data=this.storage.get(keys.data),stored.protocol=this.storage.get(keys.protocol),stored.thumbprint=this.storage.get(keys.thumbprint),isExpired=stored.thumbprint!==this.thumbprint||stored.protocol!==location.protocol,stored.data&&!isExpired?stored.data:null):null},fromNetwork:function(cb){var settings,that=this;cb&&(settings=this.prepare(this._settings()),this.transport(settings).fail(function(){cb(!0)}).done(function(resp){cb(null,that.transform(resp))}))},clear:function(){return this.storage.clear(),this}}),Prefetch}(),Remote=function(){"use strict";function Remote(o){this.url=o.url,this.prepare=o.prepare,this.transform=o.transform,this.transport=new Transport({cache:o.cache,limiter:o.limiter,transport:o.transport})}return _.mixin(Remote.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(query,cb){var settings,that=this;if(cb)return query=query||"",settings=this.prepare(query,this._settings()),this.transport.get(settings,function(err,resp){cb(err?[]:that.transform(resp))})},cancelLastRequest:function(){this.transport.cancel()}}),Remote}(),oParser=function(){"use strict";return function(o){var defaults,sorter;return defaults={initialize:!0,identify:_.stringify,datumTokenizer:null,queryTokenizer:null,sufficient:5,sorter:null,local:[],prefetch:null,remote:null},(o=_.mixin(defaults,o||{})).datumTokenizer||$.error("datumTokenizer is required"),o.queryTokenizer||$.error("queryTokenizer is required"),sorter=o.sorter,o.sorter=sorter?function(x){return x.sort(sorter)}:_.identity,o.local=_.isFunction(o.local)?o.local():o.local,o.prefetch=function(o){var defaults;return o?(defaults={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:_.identity,transform:_.identity,transport:null},o=_.isString(o)?{url:o}:o,(o=_.mixin(defaults,o)).url||$.error("prefetch requires url to be set"),o.transform=o.filter||o.transform,o.cacheKey=o.cacheKey||o.url,o.thumbprint="0.11.1"+o.thumbprint,o.transport=o.transport?callbackToDeferred(o.transport):$.ajax,o):null}(o.prefetch),o.remote=function(o){var defaults;return o?(defaults={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:_.identity,transport:null},o=_.isString(o)?{url:o}:o,(o=_.mixin(defaults,o)).url||$.error("remote requires url to be set"),o.transform=o.filter||o.transform,o.prepare=function(o){var prepare,replace,wildcard;if(prepare=o.prepare,replace=o.replace,wildcard=o.wildcard,prepare)return prepare;prepare=replace?function(query,settings){return settings.url=replace(settings.url,query),settings}:o.wildcard?function(query,settings){return settings.url=settings.url.replace(wildcard,encodeURIComponent(query)),settings}:function(query,settings){return settings};return prepare}(o),o.limiter=function(o){var limiter,method,wait;limiter=o.limiter,method=o.rateLimitBy,wait=o.rateLimitWait,limiter=limiter||(/^throttle$/i.test(method)?function(wait){return function(fn){return _.throttle(fn,wait)}}(wait):function(wait){return function(fn){return _.debounce(fn,wait)}}(wait));return limiter}(o),o.transport=o.transport?callbackToDeferred(o.transport):$.ajax,delete o.replace,delete o.wildcard,delete o.rateLimitBy,delete o.rateLimitWait,o):void 0}(o.remote),o};function callbackToDeferred(fn){return function(o){var deferred=$.Deferred();return fn(o,function(resp){_.defer(function(){deferred.resolve(resp)})},function(err){_.defer(function(){deferred.reject(err)})}),deferred}}}();return function(){"use strict";var old;function Bloodhound(o){o=oParser(o),this.sorter=o.sorter,this.identify=o.identify,this.sufficient=o.sufficient,this.local=o.local,this.remote=o.remote?new Remote(o.remote):null,this.prefetch=o.prefetch?new Prefetch(o.prefetch):null,this.index=new SearchIndex({identify:this.identify,datumTokenizer:o.datumTokenizer,queryTokenizer:o.queryTokenizer}),!1!==o.initialize&&this.initialize()}return old=window&&window.Bloodhound,Bloodhound.noConflict=function(){return window&&(window.Bloodhound=old),Bloodhound},Bloodhound.tokenizers=tokenizers,_.mixin(Bloodhound.prototype,{__ttAdapter:function(){var that=this;return this.remote?function(query,sync,async){return that.search(query,sync,async)}:function(query,sync){return that.search(query,sync)}},_loadPrefetch:function(){var deferred,serialized,that=this;return deferred=$.Deferred(),this.prefetch?(serialized=this.prefetch.fromCache())?(this.index.bootstrap(serialized),deferred.resolve()):this.prefetch.fromNetwork(function(err,data){if(err)return deferred.reject();that.add(data),that.prefetch.store(that.index.serialize()),deferred.resolve()}):deferred.resolve(),deferred.promise()},_initialize:function(){var that=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(function(){that.add(that.local)}),this.initPromise},initialize:function(force){return!this.initPromise||force?this._initialize():this.initPromise},add:function(data){return this.index.add(data),this},get:function(ids){return ids=_.isArray(ids)?ids:[].slice.call(arguments),this.index.get(ids)},search:function(query,sync,async){var local,that=this;return local=this.sorter(this.index.search(query)),sync(this.remote?local.slice():local),this.remote&&local.length<this.sufficient?this.remote.get(query,function(remote){var nonDuplicates=[];_.each(remote,function(r){_.some(local,function(l){return that.identify(r)===that.identify(l)})||nonDuplicates.push(r)}),async&&async(nonDuplicates)}):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return Transport.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),Bloodhound}()}),function(root,factory){"function"==typeof define&&define.amd?define("typeahead.js",["jquery"],function(a0){return factory(a0)}):"object"==typeof exports?module.exports=factory(require("jquery")):factory(jQuery)}(0,function($){var _=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(str){return!str||/^\s*$/.test(str)},escapeRegExChars:function(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(obj){return"string"==typeof obj},isNumber:function(obj){return"number"==typeof obj},isArray:$.isArray,isFunction:$.isFunction,isObject:$.isPlainObject,isUndefined:function(obj){return void 0===obj},isElement:function(obj){return!(!obj||1!==obj.nodeType)},isJQuery:function(obj){return obj instanceof $},toStr:function(s){return _.isUndefined(s)||null===s?"":s+""},bind:$.proxy,each:function(collection,cb){$.each(collection,function(index,value){return cb(value,index)})},map:$.map,filter:$.grep,every:function(obj,test){var result=!0;return obj?($.each(obj,function(key,val){if(!(result=test.call(null,val,key,obj)))return!1}),!!result):result},some:function(obj,test){var result=!1;return obj?($.each(obj,function(key,val){if(result=test.call(null,val,key,obj))return!1}),!!result):result},mixin:$.extend,identity:function(x){return x},clone:function(obj){return $.extend(!0,{},obj)},getIdGenerator:function(){var counter=0;return function(){return counter++}},templatify:function(obj){return $.isFunction(obj)?obj:function(){return String(obj)}},defer:function(fn){setTimeout(fn,0)},debounce:function(func,wait,immediate){var timeout,result;return function(){var later,callNow,context=this,args=arguments;return later=function(){timeout=null,immediate||(result=func.apply(context,args))},callNow=immediate&&!timeout,clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&(result=func.apply(context,args)),result}},throttle:function(func,wait){var context,args,timeout,result,previous,later;return previous=0,later=function(){previous=new Date,timeout=null,result=func.apply(context,args)},function(){var now=new Date,remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args)):timeout=timeout||setTimeout(later,remaining),result}},stringify:function(val){return _.isString(val)?val:JSON.stringify(val)},noop:function(){}}}(),WWW=function(){"use strict";var defaultClassNames={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return function(o){var www,classes;return classes=_.mixin({},defaultClassNames,o),{css:(www={css:function(){var css={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};_.isMsie()&&_.mixin(css.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"});return css}(),classes:classes,html:function(c){return{wrapper:'<span class="'+c.wrapper+'"></span>',menu:'<div class="'+c.menu+'"></div>'}}(classes),selectors:function(classes){var selectors={};return _.each(classes,function(v,k){selectors[k]="."+v}),selectors}(classes)}).css,html:www.html,classes:www.classes,selectors:www.selectors,mixin:function(o){_.mixin(o,www)}}}}(),EventBus=function(){"use strict";var deprecationMap;function EventBus(o){o&&o.el||$.error("EventBus initialized without el"),this.$el=$(o.el)}return"typeahead:",deprecationMap={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"},_.mixin(EventBus.prototype,{_trigger:function(type,args){var $e;return $e=$.Event("typeahead:"+type),(args=args||[]).unshift($e),this.$el.trigger.apply(this.$el,args),$e},before:function(type){var args;return args=[].slice.call(arguments,1),this._trigger("before"+type,args).isDefaultPrevented()},trigger:function(type){var deprecatedType;this._trigger(type,[].slice.call(arguments,1)),(deprecatedType=deprecationMap[type])&&this._trigger(deprecatedType,[].slice.call(arguments,1))}}),EventBus}(),EventEmitter=function(){"use strict";var splitter=/\s+/,nextTick=function(){var nextTickFn;nextTickFn=window.setImmediate?function(fn){setImmediate(function(){fn()})}:function(fn){setTimeout(function(){fn()},0)};return nextTickFn}();return{onSync:function(types,cb,context){return on.call(this,"sync",types,cb,context)},onAsync:function(types,cb,context){return on.call(this,"async",types,cb,context)},off:function(types){var type;if(!this._callbacks)return this;types=types.split(splitter);for(;type=types.shift();)delete this._callbacks[type];return this},trigger:function(types){var type,callbacks,args,syncFlush,asyncFlush;if(!this._callbacks)return this;types=types.split(splitter),args=[].slice.call(arguments,1);for(;(type=types.shift())&&(callbacks=this._callbacks[type]);)syncFlush=getFlush(callbacks.sync,this,[type].concat(args)),asyncFlush=getFlush(callbacks.async,this,[type].concat(args)),syncFlush()&&nextTick(asyncFlush);return this}};function on(method,types,cb,context){var type;if(!cb)return this;for(types=types.split(splitter),cb=context?function(fn,context){return fn.bind?fn.bind(context):function(){fn.apply(context,[].slice.call(arguments,0))}}(cb,context):cb,this._callbacks=this._callbacks||{};type=types.shift();)this._callbacks[type]=this._callbacks[type]||{sync:[],async:[]},this._callbacks[type][method].push(cb);return this}function getFlush(callbacks,context,args){return function(){for(var cancelled,i=0,len=callbacks.length;!cancelled&&i<len;i+=1)cancelled=!1===callbacks[i].apply(context,args);return!cancelled}}}(),highlight=function(doc){"use strict";var defaults={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(o){var regex;(o=_.mixin({},defaults,o)).node&&o.pattern&&(o.pattern=_.isArray(o.pattern)?o.pattern:[o.pattern],regex=function(patterns,caseSensitive,wordsOnly){for(var regexStr,escapedPatterns=[],i=0,len=patterns.length;i<len;i++)escapedPatterns.push(_.escapeRegExChars(patterns[i]));return regexStr=wordsOnly?"\\b("+escapedPatterns.join("|")+")\\b":"("+escapedPatterns.join("|")+")",caseSensitive?new RegExp(regexStr):new RegExp(regexStr,"i")}(o.pattern,o.caseSensitive,o.wordsOnly),function traverse(el,hightlightTextNode){var childNode;for(var i=0;i<el.childNodes.length;i++)3===(childNode=el.childNodes[i]).nodeType?i+=hightlightTextNode(childNode)?1:0:traverse(childNode,hightlightTextNode)}(o.node,function(textNode){var match,patternNode,wrapperNode;(match=regex.exec(textNode.data))&&(wrapperNode=doc.createElement(o.tagName),o.className&&(wrapperNode.className=o.className),(patternNode=textNode.splitText(match.index)).splitText(match[0].length),wrapperNode.appendChild(patternNode.cloneNode(!0)),textNode.parentNode.replaceChild(wrapperNode,patternNode));return!!match}))}}(window.document),Input=function(){"use strict";var specialKeyCodeMap;function Input(o,www){(o=o||{}).input||$.error("input is missing"),www.mixin(this),this.$hint=$(o.hint),this.$input=$(o.input),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=function($input){return $('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:$input.css("font-family"),fontSize:$input.css("font-size"),fontStyle:$input.css("font-style"),fontVariant:$input.css("font-variant"),fontWeight:$input.css("font-weight"),wordSpacing:$input.css("word-spacing"),letterSpacing:$input.css("letter-spacing"),textIndent:$input.css("text-indent"),textRendering:$input.css("text-rendering"),textTransform:$input.css("text-transform")}).insertAfter($input)}(this.$input),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=_.noop)}return specialKeyCodeMap={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},Input.normalizeQuery=function(str){return _.toStr(str).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},_.mixin(Input.prototype,EventEmitter,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function($e){var keyName=specialKeyCodeMap[$e.which||$e.keyCode];this._managePreventDefault(keyName,$e),keyName&&this._shouldTrigger(keyName,$e)&&this.trigger(keyName+"Keyed",$e)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(keyName,$e){var preventDefault;switch(keyName){case"up":case"down":preventDefault=!withModifier($e);break;default:preventDefault=!1}preventDefault&&$e.preventDefault()},_shouldTrigger:function(keyName,$e){var trigger;switch(keyName){case"tab":trigger=!withModifier($e);break;default:trigger=!0}return trigger},_checkLanguageDirection:function(){var dir=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==dir&&(this.dir=dir,this.$hint.attr("dir",dir),this.trigger("langDirChanged",dir))},_setQuery:function(val,silent){var areEquivalent,hasDifferentWhitespace;hasDifferentWhitespace=!!(areEquivalent=function(a,b){return Input.normalizeQuery(a)===Input.normalizeQuery(b)}(val,this.query))&&this.query.length!==val.length,this.query=val,silent||areEquivalent?!silent&&hasDifferentWhitespace&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},bind:function(){var onBlur,onFocus,onKeydown,onInput,that=this;return onBlur=_.bind(this._onBlur,this),onFocus=_.bind(this._onFocus,this),onKeydown=_.bind(this._onKeydown,this),onInput=_.bind(this._onInput,this),this.$input.on("blur.tt",onBlur).on("focus.tt",onFocus).on("keydown.tt",onKeydown),!_.isMsie()||9<_.isMsie()?this.$input.on("input.tt",onInput):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function($e){specialKeyCodeMap[$e.which||$e.keyCode]||_.defer(_.bind(that._onInput,that,$e))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(val,silent){this.setInputValue(val),this._setQuery(val,silent)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(value){this.$input.val(value),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(value){this.$hint.val(value)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var val,hint,valIsPrefixOfHint;valIsPrefixOfHint=(val=this.getInputValue())!==(hint=this.getHint())&&0===hint.indexOf(val),""!==val&&valIsPrefixOfHint&&!this.hasOverflow()||this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var constraint=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=constraint},isCursorAtEnd:function(){var valueLength,selectionStart,range;return valueLength=this.$input.val().length,selectionStart=this.$input[0].selectionStart,_.isNumber(selectionStart)?selectionStart===valueLength:!document.selection||((range=document.selection.createRange()).moveStart("character",-valueLength),valueLength===range.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=$("<div>")}}),Input;function withModifier($e){return $e.altKey||$e.ctrlKey||$e.metaKey||$e.shiftKey}}(),Dataset=function(){"use strict";var keys,nameGenerator;function Dataset(o,www){(o=o||{}).templates=o.templates||{},o.templates.notFound=o.templates.notFound||o.templates.empty,o.source||$.error("missing source"),o.node||$.error("missing node"),o.name&&!function(str){return/^[_a-zA-Z0-9-]+$/.test(str)}(o.name)&&$.error("invalid dataset name: "+o.name),www.mixin(this),this.highlight=!!o.highlight,this.name=o.name||nameGenerator(),this.limit=o.limit||5,this.displayFn=function(display){return display=display||_.stringify,_.isFunction(display)?display:function(obj){return obj[display]}}(o.display||o.displayKey),this.templates=function(templates,displayFn){return{notFound:templates.notFound&&_.templatify(templates.notFound),pending:templates.pending&&_.templatify(templates.pending),header:templates.header&&_.templatify(templates.header),footer:templates.footer&&_.templatify(templates.footer),suggestion:templates.suggestion||function(context){return $("<div>").text(displayFn(context))}}}(o.templates,this.displayFn),this.source=o.source.__ttAdapter?o.source.__ttAdapter():o.source,this.async=_.isUndefined(o.async)?2<this.source.length:!!o.async,this._resetLastSuggestion(),this.$el=$(o.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}return keys={val:"tt-selectable-display",obj:"tt-selectable-object"},nameGenerator=_.getIdGenerator(),Dataset.extractData=function(el){var $el=$(el);return $el.data(keys.obj)?{val:$el.data(keys.val)||"",obj:$el.data(keys.obj)||null}:null},_.mixin(Dataset.prototype,EventEmitter,{_overwrite:function(query,suggestions){(suggestions=suggestions||[]).length?this._renderSuggestions(query,suggestions):this.async&&this.templates.pending?this._renderPending(query):!this.async&&this.templates.notFound?this._renderNotFound(query):this._empty(),this.trigger("rendered",this.name,suggestions,!1)},_append:function(query,suggestions){(suggestions=suggestions||[]).length&&this.$lastSuggestion.length?this._appendSuggestions(query,suggestions):suggestions.length?this._renderSuggestions(query,suggestions):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(query),this.trigger("rendered",this.name,suggestions,!0)},_renderSuggestions:function(query,suggestions){var $fragment;$fragment=this._getSuggestionsFragment(query,suggestions),this.$lastSuggestion=$fragment.children().last(),this.$el.html($fragment).prepend(this._getHeader(query,suggestions)).append(this._getFooter(query,suggestions))},_appendSuggestions:function(query,suggestions){var $fragment,$lastSuggestion;$lastSuggestion=($fragment=this._getSuggestionsFragment(query,suggestions)).children().last(),this.$lastSuggestion.after($fragment),this.$lastSuggestion=$lastSuggestion},_renderPending:function(query){var template=this.templates.pending;this._resetLastSuggestion(),template&&this.$el.html(template({query:query,dataset:this.name}))},_renderNotFound:function(query){var template=this.templates.notFound;this._resetLastSuggestion(),template&&this.$el.html(template({query:query,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(query,suggestions){var fragment,that=this;return fragment=document.createDocumentFragment(),_.each(suggestions,function(suggestion){var $el,context;context=that._injectQuery(query,suggestion),$el=$(that.templates.suggestion(context)).data(keys.obj,suggestion).data(keys.val,that.displayFn(suggestion)).addClass(that.classes.suggestion+" "+that.classes.selectable),fragment.appendChild($el[0])}),this.highlight&&highlight({className:this.classes.highlight,node:fragment,pattern:query}),$(fragment)},_getFooter:function(query,suggestions){return this.templates.footer?this.templates.footer({query:query,suggestions:suggestions,dataset:this.name}):null},_getHeader:function(query,suggestions){return this.templates.header?this.templates.header({query:query,suggestions:suggestions,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=$()},_injectQuery:function(query,obj){return _.isObject(obj)?_.mixin({_query:query},obj):obj},update:function(query){var that=this,canceled=!1,syncCalled=!1,rendered=0;function sync(suggestions){syncCalled||(syncCalled=!0,suggestions=(suggestions||[]).slice(0,that.limit),rendered=suggestions.length,that._overwrite(query,suggestions),rendered<that.limit&&that.async&&that.trigger("asyncRequested",query))}this.cancel(),this.cancel=function(){canceled=!0,that.cancel=$.noop,that.async&&that.trigger("asyncCanceled",query)},this.source(query,sync,function(suggestions){suggestions=suggestions||[],!canceled&&rendered<that.limit&&(that.cancel=$.noop,rendered+=suggestions.length,that._append(query,suggestions.slice(0,that.limit-rendered)),that.async&&that.trigger("asyncReceived",query))}),syncCalled||sync([])},cancel:$.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=$("<div>")}}),Dataset}(),Menu=function(){"use strict";function Menu(o,www){var that=this;(o=o||{}).node||$.error("node is required"),www.mixin(this),this.$node=$(o.node),this.query=null,this.datasets=_.map(o.datasets,function(oDataset){var node=that.$node.find(oDataset.node).first();return oDataset.node=node.length?node:$("<div>").appendTo(that.$node),new Dataset(oDataset,www)})}return _.mixin(Menu.prototype,EventEmitter,{_onSelectableClick:function($e){this.trigger("selectableClicked",$($e.currentTarget))},_onRendered:function(type,dataset,suggestions,async){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",dataset,suggestions,async)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){return _.every(this.datasets,function(dataset){return dataset.isEmpty()})},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var $selectable=this.getActiveSelectable();$selectable&&$selectable.removeClass(this.classes.cursor)},_ensureVisible:function($el){var elTop,elBottom,nodeScrollTop,nodeHeight;elBottom=(elTop=$el.position().top)+$el.outerHeight(!0),nodeScrollTop=this.$node.scrollTop(),nodeHeight=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10),elTop<0?this.$node.scrollTop(nodeScrollTop+elTop):nodeHeight<elBottom&&this.$node.scrollTop(nodeScrollTop+(elBottom-nodeHeight))},bind:function(){var onSelectableClick,that=this;return onSelectableClick=_.bind(this._onSelectableClick,this),this.$node.on("click.tt",this.selectors.selectable,onSelectableClick),_.each(this.datasets,function(dataset){dataset.onSync("asyncRequested",that._propagate,that).onSync("asyncCanceled",that._propagate,that).onSync("asyncReceived",that._propagate,that).onSync("rendered",that._onRendered,that).onSync("cleared",that._onCleared,that)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(dir){this.$node.attr("dir",dir)},selectableRelativeToCursor:function(delta){var $selectables,$oldCursor,newIndex;return $oldCursor=this.getActiveSelectable(),$selectables=this._getSelectables(),-1===(newIndex=(newIndex=((newIndex=($oldCursor?$selectables.index($oldCursor):-1)+delta)+1)%($selectables.length+1)-1)<-1?$selectables.length-1:newIndex)?null:$selectables.eq(newIndex)},setCursor:function($selectable){this._removeCursor(),($selectable=$selectable&&$selectable.first())&&($selectable.addClass(this.classes.cursor),this._ensureVisible($selectable))},getSelectableData:function($el){return $el&&$el.length?Dataset.extractData($el):null},getActiveSelectable:function(){var $selectable=this._getSelectables().filter(this.selectors.cursor).first();return $selectable.length?$selectable:null},getTopSelectable:function(){var $selectable=this._getSelectables().first();return $selectable.length?$selectable:null},update:function(query){var isValidUpdate=query!==this.query;return isValidUpdate&&(this.query=query,_.each(this.datasets,function(dataset){dataset.update(query)})),isValidUpdate},empty:function(){_.each(this.datasets,function(dataset){dataset.clear()}),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){this.$node.off(".tt"),this.$node=$("<div>"),_.each(this.datasets,function(dataset){dataset.destroy()})}}),Menu}(),DefaultMenu=function(){"use strict";var s=Menu.prototype;function DefaultMenu(){Menu.apply(this,[].slice.call(arguments,0))}return _.mixin(DefaultMenu.prototype,Menu.prototype,{open:function(){return this._allDatasetsEmpty()||this._show(),s.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),s.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),s._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),s._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(dir){return this.$node.css("ltr"===dir?this.css.ltr:this.css.rtl),s.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),DefaultMenu}(),Typeahead=function(){"use strict";function Typeahead(o,www){var onFocused,onBlurred,onEnterKeyed,onTabKeyed,onEscKeyed,onUpKeyed,onDownKeyed,onLeftKeyed,onRightKeyed,onQueryChanged,onWhitespaceChanged;(o=o||{}).input||$.error("missing input"),o.menu||$.error("missing menu"),o.eventBus||$.error("missing event bus"),www.mixin(this),this.eventBus=o.eventBus,this.minLength=_.isNumber(o.minLength)?o.minLength:1,this.input=o.input,this.menu=o.menu,this.enabled=!0,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),onFocused=c(this,"activate","open","_onFocused"),onBlurred=c(this,"deactivate","_onBlurred"),onEnterKeyed=c(this,"isActive","isOpen","_onEnterKeyed"),onTabKeyed=c(this,"isActive","isOpen","_onTabKeyed"),onEscKeyed=c(this,"isActive","_onEscKeyed"),onUpKeyed=c(this,"isActive","open","_onUpKeyed"),onDownKeyed=c(this,"isActive","open","_onDownKeyed"),onLeftKeyed=c(this,"isActive","isOpen","_onLeftKeyed"),onRightKeyed=c(this,"isActive","isOpen","_onRightKeyed"),onQueryChanged=c(this,"_openIfActive","_onQueryChanged"),onWhitespaceChanged=c(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",onFocused,this).onSync("blurred",onBlurred,this).onSync("enterKeyed",onEnterKeyed,this).onSync("tabKeyed",onTabKeyed,this).onSync("escKeyed",onEscKeyed,this).onSync("upKeyed",onUpKeyed,this).onSync("downKeyed",onDownKeyed,this).onSync("leftKeyed",onLeftKeyed,this).onSync("rightKeyed",onRightKeyed,this).onSync("queryChanged",onQueryChanged,this).onSync("whitespaceChanged",onWhitespaceChanged,this).onSync("langDirChanged",this._onLangDirChanged,this)}return _.mixin(Typeahead.prototype,{_hacks:function(){var $input,$menu;$input=this.input.$input||$("<div>"),$menu=this.menu.$node||$("<div>"),$input.on("blur.tt",function($e){var active,isActive,hasActive;active=document.activeElement,isActive=$menu.is(active),hasActive=0<$menu.has(active).length,_.isMsie()&&(isActive||hasActive)&&($e.preventDefault(),$e.stopImmediatePropagation(),_.defer(function(){$input.focus()}))}),$menu.on("mousedown.tt",function($e){$e.preventDefault()})},_onSelectableClicked:function(type,$el){this.select($el)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(type,dataset,suggestions,async){this._updateHint(),this.eventBus.trigger("render",suggestions,async,dataset)},_onAsyncRequested:function(type,dataset,query){this.eventBus.trigger("asyncrequest",query,dataset)},_onAsyncCanceled:function(type,dataset,query){this.eventBus.trigger("asynccancel",query,dataset)},_onAsyncReceived:function(type,dataset,query){this.eventBus.trigger("asyncreceive",query,dataset)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(type,$e){var $selectable;($selectable=this.menu.getActiveSelectable())&&this.select($selectable)&&$e.preventDefault()},_onTabKeyed:function(type,$e){var $selectable;($selectable=this.menu.getActiveSelectable())?this.select($selectable)&&$e.preventDefault():($selectable=this.menu.getTopSelectable())&&this.autocomplete($selectable)&&$e.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onQueryChanged:function(e,query){this._minLengthMet(query)?this.menu.update(query):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(e,dir){this.dir!==dir&&(this.dir=dir,this.menu.setLanguageDirection(dir))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(query){return(query=_.isString(query)?query:this.input.getQuery()||"").length>=this.minLength},_updateHint:function(){var $selectable,data,val,query,escapedQuery,match;$selectable=this.menu.getTopSelectable(),data=this.menu.getSelectableData($selectable),val=this.input.getInputValue(),!data||_.isBlankString(val)||this.input.hasOverflow()?this.input.clearHint():(query=Input.normalizeQuery(val),escapedQuery=_.escapeRegExChars(query),(match=new RegExp("^(?:"+escapedQuery+")(.+$)","i").exec(data.val))&&this.input.setHint(val+match[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return!!this.isActive()||!(!this.isEnabled()||this.eventBus.before("active"))&&(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return!this.isActive()||!this.eventBus.before("idle")&&(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0)},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(val){this.input.setQuery(_.toStr(val))},getVal:function(){return this.input.getQuery()},select:function($selectable){var data=this.menu.getSelectableData($selectable);return!(!data||this.eventBus.before("select",data.obj))&&(this.input.setQuery(data.val,!0),this.eventBus.trigger("select",data.obj),this.close(),!0)},autocomplete:function($selectable){var query,data;return query=this.input.getQuery(),!(!((data=this.menu.getSelectableData($selectable))&&query!==data.val)||this.eventBus.before("autocomplete",data.obj))&&(this.input.setQuery(data.val),this.eventBus.trigger("autocomplete",data.obj),!0)},moveCursor:function(delta){var query,$candidate,data,payload;return query=this.input.getQuery(),$candidate=this.menu.selectableRelativeToCursor(delta),payload=(data=this.menu.getSelectableData($candidate))?data.obj:null,!(this._minLengthMet()&&this.menu.update(query))&&!this.eventBus.before("cursorchange",payload)&&(this.menu.setCursor($candidate),data?this.input.setInputValue(data.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",payload),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),Typeahead;function c(ctx){var methods=[].slice.call(arguments,1);return function(){var args=[].slice.call(arguments);_.each(methods,function(method){return ctx[method].apply(ctx,args)})}}}();!function(){"use strict";var old,keys,methods;function ttEach($els,fn){$els.each(function(){var typeahead,$input=$(this);(typeahead=$input.data(keys.typeahead))&&fn(typeahead,$input)})}function $elOrNull(obj){var $el;return($el=_.isJQuery(obj)||_.isElement(obj)?$(obj).first():[]).length?$el:null}old=$.fn.typeahead,keys={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},methods={initialize:function(o,datasets){var www;return datasets=_.isArray(datasets)?datasets:[].slice.call(arguments,1),www=WWW((o=o||{}).classNames),this.each(function(){var $input,$wrapper,$hint,$menu,defaultHint,defaultMenu,eventBus,input,menu,typeahead,MenuConstructor;_.each(datasets,function(d){d.highlight=!!o.highlight}),$input=$(this),$wrapper=$(www.html.wrapper),$hint=$elOrNull(o.hint),$menu=$elOrNull(o.menu),defaultHint=!1!==o.hint&&!$hint,defaultMenu=!1!==o.menu&&!$menu,defaultHint&&($hint=function($input,www){return $input.clone().addClass(www.classes.hint).removeData().css(www.css.hint).css(function($el){return{backgroundAttachment:$el.css("background-attachment"),backgroundClip:$el.css("background-clip"),backgroundColor:$el.css("background-color"),backgroundImage:$el.css("background-image"),backgroundOrigin:$el.css("background-origin"),backgroundPosition:$el.css("background-position"),backgroundRepeat:$el.css("background-repeat"),backgroundSize:$el.css("background-size")}}($input)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}($input,www)),defaultMenu&&($menu=$(www.html.menu).css(www.css.menu)),$hint&&$hint.val(""),$input=function($input,www){$input.data(keys.attrs,{dir:$input.attr("dir"),autocomplete:$input.attr("autocomplete"),spellcheck:$input.attr("spellcheck"),style:$input.attr("style")}),$input.addClass(www.classes.input).attr({autocomplete:"off",spellcheck:!1});try{$input.attr("dir")||$input.attr("dir","auto")}catch(e){}return $input}($input,www),(defaultHint||defaultMenu)&&($wrapper.css(www.css.wrapper),$input.css(defaultHint?www.css.input:www.css.inputWithNoHint),$input.wrap($wrapper).parent().prepend(defaultHint?$hint:null).append(defaultMenu?$menu:null));MenuConstructor=defaultMenu?DefaultMenu:Menu,eventBus=new EventBus({el:$input}),input=new Input({hint:$hint,input:$input},www),menu=new MenuConstructor({node:$menu,datasets:datasets},www),typeahead=new Typeahead({input:input,menu:menu,eventBus:eventBus,minLength:o.minLength},www),$input.data(keys.www,www),$input.data(keys.typeahead,typeahead)})},isEnabled:function(){var enabled;return ttEach(this.first(),function(t){enabled=t.isEnabled()}),enabled},enable:function(){return ttEach(this,function(t){t.enable()}),this},disable:function(){return ttEach(this,function(t){t.disable()}),this},isActive:function(){var active;return ttEach(this.first(),function(t){active=t.isActive()}),active},activate:function(){return ttEach(this,function(t){t.activate()}),this},deactivate:function(){return ttEach(this,function(t){t.deactivate()}),this},isOpen:function(){var open;return ttEach(this.first(),function(t){open=t.isOpen()}),open},open:function(){return ttEach(this,function(t){t.open()}),this},close:function(){return ttEach(this,function(t){t.close()}),this},select:function(el){var success=!1,$el=$(el);return ttEach(this.first(),function(t){success=t.select($el)}),success},autocomplete:function(el){var success=!1,$el=$(el);return ttEach(this.first(),function(t){success=t.autocomplete($el)}),success},moveCursor:function(delta){var success=!1;return ttEach(this.first(),function(t){success=t.moveCursor(delta)}),success},val:function(newVal){var query;return arguments.length?(ttEach(this,function(t){t.setVal(newVal)}),this):(ttEach(this.first(),function(t){query=t.getVal()}),query)},destroy:function(){return ttEach(this,function(typeahead,$input){!function($input){var www,$wrapper;www=$input.data(keys.www),$wrapper=$input.parent().filter(www.selectors.wrapper),_.each($input.data(keys.attrs),function(val,key){_.isUndefined(val)?$input.removeAttr(key):$input.attr(key,val)}),$input.removeData(keys.typeahead).removeData(keys.www).removeData(keys.attr).removeClass(www.classes.input),$wrapper.length&&($input.detach().insertAfter($wrapper),$wrapper.remove())}($input),typeahead.destroy()}),this}},$.fn.typeahead=function(method){return methods[method]?methods[method].apply(this,[].slice.call(arguments,1)):methods.initialize.apply(this,arguments)},$.fn.typeahead.noConflict=function(){return $.fn.typeahead=old,this}}()}),Priority={name:function(v){return 0==v?"N/A":1==v?"Low":2==v?"Medium":"3"==v?"High":void 0}},DBO=function(data){this.init(data)},DBO.prototype.constructor=DBO,DBO.prototype.init=function(data){this.fields=data,this.rowSelector=null},DBO.prototype.initPriorities=function(field){var txt=this.field(field);if(void 0!==txt&&0!=txt.length)for(var pris=txt.split(","),i=0;i<pris.length;++i){var bits=pris[i].split("="),game_id=bits[0],game_priority=bits[1];this["priority_"+game_id]=game_priority}else this["priority_"+impresslist.config.user.game]=0},DBO.prototype.priority=function(){var ret=this["priority_"+impresslist.config.user.game];return void 0===ret?0:ret},DBO.prototype.countrySelectHtml=function(type){var html="<label for='country'>Country:</label>",country=this.field("country");for(var countryCode in html+="\t<select data-"+type+"-id='"+this.id+"' data-input-field='country' class='form-control'>",impresslist.config.misc.countries)html+="\t<option value='"+countryCode+"' "+(countryCode==country?"selected='true'":"")+">"+impresslist.config.misc.countries[countryCode]+"</option>";return html+="\t</select>"},DBO.prototype.onAdded=function(){},DBO.prototype.onRemoved=function(){},DBO.prototype.field=function(f){var r=this.fields[f];return null==r?(console.error("field "+f+" was null."),console.error(this.fields),""):r},DBO.prototype.twitterCell=function(){var str="N/A";return 0<this.fields.twitter.length&&(str="<a href='http://twitter.com/"+this.fields.twitter+"' target='new'>"+new Number(this.fields.twitter_followers).toLocaleString()+"</a>"),str},DBO.prototype.filterTags=function(tagsArray){if(0==tagsArray.length)return this.show(),!0;var tags=this.field("tags");if(void 0===tags)return this.show(),!0;if("string"==typeof tags&&0==tags.length)return this.hide(),!1;for(var containsAll=!0,i=0;i<tagsArray.length;i++)if(-1==tags.indexOf(tagsArray[i])){containsAll=!1;break}return containsAll?(this.show(),!0):(this.hide(),!1)},DBO.prototype.show=function(){this.rowSelector&&$(this.rowSelector).show()},DBO.prototype.hide=function(){this.rowSelector&&$(this.rowSelector).hide()},Email=function(data){DBO.call(this,data)},Email.prototype=Object.create(DBO.prototype),Email.prototype.constructor=Email,Email.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id"))},WatchedGame=function(data){DBO.call(this,data)},WatchedGame.prototype=Object.create(DBO.prototype),WatchedGame.prototype.constructor=WatchedGame,WatchedGame.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id")),this.coverage=this.field("coverage"),this.rowSelector="#watchedgames [data-watchedgame-id='"+this.id+"']"},WatchedGame.prototype.filter=function(text){return this.search(text)?(this.show(),!0):(this.hide(),!1)},WatchedGame.prototype.search=function(text){return!0},WatchedGame.prototype.createItem=function(fromInit){console.log(this);var html="";html+="<br/> \t\t\t\t<div data-watchedgame-id='"+this.field("id")+"' class='media'>\t\t\t\t\t\t<div class='oa'>\t\t\t\t\t\t<div class='fl'>\t\t\t\t\t\t\t<h4 data-watchedgame-id='"+this.id+"' data-field='name'>"+this.field("name")+"</h4>\t\t\t\t\t\t\t\x3c!-- <p data-watchedgame-id='"+this.id+"' data-field='keywords' style='font-style:italic'>"+this.field("keywords")+"</p><br/> --\x3e\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class='fr'>\t\t\t\t\t\t\t<button id='edit-watchedgame' class='fr btn btn-default btn-sm' data-watchedgame-id='"+this.field("id")+"'  data-toggle='modal' data-target='.watchedgame_modal' ><span class='glyphicon glyphicon-pencil'></span></button> \t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<h5>Coverage:</h5>\t\t\t\t\t<div data-watchedgame-id='"+this.id+"' data-field='items'>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t\t",fromInit?$("#watchedgames").append(html):$("#watchedgames").prepend(html),this.update();for(var i=0;i<this.coverage.length;i++){new Coverage(this.coverage[i]).createItem(fromInit,"[data-watchedgame-id='"+this.id+"'][data-field='items']")}if(0==this.coverage.length){$("[data-watchedgame-id='"+this.id+"'][data-field='items']").append("<div class='alert alert-info' role='alert'> \t\t\t\t\t\t\t<span class='glyphicon glyphicon-thumbs-down' aria-hidden='true'></span> \t\t\t\t\t\t\t<span class='sr-only'>Error:</span> \t\t\t\t\t\t\tDang! There is currently no coverage for this Watched Game.\t\t\t\t\t\t</div>")}var t=this;$("#edit-watchedgame[data-watchedgame-id='"+this.id+"']").click(function(){t.open()})},WatchedGame.prototype.update=function(){$("[data-watchedgame-id='"+this.id+"'][data-field='name']").html(this.field("name"))},WatchedGame.prototype.open=function(){var html="<div class='modal fade watchedgame_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'> \t\t\t\t\t\t\t\t<div style='min-height:100px;padding:20px;'>";html+="\t\t\t\t<h3>Edit Watched Game</h3>",html+="\t\t\t\t<form role='form' class='oa' onsubmit='return false;'>\t\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-5'>\t\t\t\t\t\t\t\t\t\t\t\t<label>Name:</label> \t\t\t\t\t\t\t\t\t\t\t\t<input id='watchedgame-edit-name' class='form-control' type='text' value='"+this.field("name")+"' style='width:100%;'/>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-5'>\t\t\t\t\t\t\t\t\t\t\t\t<label>Keywords/Search Terms:</label> \t\t\t\t\t\t\t\t\t\t\t\t<input id='watchedgame-edit-keywords' class='form-control' type='text' value='"+this.field("keywords")+"' style='width:100%;'/>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t\t<div class='fl'> \t\t\t\t\t\t\t\t\t\t\t<button id='save_watchedGameId"+this.id+"' type='submit' class='btn btn-primary'>Save</button>",html+="\t\t\t\t\t\t&nbsp;<button id='close_watchedGameId"+this.id+"' type='submit' class='btn btn-default'>Close</button>",html+=" \t\t\t\t\t</div><div class='fr'> \t\t\t\t\t\t\t\t\t\t\t<button id='delete_watchedGameId"+this.id+"' type='submit' class='btn btn-danger'>Remove</button> \t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</form>",html+="\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>",$("#modals").html(html);var watchedGame=this;$("#save_watchedGameId"+this.id).click(function(){watchedGame.save()}),$("#close_watchedGameId"+this.id).click(function(){watchedGame.close()}),$("#delete_watchedGameId"+this.id).click(function(){watchedGame.remove()})},WatchedGame.prototype.onAdded=function(fromInit){this.createItem(fromInit)},WatchedGame.prototype.onRemoved=function(){this.removeItem(),this.close()},WatchedGame.prototype.save=function(){var name=$("#watchedgame-edit-name").val(),keywords=$("#watchedgame-edit-keywords").val();API.saveWatchedGame(this,name,keywords)},WatchedGame.prototype.close=function(){$(".watchedgame_modal").modal("hide")},WatchedGame.prototype.remove=function(){API.removeWatchedGame(this)},Coverage=function(data){DBO.call(this,data)},Coverage.prototype=Object.create(DBO.prototype),Coverage.prototype.constructor=Coverage,Coverage.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id")),this.rowSelector="#coverage [data-coverage-id='"+this.id+"']"},Coverage.prototype.filter=function(text){return this.search(text)?(this.show(),!0):(this.hide(),!1)},Coverage.prototype.search=function(text){var ret=!0;if(0==text.length)return ret;if(ret=-1!=this.field("url").toLowerCase().indexOf(text))return ret;if("publication"==this.field("type"))for(var i=0;i<impresslist.publications.length;++i){if(impresslist.publications[i].field("id")==this.field("publication"))if(ret=impresslist.findPublicationById(this.field("publication")).search(text))return ret}else if("youtuber"==this.field("type"))for(i=0;i<impresslist.youtubers.length;++i){if(impresslist.youtubers[i].field("id")==this.field("youtuber"))if(ret=impresslist.findYoutuberById(this.field("youtuber")).search(text))return ret}else if("twitchchannel"==this.field("type"))for(i=0;i<impresslist.twitchchannels.length;++i){if(impresslist.twitchchannels[i].field("id")==this.field("twitchchannel"))if(ret=impresslist.findTwitchChannelById(this.field("twitchchannel")).search(text))return ret}return!1},Coverage.prototype.createItem=function(fromInit,parent){parent=parent||"#coverage";var html,url="",iconurl="images/favicon.png";if("publication"in this.fields&&0<this.fields.publication){var publication=impresslist.findPublicationById(this.field("publication"));null!=publication&&(url=publication.field("url"),iconurl=publication.field("iconurl"))}var type=this.field("type");if("publication"==type?html="\t\t<div class='coverage-row' data-coverage-id='"+this.field("id")+"' data-coverage-type='"+this.field("type")+"'>\t\t\t\t\t\t\t\t\t<div class='media-left' style='min-width:50px; width:50px;'> \t\t\t\t\t\t\t\t\t<img class='media-object fl' style='width:50px;text-align:right;' src='/images/icon-web.png' alt='Image'></a> \t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div class='media-left' style='min-width:74px; width:74px;'> \t\t\t\t\t\t\t\t\t<a href='"+url+"' style='text-align:right;'><img class='media-object fr' style='width:16px;text-align:right;' src='"+iconurl+"' alt='Image'></a> \t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div class='media-body'> \t\t\t\t\t\t\t\t\t<div class='fr' style='text-align:right;'>\t\t\t\t\t\t\t\t\t\t<p style='margin-bottom:5px;font-style:italic;'><span data-coverage-id='"+this.id+"' data-person-id='"+this.fields.person+"' data-field='person-name'></span> - <span data-coverage-id='"+this.id+"' data-field='utime' >"+impresslist.util.relativetime_contact(this.field("utime"))+"</span></p>\t\t\t\t\t\t\t\t\t\t<p data-coverage-id='"+this.id+"' data-field='thanked'></p>\t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t<h4 data-coverage-id='"+this.id+"' data-field='name' data-publication-id='"+this.fields.publication+"' class='media-heading' ></h4> \t\t\t\t\t\t\t\t\t<p><a data-coverage-id='"+this.id+"' data-field='url' href='"+this.field("url")+"' target='new'>"+this.field("title")+"</a><br/>\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div class='media-right'> \t\t\t\t\t\t\t\t\t<button id='edit-coverage' class='btn btn-default btn-lg' data-coverage-id='"+this.field("id")+"'  data-toggle='modal' data-target='.coverage_modal' ><span class='glyphicon glyphicon-pencil'></span></button> \t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t</div>":"youtuber"==type?(iconurl=this.field("thumbnail"),html="\t\t<div class='coverage-row' data-youtube-coverage-id='"+this.field("id")+"' data-coverage-type='"+this.field("type")+"'>\t\t\t\t\t\t\t\t\t<div class='media-left' style='min-width:50px; width:50px;'> \t\t\t\t\t\t\t\t\t<img class='media-object fl' style='width:50px;text-align:right;' src='/images/icon-youtube.png' alt='Image'></a> \t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div class='media-left'> \t\t\t\t\t\t\t\t\t<a href='"+url+"'><img data-youtube-coverage-id='"+this.id+"' data-field='thumbnail' class='media-object' width=64 src='"+iconurl+"' alt='Image'></a> \t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div class='media-body'> \t\t\t\t\t\t\t\t\t<div class='fr' style='text-align:right;'>\t\t\t\t\t\t\t\t\t\t<p style='margin-bottom:5px;font-style:italic;'><span data-youtube-coverage-id='"+this.id+"' data-field='utime' >"+impresslist.util.relativetime_contact(this.field("utime"))+"</span></p>\t\t\t\t\t\t\t\t\t\t<p data-youtube-coverage-id='"+this.id+"' data-field='thanked'></p>\t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t<h4 data-youtube-coverage-id='"+this.id+"' data-field='name' data-youtuber-id='"+this.fields.youtuber+"' class='media-heading' >Unknown Youtuber</h4> \t\t\t\t\t\t\t\t\t<p><a data-youtube-coverage-id='"+this.id+"' data-field='url' href='"+this.field("url")+"' target='new'>"+this.field("title")+"</a><br/>\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div class='media-right'> \t\t\t\t\t\t\t\t\t<button id='edit-youtube-coverage' class='btn btn-default btn-lg' data-youtube-coverage-id='"+this.field("id")+"'  data-toggle='modal' data-target='.coverage_modal' ><span class='glyphicon glyphicon-pencil'></span></button> \t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t</div>"):"twitchchannel"==type&&(iconurl=this.field("thumbnail"),html="\t\t<div data-twitchchannel-coverage-id='"+this.field("id")+"' data-coverage-type='"+this.field("type")+"' class='media'>\t\t\t\t\t\t\t\t\t<div class='media-left' style='min-width:50px; width:50px;'> \t\t\t\t\t\t\t\t\t<img class='media-object fl' style='width:50px;text-align:right;' src='/images/icon-twitch.png' alt='Image'></a> \t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div class='media-left'> \t\t\t\t\t\t\t\t\t<a href='"+url+"'><img data-twitchchannel-coverage-id='"+this.id+"' data-field='thumbnail' class='media-object' width=64 src='"+encodeURIComponent(iconurl)+"' alt='Image'></a> \t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div class='media-body'> \t\t\t\t\t\t\t\t\t<div class='fr' style='text-align:right;'>\t\t\t\t\t\t\t\t\t\t<p style='margin-bottom:5px;font-style:italic;'><span data-twitchchannel-coverage-id='"+this.id+"' data-field='utime' >"+impresslist.util.relativetime_contact(this.field("utime"))+"</span></p>\t\t\t\t\t\t\t\t\t\t<p data-twitchchannel-coverage-id='"+this.id+"' data-field='thanked'></p>\t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t<h4 data-twitchchannel-coverage-id='"+this.id+"' data-field='name' data-youtuber-id='"+this.fields.twitchchannel+"' class='media-heading' >Unknown Twitch Channel</h4> \t\t\t\t\t\t\t\t\t<p><a data-twitchchannel-coverage-id='"+this.id+"' data-field='url' href='"+this.field("url")+"' target='new'>"+this.field("title")+"</a><br/>\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div class='media-right'> \t\t\t\t\t\t\t\t\t<button id='edit-twitchchannel-coverage' class='btn btn-default btn-lg' data-twitchchannel-coverage-id='"+this.field("id")+"'  data-toggle='modal' data-target='.coverage_modal' ><span class='glyphicon glyphicon-pencil'></span></button> \t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t</div>"),fromInit?$(parent).append(html):$(parent).prepend(html),this.update(),"publication"==type){var t=this;$("#edit-coverage[data-coverage-id='"+this.id+"']").click(function(){t.open()})}else if("youtuber"==type){t=this;$("#edit-youtube-coverage[data-youtube-coverage-id='"+this.id+"']").click(function(){t.open()})}else if("twitchchannel"==type){t=this;$("#edit-twitchchannel-coverage[data-twitchchannel-coverage-id='"+this.id+"']").click(function(){t.open()})}},Coverage.prototype.removeItem=function(){"publication"==this.field("type")?$(".media[data-coverage-id='"+this.field("id")+"']").remove():"youtuber"==this.field("type")?$(".media[data-youtube-coverage-id='"+this.field("id")+"']").remove():"twitchchannel"==this.field("type")&&$(".media[data-twitchchannel-coverage-id='"+this.field("id")+"']").remove()},Coverage.prototype.getPersonName=function(){var p=this.fields.person;return 0<p?impresslist.findPersonById(p).fullname():0<this.fields.youtuber?"":0<this.fields.twitchchannel?"":"Unknown"},Coverage.prototype.open=function(){var publicationId="",publicationName="";0<this.fields.publication&&(publicationId=this.fields.publication,publicationName=impresslist.findPublicationById(publicationId).field("name"));var youtuberId="",youtuberName="";0<this.fields.youtuber&&(youtuberId=this.fields.youtuber,youtuberName=impresslist.findYoutuberById(youtuberId).field("name"));var twitchchannelId="",twitchchannelName="";0<this.fields.twitchchannel&&(twitchchannelId=this.fields.twitchchannel,twitchchannelName=impresslist.findTwitchChannelById(twitchchannelId).field("name"));var personId="",personName="";0<this.fields.person&&(personId=this.fields.person,personName=impresslist.findPersonById(personId).field("name"));var html="<div class='modal fade coverage_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'> \t\t\t\t\t\t\t\t<div style='min-height:100px;padding:20px;'>";html+="\t\t\t\t<h3>Edit Coverage ("+this.field("type")+")</h3>",html+="\t\t\t\t<form role='form' class='oa' onsubmit='return false;'>\t\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-5'>\t\t\t\t\t\t\t\t\t\t\t\t<label>Time:</label> \t\t\t\t\t\t\t\t\t\t\t\t<div class='input-group date' id='coverage-timepicker'>\t\t\t\t\t\t\t\t\t\t\t\t\t<input id='coverage-edit-timestamp' type='text' class='form-control' />\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class='input-group-addon'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class='glyphicon glyphicon-calendar'></span>\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>","publication"==this.field("type")?html+="\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-2'>\t\t\t\t\t\t\t\t\t\t\t\t\t<label>Publication:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t\t<input id='coverage-edit-publication-id' class='form-control' type='text' value='"+publicationId+"' style='width:100%;'/>\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-4'>\t\t\t\t\t\t\t\t\t\t\t\t\t<label>&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t\t<input id='coverage-edit-publication-search' data-coverage-id='"+this.id+"' data-input-field='publication' class='form-control' type='text' value='"+publicationName+"' placeholder='Search...' />\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t\t<div id='coverage-edit-publication-results-container' class='form-group col-md-6' style='display:none;'>\t\t\t\t\t\t\t\t\t\t\t\t\t<label>Results:</label>\t\t\t\t\t\t\t\t\t\t\t\t\t<table class='table table-striped' style='margin-bottom:0px;'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tbody id='coverage-edit-publication-results'> \t\t\t\t\t\t\t\t\t\t\t\t\t\t</tbody> \t\t\t\t\t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t</div>":"youtuber"==this.field("type")?html+="\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-2'>\t\t\t\t\t\t\t\t\t\t\t\t\t<label>Youtuber:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t\t<input id='coverage-edit-youtuber-id' class='form-control' type='text' value='"+youtuberId+"' style='width:100%;'/>\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-4'>\t\t\t\t\t\t\t\t\t\t\t\t\t<label>&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t\t<input id='coverage-edit-youtuber-search' data-youtube-coverage-id='"+this.id+"' data-input-field='youtuber' class='form-control' type='text' value='"+youtuberName+"' placeholder='Search...' />\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t\t<div id='coverage-edit-youtuber-results-container' class='form-group col-md-6' style='display:none;'>\t\t\t\t\t\t\t\t\t\t\t\t\t<label>Results:</label>\t\t\t\t\t\t\t\t\t\t\t\t\t<table class='table table-striped' style='margin-bottom:0px;'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tbody id='coverage-edit-youtuber-results'> \t\t\t\t\t\t\t\t\t\t\t\t\t\t</tbody> \t\t\t\t\t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t</div>":"twitchchannel"==this.field("type")&&(html+="\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-2'>\t\t\t\t\t\t\t\t\t\t\t\t\t<label>Twitchchannel:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t\t<input id='coverage-edit-twitchchannel-id' class='form-control' type='text' value='"+twitchchannelId+"' style='width:100%;'/>\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-4'>\t\t\t\t\t\t\t\t\t\t\t\t\t<label>&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t\t<input id='coverage-edit-twitchchannel-search' data-twitchchannel-coverage-id='"+this.id+"' data-input-field='twitchchannel' class='form-control' type='text' value='"+twitchchannelName+"' placeholder='Search...' />\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t\t<div id='coverage-edit-twitchchannel-results-container' class='form-group col-md-6' style='display:none;'>\t\t\t\t\t\t\t\t\t\t\t\t\t<label>Results:</label>\t\t\t\t\t\t\t\t\t\t\t\t\t<table class='table table-striped' style='margin-bottom:0px;'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tbody id='coverage-edit-twitchchannel-results'> \t\t\t\t\t\t\t\t\t\t\t\t\t\t</tbody> \t\t\t\t\t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t</div>"),html+="\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-2'>\t\t\t\t\t\t\t\t\t\t\t\t<label>Person:</label> \t\t\t\t\t\t\t\t\t\t\t\t<input id='coverage-edit-person-id' class='form-control' type='text' value='"+personId+"' style='width:100%;'/>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-4'>\t\t\t\t\t\t\t\t\t\t\t\t<label>&nbsp; </label>\t\t\t\t\t\t\t\t\t\t\t\t<input id='coverage-edit-person-search' data-coverage-id='"+this.id+"' data-input-field='person' class='form-control' type='text' value='"+personName+"' placeholder='Search...' />\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div id='coverage-edit-person-results-container' class='form-group col-md-6' style='display:none;'>\t\t\t\t\t\t\t\t\t\t\t\t<label>Results:</label>\t\t\t\t\t\t\t\t\t\t\t\t<table class='table table-striped' style='margin-bottom:0px;'>\t\t\t\t\t\t\t\t\t\t\t\t\t<tbody id='coverage-edit-person-results'> \t\t\t\t\t\t\t\t\t\t\t\t\t</tbody> \t\t\t\t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-12'>\t\t\t\t\t\t\t\t\t\t\t\t<label>Title:</label> \t\t\t\t\t\t\t\t\t\t\t\t<input id='coverage-edit-title' data-coverage-id='"+this.id+"' data-input-field='title' class='form-control' type='text' value='' />\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-12'>\t\t\t\t\t\t\t\t\t\t\t\t<label>URL:</label> \t\t\t\t\t\t\t\t\t\t\t\t<input id='coverage-edit-url' data-coverage-id='"+this.id+"' data-input-field='url' class='form-control' type='text' value='"+this.field("url")+"' />\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-4'>\t\t\t\t\t\t\t\t\t\t\t\t<label class='checkbox-inline'><input id='coverage-edit-thanked' type='checkbox' "+(1==this.field("thanked")?"checked":"")+">Thanked?</label>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='fl'> \t\t\t\t\t\t\t\t\t\t\t<button id='save_coverageId"+this.id+"' type='submit' class='btn btn-primary'>Save</button>",html+="\t\t\t\t\t\t&nbsp;<button id='close_coverageId"+this.id+"' type='submit' class='btn btn-default'>Close</button>",html+=" \t\t\t\t\t</div><div class='fr'> \t\t\t\t\t\t\t\t\t\t\t<button id='delete_coverageId"+this.id+"' type='submit' class='btn btn-danger'>Remove</button> \t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</form>",html+="\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>",$("#modals").html(html),$("#coverage-edit-title").attr("value",this.field("title"));var coverageItem=this;$("#save_coverageId"+this.id).click(function(){coverageItem.save()}),$("#close_coverageId"+this.id).click(function(){coverageItem.close()}),$("#delete_coverageId"+this.id).click(function(){coverageItem.remove()});var utime=this.field("utime");0==utime&&(utime=Date.now()/1e3),console.log("time: "+utime),$("#coverage-timepicker").datetimepicker(),$("#coverage-timepicker").data("DateTimePicker").defaultDate(moment(utime,"X")),$("#coverage-timepicker").data("DateTimePicker").format("L h:mma"),"publication"==this.field("type")?$("#coverage-edit-publication-search").keyup(function(){$(this);var text=$(this).val().toLowerCase();if(0==text.length)return $("#coverage-edit-publication-results").html(""),void $("#coverage-edit-publication-results-container").hide();for(var html="",i=0;i<impresslist.publications.length;i++){impresslist.publications[i].search(text)&&(html+="\t<tr class='table-list' data-publication-id='"+impresslist.publications[i].id+"' data-coverage-edit-publication-result='true' >\t\t\t\t\t\t\t\t\t\t<td>"+impresslist.publications[i].name+"</td> \t\t\t\t\t\t\t\t\t</tr>")}0==html.length&&(html+="\t<tr> <td colspan='2'>No Results</td> </tr>"),$("#coverage-edit-publication-results").html(html),$("#coverage-edit-publication-results-container").show(),$("[data-coverage-edit-publication-result='true']").click(function(){var pubId=$(this).attr("data-publication-id");$("#coverage-edit-publication-id").val(""+pubId),$("#coverage-edit-publication-search").val($(this).find("td").html()),$("#coverage-edit-publication-results").html(""),$("#coverage-edit-publication-results-container").hide()})}):"youtuber"==this.field("type")?$("#coverage-edit-youtuber-search").keyup(function(){$(this);var text=$(this).val().toLowerCase();if(0==text.length)return $("#coverage-edit-youtuber-results").html(""),void $("#coverage-edit-youtuber-results-container").hide();for(var html="",i=0;i<impresslist.youtubers.length;i++){impresslist.youtubers[i].search(text)&&(html+="\t<tr class='table-list' data-youtuber-id='"+impresslist.youtubers[i].id+"' data-coverage-edit-youtuber-result='true' >\t\t\t\t\t\t\t\t\t\t<td>"+impresslist.youtubers[i].name+"</td> \t\t\t\t\t\t\t\t\t</tr>")}0==html.length&&(html+="\t<tr> <td colspan='2'>No Results</td> </tr>"),$("#coverage-edit-youtuber-results").html(html),$("#coverage-edit-youtuber-results-container").show(),$("[data-coverage-edit-youtuber-result='true']").click(function(){var ytId=$(this).attr("data-youtuber-id");$("#coverage-edit-youtuber-id").val(""+ytId),$("#coverage-edit-youtuber-search").val($(this).find("td").html()),$("#coverage-edit-youtuber-results").html(""),$("#coverage-edit-youtuber-results-container").hide()})}):"twitchchannel"==this.field("type")&&$("#coverage-edit-twitchchannel-search").keyup(function(){$(this);var text=$(this).val().toLowerCase();if(0==text.length)return $("#coverage-edit-twitchchannel-results").html(""),void $("#coverage-edit-twitchchannel-results-container").hide();for(var html="",i=0;i<impresslist.twitchchannels.length;i++){impresslist.twitchchannels[i].search(text)&&(html+="\t<tr class='table-list' data-twitchchannel-id='"+impresslist.twitchchannels[i].id+"' data-coverage-edit-twitchchannel-result='true' >\t\t\t\t\t\t\t\t\t\t<td>"+impresslist.twitchchannels[i].name+"</td> \t\t\t\t\t\t\t\t\t</tr>")}0==html.length&&(html+="\t<tr> <td colspan='2'>No Results</td> </tr>"),$("#coverage-edit-twitchchannel-results").html(html),$("#coverage-edit-twitchchannel-results-container").show(),$("[data-coverage-edit-twitchchannel-result='true']").click(function(){var twId=$(this).attr("data-twitchchannel-id");$("#coverage-edit-twitchchannel-id").val(""+twId),$("#coverage-edit-twitchchannel-search").val($(this).find("td").html()),$("#coverage-edit-twitchchannel-results").html(""),$("#coverage-edit-twitchchannel-results-container").hide()})}),$("#coverage-edit-person-search").keyup(function(){$(this);var text=$(this).val().toLowerCase();if(0==text.length)return $("#coverage-edit-person-results").html(""),void $("#coverage-edit-person-results-container").hide();for(var html="",i=0;i<impresslist.people.length;i++){impresslist.people[i].search(text)&&(html+="\t<tr class='table-list' data-person-id='"+impresslist.people[i].id+"' data-coverage-edit-person-result='true' >\t\t\t\t\t\t\t\t\t<td>"+impresslist.people[i].fullname()+"</td> \t\t\t\t\t\t\t\t</tr>")}0==html.length&&(html+="\t<tr> <td colspan='2'>No Results</td> </tr>"),$("#coverage-edit-person-results").html(html),$("#coverage-edit-person-results-container").show(),$("[data-coverage-edit-person-result='true']").click(function(){var pubId=$(this).attr("data-person-id");$("#coverage-edit-person-id").val(""+pubId),$("#coverage-edit-person-search").val($(this).find("td").html()),$("#coverage-edit-person-results").html(""),$("#coverage-edit-person-results-container").hide()})})},Coverage.prototype.update=function(){var selector="data-coverage-id",publicationName="Unknown Publication";if(0<this.fields.publication){var pub=impresslist.findPublicationById(this.fields.publication);publicationName=pub?pub.name:"Unknown"}"youtuber"==this.field("type")&&(publicationName="Unknown Youtuber",0<this.fields.youtuber&&(youtuberObj=impresslist.findYoutuberById(this.fields.youtuber),null!=youtuberObj&&(publicationName=youtuberObj.name)),selector="data-youtube-coverage-id",$("["+selector+"='"+this.id+"'][data-field='thumbnail']").attr("src",this.field("thumbnail"))),"twitchchannel"==this.field("type")&&(publicationName="Unknown Twitch Channel",0<this.fields.twitchchannel&&(youtuberObj=impresslist.findTwitchChannelById(this.fields.twitchchannel),null!=youtuberObj&&(publicationName=youtuberObj.name)),selector="data-twitchchannel-coverage-id",$("["+selector+"='"+this.id+"'][data-field='thumbnail']").attr("src",this.field("thumbnail"))),$("["+selector+"='"+this.id+"'][data-field='name']").html(publicationName),$("["+selector+"='"+this.id+"'][data-field='url']").attr("href",this.field("url")),$("["+selector+"='"+this.id+"'][data-field='url']").html(this.field("title")),$("["+selector+"='"+this.id+"'][data-field='utime']").html(impresslist.util.relativetime_contact(this.field("utime"))),1==this.field("thanked")?$("["+selector+"='"+this.id+"'][data-field='thanked']").html("<span style='color:green;font-style:italic;'>Thanked!</span>"):$("["+selector+"='"+this.id+"'][data-field='thanked']").html("<span style='color:red;font-style:italic;'>Not thanked...</span>");selector="["+selector+"='"+this.id+"'][data-field='person-name']";$(selector).html(this.getPersonName())},Coverage.prototype.onAdded=function(fromInit){this.createItem(fromInit)},Coverage.prototype.onRemoved=function(){this.removeItem(),this.close()},Coverage.prototype.save=function(){if("publication"==this.field("type")){var title=$("#coverage-edit-title").val(),url=$("#coverage-edit-url").val(),timestamp=moment($("#coverage-edit-timestamp").val(),"L h:mma").format("X"),publication=$("#coverage-edit-publication-id").val(),person=$("#coverage-edit-person-id").val(),thanked=$("#coverage-edit-thanked").is(":checked");API.savePublicationCoverage(this,publication,person,title,url,timestamp,thanked)}else if("youtuber"==this.field("type")){title=$("#coverage-edit-title").val(),url=$("#coverage-edit-url").val(),timestamp=moment($("#coverage-edit-timestamp").val(),"L h:mma").format("X");var youtuber=$("#coverage-edit-youtuber-id").val();person=$("#coverage-edit-person-id").val(),thanked=$("#coverage-edit-thanked").is(":checked");API.saveYoutuberCoverage(this,youtuber,person,title,url,timestamp,thanked)}else if("twitchchannel"==this.field("type")){title=$("#coverage-edit-title").val(),url=$("#coverage-edit-url").val(),timestamp=moment($("#coverage-edit-timestamp").val(),"L h:mma").format("X");var twitchchannel=$("#coverage-edit-twitchchannel-id").val();person=$("#coverage-edit-person-id").val(),thanked=$("#coverage-edit-thanked").is(":checked");API.saveTwitchChannelCoverage(this,twitchchannel,person,title,url,timestamp,thanked)}},Coverage.prototype.close=function(){$(".coverage_modal").modal("hide")},Coverage.prototype.remove=function(){"publication"==this.field("type")?API.removePublicationCoverage(this):"youtuber"==this.field("type")?API.removeYoutuberCoverage(this):"twitchchannel"==this.field("type")&&API.removeTwitchChannelCoverage(this)},Audience=function(data){DBO.call(this,data)},Audience.prototype=Object.create(DBO.prototype),Audience.prototype.constructor=Audience,Audience.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id")),this.name=this.field("name")},Audience.prototype.onAdded=function(){var html="<div data-audience-container data-audience-id='"+this.id+"' style='padding:5px;'> \t\t\t\t\t\t<p><b><span data-field='name'>"+this.name+"</span></b></p> \t\t\t\t\t\t<p>Automations:</p>\t\t\t\t\t\t<p>No automations set.</p>\t\t\t\t\t\t<button class='btn btn-primary'>Add Automation</button>\t\t\t\t\t</div><hr/>";$("#admin-audiences-list").append(html)},Game=function(data){DBO.call(this,data)},Game.prototype=Object.create(DBO.prototype),Game.prototype.constructor=Game,Game.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id")),this.name=this.field("name")},Game.prototype.iconUrl=function(){return this.fields.iconurl&&0<this.fields.iconurl.length?this.fields.iconurl:"images/favicon.png"},Game.prototype.onAdded=function(){var html="<div data-project-container data-project-id='"+this.id+"' style='padding:5px;'> \t\t\t\t\t\t<img src='"+this.iconUrl()+"' style='width:32px;height:32px' /> \t\t\t\t\t\t<span data-field='name'>"+this.name+"</span> \t\t\t\t\t</div>";$("#admin-projects-list").append(html)},Company=function(data){DBO.call(this,data)},Company.prototype=Object.create(DBO.prototype),Company.prototype.constructor=Company,Company.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id")),this.name=this.field("name")},Company.prototype.update=function(data){$("#superadmin-companies-list tr[data-company-id="+this.id+'] td[data-field="id"]').html(this.id),$("#superadmin-companies-list tr[data-company-id="+this.id+'] td[data-field="name"]').html(this.field("name")),$("#superadmin-companies-list tr[data-company-id="+this.id+'] td[data-field="games"]').html(this.buildGamesStr()),$("#superadmin-companies-list tr[data-company-id="+this.id+'] td[data-field="discord"]').html(this.buildDiscordStr())},Company.prototype.buildDiscordStr=function(){return"1"==this.field("discord_enabled")?"Discord":"N/A"},Company.prototype.buildGamesStr=function(){var games=this.field("games"),gamesStr="None";0<games.length&&(gamesStr="");for(var i=0;i<games.length;i++)gamesStr+="  "+games[i].name+"<br/>";return gamesStr},Company.prototype.onAdded=function(){var html="<tr data-company-container data-company-id='"+this.id+"'>\t\t\t\t\t\t<td data-field='name'>"+this.name+"</td>\t\t\t\t\t\t<td data-field='games'>"+this.buildGamesStr()+"</td>\t\t\t\t\t\t<td data-field='discord'>"+this.buildDiscordStr()+"</td>\t\t\t\t\t\t<td><button id='company-edit-open-"+this.id+"' class='btn btn-primary btn-sm fr'>Edit</button></td>\t\t\t\t\t</tr>";$("#superadmin-companies-list").append(html);var thiz=this;$("#company-edit-open-"+this.id).click(function(){thiz.openEditModal()})},Company.prototype.clearEditModal=function(){$(".modal-backdrop").remove(),$(".editcompany_modal").remove()},Company.prototype.openEditModal=function(){var html="<div class='modal fade editcompany_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'> \t\t\t\t\t\t\t\t<div style='min-height:200px;padding:20px;'> \t\t\t\t\t\t\t\t\t<h3 data-company-id='"+this.id+"' data-field='name'>"+this.field("name")+"</h3> \t\t\t\t\t\t\t\t\t<form role='form' style='overflow:hidden' onsubmit='return false;'>\t\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-6'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='name'>Name:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t<input data-company-id='"+this.id+"' data-input-field='name' class='form-control' type='text' value='"+this.field("name")+"' />\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-6'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='name'>Keywords:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t<input data-company-id='"+this.id+"' data-input-field='keywords' class='form-control' type='text' value='"+this.field("keywords")+"' />\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-12'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='email'>Email:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t<input data-company-id='"+this.id+"' data-input-field='email' class='form-control' type='text' value='"+this.field("email")+"' />\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-6'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='twitter'>Twitter Username:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t<input data-company-id='"+this.id+"' data-input-field='twitter' class='form-control' type='text' value='"+this.field("twitter")+"' />\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-6'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='facebook'>Facebook:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t<input data-company-id='"+this.id+"' data-input-field='facebook' class='form-control' type='text' value='"+this.field("facebook")+"' />\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-2'>\t\t\t\t\t\t\t\t\t\t\t\t<label class='checkbox-inline'>\t\t\t\t\t\t\t\t\t\t\t\t<input data-company-id='"+this.id+"' data-input-field='discord_enabled' type='checkbox' "+(1==this.field("discord_enabled")?"checked":"")+"/>\t\t\t\t\t\t\t\t\t\t\t\t<strong>Discord</strong></label>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-4'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='discord_webhookId'>Webhook Id:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t<input data-company-id='"+this.id+"' data-input-field='discord_webhookId' class='form-control' type='text' value='"+this.field("discord_webhookId")+"' />\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-6'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='discord_webhookToken'>Webhook Token:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t<input data-company-id='"+this.id+"' data-input-field='discord_webhookToken' class='form-control' type='text' value='"+this.field("discord_webhookToken")+"' />\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div> \t\t\t\t\t\t\t\t\t\t\t<button id='company-edit-submit' type='submit' class='btn btn-primary'>Save</button> \t\t\t\t\t\t\t\t\t\t\t<button id='company-edit-submit' type='submit' class='btn btn-warning' onclick='API.testDiscordWebhook("+this.id+")'>Test Webhook</button> \t\t\t\t\t\t\t\t\t\t\t<button id='company-edit-close' type='submit' class='btn btn-default'>Close</button> \t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<hr/>\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-12'>\t\t\t\t\t\t\t\t\t\t\t\t<h4>Games</h4>\t\t\t\t\t\t\t\t\t\t\t\t<table class='table'>\t\t\t\t\t\t\t\t\t\t\t\t\t<thead>\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<th>Name</th>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<th width=120>Keywords</th>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<th width=120>Blackwords</th>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<th width=50>Twitch ID</th>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<th></th>\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t\t\t\t\t\t\t</thead>\t\t\t\t\t\t\t\t\t\t\t\t\t<tbody id='company-edit-games-tbody'>\t\t\t\t\t\t\t\t\t\t\t\t\t</tbody>\t\t\t\t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-12'>\t\t\t\t\t\t\t\t\t\t\t\t<h4>Coverage Stats</h4>\t\t\t\t\t\t\t\t\t\t\t\t<div id='company-game-stats-container'>\t\t\t\t\t\t\t\t\t\t\t\t\t<p><i>Click a stats button to generate...</p></i>\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</form> \t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>";$("#modals").html(html),$(".modal-dialog").css("width","800px");for(var thiz=this,games=this.field("games"),i=0;i<games.length;i++){var gameHtml="";gameHtml+="<tr>\t\t\t\t\t\t\t<td><input data-game-id='"+games[i].id+"' data-field='name' class='form-control' type='text' value='"+games[i].name+"'/></td>\t\t\t\t\t\t\t<td><input data-game-id='"+games[i].id+"' data-field='keywords' class='form-control' type='text' value='"+games[i].keywords+"'/></td>\t\t\t\t\t\t\t<td><input data-game-id='"+games[i].id+"' data-field='blackwords' class='form-control' type='text' value='"+games[i].blackwords+"'/></td>\t\t\t\t\t\t\t<td><input data-game-id='"+games[i].id+"' data-field='twitchId' class='form-control' type='text' value='"+games[i].twitchId+"'/></td>\t\t\t\t\t\t\t<td>\t\t\t\t\t\t\t\t\x3c!-- <button id='refresh-company-game-twitch-"+games[i].id+"' data-game-id='"+games[i].id+"' class='btn btn-warning btn-sm'>Refresh Twitch</button> --\x3e\t\t\t\t\t\t\t\t<button id='save-company-game-"+games[i].id+"' data-game-id='"+games[i].id+"' class='btn btn-primary btn-sm'><span class='glyphicon glyphicon-floppy-disk' aria-hidden='true'></span></button>\t\t\t\t\t\t\t\t<button id='generatestats-company-game-"+games[i].id+"' data-game-id='"+games[i].id+"' class='btn btn-warning btn-sm'><span class='glyphicon glyphicon-signal' aria-hidden='true'></span></button>\t\t\t\t\t\t\t\t<button id='remove-company-game-"+games[i].id+"' data-game-id='"+games[i].id+"' class='btn btn-danger btn-sm'><span class='glyphicon glyphicon-trash' aria-hidden='true'></span></button>\t\t\t\t\t\t\t</td>\t\t\t\t\t\t </tr>",$("#company-edit-games-tbody").append(gameHtml),$("#save-company-game-"+games[i].id).click(function(){var gameId=$(this).attr("data-game-id"),gameName=$("[data-game-id='"+gameId+"'][data-field='name']").val(),gameKeywords=$("[data-game-id='"+gameId+"'][data-field='keywords']").val(),gameBlackwords=$("[data-game-id='"+gameId+"'][data-field='blackwords']").val(),gameTwitchId=$("[data-game-id='"+gameId+"'][data-field='twitchId']").val();API.saveCompanyGame(thiz,gameId,gameName,gameKeywords,gameBlackwords,gameTwitchId)}),$("#remove-company-game-"+games[i].id).click(function(){var gameId=$(this).attr("data-game-id");API.removeCompanyGame(thiz,gameId,function(){thiz.clearEditModal(),thiz.openEditModal()})}),$("#generatestats-company-game-"+games[i].id).click(function(){var gameId=$(this).attr("data-game-id");API.request("/superadmin/company/game/coverage-stats/",{game:gameId},function(data){$("#company-game-stats-container").html("<b>"+data.game.name+"</b><br/>"+impresslist.util.templates.StatsTable(data.stats))},function(){})})}$("#company-edit-games-tbody").append("<button id='superadmin-add-company-game' data-company-id='"+this.id+"' class='btn btn-success' style='margin-top:10px;'>Add Game</button>"),$("#superadmin-add-company-game").click(function(){API.addCompanyGame(thiz,function(){thiz.clearEditModal(),thiz.openEditModal()})}),$(".editcompany_modal").modal("show"),$("#company-edit-submit").click(function(){var name=$("[data-company-id='"+thiz.id+"'][data-input-field='name']").val(),keywords=$("[data-company-id='"+thiz.id+"'][data-input-field='keywords']").val(),email=$("[data-company-id='"+thiz.id+"'][data-input-field='email']").val(),twitter=$("[data-company-id='"+thiz.id+"'][data-input-field='twitter']").val(),facebook=$("[data-company-id='"+thiz.id+"'][data-input-field='facebook']").val(),discord_enabled=$("[data-company-id='"+thiz.id+"'][data-input-field='discord_enabled']").prop("checked"),discord_webhookId=$("[data-company-id='"+thiz.id+"'][data-input-field='discord_webhookId']").val(),discord_webhookToken=$("[data-company-id='"+thiz.id+"'][data-input-field='discord_webhookToken']").val();API.saveCompany(thiz,name,keywords,email,twitter,facebook,discord_enabled,discord_webhookId,discord_webhookToken,function(data){$(".editcompany_modal").modal("hide")},function(err){})}),$("#company-edit-close").click(function(){$(".editcompany_modal").modal("hide")})},User=function(data){DBO.call(this,data)},User.prototype=Object.create(DBO.prototype),User.prototype.constructor=User,User.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id"))},User.prototype.fullname=function(){return this.field("forename")+" "+this.field("surname")},User.prototype.openChangeProject=function(){for(var curProj=impresslist.config.user.game,html="<div class='modal fade changeproject_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'> \t\t\t\t\t\t\t\t<div style='min-height:100px;padding:20px;'> \t\t\t\t\t\t\t\t\t<h3>Change Project</h3> \t\t\t\t\t\t\t\t\t<form role='form' class='oa' onsubmit='return false;'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<select id='user-change-project-new' data-project-id='"+this.id+"' data-input-field='id' class='form-control'>",i=0;i<impresslist.games.length;i++)html+="<option value='"+impresslist.games[i].id+"' "+(impresslist.games[i].id==curProj?"selected='true'":"")+">"+impresslist.games[i].name+"</option>\n";html+="\t\t\t\t\t\t\t</select>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='fl'> \t\t\t\t\t\t\t\t\t\t\t<button id='user-change-project-submit' type='submit' class='btn btn-primary'>Save</button> \t\t\t\t\t\t\t\t\t\t\t&nbsp;<button id='user-change-project-close' type='submit' class='btn btn-default'>Close</button> \t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</form> \t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>",$("#modals").html(html);var thiz=this;$("#user-change-project-submit").click(function(){var newProject=$("#user-change-project-new").val();console.log(newProject),API.userChangeProject(thiz,newProject,function(){window.location.href="/"}),$(".changeproject_modal").modal("hide")}),$("#user-change-project-close").click(function(){$(".changeproject_modal").modal("hide")})},User.prototype.openChangeAudience=function(){for(var curAudience=impresslist.config.user.audience,html="<div class='modal fade changeaudience_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'> \t\t\t\t\t\t\t\t<div style='min-height:100px;padding:20px;'> \t\t\t\t\t\t\t\t\t<h3>Change Audience</h3> \t\t\t\t\t\t\t\t\t<form role='form' class='oa' onsubmit='return false;'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<select id='user-change-audience-new' data-audience-id='"+this.id+"' data-input-field='id' class='form-control'>",i=0;i<impresslist.audiences.length;i++)html+="<option value='"+impresslist.audiences[i].id+"' "+(impresslist.audiences[i].id==curAudience?"selected='true'":"")+">"+impresslist.audiences[i].name+"</option>\n";html+="\t\t\t\t\t\t\t</select>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='fl'> \t\t\t\t\t\t\t\t\t\t\t<button id='user-change-audience-submit' type='submit' class='btn btn-primary'>Save</button> \t\t\t\t\t\t\t\t\t\t\t&nbsp;<button id='user-change-audience-close' type='submit' class='btn btn-default'>Close</button> \t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</form> \t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>",$("#modals").html(html);var thiz=this;$("#user-change-audience-submit").click(function(){var newProject=$("#user-change-audience-new").val();console.log(newProject),API.userChangeAudience(thiz,newProject,function(){window.location.href=window.location.href}),$(".changeaudience_modal").modal("hide")}),$("#user-change-audience-close").click(function(){$(".changeaudience_modal").modal("hide")})},User.prototype.openChangePassword=function(){$("#modals").html("<div class='modal fade password_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'> \t\t\t\t\t\t\t\t<div style='min-height:100px;padding:20px;'> \t\t\t\t\t\t\t\t\t<h3>Change Password</h3> \t\t\t\t\t\t\t\t\t<form role='form' class='oa' onsubmit='return false;'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='password-current'>Current Password: </label> \t\t\t\t\t\t\t\t\t\t\t<input id='user-change-password-current' class='form-control' type='password' name='password-current' value='' />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='password-new'>New Password:</label> \t\t\t\t\t\t\t\t\t\t\t<input id='user-change-password-new' class='form-control' type='password' name='password-new' value='' />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='fl'> \t\t\t\t\t\t\t\t\t\t\t<button id='user-change-password-submit' type='submit' class='btn btn-primary'>Save</button> \t\t\t\t\t\t\t\t\t\t\t&nbsp;<button id='user-change-password-close' type='submit' class='btn btn-default'>Close</button> \t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</form> \t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>");var thiz=this;$("#user-change-password-submit").click(function(){var currentPassword=$("#user-change-password-current").val(),newPassword=$("#user-change-password-new").val();API.userChangePassword(thiz,currentPassword,newPassword)}),$("#user-change-password-close").click(function(){$(".password_modal").modal("hide")})},User.prototype.openChangeIMAPSettings=function(){var html="<div class='modal fade imapsettings_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'> \t\t\t\t\t\t\t\t<div style='min-height:100px;padding:20px;'> \t\t\t\t\t\t\t\t\t<h3>IMAP Settings</h3> \t\t\t\t\t\t\t\t\t<form role='form' class='oa' onsubmit='return false;'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='change-smtp-server'>SMTP Server:</label> \t\t\t\t\t\t\t\t\t\t\t<input id='user-change-smtp-server' type='text' class='form-control' value='"+impresslist.config.user.smtpServer+"'   />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='change-imap-server'>IMAP Server:</label> \t\t\t\t\t\t\t\t\t\t\t<input id='user-change-imap-server' type='text' class='form-control' value='"+impresslist.config.user.imapServer+"'   />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='change-imap-password'>IMAP Password:</label> \t\t\t\t\t\t\t\t\t\t\t<input id='user-change-imap-password' class='form-control'  type='password' />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='fl'> \t\t\t\t\t\t\t\t\t\t\t<button id='user-change-imap-settings-submit' type='submit' class='btn btn-primary'>Save</button> \t\t\t\t\t\t\t\t\t\t\t&nbsp;<button id='user-change-imap-settings-close' type='submit' class='btn btn-default'>Close</button> \t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</form> \t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>";$("#modals").html(html);var thiz=this;$("#user-change-imap-settings-submit").click(function(){var smtp_server=$("#user-change-smtp-server").val(),imap_server=$("#user-change-imap-server").val(),imap_password=$("#user-change-imap-password").val();API.userChangeIMAPSettings(thiz,smtp_server,imap_server,imap_password)}),$("#user-change-imap-settings-close").click(function(){$(".imapsettings_modal").modal("hide")})},User.prototype.createRow=function(){var html="";html+="<div data-user='"+this.id+"' data-user-row class='oa'> \t\t\t\t\t<p class='fl'> \t\t\t\t\t\t<span data-user='"+this.id+"' data-field='id'></span>. \t\t\t\t\t\t<b><span data-user='"+this.id+"' data-field='forename'></span></b><br/> \t\t\t\t\t\t<span data-user='"+this.id+"' data-field='num_emails'></span> emails - \t\t\t\t\t\tlast active <span data-user='"+this.id+"' data-field='lastactive'></span> \t\t\t\t\t</p> \t\t\t\t\t&nbsp;<button data-user='"+this.id+"' class='fr btn btn-sm btn-primary admin-edit-user-password'>Change Password</button> \t\t\t\t\t&nbsp;<button data-user='"+this.id+"' class='fr btn btn-sm btn-primary admin-edit-user' style='margin-right:5px;'>Edit</button>&nbsp; \t\t\t\t</div>",$("#admin-users-list").append(html);var th=this;$(".admin-edit-user[data-user="+this.id+"]").click(function(){th.open()}),$(".admin-edit-user-password[data-user="+this.id+"]").click(function(){th.openChangePasswordAdmin()}),this.update()},User.prototype.removeRow=function(){$("div[data-user="+this.id+"][data-user-row]").remove()},User.prototype.open=function(){$("#edit-user-forename").val(this.field("forename")),$("#edit-user-surname").val(this.field("surname")),$("#edit-user-email").val(this.field("email")),$("#edit-user-color").val(this.field("color")),$("#edit-user-admin").prop("checked",1==this.field("admin")),$("#admin-edit-user-form").show();var th=this;$("#nav-save-user").unbind("click"),$("#nav-save-user").click(function(){th.save()}),$("#nav-close-user").unbind("click"),$("#nav-close-user").click(function(){th.close()}),$("#nav-delete-user").unbind("click"),$("#nav-delete-user").click(function(){API.removeUser(th)})},User.prototype.save=function(){var th=this,forename=$("#edit-user-forename").val(),surname=$("#edit-user-surname").val(),email=$("#edit-user-email").val(),color=$("#edit-user-color").val(),admin=$("#edit-user-admin").prop("checked");API.saveUser(this,forename,surname,email,color,admin,function(){th.close()})},User.prototype.close=function(){$("#admin-edit-user-form").hide()},User.prototype.update=function(){$("#admin-users-list [data-user="+this.id+"][data-field=id]").html(this.id),$("#admin-users-list [data-user="+this.id+"][data-field=forename]").html(this.field("forename")),$("#admin-users-list [data-user="+this.id+"][data-field=forename]").css("color",this.field("color")),$("#admin-users-list [data-user="+this.id+"][data-field=num_emails]").html(this.field("num_emails")),$("#admin-users-list [data-user="+this.id+"][data-field=lastactive]").html(impresslist.util.relativetime_contact(this.field("lastactivity")))},User.prototype.onAdded=function(){this.createRow()},User.prototype.onRemoved=function(){this.removeRow(),this.close()},User.prototype.openChangePasswordAdmin=function(){$("#edit-user-password").val(""),$("#edit-user-password-confirm").val(""),$("#admin-edit-user-password-form").show();var th=this;$("#nav-save-user-password").unbind("click"),$("#nav-save-user-password").click(function(){th.savePassword()}),$("#nav-close-user-password").unbind("click"),$("#nav-close-user-password").click(function(){th.closeChangePasswordAdmin()})},User.prototype.savePassword=function(){var th=this,password1=$("#edit-user-password").val(),password2=$("#edit-user-password-confirm").val();API.saveUserPassword(this,password1,password2,function(){th.closeChangePasswordAdmin()})},User.prototype.closeChangePasswordAdmin=function(){$("#admin-edit-user-password-form").hide()},YouTuberBatchModal=function(){},YouTuberBatchModal.open=function(){var html="<div class='modal fade youtuber_batch_add_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'> \t\t\t\t\t\t\t\t<div style='min-height:100px;padding:20px;'> \t\t\t\t\t\t\t\t\t<h3>Youtuber Batch Add</h3> \t\t\t\t\t\t\t\t\t<form role='form' class='oa' onsubmit='return false;'>\t\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-5'>\t\t\t\t\t\t\t\t\t\t\t\t<input id='youtuber_batch_add_modal_search_text' class='form-control' type='text' value='' placeholder='Search'/>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-3'>\t\t\t\t\t\t\t\t\t\t\t\t<button id='youtuber_batch_add_modal_search_relevance' type='submit' class='btn btn-primary'>Search (Relevance)</button>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-2'>\t\t\t\t\t\t\t\t\t\t\t\t<button id='youtuber_batch_add_modal_search_latest' type='submit' class='btn btn-primary' style='margin-left:10px;'>Search (Latest)</button>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</form>\t\t\t\t\t\t\t\t\t<div id='youtuber_batch_add_no_results' style='display:none'>\t\t\t\t\t\t\t\t\t\t<div class='alert alert-info' role='alert'> \t\t\t\t\t\t\t\t\t\t\t<span class='glyphicon glyphicon-thumbs-down' aria-hidden='true'></span> \t\t\t\t\t\t\t\t\t\t\t<span class='sr-only'>Error:</span> \t\t\t\t\t\t\t\t\t\t\tDang! There were no results.\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div id='youtuber_batch_add_results_container'  style='display:none'>\t\t\t\t\t\t\t\t\t\t<h4>Results</h4>\t\t\t\t\t\t\t\t\t\t<div id='youtuber_batch_add_results_list' class='oa'>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>";$("#modals").html(html),console.log(html),$(".youtuber_batch_add_modal").modal("show");function resultsFunc(results){$("#youtuber_batch_add_results_list").html(""),0==results.length?($("#youtuber_batch_add_no_results").show(),$("#youtuber_batch_add_results_container").hide()):0<results.length&&($("#youtuber_batch_add_no_results").hide(),$("#youtuber_batch_add_results_container").show());for(var i=0;i<results.length;i++){var channelExists=null!=impresslist.findYoutuberByChannelId(results[i].channel.id),html="";html+="<div class='oa' style='padding-bottom:10px;'>",html+="<div class='fl' style='width:80px'><img src='"+results[i].video.thumbnail+"' width=80px/></div>",html+="<div class='fl' style='width:400px;padding-left:10px;'>",html+="<p><b><a href='http://youtube.com/watch?v="+results[i].video.id+"' target='new'>"+results[i].video.title+"</a></b></p>",html+="<p><b>Channel:</b> <a href='http://www.youtube.com/channel/"+results[i].channel.id+"'><i>"+results[i].channel.title+"</i></a></p>",channelExists||(html+="<button \t\t\t\t\t\t\t\t\tid='youtuber_batch_add_channel_"+results[i].channel.id+"'  \t\t\t\t\t\t\t\t\tdata-channel-id='"+results[i].channel.id+"' \t\t\t\t\t\t\t\t\tdata-channel-title='"+results[i].channel.title+"' \t\t\t\t\t\t\t\t\ttype='submit' \t\t\t\t\t\t\t\t\tclass='btn btn-primary btn-sm'\t\t\t\t\t\t\t\t\t>Add YouTuber</button>"),html+="</div>",$("#youtuber_batch_add_results_list").append(html),$("#youtuber_batch_add_channel_"+results[i].channel.id).unbind("click"),$("#youtuber_batch_add_channel_"+results[i].channel.id).off("click"),$("#youtuber_batch_add_channel_"+results[i].channel.id).click(function(){var channelId=$(this).attr("data-channel-id"),channelName=$(this).attr("data-channel-title"),notes=$("#youtuber_batch_add_modal_search_text").val();API.addYoutuber(!1,function(yter){yter.saveWith(channelId,channelName,notes)})})}}$("#youtuber_batch_add_modal_search_latest").click(function(){var str=$("#youtuber_batch_add_modal_search_text").val();API.searchYouTube(str,"date",resultsFunc,function(){})}),$("#youtuber_batch_add_modal_search_relevance").click(function(){var str=$("#youtuber_batch_add_modal_search_text").val();API.searchYouTube(str,"relevance",resultsFunc,function(){})})},Podcast=function(data){DBO.call(this,data)},Podcast.prototype=Object.create(DBO.prototype),Podcast.prototype.constructor=Podcast,Podcast.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id")),this.name=this.field("name")},TwitchChannel=function(data){DBO.call(this,data)},TwitchChannel.prototype=Object.create(DBO.prototype),TwitchChannel.prototype.constructor=TwitchChannel,TwitchChannel.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id")),this.name=this.field("name"),this.initPriorities("priorities")},TwitchChannel.prototype.createTableRow=function(){var html="\t<tr data-twitchchannel-id='"+this.field("id")+"' data-twitchchannel-tablerow='true' class='table-list' data-toggle='modal' data-target='.twitchchannel_modal'> \t\t\t\t\t\t\t\x3c!-- <td data-twitchchannel-id='"+this.field("id")+"' data-field='name' data-value='"+this.field("name")+"'>"+this.field("name")+"</td> --\x3e\t\t\t\t\t\t\t\x3c!-- <td data-twitchchannel-id='"+this.field("id")+"' data-field='id' data-value='"+this.field("id")+"'>"+this.field("id")+"</td> --\x3e\t\t\t\t\t\t\t<td data-value='"+this.field("name")+"'> \t\t\t\t\t\t\t\t<span data-twitchchannel-id='"+this.field("id")+"' data-field='name' >"+this.field("name")+"</span> \t\t\t\t\t\t\t\t<div data-twitchchannel-id='"+this.field("id")+"' data-field='email-list'></div> \t\t\t\t\t\t\t</td> \t\t\t\t\t\t\t<td data-twitchchannel-id='"+this.field("id")+"' data-field='priority' data-value='"+this.priority()+"'>"+Priority.name(this.priority())+"</td> \t\t\t\t\t\t\t<td data-twitchchannel-id='"+this.field("id")+"' data-field='subscribers' data-value='"+this.field("subscribers")+"'>"+new Number(this.field("subscribers")).toLocaleString()+"</td> \t\t\t\t\t\t\t<td data-twitchchannel-id='"+this.field("id")+"' data-field='views' data-value='"+this.field("views")+"'>"+new Number(this.field("views")).toLocaleString()+"</td> \t\t\t\t\t\t\t<td data-twitchchannel-id='"+this.field("id")+"' data-field='twitter_followers' data-value='"+this.field("twitter_followers")+"'>"+this.twitterCell()+"</td> \t\t\t\t\t\t\t<td data-twitchchannel-id='"+this.field("id")+"' data-field='lastpostedon' data-value='"+this.field("lastpostedon")+"'>"+impresslist.util.relativetime_contact(this.field("lastpostedon"))+"</td> \t\t\t\t\t\t\t<td data-twitchchannel-id='"+this.field("id")+"' data-field='tags' data-value='"+this.field("tags")+"'>"+impresslist.util.buildTags(this.field("tags"))+"</td> \t\t\t\t\t\t</tr>";$("#twitchchannels").append(html);var twitchchannel=this;$(this.openSelector()).click(function(){twitchchannel.open()})},TwitchChannel.prototype.openSelector=function(){return"#twitchchannels [data-twitchchannel-tablerow='true'][data-twitchchannel-id='"+this.id+"']"},TwitchChannel.prototype.removeTableRow=function(){$("#twitchchannels [data-twitchchannel-tablerow='true'][data-twitchchannel-id='"+this.id+"']").remove()},TwitchChannel.prototype.onAdded=function(){this.createTableRow()},TwitchChannel.prototype.onRemoved=function(){this.removeTableRow(),this.close()},TwitchChannel.prototype.preventOpen=function(){$("#modals").html("")},TwitchChannel.prototype.open=function(){var html="<div class='modal fade twitchchannel_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'> \t\t\t\t\t\t\t\t<div style='min-height:100px;padding:20px;'>";html+=" \t\t\t\t<h3 data-twitchchannel-id='"+this.id+"' data-field='name'>"+this.field("name")+"</h3> ",html+="\t\t\t\t<form role='form' class='oa' onsubmit='return false;'>\t\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-8'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='url'>Channel Name:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t<input data-twitchchannel-id='"+this.id+"' data-input-field='twitchUsername' class='form-control' type='text' value='"+this.field("twitchUsername")+"' />\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-4'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='url'>Priority:&nbsp; </label>";var priority=this.priority();html+="\t<select data-twitchchannel-id='"+this.id+"' data-input-field='priority' class='form-control'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='3' "+(3==priority?"selected='true'":"")+">High</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='2' "+(2==priority?"selected='true'":"")+">Medium</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='1' "+(1==priority?"selected='true'":"")+">Low</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='0' "+(0==priority?"selected='true'":"")+">N/A</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>",html+="\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<p data-twitchchannel-id='"+this.id+"' data-field='twitchDescription'>"+this.field("twitchDescription")+"</p>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='email'>Email:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t<input data-twitchchannel-id='"+this.id+"' data-input-field='email' class='form-control' type='text' value='"+this.field("email")+"' />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='twitter'>Twitter Username:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t<input data-twitchchannel-id='"+this.id+"' data-input-field='twitter' class='form-control' type='text' value='"+this.field("twitter")+"' />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='email'>Notes:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t<textarea data-twitchchannel-id='"+this.id+"' data-input-field='notes' class='form-control' style='height:100px;'>"+this.field("notes")+"</textarea>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='tags'>Tags:</label><Br/> \t\t\t\t\t\t\t\t\t\t\t<input id='twitchchannel-modal-tagsinput' data-twitchchannel-id='"+this.id+"' data-input-field='tags' class='form-control' type='text' value='"+impresslist.util.tagStringToInputField(this.field("tags"))+"' data-role=\"tagsinput\" />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='fl'> \t\t\t\t\t\t\t\t\t\t\t<button id='save_twitchchannelId"+this.id+"' type='submit' class='btn btn-primary'>Save</button>",html+="\t\t\t\t\t\t&nbsp;<button id='close_twitchchannelId"+this.id+"' type='submit' class='btn btn-default'>Close</button>",html+=" \t\t\t\t\t</div><div class='fr'> \t\t\t\t\t\t\t\t\t\t\t<button id='delete_twitchchannelId"+this.id+"' type='submit' class='btn btn-danger'>Remove</button> \t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</form>",html+="\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>",$("#modals").html(html),$("#twitchchannel-modal-tagsinput").tagsinput(impresslist.config.misc.tagSearchConfig);var twitchchannel=this;$("#save_twitchchannelId"+this.id).click(function(){twitchchannel.save()}),$("#close_twitchchannelId"+this.id).click(function(){twitchchannel.close()}),$("#delete_twitchchannelId"+this.id).click(function(){API.removeTwitchChannel(twitchchannel)}),$("[data-twitchchannel-id='"+this.id+"'][data-input-field='priority']").change(function(){twitchchannel.savePriority()})},TwitchChannel.prototype.update=function(){$("[data-twitchchannel-id='"+this.id+"'][data-field='name']").html(this.name),$("[data-twitchchannel-id='"+this.id+"'][data-field='twitchUsername']").html(this.field("twitchUsername")),$("[data-twitchchannel-id='"+this.id+"'][data-field='priority']").html(Priority.name(this.priority())),$("[data-twitchchannel-id='"+this.id+"'][data-field='twitchDescription']").html(this.field("twitchDescription")),$("[data-twitchchannel-id='"+this.id+"'][data-field='views']").html(new Number(this.field("views")).toLocaleString()),$("[data-twitchchannel-id='"+this.id+"'][data-field='twitter']").html(this.field("twitter")),$("[data-twitchchannel-id='"+this.id+"'][data-field='twitter_followers']").html(this.twitterCell()),$("[data-twitchchannel-id='"+this.id+"'][data-field='lastpostedon']").html(impresslist.util.relativetime_contact(this.field("lastpostedon"))),$("[data-twitchchannel-id='"+this.id+"'][data-field='tags']").html(impresslist.util.buildTags(this.field("tags")))},TwitchChannel.prototype.close=function(){$(".twitchchannel_modal").modal("hide")},TwitchChannel.prototype.filter=function(text){var elementExtras=$("#twitchchannels [data-twitchchannel-extra-tablerow='true'][data-twitchchannel-id='"+this.id+"']");elementExtras.hide();var element=$("#twitchchannels [data-twitchchannel-tablerow='true'][data-twitchchannel-id='"+this.id+"']");return this.search(text)&&this.filter_isHighPriority()&&this.filter_hasEmail()?(element.show(),impresslist.selectModeIsOpen&&elementExtras.show(),!0):(element.hide(),!1)},TwitchChannel.prototype.filter_isHighPriority=function(){return!$("#filter-high-priority").is(":checked")||3==this.priority()},TwitchChannel.prototype.filter_hasEmail=function(){return!$("#filter-email-attached").is(":checked")||0<this.field("email").length},TwitchChannel.prototype.search=function(text){var ret=!0;if(0==text.length)return ret;if(ret=-1!=this.name.toLowerCase().indexOf(text))return ret;if(ret=-1!=this.field("tags").indexOf(text))return ret;if($("#search-option-full").is(":checked")){if(ret=-1!=this.fields.notes.toLowerCase().indexOf(text))return ret;if(ret=-1!=this.fields.description.toLowerCase().indexOf(text))return ret}return(ret=-1!=this.fields.twitter.toLowerCase().indexOf(text))||!1},TwitchChannel.prototype.save=function(){var channel=$("[data-twitchchannel-id="+this.id+"][data-input-field='twitchUsername']").val(),email=$("[data-twitchchannel-id="+this.id+"][data-input-field='email']").val(),twitter=$("[data-twitchchannel-id="+this.id+"][data-input-field='twitter']").val(),notes=$("[data-twitchchannel-id="+this.id+"][data-input-field='notes']").val(),tags=impresslist.util.tagInputFieldToString($("#twitchchannel-modal-tagsinput").val());API.saveTwitchChannel(this,channel,email,twitter,notes,tags)},TwitchChannel.prototype.saveWith=function(channel,nameOverride){},TwitchChannel.prototype.savePriority=function(){var priority=$("[data-twitchchannel-id='"+this.id+"'][data-input-field='priority']").val();API.setTwitchChannelPriority(this,priority,impresslist.config.user.game)},TwitchChannel.prototype.refreshEmails=function(){var emails=[];0<this.field("email").length&&emails.push({type:"twitchchannel",typeId:this.field("id"),typeName:this.name+" (TwitchChannel)",twitchchannel:this.field("id"),name:this.name,email:this.field("email")});for(var extraEmails="",i=0;i<emails.length;i++)extraEmails+="\t<div data-type='twitchchannel' data-twitchchannel-id='"+this.field("id")+"' data-twitchchannel-extra-tablerow='true' style='padding:5px;'>",extraEmails+="\t\t<input \t\t\t\t\t\t\t\t\t\tdata-type='twitchchannel' \t\t\t\t\t\t\t\t\t\tdata-twitchchannel-id='"+this.field("id")+"' \t\t\t\t\t\t\t\t\t\tdata-checkbox='true' \t\t\t\t\t\t\t\t\t\tdata-twitchchannel-checkbox='true' \t\t\t\t\t\t\t\t\t\tdata-mailout-name='"+emails[i].name+" (TwitchChannel)' \t\t\t\t\t\t\t\t\t\tdata-mailout-type='"+emails[i].type+"' \t\t\t\t\t\t\t\t\t\tdata-mailout-typeid='"+emails[i].typeId+"' \t\t\t\t\t\t\t\t\t\tdata-mailout-typename='"+emails[i].typeName+"' \t\t\t\t\t\t\t\t\t\tdata-mailout-email='"+emails[i].email+"' \t\t\t\t\t\t\t\t\t\ttype='checkbox' \t\t\t\t\t\t\t\t\t\tvalue='1'/>",extraEmails+="\t\t&nbsp; "+emails[i].typeName+" - "+emails[i].email,extraEmails+="\t</div>";$('div[data-twitchchannel-id="'+this.field("id")+'"][data-field="email-list"]').html(extraEmails);var twitchchannel=this;$("input[data-twitchchannel-id='"+this.field("id")+"'][data-checkbox='true']").click(function(e){impresslist.refreshMailoutRecipients(),twitchchannel.preventOpen(),e.stopPropagation()})},Youtuber=function(data){DBO.call(this,data)},Youtuber.prototype=Object.create(DBO.prototype),Youtuber.prototype.constructor=Youtuber,Youtuber.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id")),this.name=this.field("name"),this.initPriorities("priorities")},Youtuber.prototype.createTableRow=function(){var html="\t<tr data-youtuber-id='"+this.field("id")+"' data-youtuber-tablerow='true' class='table-list' data-toggle='modal' data-target='.youtuber_modal'> \t\t\t\t\t\t\t\x3c!-- <td data-youtuber-id='"+this.field("id")+"' data-field='name' data-value='"+this.field("name")+"'>"+this.field("name")+"</td> --\x3e\t\t\t\t\t\t\t\x3c!-- <td data-youtuber-id='"+this.field("id")+"' data-field='id' data-value='"+this.field("id")+"'>"+this.field("id")+"</td> --\x3e\t\t\t\t\t\t\t<td data-value='"+this.field("name")+"'> \t\t\t\t\t\t\t\t<span data-youtuber-id='"+this.field("id")+"' data-field='name' >"+this.field("name")+"</span> \t\t\t\t\t\t\t\t<div data-youtuber-id='"+this.field("id")+"' data-field='email-list'></div> \t\t\t\t\t\t\t</td> \t\t\t\t\t\t\t<td data-youtuber-id='"+this.field("id")+"' data-field='priority' data-value='"+this.priority()+"'>"+Priority.name(this.priority())+"</td> \t\t\t\t\t\t\t<td data-youtuber-id='"+this.field("id")+"' data-field='subscribers' data-value='"+this.field("subscribers")+"'><a href='http://youtube.com/user/"+this.field("channel")+"' target='new'>"+new Number(this.field("subscribers")).toLocaleString()+"</a></td> \t\t\t\t\t\t\t<td data-youtuber-id='"+this.field("id")+"' data-field='views' data-value='"+this.field("views")+"'>"+new Number(this.field("views")).toLocaleString()+"</td> \t\t\t\t\t\t\t<td data-youtuber-id='"+this.field("id")+"' data-field='twitter_followers' data-value='"+this.field("twitter_followers")+"'>"+this.twitterCell()+"</td> \t\t\t\t\t\t\t<td data-youtuber-id='"+this.field("id")+"' data-field='lastpostedon' data-value='"+this.field("lastpostedon")+"'>"+impresslist.util.relativetime_contact(this.field("lastpostedon"))+"</td> \t\t\t\t\t\t\t<td data-youtuber-id='"+this.field("id")+"' data-field='tags' data-value='"+this.field("tags")+"'>"+impresslist.util.buildTags(this.field("tags"))+"</td> \t\t\t\t\t\t</tr>";$("#youtubers").append(html);var youtuber=this;$(this.openSelector()).click(function(){youtuber.open()})},Youtuber.prototype.openSelector=function(){return"#youtubers [data-youtuber-tablerow='true'][data-youtuber-id='"+this.id+"']"},Youtuber.prototype.removeTableRow=function(){$("#youtubers [data-youtuber-tablerow='true'][data-youtuber-id='"+this.id+"']").remove()},Youtuber.prototype.onAdded=function(){this.createTableRow()},Youtuber.prototype.onRemoved=function(){this.removeTableRow(),this.close()},Youtuber.prototype.preventOpen=function(){$("#modals").html("")},Youtuber.prototype.open=function(){var html="<div class='modal fade youtuber_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'> \t\t\t\t\t\t\t\t<div style='min-height:100px;padding:20px;'>";html+=" \t\t\t\t<h3 data-youtuber-id='"+this.id+"' data-field='name'>"+this.field("name")+"</h3> ",html+="\t\t\t\t<form role='form' class='oa' onsubmit='return false;'>\t\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-8'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='url'>Channel Name:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t<input data-youtuber-id='"+this.id+"' data-input-field='channel' class='form-control' type='text' value='"+this.field("channel")+"' />\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-5'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='url'>Name (Override):&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t<input data-youtuber-id='"+this.id+"' data-input-field='name' class='form-control' type='text' value='"+this.field("name_override")+"' />\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-3'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='url'>Priority:&nbsp; </label>";var priority=this.priority();html+="\t<select data-youtuber-id='"+this.id+"' data-input-field='priority' class='form-control'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='3' "+(3==priority?"selected='true'":"")+">High</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='2' "+(2==priority?"selected='true'":"")+">Medium</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='1' "+(1==priority?"selected='true'":"")+">Low</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='0' "+(0==priority?"selected='true'":"")+">N/A</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>",html+="\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-4'>\t\t\t\t\t\t\t\t\t\t\t\t"+this.countrySelectHtml("youtuber")+"\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='email'>Email:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t<input data-youtuber-id='"+this.id+"' data-input-field='email' class='form-control' type='text' value='"+this.field("email")+"' />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='twitter'>Twitter Username:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t<input data-youtuber-id='"+this.id+"' data-input-field='twitter' class='form-control' type='text' value='"+this.field("twitter")+"' />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='email'>Notes:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t<textarea data-youtuber-id='"+this.id+"' data-input-field='notes' class='form-control' style='height:100px;'>"+this.field("notes")+"</textarea>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='tags'>Tags:</label><Br/> \t\t\t\t\t\t\t\t\t\t\t<input id='youtuber-modal-tagsinput' data-youtuber-id='"+this.id+"' data-input-field='tags' class='form-control' type='text' value='"+impresslist.util.tagStringToInputField(this.field("tags"))+"' data-role=\"tagsinput\" />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='fl'> \t\t\t\t\t\t\t\t\t\t\t<button id='save_youtuberId"+this.id+"' type='submit' class='btn btn-primary'>Save</button>",html+="\t\t\t\t\t\t&nbsp;<button id='close_youtuberId"+this.id+"' type='submit' class='btn btn-default'>Close</button>",html+=" \t\t\t\t\t</div><div class='fr'> \t\t\t\t\t\t\t\t\t\t\t<button id='delete_youtuberId"+this.id+"' type='submit' class='btn btn-danger'>Remove</button> \t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</form>",html+="\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>",$("#modals").html(html),$("#youtuber-modal-tagsinput").tagsinput(impresslist.config.misc.tagSearchConfig);var youtuber=this;$("#save_youtuberId"+this.id).click(function(){youtuber.save()}),$("#close_youtuberId"+this.id).click(function(){youtuber.close()}),$("#delete_youtuberId"+this.id).click(function(){API.removeYoutuber(youtuber)}),$("[data-youtuber-id='"+this.id+"'][data-input-field='priority']").change(function(){youtuber.savePriority()})},Youtuber.prototype.update=function(){$("[data-youtuber-id='"+this.id+"'][data-field='name']").html(this.name),$("[data-youtuber-id='"+this.id+"'][data-field='channel']").html(this.field("channel")),$("[data-youtuber-id='"+this.id+"'][data-field='priority']").html(Priority.name(this.priority())),$("[data-youtuber-id='"+this.id+"'][data-field='subscribers']").html("<a href='http://youtube.com/user/"+this.field("channel")+"' target='new'>"+new Number(this.field("subscribers")).toLocaleString()+"</a>"),$("[data-youtuber-id='"+this.id+"'][data-field='views']").html(new Number(this.field("views")).toLocaleString()),$("[data-youtuber-id='"+this.id+"'][data-field='twitter']").html(this.field("twitter")),$("[data-youtuber-id='"+this.id+"'][data-field='twitter_followers']").html(this.twitterCell()),$("[data-youtuber-id='"+this.id+"'][data-field='lastpostedon']").html(impresslist.util.relativetime_contact(this.field("lastpostedon"))),$("[data-youtuber-id='"+this.id+"'][data-field='tags']").html(impresslist.util.buildTags(this.field("tags")))},Youtuber.prototype.close=function(){$(".youtuber_modal").modal("hide")},Youtuber.prototype.filter=function(text){var elementExtras=$("#youtubers [data-youtuber-extra-tablerow='true'][data-youtuber-id='"+this.id+"']");elementExtras.hide();var element=$("#youtubers [data-youtuber-tablerow='true'][data-youtuber-id='"+this.id+"']");return this.search(text)&&this.filter_isHighPriority()&&this.filter_hasEmail()?(element.show(),impresslist.selectModeIsOpen&&elementExtras.show(),!0):(element.hide(),!1)},Youtuber.prototype.filter_isHighPriority=function(){return!$("#filter-high-priority").is(":checked")||3==this.priority()},Youtuber.prototype.filter_hasEmail=function(){return!$("#filter-email-attached").is(":checked")||0<this.field("email").length},Youtuber.prototype.search=function(text){var ret=!0;if(0==text.length)return ret;if(ret=-1!=this.name.toLowerCase().indexOf(text))return ret;if(ret=-1!=this.field("tags").indexOf(text))return ret;if($("#search-option-full").is(":checked")){if(ret=-1!=this.fields.notes.toLowerCase().indexOf(text))return ret;if(ret=-1!=this.fields.description.toLowerCase().indexOf(text))return ret}return(ret=-1!=this.fields.twitter.toLowerCase().indexOf(text))||!1},Youtuber.prototype.save=function(){var nameOverride=$("[data-youtuber-id="+this.id+"][data-input-field='name']").val(),channel=$("[data-youtuber-id="+this.id+"][data-input-field='channel']").val(),email=$("[data-youtuber-id="+this.id+"][data-input-field='email']").val(),twitter=$("[data-youtuber-id="+this.id+"][data-input-field='twitter']").val(),notes=$("[data-youtuber-id="+this.id+"][data-input-field='notes']").val(),country=$("[data-youtuber-id='"+this.id+"'][data-input-field='country']").val(),tags=impresslist.util.tagInputFieldToString($("#youtuber-modal-tagsinput").val());API.saveYoutuber(this,channel,nameOverride,email,twitter,notes,country,tags)},Youtuber.prototype.saveWith=function(channel,nameOverride,notes){API.saveYoutuber(this,channel,nameOverride,"","",notes,"","todo")},Youtuber.prototype.savePriority=function(){var priority=$("[data-youtuber-id='"+this.id+"'][data-input-field='priority']").val();API.setYoutuberPriority(this,priority,impresslist.config.user.game)},Youtuber.prototype.refreshEmails=function(){var emails=[];0<this.field("email").length&&emails.push({type:"youtuber",typeId:this.field("id"),typeName:this.name+" (Youtuber)",youtuber:this.field("id"),name:this.name,email:this.field("email")});for(var extraEmails="",i=0;i<emails.length;i++)extraEmails+="\t<div data-type='youtuber' data-youtuber-id='"+this.field("id")+"' data-youtuber-extra-tablerow='true' style='padding:5px;'>",extraEmails+="\t\t<input \t\t\t\t\t\t\t\t\t\tdata-type='youtuber' \t\t\t\t\t\t\t\t\t\tdata-youtuber-id='"+this.field("id")+"' \t\t\t\t\t\t\t\t\t\tdata-checkbox='true' \t\t\t\t\t\t\t\t\t\tdata-youtuber-checkbox='true' \t\t\t\t\t\t\t\t\t\tdata-mailout-name='"+emails[i].name+" (Youtuber)' \t\t\t\t\t\t\t\t\t\tdata-mailout-type='"+emails[i].type+"' \t\t\t\t\t\t\t\t\t\tdata-mailout-typeid='"+emails[i].typeId+"' \t\t\t\t\t\t\t\t\t\tdata-mailout-typename='"+emails[i].typeName+"' \t\t\t\t\t\t\t\t\t\tdata-mailout-email='"+emails[i].email+"' \t\t\t\t\t\t\t\t\t\ttype='checkbox' \t\t\t\t\t\t\t\t\t\tvalue='1'/>",extraEmails+="\t\t&nbsp; "+emails[i].typeName+" - "+emails[i].email,extraEmails+="\t</div>";$('div[data-youtuber-id="'+this.field("id")+'"][data-field="email-list"]').html(extraEmails);var youtuber=this;$("input[data-youtuber-id='"+this.field("id")+"'][data-checkbox='true']").click(function(e){impresslist.refreshMailoutRecipients(),youtuber.preventOpen(),e.stopPropagation()})},PersonPublication=function(data){DBO.call(this,data)},PersonPublication.prototype=Object.create(DBO.prototype),PersonPublication.prototype.constructor=PersonPublication,PersonPublication.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.fields.id)},PersonPublication.prototype.open=function(){console.log("per pub open");var obj=this,pub=impresslist.findPublicationById(this.fields.publication),html="";pub&&(html+="<div data-perpub-id='"+this.id+"' data-perpub-tablerow='true' class='panel panel-default'> \t\t\t\t\t\t\t<div class='panel-heading oa'> \t\t\t\t\t\t\t\t<h3 class='panel-title fl'>"+pub.name+"&nbsp;</h3><span class='fr'>Last Contacted: <a data-perpub-id='"+this.id+"' href=''>"+impresslist.util.relativetime_contact(this.fields.lastcontacted)+"</a></span> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t<div class='panel-body'> \t\t\t\t\t\t\t\t<div class='row'> \t\t\t\t\t\t\t\t\t<div class='form-group col-sm-8'> \t\t\t\t\t\t\t\t\t\t<label for='email'>Email:</label> \t\t\t\t\t\t\t\t\t\t<input data-perpub-id='"+this.id+"' data-input-field='email' type='text' class='form-control' value='"+this.fields.email+"' style='width:100%;'/> \t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class='fl padx'> \t\t\t\t\t\t\t\t\t\t<label for='submit'>&nbsp;</label><br/> \t\t\t\t\t\t\t\t\t\t<button id='save_personPublicationId"+this.id+"' type='submit' class='btn btn-primary' data-perpub-id='"+this.id+"'>Save</button> \t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t<div class='fl padx'> \t\t\t\t\t\t\t\t\t\t<label for='submit'>&nbsp;</label><br/> \t\t\t\t\t\t\t\t\t\t<button id='delete_personPublicationId"+this.id+"' type='submit' class='btn btn-danger' data-perpub-id='"+this.id+"'>Remove</button> \t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div>"),$("#person-publications").append(html),$("#save_personPublicationId"+this.id).click(function(){obj.save()}),$("#delete_personPublicationId"+this.id).click(function(){API.removePersonPublication(obj)}),$("[data-perpub-id='"+this.id+"'] a").click(function(e){e.preventDefault(),$("#person_tabs [data-tab='person_messages']").click()})},PersonPublication.prototype.save=function(){var email=$("[data-perpub-id="+this.id+"][data-input-field='email']").val();API.savePersonPublication(this,email)},PersonPublication.prototype.update=function(){},PersonPublication.prototype.onAdded=function(fromInit){fromInit||this.open()},PersonPublication.prototype.onRemoved=function(){$("[data-perpub-id='"+this.id+"'][data-perpub-tablerow='true']").remove()},PersonYoutubeChannel=function(data){DBO.call(this,data)},PersonYoutubeChannel.prototype=Object.create(DBO.prototype),PersonYoutubeChannel.prototype.constructor=PersonYoutubeChannel,PersonYoutubeChannel.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.fields.id)},PersonYoutubeChannel.prototype.open=function(){console.log("per yt open");var obj=this,yt=impresslist.findYoutuberById(this.fields.youtuber),html="<div data-peryt-id='"+this.id+"' data-peryt-tablerow='true' class='panel panel-default'> \t\t\t\t\t\t<div class='panel-heading oa'> \t\t\t\t\t\t\t<h3 class='panel-title fl'>"+yt.name+"&nbsp;</h3> \t\t\t\t\t\t</div> \t\t\t\t\t\t<div class='panel-body'> \t\t\t\t\t\t\t<div class='row'> \t\t\t\t\t\t\t\t<div class='fr padx'> \t\t\t\t\t\t\t\t\t<button id='delete_personYoutubeChannelId"+this.id+"' type='submit' class='btn btn-danger' data-peryt-id='"+this.id+"'>Remove</button> \t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div> \t\t\t\t\t</div>";$("#person-youtubechannels").append(html),$("#delete_personYoutubeChannelId"+this.id).click(function(){API.removePersonYoutubeChannel(obj)}),$("[data-peryt-id='"+this.id+"'] a").click(function(e){e.preventDefault(),$("#person_tabs [data-tab='person_messages']").click()})},PersonYoutubeChannel.prototype.update=function(){},PersonYoutubeChannel.prototype.onAdded=function(fromInit){fromInit||this.open()},PersonYoutubeChannel.prototype.onRemoved=function(){$("[data-peryt-id='"+this.id+"'][data-peryt-tablerow='true']").remove()},PersonTwitchChannel=function(data){DBO.call(this,data)},PersonTwitchChannel.prototype=Object.create(DBO.prototype),PersonTwitchChannel.prototype.constructor=PersonTwitchChannel,PersonTwitchChannel.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.fields.id)},PersonTwitchChannel.prototype.open=function(){console.log("per tw open");var obj=this,tw=impresslist.findTwitchChannelById(this.fields.twitchchannel),html="<div data-pertw-id='"+this.id+"' data-pertw-tablerow='true' class='panel panel-default'> \t\t\t\t\t\t<div class='panel-heading oa'> \t\t\t\t\t\t\t<h3 class='panel-title fl'>"+tw.name+"&nbsp;</h3> \t\t\t\t\t\t</div> \t\t\t\t\t\t<div class='panel-body'> \t\t\t\t\t\t\t<div class='row'> \t\t\t\t\t\t\t\t<div class='fr padx'> \t\t\t\t\t\t\t\t\t<button id='delete_personTwitchChannelId"+this.id+"' type='submit' class='btn btn-danger' data-pertw-id='"+this.id+"'>Remove</button> \t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div> \t\t\t\t\t</div>";$("#person-twitchchannels").append(html),$("#delete_personTwitchChannelId"+this.id).click(function(){API.removePersonTwitchChannel(obj)}),$("[data-pertw-id='"+this.id+"'] a").click(function(e){e.preventDefault(),$("#person_tabs [data-tab='person_messages']").click()})},PersonTwitchChannel.prototype.update=function(){},PersonTwitchChannel.prototype.onAdded=function(fromInit){fromInit||this.open()},PersonTwitchChannel.prototype.onRemoved=function(){$("[data-pertw-id='"+this.id+"'][data-pertw-tablerow='true']").remove()},SimpleMailout=function(data){DBO.call(this,data)},SimpleMailout.prototype=Object.create(DBO.prototype),SimpleMailout.prototype.constructor=SimpleMailout,SimpleMailout.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id")),this.numRecipients=0,this.numOpens=0,"["!=data.recipients.substr(0,1)?this.recipientsData=[]:this.recipientsData=JSON.parse(data.recipients);for(var i=0;i<this.recipientsData.length;i++)this.recipientsData[i].read&&this.numOpens++,this.numRecipients++},SimpleMailout.showAll=function(){$("[data-simplemailout-tablerow='true']").show()},SimpleMailout.prototype.createTableRow=function(){var html="\t<tr data-simplemailout-id='"+this.field("id")+"' data-simplemailout-tablerow='true' class='table-list' > \t\t\t\t\t\t\t<td data-simplemailout-id='"+this.field("id")+"' data-field='name' data-value='"+this.field("name")+"'>"+this.field("name")+"</td> \t\t\t\t\t\t\t<td data-simplemailout-id='"+this.field("id")+"' data-field='numRecipients' data-value='"+this.numRecipients+"'>"+this.numRecipients+"</td> \t\t\t\t\t\t\t<td data-simplemailout-id='"+this.field("id")+"' data-field='numOpens' data-value='"+this.numOpens+"'>...</td>\t\t\t\t\t\t\t<td data-simplemailout-id='"+this.field("id")+"' data-field='timestamp' data-value='"+this.field("timestamp")+"'>...</td>\t\t\t\t\t\t\t<td data-simplemailout-id='"+this.field("id")+"' data-field='visible' data-value='"+this.field("visible")+"' style='display:none;'>"+this.field("visible")+"</td>";html+="\t\t</tr>",$("#mailout-list-tbody").append(html),$("#mailout-list-footer").hide(),this.field("visible")||$("[data-simplemailout-id='"+this.field("id")+"'][data-simplemailout-tablerow='true']").hide();var mailout=this;$('tr[data-simplemailout-id="'+this.field("id")+'"][data-simplemailout-tablerow="true"]').unbind("click"),$('tr[data-simplemailout-id="'+this.field("id")+'"][data-simplemailout-tablerow="true"]').click(function(){mailout.open()}),this.update()},SimpleMailout.prototype.removeTableRow=function(){$("[data-simplemailout-tablerow='true'][data-simplemailout-id='"+this.field("id")+"']").remove()},SimpleMailout.prototype.update=function(){var sentText="";sentText=1==this.field("sent")?"Sent "+impresslist.util.relativetime_contact(this.field("timestamp")):1==this.field("ready")&&Date.now()/1e3<=this.field("timestamp")?"Scheduled "+impresslist.util.relativetime_contact(this.field("timestamp")):1==this.field("ready")&&Date.now()/1e3>this.field("timestamp")?"In send queue.":"Draft";var recipientsText=""+this.numRecipients,openText="-";1==this.field("sent")&&(openText=Math.round(1*this.numOpens/(1*this.numRecipients)*100)),$("[data-simplemailout-id='"+this.id+"'][data-field='name']").html(this.field("name")),$("[data-simplemailout-id='"+this.id+"'][data-field='numRecipients']").html(recipientsText),$("[data-simplemailout-id='"+this.id+"'][data-field='numOpens']").html(openText+"%"),$("[data-simplemailout-id='"+this.id+"'][data-field='numOpens']").attr("data-value",openText),$("[data-simplemailout-id='"+this.id+"'][data-field='timestamp']").html(sentText)},SimpleMailout.prototype.send=function(){var mailout=this;this.save(function(){API.sendSimpleMailout(mailout),mailout.close()})},SimpleMailout.prototype.cancelsend=function(){API.cancelSimpleMailout(this),this.close()},SimpleMailout.prototype.duplicate=function(){var th=this;API.duplicateSimpleMailout(this,function(){th.close()})},SimpleMailout.prototype.save=function(callback){void 0===callback&&(callback=function(data){console.log("saved"),0<data.checks.length&&API.infoMessage(data.checks.join("<br/>\n"))});for(var name=$("#mailout-name").val(),subject=$("#mailout-subject").val(),markdown=$("#mailout-content").val(),recipients=[],peopleSelected=$('input[data-type="person"][data-checkbox="true"]:checked'),i=0;i<peopleSelected.length;i++){(obj={}).type=$(peopleSelected[i]).attr("data-mailout-type"),obj.sent=!1,obj.read=!1,"person"==obj.type?obj.person_id=$(peopleSelected[i]).attr("data-mailout-typeid"):"personPublication"==obj.type&&(obj.personPublication_id=$(peopleSelected[i]).attr("data-mailout-typeid")),recipients.push(obj)}var publicationsSelected=$('input[data-type="publication"][data-checkbox="true"]:checked');for(i=0;i<publicationsSelected.length;i++){(obj={}).type=$(publicationsSelected[i]).attr("data-mailout-type"),obj.sent=!1,obj.read=!1,"publication"==obj.type&&(obj.publication_id=$(publicationsSelected[i]).attr("data-mailout-typeid")),recipients.push(obj)}var youTubersSelected=$('input[data-type="youtuber"][data-checkbox="true"]:checked');for(i=0;i<youTubersSelected.length;i++){(obj={}).type=$(youTubersSelected[i]).attr("data-mailout-type"),obj.sent=!1,obj.read=!1,"youtuber"==obj.type&&(obj.youtuber_id=$(youTubersSelected[i]).attr("data-mailout-typeid")),recipients.push(obj)}var twitchChannelsSelected=$('input[data-type="twitchchannel"][data-checkbox="true"]:checked');for(i=0;i<twitchChannelsSelected.length;i++){var obj;(obj={}).type=$(twitchChannelsSelected[i]).attr("data-mailout-type"),obj.sent=!1,obj.read=!1,"twitchchannel"==obj.type&&(obj.twitchchannel_id=$(twitchChannelsSelected[i]).attr("data-mailout-typeid")),recipients.push(obj)}console.log(JSON.stringify(recipients));var whichtime=$('input[name="mailout-time-radio"]:checked').val();if(null!=whichtime){var timestamp=0;if("later"==whichtime){var date=new Date($("#mailout-timepicker").data("DateTimePicker").date());timestamp=Math.floor(date.getTime()/1e3)}API.saveSimpleMailout(this,name,subject,recipients,markdown,timestamp,callback)}else API.errorMessage("Please select a time for this mailout.")},SimpleMailout.prototype.setFormEnabled=function(boo){boo=!boo,$("#mailout-name").attr("disabled",boo),$("#mailout-subject").attr("disabled",boo),$("#mailout-content").attr("disabled",boo),$("#mailout-radio-time-asap").attr("disabled",boo),$("#mailout-radio-time-scheduled").attr("disabled",boo),$("#mailout-timepicker").attr("disabled",boo),$("#mailout-edit-timestamp").attr("disabled",boo),$("#mailout-writepage-back").attr("disabled",boo),$("#mailout-writepage-save").attr("disabled",boo),$("#mailout-writepage-send").attr("disabled",boo),$("#mailout-writepage-cancelsend").attr("disabled",boo),$("#mailout-writepage-remove").attr("disabled",boo)},SimpleMailout.prototype.open=function(){console.log("mailout open"),$("#mailout-homepage").hide(),$("#mailout-writepage").show(),$("#mailout-writepage-send").hide(),$("#mailout-writepage-cancelsend").hide(),$(".mailout-readflags").hide(),$("#mailout-writepage-save").show(),$("#mailout-writepage-duplicate").show(),$("#mailout-writepage-remove").show(),0==this.field("ready")&&$("#mailout-writepage-send").show(),1==this.field("ready")&&0==this.field("sent")&&$("#mailout-writepage-cancelsend").show(),this.setFormEnabled(!0),$("#mailout-name").val(this.field("name")),$("#mailout-subject").val(this.field("subject")),$("#mailout-content").val(this.field("markdown")),$("#mailout-content").keyup();var utime=this.field("timestamp");0==utime&&(utime=Date.now()/1e3),$("#mailout-timepicker").datetimepicker(),$("#mailout-timepicker").data("DateTimePicker").defaultDate(moment(utime,"X")),$("#mailout-timepicker").data("DateTimePicker").format("DD/MM/YYYY h:mma");var mailout=this;$("#mailout-writepage-save").unbind("click"),$("#mailout-writepage-save").click(function(){mailout.save()}),$("#mailout-writepage-duplicate").unbind("click"),$("#mailout-writepage-duplicate").click(function(){mailout.duplicate()}),$("#mailout-writepage-send").unbind("click"),$("#mailout-writepage-send").click(function(){mailout.send()}),$("#mailout-writepage-cancelsend").unbind("click"),$("#mailout-writepage-cancelsend").click(function(){mailout.cancelsend()}),$("#mailout-writepage-back").unbind("click"),$("#mailout-writepage-back").click(function(){mailout.close()}),$("#mailout-writepage-remove").unbind("click"),$("#mailout-writepage-remove").click(function(){mailout.setFormEnabled(!1),API.removeSimpleMailout(mailout)}),$("#mailout-radio-time-asap").unbind("click"),$("#mailout-radio-time-scheduled").unbind("click"),$("#mailout-radio-time-asap").click(function(){$("#mailout-timepicker").hide()}),$("#mailout-radio-time-scheduled").click(function(){$("#mailout-timepicker").show()}),0==this.field("timestamp")?($("#mailout-timepicker").hide(),$("#mailout-radio-time-asap").prop("checked","true")):($("#mailout-timepicker").show(),$("#mailout-radio-time-scheduled").prop("checked","true")),impresslist.openSelectMode();for(var i=0;i<this.recipientsData.length;i++){if("person"==this.recipientsData[i].type){if(null!=(p=impresslist.findPersonById(this.recipientsData[i].person_id))){var box=$('input[data-type="person"][data-mailout-typeid="'+p.id+'"][data-checkbox="true"][data-mailout-type="person"]');$(box).prop("checked",!0)}}else if("personPublication"==this.recipientsData[i].type){if(null!=(p=impresslist.findPersonPublicationById(this.recipientsData[i].personPublication_id))){box=$('input[data-type="person"][data-mailout-typeid="'+p.id+'"][data-checkbox="true"][data-mailout-type="personPublication"]');$(box).prop("checked",!0)}}else if("publication"==this.recipientsData[i].type){if(null!=(p=impresslist.findPublicationById(this.recipientsData[i].publication_id))){box=$('input[data-type="publication"][data-mailout-typeid="'+p.id+'"][data-checkbox="true"][data-mailout-type="publication"]');$(box).prop("checked",!0)}}else if("youtuber"==this.recipientsData[i].type){if(null!=(p=impresslist.findYoutuberById(this.recipientsData[i].youtuber_id))){box=$('input[data-type="youtuber"][data-mailout-typeid="'+p.id+'"][data-checkbox="true"][data-mailout-type="youtuber"]');$(box).prop("checked",!0)}}else if("twitchchannel"==this.recipientsData[i].type){var p;if(null!=(p=impresslist.findTwitchChannelById(this.recipientsData[i].twitchchannel_id))){box=$('input[data-type="twitchchannel"][data-mailout-typeid="'+p.id+'"][data-checkbox="true"][data-mailout-type="twitchchannel"]');$(box).prop("checked",!0)}}$(box).attr("mailout-read",this.recipientsData[i].read),$(box).attr("mailout-reminded-twitter-dm",!(!this.recipientsData[i].remind||!this.recipientsData[i].remind.twitterdm))}impresslist.refreshMailoutRecipients(),console.log(this.field("sent")),1==this.field("sent")&&(this.setFormEnabled(!1),$("#mailout-writepage-back").attr("disabled",!1),$("#mailout-writepage-save").hide(),$("#mailout-writepage-remove").hide(),$("#mailout-writepage-send").hide(),$(".mailout-readflags").show())},SimpleMailout.prototype.close=function(){console.log("mailout close"),impresslist.closeSelectMode(),$("#mailout-writepage").hide(),$("#mailout-homepage").show()},SimpleMailout.prototype.onAdded=function(fromInit){this.createTableRow()},SimpleMailout.prototype.onRemoved=function(fromInit){this.setFormEnabled(!0),this.removeTableRow(),this.close()},Person=function(data){DBO.call(this,data)},Person.prototype=Object.create(DBO.prototype),Person.prototype.constructor=Person,Person.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id")),this.name=this.field("firstname"),this.rowSelector="#people [data-person-tablerow='true'][data-person-id='"+this.id+"']",this.initPriorities("priorities")},Person.prototype.update=function(){$("[data-person-id='"+this.id+"'][data-field='name']").html(this.fullname()),$("[data-person-id='"+this.id+"'][data-field='priority']").html(Priority.name(this.priority())),$("[data-person-id='"+this.id+"'][data-field='twitter_followers']").html(this.twitterCell()),$("[data-person-id='"+this.id+"'][data-field='tags']").html(impresslist.util.buildTags(this.field("tags")))},Person.prototype.save=function(){var firstname=$("[data-person-id="+this.id+"][data-input-field='firstname']").val(),surnames=$("[data-person-id="+this.id+"][data-input-field='surnames']").val(),email=$("[data-person-id="+this.id+"][data-input-field='email']").val(),twitter=$("[data-person-id="+this.id+"][data-input-field='twitter']").val(),notes=$("[data-person-id="+this.id+"][data-input-field='notes']").val(),country=$("[data-person-id='"+this.id+"'][data-input-field='country']").val(),language=$("[data-person-id='"+this.id+"'][data-input-field='lang']").val(),tags=impresslist.util.tagInputFieldToString($("#person-modal-tagsinput").val()),outofdate=$("[data-person-id="+this.id+"][data-input-field='outofdate']").is(":checked");API.savePerson(this,firstname,surnames,email,twitter,notes,country,language,tags,outofdate)},Person.prototype.savePriority=function(){var priority=$("[data-person-id='"+this.id+"'][data-input-field='priority']").val();API.setPersonPriority(this,priority,impresslist.config.user.game)},Person.prototype.saveUserAssignment=function(){var assignment=$("[data-person-id='"+this.id+"'][data-input-field='assignment']").val();API.setPersonAssignment(this,assignment)},Person.prototype.preventOpen=function(){$("#modals").html("")},Person.prototype.open=function(){var html="<div class='modal fade person_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'>";html+="\t\t\t\t<div style='min-height:100px;padding:20px;'>",html+="\t<div style='min-height:45px;'> \t\t\t\t\t\t<h3 class='fl' data-person-id='"+this.id+"' data-field='name'>"+this.fullname()+"</h3> \t\t\t\t\t\t\t\t\t\t\t\t<div class='fr'>\t\t\t\t\t\t\x3c!-- Single button --\x3e\t\t\t\t\t\t<div class='btn-group'>\t\t\t\t\t\t\t<button id='person-email-default' type='button' class='btn btn-default'>\t\t\t\t\t\t\t\t<span class='glyphicon glyphicon-send glyphicon-align-left' aria-hidden='true'></span> Email \t\t\t\t\t\t\t</button>\t\t\t\t\t\t\t<button type='button' class='btn btn-default dropdown-toggle' data-toggle='dropdown' aria-expanded='false'>\t\t\t\t\t\t\t\t<span class='caret'></span> \t\t\t\t\t\t\t\t<span class='sr-only'>Toggle Dropdown</span> \t\t\t\t\t\t\t</button>\t\t\t\t\t\t\t<ul class='dropdown-menu' role='menu' style='position:absolute;z-index:999;'>";var emailBCC=impresslist.config.system.email,emailGmailIndex=impresslist.config.user.gmail,emails=[];emails.push({type:"Personal",email:this.field("email")});for(var i=0;i<impresslist.personPublications.length;++i)if(impresslist.personPublications[i].field("person")==this.id){var pub=impresslist.findPublicationById(impresslist.personPublications[i].field("publication"));pub&&emails.push({type:pub.field("name"),email:impresslist.personPublications[i].field("email")})}for(i=0;i<emails.length;++i){var defaultEmail=emails[i].email;if(0!=defaultEmail.length){var emailClientLink=impresslist.util.mailtoClient(defaultEmail,"","",emailBCC),emailGmailLink=impresslist.util.mailtoGmail(defaultEmail,"","",emailBCC,emailGmailIndex);html+="<li><a href='"+emailGmailLink+"' target='new'>"+emails[i].type+" (Gmail)</a></li>",html+="<li><a href='"+emailClientLink+"'>"+emails[i].type+" (Client)</a></li>"}}html+="\t\t\t</ul>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>",html+="\t<div id='person_tabs_container' role='tabpanel'>",html+='\t\t<ul id="person_tabs" class="nav nav-tabs" role="tablist"> \t\t\t\t\t\t\t<li role="presentation" class="active"><a role="tab" href="#" data-tab="person_profile" data-toggle="tab">Profile</a></li> \t\t\t\t\t\t\t<li role="presentation"><a role="tab" href="#" data-tab="person_publications" data-toggle="tab">Publications</a></li> \t\t\t\t\t\t\t<li role="presentation"><a role="tab" href="#" data-tab="person_youtubeChannels" data-toggle="tab">Youtubes</a></li> \t\t\t\t\t\t\t<li role="presentation"><a role="tab" href="#" data-tab="person_twitchChannels" data-toggle="tab">Twitchs</a></li> \t\t\t\t\t\t\t<li role="presentation"><a role="tab" href="#" data-tab="person_messages" data-toggle="tab">Messages</a></li> \t\t\t\t\t\t\t<li role="presentation"><a role="tab" href="#" data-tab="person_keys" data-toggle="tab">Keys</a></li> \t\t\t\t\t\t</ul> \t\t\t\t\t\t<div class="tab-content">',html+="\t<div role='tabpanel' class='tab-pane active pady' data-tab='person_profile'>\t\t\t\t\t\t\t\t<form role='form' class='oa' onsubmit='return false;'>\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-3'>\t\t\t\t\t\t\t\t\t\t\t<label for='name'>First Name:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t<input data-person-id='"+this.id+"' data-input-field='firstname' class='form-control' type='text' value='"+this.field("firstname")+"' />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-3'>\t\t\t\t\t\t\t\t\t\t\t<label for='name'>Surname/s:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t<input data-person-id='"+this.id+"' data-input-field='surnames' class='form-control' type='text' value='"+this.field("surnames")+"' />\t\t\t\t\t\t\t\t\t\t</div>",html+="\t\t\t\t<div class='form-group col-md-3'>\t\t\t\t\t\t\t\t\t\t\t<label for='email'>Assignment:</label>";var assignment=this.fields.assigned;html+="\t<select data-person-id='"+this.id+"' data-input-field='assignment' class='form-control'>";for(var u=0;u<impresslist.users.length;u++)html+="<option value='"+impresslist.users[u].id+"' "+(assignment==impresslist.users[u].id?"selected='true'":"")+">"+impresslist.users[u].fullname()+"</option>";html+=" \t\t<option value='0' "+(0==assignment?"selected='true'":"")+">N/A</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>",html+="\t\t\t\t</div>",html+="\t\t\t\t<div class='form-group col-md-3'>\t\t\t\t\t\t\t\t\t\t\t<label for='email'>Priority:</label>";var priority=this.priority();html+="\t<select data-person-id='"+this.id+"' data-input-field='priority' class='form-control'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='3' "+(3==priority?"selected='true'":"")+">High</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='2' "+(2==priority?"selected='true'":"")+">Medium</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='1' "+(1==priority?"selected='true'":"")+">Low</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='0' "+(0==priority?"selected='true'":"")+">N/A</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>",html+="\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t<label for='email'>Email:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t<input data-person-id='"+this.id+"' data-input-field='email' class='form-control' type='text' value='"+this.field("email")+"' />\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t<label for='email'>Twitter Username:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t<input data-person-id='"+this.id+"' data-input-field='twitter' class='form-control' type='text' value='"+this.field("twitter")+"' />\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t<label for='email'>Notes:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t<textarea data-person-id='"+this.id+"' data-input-field='notes' class='form-control' style='height:100px;'>"+this.field("notes")+"</textarea>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-3'>\t\t\t\t\t\t\t\t\t\t\t<label for='language'>Language:</label>";var language=this.field("lang");html+="\t<select data-person-id='"+this.id+"' data-input-field='lang' class='form-control'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='en' "+("en"==language?"selected='true'":"")+">English</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='fr' "+("fr"==language?"selected='true'":"")+">French</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='it' "+("it"==language?"selected='true'":"")+">Italian</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='de' "+("de"==language?"selected='true'":"")+">German</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='es' "+("es"==language?"selected='true'":"")+">Spanish</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='pt' "+("pt"==language?"selected='true'":"")+">Portuguese</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>",html+="\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-3'>\t\t\t\t\t\t\t\t\t\t\t"+this.countrySelectHtml("person")+"\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-6'>\t\t\t\t\t\t\t\t\t\t\t<label for='tags'>Tags:</label><Br/> \t\t\t\t\t\t\t\t\t\t\t<input id='person-modal-tagsinput' data-person-id='"+this.id+"' data-input-field='tags' class='form-control' type='text' value='"+impresslist.util.tagStringToInputField(this.field("tags"))+"' data-role=\"tagsinput\" />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t<label class='checkbox-inline'><input data-person-id='"+this.id+"' data-input-field='outofdate' type='checkbox' "+(1==this.field("outofdate")?"checked":"")+"><strong>Out of date?</strong></label>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class='fl'> \t\t\t\t\t\t\t\t\t\t<button id='save_personId"+this.id+"' type='submit' class='btn btn-primary'>Save</button>",html+="\t\t\t\t&nbsp;<button id='close_personId"+this.id+"' type='submit' class='btn btn-default'>Close</button>",html+=" \t\t\t</div><div class='fr'> \t\t\t\t\t\t\t\t\t\t<button id='delete_personId"+this.id+"' type='submit' class='btn btn-danger'>Remove</button> \t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</form>\t\t\t\t\t\t\t</div>",html+="\t<div role='tabpanel' class='tab-pane pady' data-tab='person_publications'> \t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t<label for='add-publication'>Add:&nbsp;</label> \t\t\t\t\t\t\t\t\t<input id='add-publication-search' type='text' class='form-control' placeholder='Search' /> \t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div id='add-publication-results-container' style='display:none;'>\t\t\t\t\t\t\t\t\t<table class='table table-striped'>\t\t\t\t\t\t\t\t\t\t<thead>\t\t\t\t\t\t\t\t\t\t\t<th>Name</th> \t\t\t\t\t\t\t\t\t\t\t<th>URL</th> \t\t\t\t\t\t\t\t\t\t</thead> \t\t\t\t\t\t\t\t\t\t<tbody id='add-publication-results'> \t\t\t\t\t\t\t\t\t\t</tbody> \t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div id='person-publications'>",html+="\t\t</div>\t\t\t\t\t\t\t</div>",html+="\t<div role='tabpanel' class='tab-pane pady' data-tab='person_youtubeChannels'> \t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t<label for='add-youtubechannel'>Add:&nbsp;</label> \t\t\t\t\t\t\t\t\t<input id='add-youtubechannel-search' type='text' class='form-control' placeholder='Search' /> \t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div id='add-youtubechannel-results-container' style='display:none;'>\t\t\t\t\t\t\t\t\t<table class='table table-striped'>\t\t\t\t\t\t\t\t\t\t<thead>\t\t\t\t\t\t\t\t\t\t\t<th>Name</th> \t\t\t\t\t\t\t\t\t\t\t<th>Subscribers</th> \t\t\t\t\t\t\t\t\t\t</thead> \t\t\t\t\t\t\t\t\t\t<tbody id='add-youtubechannel-results'> \t\t\t\t\t\t\t\t\t\t</tbody> \t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div id='person-youtubechannels'>",html+="\t\t</div>\t\t\t\t\t\t\t</div>",html+="\t<div role='tabpanel' class='tab-pane pady' data-tab='person_twitchChannels'> \t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t<label for='add-twitchchannel'>Add:&nbsp;</label> \t\t\t\t\t\t\t\t\t<input id='add-twitchchannel-search' type='text' class='form-control' placeholder='Search' /> \t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div id='add-twitchchannel-results-container' style='display:none;'>\t\t\t\t\t\t\t\t\t<table class='table table-striped'>\t\t\t\t\t\t\t\t\t\t<thead>\t\t\t\t\t\t\t\t\t\t\t<th>Name</th> \t\t\t\t\t\t\t\t\t\t\t<th>Subscribers</th> \t\t\t\t\t\t\t\t\t\t</thead> \t\t\t\t\t\t\t\t\t\t<tbody id='add-twitchchannel-results'> \t\t\t\t\t\t\t\t\t\t</tbody> \t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div id='person-twitchchannels'>",html+="\t\t</div>\t\t\t\t\t\t\t</div>",html+="\t<div role='tabpanel' class='tab-pane pady' data-tab='person_keys'> \t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t<label for='add-keys'>Add:&nbsp;</label> \t\t\t\t\t\t\t\t\t<input id='add-keys-search' type='text' class='form-control' placeholder='Search' /> \t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div id='add-keys-results-container' style='display:none;'>\t\t\t\t\t\t\t\t\t<table class='table table-striped'>\t\t\t\t\t\t\t\t\t\t<thead>\t\t\t\t\t\t\t\t\t\t\t<th>Key</th> \t\t\t\t\t\t\t\t\t\t\t<th>Platform</th> \t\t\t\t\t\t\t\t\t\t\t<th>Subplatform</th> \t\t\t\t\t\t\t\t\t\t</thead> \t\t\t\t\t\t\t\t\t\t<tbody id='add-keys-results'> \t\t\t\t\t\t\t\t\t\t</tbody> \t\t\t\t\t\t\t\t\t</table>\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div id='person-keys'> \t\t\t\t\t\t\t\t\t<div class='pady'><b>All Keys</b></div> \t\t\t\t\t\t\t\t\t<table class='table table-striped sortable'> \t\t\t\t\t\t\t\t\t\t<thead> \t\t\t\t\t\t\t\t\t\t\t<th>Game</th> \t\t\t\t\t\t\t\t\t\t\t<th>Key</th> \t\t\t\t\t\t\t\t\t\t\t<th>Platform</th> \t\t\t\t\t\t\t\t\t\t\t<th>Subplatform</th> \t\t\t\t\t\t\t\t\t\t\t<th>Assigned On</th> \t\t\t\t\t\t\t\t\t\t\t<th>&nbsp;</th> \t\t\t\t\t\t\t\t\t\t</thead> \t\t\t\t\t\t\t\t\t\t<tbody id='person-keys-list'>\t\t\t\t\t\t\t\t\t\t</tbody>\t\t\t\t\t\t\t\t\t</table> \t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>";var messages=[];for(i=0;i<impresslist.emails.length;++i)impresslist.emails[i].field("person_id")==this.id&&messages.push(impresslist.emails[i]);var lastContactBy="N/A";0<messages.length&&(lastContactBy=impresslist.findUserById(messages[0].field("user_id")).field("forename")),html+="\t<div role='tabpanel' class='tab-pane pady' data-tab='person_messages' > \t\t\t\t\t\t\t\t\x3c!-- <div class='pady'><b>Last contacted by:</b> "+lastContactBy+"</div> --\x3e\t\t\t\t\t\t\t\t<div id='all-messages'> \t\t\t\t\t\t\t\t\t<div class='pady'><b>All Messages</b></div> \t\t\t\t\t\t\t\t\t<table class='table table-striped sortable'> \t\t\t\t\t\t\t\t\t\t<thead> \t\t\t\t\t\t\t\t\t\t\t<th>Subject</th> \t\t\t\t\t\t\t\t\t\t\t<th>Date</th> \t\t\t\t\t\t\t\t\t\t\t<th>From</th> \t\t\t\t\t\t\t\t\t\t</thead> \t\t\t\t\t\t\t\t\t\t<tbody>";for(i=0;i<messages.length;i++){var dateformatStr=new Date(1e3*messages[i].field("utime")).toUTCString();html+="\t<tr data-open-field='email' data-email-id='"+messages[i].id+"' style='cursor:pointer;'> \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>"+messages[i].field("subject")+"</td> \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td title='"+dateformatStr+"'>"+impresslist.util.relativetime_contact(messages[i].field("utime"))+"</td> \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>"+impresslist.findUserById(messages[i].field("user_id")).field("forename")+"</td> \t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>"}0==messages.length&&(html+="\t<tr> \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td colspan='3'>No Messages</td> \t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>"),html+="\t\t\t\t</tbody> \t\t\t\t\t\t\t\t\t</table> \t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t<div id='person-view-email' style='display:none;'> \t\t\t\t\t\t\t\t\t<div class='pady'><b><a class='person-view-all-messages'>All Messages</a> </b> >&nbsp;<span data-view-email-field='subject'></span></div> \t\t\t\t\t\t\t\t\t<table class='table table-striped sortable'> \t\t\t\t\t\t\t\t\t\t<tbody> \t\t\t\t\t\t\t\t\t\t\t<tr> \t\t\t\t\t\t\t\t\t\t\t\t<th>Date:</th>\t\t\t\t\t\t\t\t\t\t\t\t<td data-view-email-field='date'></td>\t\t\t\t\t\t\t\t\t\t\t</tr> \t\t\t\t\t\t\t\t\t\t\t<tr> \t\t\t\t\t\t\t\t\t\t\t\t<th>From:</th>\t\t\t\t\t\t\t\t\t\t\t\t<td data-view-email-field='from'></td>\t\t\t\t\t\t\t\t\t\t\t</tr> \t\t\t\t\t\t\t\t\t\t\t<tr> \t\t\t\t\t\t\t\t\t\t\t\t<th>To:</th>\t\t\t\t\t\t\t\t\t\t\t\t<td data-view-email-field='to'></td>\t\t\t\t\t\t\t\t\t\t\t</tr> \t\t\t\t\t\t\t\t\t\t\t<tr> \t\t\t\t\t\t\t\t\t\t\t\t<td data-view-email-field='content' colspan='2'></td>\t\t\t\t\t\t\t\t\t\t\t</tr> \t\t\t\t\t\t\t\t\t\t</tbody> \t\t\t\t\t\t\t\t\t</table> \t\t\t\t\t\t\t\t\t<div class='oa'> \t\t\t\t\t\t\t\t\t\t<button class='person-view-all-messages btn btn-sm btn-default fl'>Return to Messages</button> \t\t\t\t\t\t\t\t\t\t<button class='person-remove-message btn btn-sm btn-danger fr' style='display:none'>Remove</button> \t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t</div>",html+="\t\t</div>",html+="\t</div>",html+="\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>",$("#modals").html(html),$("#person-modal-tagsinput").tagsinput(impresslist.config.misc.tagSearchConfig);var person=this;$("#save_personId"+this.id).click(function(){person.save()}),$("#close_personId"+this.id).click(function(){person.close()}),$("#delete_personId"+this.id).click(function(){API.removePerson(person)}),$("[data-person-id='"+this.id+"'][data-input-field='priority']").change(function(){person.savePriority()}),$("[data-person-id='"+this.id+"'][data-input-field='assignment']").change(function(){person.saveUserAssignment()}),$("#person-email-default").click(function(e){e.preventDefault(),window.open(emailGmailLink)}),$("#person_tabs [data-tab='person_keys']").click(function(){API.assignedKeys("person",person.id,function(d){for(var html="",i=0;i<d.keys.length;i++){var obj=d.keys[i],dateformatStr=new Date(1e3*obj.assignedByUserTimestamp).toUTCString();html+="\t<tr data-key-id='"+obj.id+"'> \t\t\t\t\t\t\t\t\t<td>"+impresslist.findGameById(obj.game).name+"</td> \t\t\t\t\t\t\t\t\t<td>"+obj.keystring+"</td> \t\t\t\t\t\t\t\t\t<td>"+obj.platform+"</td> \t\t\t\t\t\t\t\t\t<td>"+obj.subplatform+"</td> \t\t\t\t\t\t\t\t\t<td>"+dateformatStr+"</td> \t\t\t\t\t\t\t\t\t<td>\t\t\t\t\t\t\t\t\t\t<button id='unassign_key_"+this.id+"' type='submit' class='btn btn-danger' data-key-id='"+obj.id+"'>X</button> \t\t\t\t\t\t\t\t\t</td> \t\t\t\t\t\t\t\t</tr>"}0==d.keys.length&&(html+="\t<tr> \t\t\t\t\t\t\t\t\t<td colspan='6'>No Keys</td> \t\t\t\t\t\t\t\t</tr>"),$("#person-keys-list").html(html)},function(e){})}),$("#add-publication-search").keyup(function(){var searchfield=$(this),text=$(this).val().toLowerCase();if(0==text.length)return $("#add-publication-results").html(""),void $("#add-publication-results-container").hide();for(var html="",i=0;i<impresslist.publications.length;i++){impresslist.publications[i].search(text)&&(html+="\t<tr class='table-list' data-publication-id='"+impresslist.publications[i].id+"' data-add-publication-result='true' >\t\t\t\t\t\t\t\t\t<td>"+impresslist.publications[i].name+"</td> \t\t\t\t\t\t\t\t\t<td>"+impresslist.publications[i].field("url")+"</td> \t\t\t\t\t\t\t\t</tr>")}0==html.length&&(html+="\t<tr>\t\t\t\t\t\t\t\t<td colspan='2'>No Results</td> \t\t\t\t\t\t\t</tr>"),$("#add-publication-results").html(html),$("#add-publication-results-container").show(),$("[data-add-publication-result='true']").click(function(){var pubId=$(this).attr("data-publication-id");API.addPersonPublication(person,pubId),searchfield.val(""),$("#add-publication-results").html(""),$("#add-publication-results-container").hide()})});for(i=0;i<impresslist.personPublications.length;++i){var perpub=impresslist.personPublications[i];perpub.field("person")==this.id&&perpub.open()}$("#add-youtubechannel-search").keyup(function(){var searchfield=$(this),text=$(this).val().toLowerCase();if(0==text.length)return $("#add-youtubechannel-results").html(""),void $("#add-youtubechannel-results-container").hide();for(var html="",i=0;i<impresslist.youtubers.length;i++){impresslist.youtubers[i].search(text)&&(html+="\t<tr class='table-list' data-youtubechannel-id='"+impresslist.youtubers[i].id+"' data-add-youtubechannel-result='true' >\t\t\t\t\t\t\t\t\t<td>"+impresslist.youtubers[i].name+"</td> \t\t\t\t\t\t\t\t\t<td>"+impresslist.youtubers[i].field("subscribers")+"</td> \t\t\t\t\t\t\t\t</tr>")}0==html.length&&(html+="\t<tr>\t\t\t\t\t\t\t\t<td colspan='2'>No Results</td> \t\t\t\t\t\t\t</tr>"),$("#add-youtubechannel-results").html(html),$("#add-youtubechannel-results-container").show(),$("[data-add-youtubechannel-result='true']").click(function(){var ytId=$(this).attr("data-youtubechannel-id");API.addPersonYoutubeChannel(person,ytId),searchfield.val(""),$("#add-youtubechannel-results").html(""),$("#add-youtubechannel-results-container").hide()})}),$("#add-twitchchannel-search").keyup(function(){var searchfield=$(this),text=$(this).val().toLowerCase();if(0==text.length)return $("#add-twitchchannel-results").html(""),void $("#add-twitchchannel-results-container").hide();for(var html="",i=0;i<impresslist.twitchchannels.length;i++){impresslist.twitchchannels[i].search(text)&&(html+="\t<tr class='table-list' data-twitchchannel-id='"+impresslist.twitchchannels[i].id+"' data-add-twitchchannel-result='true' >\t\t\t\t\t\t\t\t\t<td>"+impresslist.twitchchannels[i].name+"</td> \t\t\t\t\t\t\t\t\t<td>"+impresslist.twitchchannels[i].field("subscribers")+"</td> \t\t\t\t\t\t\t\t</tr>")}0==html.length&&(html+="\t<tr>\t\t\t\t\t\t\t\t<td colspan='2'>No Results</td> \t\t\t\t\t\t\t</tr>"),$("#add-twitchchannel-results").html(html),$("#add-twitchchannel-results-container").show(),$("[data-add-twitchchannel-result='true']").click(function(){var ytId=$(this).attr("data-twitchchannel-id");API.addPersonTwitchChannel(person,ytId),searchfield.val(""),$("#add-twitchchannel-results").html(""),$("#add-twitchchannel-results-container").hide()})});for(i=0;i<impresslist.personYoutubeChannels.length;++i){var peryt=impresslist.personYoutubeChannels[i];peryt.field("person")==this.id&&peryt.open()}for(i=0;i<impresslist.personTwitchChannels.length;++i){var pertw=impresslist.personTwitchChannels[i];pertw.field("person")==this.id&&pertw.open()}function returnToMessages(){$("#person-view-email").hide(),$("#all-messages").show()}return $(".person-view-all-messages").click(returnToMessages),$("[data-open-field='email']").click(function(){var emailId=$(this).attr("data-email-id"),emailObj=impresslist.findEmailById(emailId),emailDate=new Date(1e3*emailObj.field("utime")).toUTCString(),emailSubject=emailObj.field("subject");60<emailSubject.length&&(emailSubject=emailSubject.substr(0,60)+"..."),$("[data-view-email-field='date']").html(emailDate),$("[data-view-email-field='subject']").html(emailSubject),$("[data-view-email-field='from']").html(emailObj.field("from_email")),$("[data-view-email-field='to']").html(emailObj.field("to_email")),$("[data-view-email-field='content']").html(emailObj.field("contents")),impresslist.config.user.admin&&$(".person-remove-message").show(),$(".person-remove-message").unbind("click"),$(".person-remove-message").click(function(){API.request("/email/remove/",{id:emailId},function(data){API.successMessage("Email successfully removed."),$("#all-messages tr[data-open-field=email][data-email-id="+emailId+"]").remove(),returnToMessages()},function(){})}),$("#all-messages").hide(),$("#person-view-email").show()}),$("#person_tabs a").click(function(e){e.preventDefault(),$("#person_tabs_container .tab-content [role='tabpanel']").hide(),$("#person_tabs_container .tab-content [data-tab='"+$(this).attr("data-tab")+"']").addClass("active").show(),$(this).tab("show")}),html},Person.prototype.close=function(){$(".person_modal").modal("hide")},Person.prototype.onAdded=function(){this.createTableRow()},Person.prototype.onRemoved=function(){this.removeTableRow(),this.close()},Person.prototype.fullname=function(){return this.field("firstname")+" "+this.field("surnames")},Person.prototype.createTableRow=function(){var lastcontactedbytemp=this.field("lastcontactedby"),lastcontactedbystring="";if(0<lastcontactedbytemp){var lastcontactedbyuser=impresslist.findUserById(parseInt(lastcontactedbytemp));lastcontactedbystring="by <span style='color:"+lastcontactedbyuser.field("color")+"'>"+lastcontactedbyuser.field("forename")+"</span>"}var html="\t<tr data-person-id='"+this.field("id")+"' data-person-tablerow='true' class='table-list' data-toggle='modal' data-target='.person_modal'> \t\t\t\t\t\t\t\x3c!-- <td data-person-id='"+this.field("id")+"' data-field='id' data-value='"+this.field("id")+"'>"+this.field("id")+"</td> --\x3e\t\t\t\t\t\t\t<td data-value='"+this.fullname()+"'> \t\t\t\t\t\t\t\t<span data-person-id='"+this.field("id")+"' data-field='name' >"+this.fullname()+"</span> \t\t\t\t\t\t\t\t<div data-person-id='"+this.field("id")+"' data-field='email-list'></div> \t\t\t\t\t\t\t</td> \t\t\t\t\t\t\t<td data-person-id='"+this.field("id")+"' data-field='priority' data-value='"+this.priority()+"'>"+Priority.name(this.priority())+"</td> \t\t\t\t\t\t\t<td data-person-id='"+this.field("id")+"' data-field='twitter_followers' data-value='"+this.field("twitter_followers")+"'>"+this.twitterCell()+"</td> \t\t\t\t\t\t\t<td data-person-id='"+this.field("id")+"' data-field='last_contacted' data-value='"+this.field("lastcontacted")+"'>"+impresslist.util.relativetime_contact(this.field("lastcontacted"))+" "+lastcontactedbystring+"</td>\t\t\t\t\t\t\t<td data-person-id='"+this.field("id")+"' data-field='tags' data-value='"+this.field("tags")+"'>"+impresslist.util.buildTags(this.field("tags"))+"</td>";html+="\t\t</tr>",$("#people").append(html);var person=this;$(this.openSelector()).click(function(){person.open()})},Person.prototype.refreshEmails=function(){var emails=[];0<this.field("email").length&&emails.push({type:"person",typeId:this.field("id"),typeName:"Personal",person:this.field("id"),name:this.fullname(),email:this.field("email")});for(var i=0;i<impresslist.personPublications.length;++i)if(impresslist.personPublications[i].field("person")==this.id&&0<impresslist.personPublications[i].field("email").length){var publication=impresslist.findPublicationById(impresslist.personPublications[i].field("publication"));if(!publication)continue;emails.push({type:"personPublication",typeId:impresslist.personPublications[i].field("id"),typeName:publication.field("name"),personPublication:impresslist.personPublications[i].field("id"),name:this.fullname(),email:impresslist.personPublications[i].field("email")})}var extraEmails="";for(i=0;i<emails.length;i++)extraEmails+="\t<div data-type='person' data-person-id='"+this.field("id")+"' data-person-extra-tablerow='true' style='padding:5px;'>",extraEmails+="\t\t<input \t\t\t\t\t\t\t\t\t\tdata-type='person' \t\t\t\t\t\t\t\t\t\tdata-person-id='"+this.field("id")+"' \t\t\t\t\t\t\t\t\t\tdata-checkbox='true' \t\t\t\t\t\t\t\t\t\tdata-person-checkbox='true' \t\t\t\t\t\t\t\t\t\tdata-mailout-name='"+emails[i].name+"' \t\t\t\t\t\t\t\t\t\tdata-mailout-type='"+emails[i].type+"' \t\t\t\t\t\t\t\t\t\tdata-mailout-typeid='"+emails[i].typeId+"' \t\t\t\t\t\t\t\t\t\tdata-mailout-typename='"+emails[i].typeName+"' \t\t\t\t\t\t\t\t\t\tdata-mailout-email='"+emails[i].email+"' \t\t\t\t\t\t\t\t\t\ttype='checkbox' \t\t\t\t\t\t\t\t\t\tvalue='1'/>",extraEmails+="\t\t&nbsp; "+emails[i].typeName+" - "+emails[i].email,extraEmails+="\t</div>";$('div[data-person-id="'+this.field("id")+'"][data-field="email-list"]').html(extraEmails);var person=this;$("input[data-person-id='"+this.field("id")+"'][data-checkbox='true']").click(function(e){impresslist.refreshMailoutRecipients(),person.preventOpen(),e.stopPropagation()})},Person.prototype.openSelector=function(){return"#people [data-person-tablerow='true'][data-person-id='"+this.id+"']"},Person.prototype.removeTableRow=function(){$("#people [data-person-tablerow='true'][data-person-id='"+this.id+"']").remove()},Person.prototype.filterTags=function(tagsArray){return DBO.prototype.filterTags.call(this,tagsArray)},Person.prototype.filter=function(text){var elementExtras=$("#people [data-person-extra-tablerow='true'][data-person-id='"+this.id+"']");return elementExtras.hide(),this.search(text)&&this.filter_isContactedByMe()&&this.filter_isRecentlyContacted()&&this.filter_isHighPriority()&&this.filter_hasEmail()&&this.filter_isAssignedToMe()&&this.filter_isOutOfDate()?(this.show(),impresslist.selectModeIsOpen&&elementExtras.show(),!0):(this.hide(),!1)},Person.prototype.filter_isRecentlyContacted=function(){if($("#filter-recent-contact").is(":checked")){for(var contactedRecently=!1,len=impresslist.emails.length,i=0;i<len;++i)impresslist.emails[i].field("person_id")==this.id&&Number(impresslist.emails[i].field("utime"))>=Date.now()/1e3-604800&&(contactedRecently=!0);return!contactedRecently}return!0},Person.prototype.filter_isContactedByMe=function(){if($("#filter-personal-contact").is(":checked")){for(var len=impresslist.emails.length,i=0;i<len;++i)if(impresslist.emails[i].field("person_id")==this.id&&impresslist.emails[i].field("user_id")==impresslist.config.user.id)return!0;return!1}return!0},Person.prototype.filter_isHighPriority=function(){if($("#filter-high-priority").is(":checked")){if(3==this.priority())return!0;for(var len=impresslist.personPublications.length,i=0;i<len;++i){if(impresslist.personPublications[i].field("person")==this.id)if(3==impresslist.findPublicationById(impresslist.personPublications[i].field("publication")).priority())return!0}return!1}return!0},Person.prototype.filter_isAssignedToMe=function(){return!$("#filter-assigned-self").is(":checked")||this.field("assigned")==impresslist.config.user.id},Person.prototype.filter_isOutOfDate=function(){return!$("#filter-show-outofdate").is(":checked")||1==this.field("outofdate")},Person.prototype.filter_hasEmail=function(){if($("#filter-email-attached").is(":checked")){if(0<this.field("email").length)return!0;for(var len=impresslist.personPublications.length,i=0;i<len;++i)if(impresslist.personPublications[i].field("person")==this.id&&0<impresslist.personPublications[i].field("email").length)return!0;return!1}return!0},Person.prototype.search=function(text){var ret=!0;if(0==text.length)return ret;if(ret=-1!=this.fullname().toLowerCase().indexOf(text))return ret;if(ret=-1!=this.field("tags").indexOf(text))return ret;if($("#search-option-full").is(":checked")&&(ret=-1!=this.fields.notes.toLowerCase().indexOf(text)))return ret;if(ret=-1!=this.fields.email.toLowerCase().indexOf(text))return ret;for(var len=impresslist.personPublications.length,i=0;i<len;++i)if(impresslist.personPublications[i].fields.person==this.id){if(!(pub=impresslist.findPublicationById(impresslist.personPublications[i].fields.publication)))return!1;if(ret=pub.search(text))return ret}len=impresslist.personYoutubeChannels.length;for(i=0;i<len;++i)if(impresslist.personYoutubeChannels[i].fields.person==this.id){var pub;if(!(pub=impresslist.findYoutuberById(impresslist.personYoutubeChannels[i].fields.youtuber)))return!1;if(ret=pub.search(text))return ret}return!1},Publication=function(data){DBO.call(this,data)},Publication.prototype=Object.create(DBO.prototype),Publication.prototype.constructor=Publication,Publication.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.fields.id),this.name=this.fields.name,this.lastpostedon=0,this.initPriorities("priorities")},Publication.prototype.onAdded=function(){this.createTableRow()},Publication.prototype.onRemoved=function(){this.removeTableRow(),this.close()},Publication.prototype.preventOpen=function(){$("#modals").html("")},Publication.prototype.open=function(){var html="<div class='modal fade publication_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'> \t\t\t\t\t\t\t\t<div style='min-height:100px;padding:20px;'>";html+=" \t\t\t\t<h3 data-publication-id='"+this.id+"' data-field='name'>"+this.field("name")+"</h3> ",html+="\t\t\t\t<form role='form' class='oa' onsubmit='return false;'>\t\t\t\t\t\t\t\t\t\t\t<div class='row'>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group  col-md-6'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='name'>Name:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t\t<input data-publication-id='"+this.id+"' data-input-field='name' class='form-control' type='text' value='"+this.field("name")+"' /> \t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-3'>\t\t\t\t\t\t\t\t\t\t\t\t<label for='email'>Priority:</label>";var priority=this.priority();html+="\t<select data-publication-id='"+this.id+"' data-input-field='priority' class='form-control'>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='3' "+(3==priority?"selected='true'":"")+">High</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='2' "+(2==priority?"selected='true'":"")+">Medium</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='1' "+(1==priority?"selected='true'":"")+">Low</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='0' "+(0==priority?"selected='true'":"")+">N/A</option>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>",html+="\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class='form-group col-md-3'>\t\t\t\t\t\t\t\t\t\t\t\t"+this.countrySelectHtml("publication")+"\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='url'>URL:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t<input data-publication-id='"+this.id+"' data-input-field='url' class='form-control' type='text' value='"+this.field("url")+"' />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='url'>General/Tips Email:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t<input data-publication-id='"+this.id+"' data-input-field='email' class='form-control' type='text' value='"+this.field("email")+"' />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='rssfeedurl'>RSS Feed URL:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t<input data-publication-id='"+this.id+"' data-input-field='rssfeedurl' class='form-control' type='text' value='"+this.field("rssfeedurl")+"' />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='email'>Twitter Username:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t<input data-publication-id='"+this.id+"' data-input-field='twitter' class='form-control' type='text' value='"+this.field("twitter")+"' />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='email'>Notes:&nbsp; </label> \t\t\t\t\t\t\t\t\t\t\t<textarea data-publication-id='"+this.id+"' data-input-field='notes' class='form-control' style='height:50px;'>"+this.field("notes")+"</textarea>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t\t\t\t<label for='tags'>Tags:</label><Br/> \t\t\t\t\t\t\t\t\t\t\t<input id='publication-modal-tagsinput' data-publication-id='"+this.id+"' data-input-field='tags' class='form-control' type='text' value='"+impresslist.util.tagStringToInputField(this.field("tags"))+"' data-role=\"tagsinput\" />\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='fl'> \t\t\t\t\t\t\t\t\t\t\t<button id='save_publicationId"+this.id+"' type='submit' class='btn btn-primary'>Save</button>",html+="\t\t\t\t\t\t&nbsp;<button id='close_publicationId"+this.id+"' type='submit' class='btn btn-default'>Close</button>",html+=" \t\t\t\t\t</div><div class='fr'> \t\t\t\t\t\t\t\t\t\t\t<button id='delete_publicationId"+this.id+"' type='submit' class='btn btn-danger'>Remove</button> \t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</form>",html+="\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>",$("#modals").html(html),$("#publication-modal-tagsinput").tagsinput(impresslist.config.misc.tagSearchConfig);var publication=this;$("#save_publicationId"+this.id).click(function(){publication.save()}),$("#close_publicationId"+this.id).click(function(){publication.close()}),$("#delete_publicationId"+this.id).click(function(){API.removePublication(publication)}),$("[data-publication-id='"+this.id+"'][data-input-field='priority']").change(function(){publication.savePriority()})},Publication.prototype.save=function(){var name=$("[data-publication-id="+this.id+"][data-input-field='name']").val(),url=$("[data-publication-id="+this.id+"][data-input-field='url']").val(),email=$("[data-publication-id="+this.id+"][data-input-field='email']").val(),rssfeedurl=$("[data-publication-id="+this.id+"][data-input-field='rssfeedurl']").val(),twitter=$("[data-publication-id="+this.id+"][data-input-field='twitter']").val(),notes=$("[data-publication-id="+this.id+"][data-input-field='notes']").val(),country=$("[data-publication-id="+this.id+"][data-input-field='country']").val(),tags=impresslist.util.tagInputFieldToString($("#publication-modal-tagsinput").val());API.savePublication(this,name,url,email,rssfeedurl,twitter,notes,country,tags)},Publication.prototype.savePriority=function(){var priority=$("[data-publication-id='"+this.id+"'][data-input-field='priority']").val();API.setPublicationPriority(this,priority,impresslist.config.user.game)},Publication.prototype.update=function(){$("[data-publication-id='"+this.id+"'][data-field='name']").html(this.name),$("[data-publication-id='"+this.id+"'][data-field='priority']").html(Priority.name(this.priority())),$("[data-publication-id='"+this.id+"'][data-field='url']").html(this.field("url")),$("[data-publication-id='"+this.id+"'][data-field='email']").html(this.field("email")),$("[data-publication-id='"+this.id+"'][data-field='twitter']").html(this.field("twitter")),$("[data-publication-id='"+this.id+"'][data-field='twitter_followers']").html(this.twitterCell()),$("[data-publication-id='"+this.id+"'][data-field='tags']").html(impresslist.util.buildTags(this.field("tags")))},Publication.prototype.close=function(){$(".publication_modal").modal("hide")},Publication.prototype.createTableRow=function(){var html="\t<tr data-publication-tablerow='true' data-publication-id='"+this.id+"' class='table-list' data-toggle='modal' data-target='.publication_modal'> \t\t\t\t\t\t\t\x3c!-- <td data-publication-id='"+this.field("id")+"' data-field='id' \t\t\t\tdata-value='"+this.field("id")+"' >"+this.field("id")+"</td> --\x3e \t\t\t\t\t\t\t\x3c!-- <td data-publication-id='"+this.field("id")+"' data-field='name' \t\t\t\tdata-value='"+this.field("name")+"' >"+this.icon()+this.field("name")+"</td> --\x3e\t\t\t\t\t\t\t<td data-value='"+this.field("name")+"'> \t\t\t\t\t\t\t\t<span data-publication-id='"+this.field("id")+"' data-field='name' data-value='"+this.field("name")+"'>"+this.icon()+this.field("name")+"</span> \t\t\t\t\t\t\t\t<div data-publication-id='"+this.field("id")+"' data-field='email-list'></div> \t\t\t\t\t\t\t</td> \t\t\t\t\t\t\t<td data-publication-id='"+this.field("id")+"' data-field='priority' \t\t\tdata-value='"+this.priority()+"'>"+Priority.name(this.priority())+"</td> \t\t\t\t\t\t\t<td data-publication-id='"+this.field("id")+"' data-field='url' \t\t\t\tdata-value='"+this.field("url")+"' style='max-width:250px;'><a href='"+this.field("url")+"' target='new'>"+this.field("url")+"</a></td> \t\t\t\t\t\t\t<td data-publication-id='"+this.field("id")+"' data-field='twitter_followers' \tdata-value='"+this.field("twitter_followers")+"'>"+this.twitterCell()+"</td> \t\t\t\t\t\t\t<td data-publication-id='"+this.field("id")+"' data-field='lastpostedon' \t\tdata-value='"+this.field("lastpostedon")+"'>"+impresslist.util.relativetime_contact(this.field("lastpostedon"))+"</td> \t\t\t\t\t\t\t<td data-publication-id='"+this.field("id")+"' data-field='tags' \t\t\t\tdata-value='"+this.field("tags")+"' style='max-width:200px;'>"+impresslist.util.buildTags(this.field("tags"))+"</td> \t\t\t\t\t\t</tr>";$("#publications").append(html);var publication=this;$(this.openSelector()).click(function(){publication.open()})},Publication.prototype.openSelector=function(){return"#publications [data-publication-tablerow='true'][data-publication-id='"+this.id+"']"},Publication.prototype.removeTableRow=function(){$("#publications [data-publication-tablerow='true'][data-publication-id='"+this.id+"']").remove()},Publication.prototype.icon=function(){return""},Publication.prototype.filter=function(text){var elementExtras=$("#publications [data-publication-extra-tablerow='true'][data-publication-id='"+this.id+"']");elementExtras.hide();var element=$("#publications [data-publication-tablerow='true'][data-publication-id='"+this.id+"']");return this.search(text)&&this.filter_isHighPriority()?(impresslist.selectModeIsOpen&&elementExtras.show(),element.show(),!0):(element.hide(),!1)},Publication.prototype.filter_isHighPriority=function(){return!$("#filter-high-priority").is(":checked")||3==this.priority()},Publication.prototype.search=function(text){var ret=!0;return 0==text.length?ret:(ret=-1!=this.name.toLowerCase().indexOf(text))?ret:(ret=-1!=this.field("tags").indexOf(text))?ret:$("#search-option-full").is(":checked")&&(ret=-1!=this.fields.notes.toLowerCase().indexOf(text))?ret:(ret=-1!=this.fields.url.toLowerCase().indexOf(text))?ret:(ret=-1!=this.fields.email.toLowerCase().indexOf(text))?ret:(ret=-1!=this.fields.twitter.toLowerCase().indexOf(text))||!1},Publication.prototype.refreshEmails=function(){var emails=[];0<this.field("email").length&&emails.push({type:"publication",typeId:this.field("id"),typeName:this.name+" (Publication)",publication:this.field("id"),name:this.name,email:this.field("email")});for(var extraEmails="",i=0;i<emails.length;i++)extraEmails+="\t<div data-type='publication' data-publication-id='"+this.field("id")+"' data-publication-extra-tablerow='true' style='padding:5px;'>",extraEmails+="\t\t<input \t\t\t\t\t\t\t\t\t\tdata-type='publication' \t\t\t\t\t\t\t\t\t\tdata-publication-id='"+this.field("id")+"' \t\t\t\t\t\t\t\t\t\tdata-checkbox='true' \t\t\t\t\t\t\t\t\t\tdata-publication-checkbox='true' \t\t\t\t\t\t\t\t\t\tdata-mailout-name='"+emails[i].name+" (Publication)' \t\t\t\t\t\t\t\t\t\tdata-mailout-type='"+emails[i].type+"' \t\t\t\t\t\t\t\t\t\tdata-mailout-typeid='"+emails[i].typeId+"' \t\t\t\t\t\t\t\t\t\tdata-mailout-typename='"+emails[i].typeName+"' \t\t\t\t\t\t\t\t\t\tdata-mailout-email='"+emails[i].email+"' \t\t\t\t\t\t\t\t\t\ttype='checkbox' \t\t\t\t\t\t\t\t\t\tvalue='1'/>",extraEmails+="\t\t&nbsp; "+emails[i].typeName+" - "+emails[i].email,extraEmails+="\t</div>";$('div[data-publication-id="'+this.field("id")+'"][data-field="email-list"]').html(extraEmails);var publication=this;$("input[data-publication-id='"+this.field("id")+"'][data-checkbox='true']").click(function(e){impresslist.refreshMailoutRecipients(),publication.preventOpen(),e.stopPropagation()})},OAuthTwitterAccount=function(data){DBO.call(this,data)},OAuthTwitterAccount.prototype=Object.create(DBO.prototype),OAuthTwitterAccount.prototype.constructor=OAuthTwitterAccount,OAuthTwitterAccount.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id"))},OAuthTwitterAccount.prototype.onAdded=function(fromInit){this.createItem(fromInit),$("#social-homepage-twitteracc-list-none").hide(),fromInit||$("#social-addtwitteraccount-cancel").click()},OAuthTwitterAccount.prototype.onRemoved=function(){this.removeItem(),impresslist.oauthTwitterAccounts.length-1==0&&$("#social-homepage-twitteracc-list-none").show()},OAuthTwitterAccount.prototype.createItem=function(fromInit){var followers=0,following=0;try{followers=JSON.parse(this.field("twitter_followers")).length}catch(e){}try{following=JSON.parse(this.field("twitter_friends")).length}catch(e){}var html="";html+="<div class='social-account-list-item' id='social-twitteracc-"+this.id+"'>",html+="\t<div class='fl'><img src='"+this.field("twitter_image")+"' style='width:60px;'/></div>",html+="\t<div class='fl' style='padding-left:10px;'>"+this.field("twitter_name")+"<br/> <a href='http://twitter.com/"+this.field("twitter_handle")+"' target='new'>@"+this.field("twitter_handle")+"</a><br/>Followers: <b>"+followers+"</b> Following: <b>"+following+"</b></div>",html+="\t<button id='social-remove-twitteracc-"+this.id+"' class='btn btn-danger fr'>X</button>",html+="\t<div class='fr dropdown' style='margin-right:8px;'> \t\t  \t\t\t\t<button class='btn btn-primary dropdown-toggle' type='button' data-toggle='dropdown'>View Tools <span class='caret'></span></button> \t\t\t\t\t  \t<ul class='dropdown-menu dropdown-menu-right'> \t\t\t\t\t    \t<li><a href='javascript:;' id='social-twitteracc-"+this.id+"-unrequited-followings' >Unrequited Followings</a></li> \t\t\t\t\t    \t<li><a href='javascript:;' id='social-twitteracc-"+this.id+"-inactive-followings-1' data-years='1'>Inactive Followings (1 year)</a></li> \t\t\t\t\t    \t<li><a href='javascript:;' id='social-twitteracc-"+this.id+"-inactive-followings-half' data-years='0.5'>Inactive Followings (6 mths)</a></li> \t\t\t\t\t    \t<li><a href='javascript:;' id='social-twitteracc-"+this.id+"-inactive-followings-qt' data-years='0.25'>Inactive Followings (3 mths)</a></li> \t\t\t\t\t  \t</ul> \t\t\t\t\t</div>",html+="</div>",$("#social-homepage-twitteracc-list").append(html);var th=this;$("#social-twitteracc-"+this.id+"-inactive-followings-1").click(function(){th.showInactiveFollowings($(this).attr("data-years"))}),$("#social-twitteracc-"+this.id+"-inactive-followings-half").click(function(){th.showInactiveFollowings($(this).attr("data-years"))}),$("#social-twitteracc-"+this.id+"-inactive-followings-qt").click(function(){th.showInactiveFollowings($(this).attr("data-years"))}),$("#social-twitteracc-"+this.id+"-unrequited-followings").click(function(){th.showUnrequitedFollowings()}),this.update()},OAuthTwitterAccount.prototype.accountListModal=function(title){var html="";html+="\t<div id='twitterAccountsList_modal' class='modal fade' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content'> \t\t\t\t\t\t\t\t<div style='min-height:"+Math.round(.8*window.innerHeight)+"px;padding:20px;'>",html+="\t\t\t\t\t<h3>"+title+"</h3>",html+="\t\t\t\t\t<h4>"+this.field("twitter_name")+" (@"+this.field("twitter_handle")+")</h4>",html+="\t\t\t\t\t<div id='twitterAccountsList_data'></div>",html+="\t\t\t\t</div> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div> \t\t\t\t\t</div>",$("#modals").html(html),$("#twitterAccountsList_modal").modal("show")},OAuthTwitterAccount.prototype.accountListModalSetTotal=function(count){var html="<b>Total: "+count+"</b><br/><br/>";$("#twitterAccountsList_data").append(html)},OAuthTwitterAccount.prototype.accountListModalAddAccount=function(row){var html="<div id='twitter-acc-row-"+row.twitter_id+"' class='oa' style='padding:4px;'> \t\t\t\t\t\t<div class='fl'><img src='"+row.twitter_image+"' style='display:inline-block;width:75px;padding-right:6px;'/></div> \t\t\t\t\t\t<div class='fl' style='width:385px;'> \t\t\t\t\t\t\t<b>"+row.twitter_name+"</b> (<a href='http://twitter.com/"+row.twitter_handle+"' target='new'>@"+row.twitter_handle+'</a>)<br/> \t\t\t\t\t\t\t"<i>'+row.twitter_bio.substr(0,127)+'...</i>"<br/> \t\t\t\t\t\t\t'+impresslist.util.relativetime_contact(row.twitter_lastpostedon)+"\t\t\t\t\t\t</div>\t\t\t\t\t\t<button id='unfollow-twitter-account' data-from-id='"+this.id+"' data-from-handle='"+this.field("twitter_handle")+"' data-handle='"+row.twitter_handle+"' class='btn btn-sm btn-danger fr'>Unfollow</button>\t\t\t\t\t</div>";$("#twitterAccountsList_data").append(html),$("#unfollow-twitter-account[data-from-handle="+this.field("twitter_handle")+"][data-handle="+row.twitter_handle+"]").click(function(e){console.log("Unfollow",$(this).attr("data-from-handle"),$(this).attr("data-handle")),$(this).prop("disabled",!0),API.doOAuthTwitterAccountUnfollow($(this).attr("data-from-id"),$(this).attr("data-handle"),function(data){$("#twitter-acc-row-"+row.twitter_id).fadeOut()},function(){$(this).prop("disabled",!1)})})},OAuthTwitterAccount.prototype.showInactiveFollowings=function(years){var th=this;this.accountListModal("Inactive Followings ("+years+" years)"),API.getOAuthTwitterAccountInactiveFollowings(this.field("twitter_handle"),years,function(data){th.accountListModalSetTotal(data.accounts.length);for(var i=0;i<data.accounts.length;i++)th.accountListModalAddAccount(data.accounts[i])},null)},OAuthTwitterAccount.prototype.showUnrequitedFollowings=function(){var th=this;this.accountListModal("Unrequited Followings"),API.getOAuthTwitterAccountUnrequitedFollowings(this.field("twitter_handle"),function(data){th.accountListModalSetTotal(data.accounts.length);for(var i=0;i<data.accounts.length;i++)th.accountListModalAddAccount(data.accounts[i])},null)},OAuthTwitterAccount.prototype.removeItem=function(){$("#social-twitteracc-"+this.id).remove()},OAuthTwitterAccount.prototype.update=function(){var th=this;$("#social-remove-twitteracc-"+this.id).click(function(){API.removeOAuthTwitterAccount(th)})},OAuthFacebookAccount=function(data){DBO.call(this,data)},OAuthFacebookAccount.prototype=Object.create(DBO.prototype),OAuthFacebookAccount.prototype.constructor=OAuthFacebookAccount,OAuthFacebookAccount.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id"))},OAuthFacebookAccount.prototype.onAdded=function(fromInit){this.createItem(fromInit),$("#social-homepage-facebookacc-list-none").hide(),fromInit||$("#social-addfacebookaccount-cancel").click()},OAuthFacebookAccount.prototype.onRemoved=function(){this.removeItem(),impresslist.oauthFacebookAccounts.length-1==0&&$("#social-homepage-facebookacc-list-none").show()},OAuthFacebookAccount.prototype.createItem=function(fromInit){var html="";html+="<div class='social-account-list-item' id='social-facebookacc-"+this.id+"'>",html+="\t<img src='"+this.field("facebook_image")+"' /> <a href='http://facebook.com/"+this.field("facebook_id")+"' target='new'>"+this.field("facebook_name")+"</a>",html+="\t<button id='social-remove-facebookacc-"+this.id+"' class='btn btn-sm btn-danger fr'>X</button>",html+="</div>",$("#social-homepage-facebookacc-list").append(html),this.update()},OAuthFacebookAccount.prototype.removeItem=function(){$("#social-facebookacc-"+this.id).remove()},OAuthFacebookAccount.prototype.update=function(){var th=this;$("#social-remove-facebookacc-"+this.id).click(function(){API.removeOAuthFacebookAccount(th)})},OAuthFacebookPage=function(data){DBO.call(this,data)},OAuthFacebookPage.prototype=Object.create(DBO.prototype),OAuthFacebookPage.prototype.constructor=OAuthFacebookPage,OAuthFacebookPage.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(this.field("id"))},OAuthFacebookPage.prototype.onAdded=function(fromInit){this.createItem(fromInit),$("#social-homepage-facebookacc-list-none").hide()},OAuthFacebookPage.prototype.onRemoved=function(){this.removeItem(),impresslist.oauthFacebookPages.length-1==0&&$("#social-homepage-facebookacc-list-none").show()},OAuthFacebookPage.prototype.createItem=function(fromInit){var html="";html+="<p id='social-facebookpage-"+this.id+"'>",html+="\t<img src='"+this.field("page_image")+"' /> <a href='http://facebook.com/"+this.field("page_id")+"' target='new'>"+this.field("page_name")+"</a>",html+="\t<button id='social-remove-facebookpage-"+this.id+"' class='btn btn-sm btn-danger fr'>X</button>",html+="</p>",$("#social-homepage-facebookacc-list").append(html),this.update()},OAuthFacebookPage.prototype.removeItem=function(){$("#social-facebookacc-"+this.id).remove()},OAuthFacebookPage.prototype.update=function(){var th=this;$("#social-remove-facebookpage-"+this.id).click(function(){API.removeOAuthFacebookPage(th)})};var SocialUploadID=0;SocialUpload=function(data){DBO.call(this,data)},SocialUpload.prototype=Object.create(DBO.prototype),SocialUpload.prototype.constructor=SocialUpload,SocialUpload.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=SocialUploadID,SocialUploadID++},SocialUpload.prototype.onAdded=function(fromInit){this.createItem(fromInit),$("#socialUploads-list-loading").hide(),$("#social-uploads-list-none").hide()},SocialUpload.prototype.onRemoved=function(){this.removeItem(),impresslist.socialUploads.length-1==0&&$("#social-uploads-list-none").show()},SocialUpload.prototype.createItem=function(fromInit){var html="";html+="<div id='social-upload-"+this.id+"' class='socialqueue-item' style='padding:0px; float:left;margin-right:5px;width:149px;'>",html+="\t<button id='social-remove-upload-"+this.id+"' class='btn btn-sm btn-danger fr' style='border-radius:0;'>X</button>",html+="\t<a href='"+this.field("fullname")+"' target='new'><img style='padding:0px;width:100%;' src='"+this.field("fullname")+"' /></a>",html+="</div>",$("#social-uploads-list").prepend(html),this.update()},SocialUpload.prototype.removeItem=function(){$("#social-upload-"+this.id).remove()},SocialUpload.prototype.update=function(){var th=this;$("#social-remove-upload-"+this.id).click(function(){API.removeSocialUpload(th)})},SocialTimelineItem=function(data){DBO.call(this,data)},SocialTimelineItem.prototype=Object.create(DBO.prototype),SocialTimelineItem.prototype.constructor=SocialTimelineItem,SocialTimelineItem.displaySort=function(){var $wrapper=$("#social-timeline");$wrapper.find(".socialqueue-item-container").sort(function(a,b){return+a.getAttribute("data-timestamp")-+b.getAttribute("data-timestamp")}).appendTo($wrapper)},SocialTimelineItem.prototype.init=function(data){DBO.prototype.init.call(this,data),this.id=parseInt(data.id)},SocialTimelineItem.prototype.onAdded=function(fromInit){this.createItem(fromInit),$("#social-timeline-loading").hide(),$("#social-timeline-none").hide(),SocialTimelineItem.displaySort()},SocialTimelineItem.prototype.onRemoved=function(){this.removeItem(),impresslist.socialUploads.length-1==0&&$("#social-uploads-list-none").show()},SocialTimelineItem.prototype.createItem=function(fromInit){var html="";html+="<div class='socialqueue-item-container' data-timestamp='"+this.field("timestamp")+"' data-social-id='"+this.id+"' >",html+="</div>",$("#social-timeline").append(html),this.updateRow(),this.update()},SocialTimelineItem.prototype.removeItem=function(){$(".socialqueue-item-container[data-social-id='"+this.id+"']").remove(),this.close()},SocialTimelineItem.prototype.openShareDialog=function(){var html="<div class='modal fade socialShare_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog' style='width:400px;margin-top:20%'> \t\t\t\t\t\t\t<div class='modal-content' style='width:400px;'> \t\t\t\t\t\t\t\t<div style='min-height:100px;padding:20px;'>";html+="\t<h3>Add Retweets</h3>",html+="\t<div class='form-group'>\t\t\t\t\t\t<label for='type'>Time Separation:&nbsp; </label> \t\t\t\t\t\t<select id='social-sharemodal-retweet-timesep' class='form-control'> \t\t\t\t\t\t\t<option value='3600'>1 hr</option>\t\t\t\t\t\t\t<option value='7200'>2 hrs</option>\t\t\t\t\t\t\t<option value='21600'>6 hrs</option>\t\t\t\t\t\t\t<option value='43200'>12 hrs</option>\t\t\t\t\t\t\t<option value='86400'>24 hrs</option>\t\t\t\t\t\t</select>\t\t\t\t\t</div>",html+="\t<div class='form-group'>\t\t\t\t\t\t<label for='accounts'>Accounts:&nbsp; </label>\t\t\t\t\t\t<select id='social-sharemodal-retweet-accounts' multiple='multiple'>";for(var i=0;i<impresslist.oauthTwitterAccounts.length;i++){var tw=impresslist.oauthTwitterAccounts[i];if(console.log("upid:"+tw.id),console.log(this.field("typedata").account),tw.id!=parseInt(this.field("typedata").account)){for(var hasRetweetScheduled=!1,j=0;j<impresslist.socialTimelineItems.length;j++){var sti=impresslist.socialTimelineItems[j];"retweet"==sti.field("type")&&parseInt(sti.field("typedata").tweet)==this.id&&parseInt(sti.field("typedata").account)==tw.id&&(hasRetweetScheduled=!0)}if(!hasRetweetScheduled){html+="<option value='"+tw.field("id")+"' >"+tw.field("twitter_handle")+"</option>"}}}html+="\t\t</select>\t\t\t\t\t</div>",html+="\t<div class='oa'> \t\t\t\t\t\t<div class='fl'> \t\t\t\t\t\t\t<button id='social-add-retweets-"+this.id+"' type='submit' class='btn btn-success' style='margin-right:5px;'>Add</button> \t\t\t\t\t\t</div>\t\t\t\t\t\t<div class='fr'> \t\t\t\t\t\t\t<button id='social-close-retweets-"+this.id+"' type='submit' class='btn btn-default'>Close</button> \t\t\t\t\t\t</div> \t\t\t\t\t</div>",html+="\t\t\t\t</div> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div> \t\t\t\t\t</div>",$("#modals").html(html);var th=this;$("#social-sharemodal-retweet-accounts").multiselect({enableFiltering:!0,includeSelectAllOption:!0,enableCaseInsensitiveFiltering:!0}),$("#social-add-retweets-"+this.id).click(function(){for(var timeSeparation=$("#social-sharemodal-retweet-timesep").val(),selectedAccountsNodes=$("#social-sharemodal-retweet-accounts option:selected"),selectedAccounts="",i=0;i<selectedAccountsNodes.length;i++)selectedAccounts+=selectedAccountsNodes[i].value,i<selectedAccountsNodes.length-1&&(selectedAccounts+=",");console.log(timeSeparation),console.log(selectedAccountsNodes),console.log(selectedAccounts),API.addSocialTimelineItemRetweets(th,selectedAccounts,timeSeparation,function(){th.closeShareDialog(),SocialTimelineItem.displaySort()})}),$("#social-close-retweets-"+this.id).click(function(){th.closeShareDialog()})},SocialTimelineItem.prototype.closeShareDialog=function(){$(".socialShare_modal").modal("hide")},SocialTimelineItem.prototype.open=function(){console.log("open");var html="<div class='modal fade social_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content'> \t\t\t\t\t\t\t\t<div style='min-height:100px;padding:20px;'>";html+="\t<h3>Scheduled Item</h3>",html+="\t<div class='row'>\t\t\t\t\t\t<div class='col-sm-6'>\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t<label for='type'>Type:&nbsp; </label> \t\t\t\t\t\t\t\t<select id='social-modal-type'  class='form-control'> \t\t\t\t\t\t\t\t\t<option value='blank' "+("blank"==this.field("type")?"selected='true'":"")+">Blank</option>\t\t\t\t\t\t\t\t\t<option value='tweet' "+("tweet"==this.field("type")?"selected='true'":"")+">Tweet</option>\t\t\t\t\t\t\t\t\t<option value='retweet' "+("retweet"==this.field("type")?"selected='true'":"")+">Retweet</option>\t\t\t\t\t\t\t\t\t\x3c!-- <option value='fbpost' "+("fbpost"==this.field("type")?"selected='true'":"")+">Facebook Post</option>\t\t\t\t\t\t\t\t\t<option value='fbshare' "+("fbshare"==this.field("type")?"selected='true'":"")+">Facebook Share</option>--\x3e\t\t\t\t\t\t\t\t</select>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class='col-sm-6'>\t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t<label for='account'>Account:&nbsp; </label> \t\t\t\t\t\t\t\t<select id='social-modal-account'  class='form-control'>",html+="\t\t\t\t</select>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>",html+="\t<div class='form-group'> \t\t\t\t\t\t<label for='timepicker'>Date &amp; Time:</label>\t\t\t\t\t\t<div class='input-group date' id='social-modal-timepicker'>\t\t\t\t\t\t\t<input id='social-modal-edit-timestamp' type='text' class='form-control' value=''/>\t\t\t\t\t\t\t<span class='input-group-addon'>\t\t\t\t\t\t\t\t<span class='glyphicon glyphicon-calendar'></span>\t\t\t\t\t\t\t</span>\t\t\t\t\t\t</div>\t\t\t\t\t</div>",html+="\t<div class='social-modal-blank' style='display:none;'>",html+="\t\t<p>Please select a type...</p>",html+="\t</div>",html+="\t<div class='social-modal-tweet' style='display:none;'>",html+="\t\t<div class='form-group'>\t\t\t\t\t\t\t\t<label for='message'>Message: (<span id='social-modal-tweet-charsleft'>140</span> characters remaining)&nbsp; </label> \t\t\t\t\t\t\t\t<textarea id='social-modal-tweet-message' data-socialitem-id='"+this.id+"' class='form-control' style='height:100px;'>"+(this.field("typedata").message?this.field("typedata").message:"")+"</textarea>\t\t\t\t\t\t\t</div>",html+="\t\t<div class='form-group'>\t\t\t\t\t\t\t\t<label for='attachments'>Attachments:&nbsp; </label>\t\t\t\t\t\t\t\t<select id='social-modal-tweet-attachments' multiple='multiple'>";for(var attachments=this.field("typedata").attachments,i=0;i<impresslist.socialUploads.length;++i){var up=impresslist.socialUploads[i],hasAttachment=!1;if(attachments)for(var j=0;j<attachments.length;j++)up.field("name")==attachments[j].file&&(hasAttachment=!0);var selectedText=hasAttachment?"selected='true'":"";html+="<option value='"+up.field("name")+"' "+selectedText+">"+up.field("name")+"</option>"}html+="\t\t\t</select>\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t<div class='social-modal-tweet-attachment-preview-container' style='margin-bottom:15px;'></div>\t\t\t\t\t\t</div>",html+="\t<div class='social-modal-retweet' style='display:none;'> \t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t<label for='account'>Tweet:&nbsp; </label> \t\t\t\t\t\t\t\t<select id='social-modal-retweet-select'  class='form-control'>";for(i=0;i<impresslist.socialTimelineItems.length;i++){"tweet"==(it=impresslist.socialTimelineItems[i]).field("type")&&(html+="<option value='"+it.field("id")+"' "+(this.field("typedata").tweet==it.id?"selected='true'":"")+" >@"+impresslist.findOAuthTwitterAccountById(parseInt(it.field("typedata").account)).field("twitter_handle")+" "+it.field("typedata").message+"</option>")}html+="\t\t\t</select>\t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div>",html+="\t<div class='social-modal-fbpost' style='display:none;'>",html+="\t\t<div class='form-group'>\t\t\t\t\t\t\t\t<label for='message'>Message: </label> \t\t\t\t\t\t\t\t<textarea id='social-modal-fbpost-message' data-socialitem-id='"+this.id+"' class='form-control' style='height:100px;'>"+(this.field("typedata").message?this.field("typedata").message:"")+"</textarea>\t\t\t\t\t\t\t</div>",html+="\t\t<div class='form-group'>\t\t\t\t\t\t\t\t<label for='attachments'>Attachments:&nbsp; </label>\t\t\t\t\t\t\t\t<select id='social-modal-fbpost-attachments' multiple='multiple'>";for(attachments=this.field("typedata").attachments,i=0;i<impresslist.socialUploads.length;++i){up=impresslist.socialUploads[i],hasAttachment=!1;if(attachments)for(j=0;j<attachments.length;j++)up.field("name")==attachments[j].file&&(hasAttachment=!0);selectedText=hasAttachment?"selected='true'":"";html+="<option value='"+up.field("name")+"' "+selectedText+">"+up.field("name")+"</option>"}html+="\t\t\t</select>\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t<div class='social-modal-fbpost-attachment-preview-container' style='margin-bottom:15px;'></div>\t\t\t\t\t\t</div>",html+="\t<div class='social-modal-fbshare' style='display:none;'> \t\t\t\t\t\t\t<div class='form-group'>\t\t\t\t\t\t\t\t<label for='account'>Post:&nbsp; </label> \t\t\t\t\t\t\t\t<select id='social-modal-fbshare-select'  class='form-control'>";for(i=0;i<impresslist.socialTimelineItems.length;i++){var it;"fbpost"==(it=impresslist.socialTimelineItems[i]).field("type")&&(html+="<option value='"+it.field("id")+"' "+(this.field("typedata").tweet==it.id?"selected='true'":"")+" >"+impresslist.findOAuthFacebookPageById(parseInt(it.field("typedata").account)).field("page_name")+" "+it.field("typedata").message+"</option>")}html+="\t\t\t</select>\t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div>",html+="\t<div class='form-group'> \t\t\t\t\t\t<label class='checkbox-inline'><input id='social-modal-edit-ready' type='checkbox' "+(1==this.field("ready")?"checked":"")+"><b>Ready to send?</b></label>\t\t\t\t\t</div>",html+="\t\t<div class='oa'> \t\t\t\t\t\t\t<div class='fl'> \t\t\t\t\t\t\t\t<button id='save_socialitemId"+this.id+"' type='submit' class='btn btn-primary' style='margin-right:5px;'>Save</button> \t\t\t\t\t\t\t\t<button id='close_socialitemId"+this.id+"' type='submit' class='btn btn-default'>Close</button> \t\t\t\t \t\t\t\t</div>\t\t\t\t\t\t\t<div class='fr'> \t\t\t\t\t\t\t\t<button id='delete_socialitemId"+this.id+"' type='submit' class='btn btn-danger'>Remove</button> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div>",html+="\t\t\t\t</div> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div> \t\t\t\t\t</div>",$("#modals").html(html);var utime=this.field("timestamp");0==utime&&(utime=Date.now()/1e3),$("#social-modal-timepicker").datetimepicker(),$("#social-modal-timepicker").data("DateTimePicker").defaultDate(moment(utime,"X")),$("#social-modal-timepicker").data("DateTimePicker").format("MMMM Do YYYY HH:mm zz");function onAttachmentsChanged(type){$("#social-modal-"+type+"-attachments option:selected");for(var selectedOptionValues=$("#social-modal-"+type+"-attachments option:selected").map(function(a,item){return item.value}),html="",i=0;i<selectedOptionValues.length;i++)html+="<img src='images/uploads/"+selectedOptionValues[i]+"' style='width:100px;height:100px;margin-right:5px;'/>";$(".social-modal-"+type+"-attachment-preview-container").html(html),th.testAttachments=selectedOptionValues.length,th.updateTwitterCharactersLeft()}var th=this;$("#social-modal-tweet-attachments").multiselect({enableFiltering:!0,enableCaseInsensitiveFiltering:!0,onSelectAll:function(){onAttachmentsChanged("tweet")},onChange:function(){onAttachmentsChanged("tweet")}}),$("#social-modal-fbpost-attachments").multiselect({enableFiltering:!0,enableCaseInsensitiveFiltering:!0,onSelectAll:function(){onAttachmentsChanged("fbpost")},onChange:function(){onAttachmentsChanged("fbpost")}});function onTypeChanged(ty){if($(".social-modal-blank").hide(),$(".social-modal-tweet").hide(),$(".social-modal-retweet").hide(),$(".social-modal-fbpost").hide(),$(".social-modal-fbshare").hide(),"tweet"==ty?(onAttachmentsChanged(ty),$(".social-modal-tweet").show()):"retweet"==ty?$(".social-modal-retweet").show():"fbpost"==ty?(onAttachmentsChanged(ty),$(".social-modal-fbpost").show()):"fbshare"==ty&&$(".social-modal-fbshare").show(),$("#social-modal-account").html(""),"tweet"==ty||"retweet"==ty){for(var html="<option value='---'> --- Twitter Accounts ---</option>",i=0;i<impresslist.oauthTwitterAccounts.length;i++){var tw=impresslist.oauthTwitterAccounts[i];html+="<option value='"+tw.field("id")+"' "+(th.field("typedata").account==tw.id?"selected='true'":"")+" >@"+tw.field("twitter_handle")+"</option>"}$("#social-modal-account").html(html)}if("fbpost"==ty||"fbshare"==ty){for(html="<option value='---'> --- Facebook Pages ---</option>",i=0;i<impresslist.oauthFacebookPages.length;i++){var fbp=impresslist.oauthFacebookPages[i];html+="<option value='"+fbp.field("id")+"' "+(th.field("typedata").account==fbp.id?"selected='true'":"")+" >"+fbp.field("page_name")+" (Page)</option>"}$("#social-modal-account").html(html)}}onTypeChanged(this.field("type")),th.updateTwitterCharactersLeft(),$("#social-modal-tweet-message").on("change keyup paste",function(){th.updateTwitterCharactersLeft()}),$("#social-modal-type").change(function(){var vl=$(this).val();onTypeChanged(vl)}),$("#save_socialitemId"+this.id).click(function(){th.save()}),$("#close_socialitemId"+this.id).click(function(){th.close()}),$("#delete_socialitemId"+this.id).click(function(){API.removeSocialTimelineItem(th)}),this.setFormEnabled(!0),1==this.field("sent")&&(this.setFormEnabled(!1),$("#save_socialitemId"+this.id).hide(),$("#delete_socialitemId"+this.id).hide())},SocialTimelineItem.prototype.updateRow=function(){var acc,html="",thedate=moment(this.field("timestamp"),"X").format("MMMM Do YYYY HH:mm zz"),reldate=impresslist.util.relativetime(this.field("timestamp"));if("tweet"==this.field("type")){if(acc=impresslist.findOAuthTwitterAccountById(parseInt(this.field("typedata").account)),html+="\t<div class='socialqueue-item "+(1==this.field("ready")?"ready":"")+"'> \t\t\t\t\t\t\t<div class='oa'> \t\t\t\t\t\t\t\t<p class='fl'><b>Tweet: <a href='http://twitter.com/"+acc.field("twitter_handle")+"'>@"+acc.field("twitter_handle")+"</a></b></p>",html+="\t\t\t<p class='fr text-muted' style='margin-left:10px;'> <a data-socialitem-id='"+this.id+"' data-toggle='modal' data-target='.social_modal'    style='cursor:pointer' title='Edit'><i class='glyphicon glyphicon-pencil'></i></a></p>",1==this.field("ready")&&(html+="\t\t<p class='fr text-muted' style='margin-left:10px;'> <a class='social-timeline-opensharedialog' data-socialitem-id='"+this.id+"' data-toggle='modal' data-target='.socialShare_modal' style='cursor:pointer' title='Add Shares'><i class='glyphicon glyphicon-plus'></i></a></p>"),html+="\t\t\t<p class='fr text-muted'><i class='glyphicon glyphicon-time'></i> <span data-social-id='"+this.id+"' data-toggle='tooltip' data-placement='left' title='"+reldate+"'>"+thedate+"</span></p> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t<div> \t\t\t\t\t\t\t\t<img class='icon' src='"+acc.field("twitter_image")+"' /> \t\t\t\t\t\t\t\t<p style='min-height:40px;margin-bottom:0px;'>"+this.field("typedata").message+"</p>",0<(attachments=this.field("typedata").attachments).length){html+="<p class='text-muted attachments'>Attachment/s: "+attachments.length+" <i class='glyphicon glyphicon-picture'></i></p>";for(var i=0;i<attachments.length;i++)html+="<p class='socialqueue-imageattachment-container' data-social-id='"+this.id+"'  data-attachment-id='"+i+"'><img class='socialqueue-imageattachment' data-social-id='"+this.id+"' data-attachment-id='"+i+"' src='images/uploads/"+attachments[i].file+"'/></p>"}html+="\t\t</div> \t\t\t\t\t\t</div>"}else if("retweet"==this.field("type"))acc=impresslist.findOAuthTwitterAccountById(parseInt(this.field("typedata").account)),html+="\t<div class='socialqueue-item indented thinnest "+(1==this.field("ready")?"ready":"")+"'> \t\t\t\t\t\t\t<div class='oa'> \t\t\t\t\t\t\t\t<img class='icon' src='"+acc.field("twitter_image")+"'/> \t\t\t\t\t\t\t\t<p class='fl'><b>Retweet by <a href='http://twitter.com/"+acc.field("twitter_handle")+"'>@"+acc.field("twitter_handle")+"</a></b></p> \t\t\t\t\t\t\t\t<p class='fr text-muted' style='margin-left:10px;'> <a data-socialitem-id='"+this.id+"' data-toggle='modal' data-target='.social_modal' style='cursor:pointer'><i class='glyphicon glyphicon-pencil'></i></a></p> \t\t\t\t\t\t\t\t<p class='fr text-muted'><i class='glyphicon glyphicon-time'></i> <span data-social-id='"+this.id+"' data-toggle='tooltip' data-placement='left' title='"+reldate+"'>"+thedate+"</span> </p> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div>";else if("fbpost"==this.field("type")){var attachments;if(acc=impresslist.findOAuthFacebookPageById(parseInt(this.field("typedata").account)),html+="\t<div class='socialqueue-item "+(1==this.field("ready")?"ready":"")+"'> \t\t\t\t\t\t\t<div class='oa'> \t\t\t\t\t\t\t\t<p class='fl'><b>Facebook: <a href='http://facebook.com/"+acc.field("page_id")+"'>"+acc.field("page_name")+"</a></b></p>",html+="\t\t\t<p class='fr text-muted' style='margin-left:10px;'> <a data-socialitem-id='"+this.id+"' data-toggle='modal' data-target='.social_modal'    style='cursor:pointer' title='Edit'><i class='glyphicon glyphicon-pencil'></i></a></p>",1==this.field("ready")&&(html+="\t\t<p class='fr text-muted' style='margin-left:10px;'> <a class='social-timeline-opensharedialog' data-socialitem-id='"+this.id+"' data-toggle='modal' data-target='.socialShare_modal' style='cursor:pointer' title='Add Shares'><i class='glyphicon glyphicon-plus'></i></a></p>"),html+="\t\t\t<p class='fr text-muted'><i class='glyphicon glyphicon-time'></i> <span data-social-id='"+this.id+"' data-toggle='tooltip' data-placement='left' title='"+reldate+"'>"+thedate+"</span></p> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t<div> \t\t\t\t\t\t\t\t<img class='icon' src='"+acc.field("page_image")+"' /> \t\t\t\t\t\t\t\t<p style='min-height:40px;margin-bottom:0px;'>"+this.field("typedata").message+"</p>",0<(attachments=this.field("typedata").attachments).length){html+="<p class='text-muted attachments'>Attachment/s: "+attachments.length+" <i class='glyphicon glyphicon-picture'></i></p>";for(i=0;i<attachments.length;i++)html+="<p class='socialqueue-imageattachment-container' data-social-id='"+this.id+"'  data-attachment-id='"+i+"'><img class='socialqueue-imageattachment' data-social-id='"+this.id+"' data-attachment-id='"+i+"' src='images/uploads/"+attachments[i].file+"'/></p>"}html+="\t\t</div> \t\t\t\t\t\t</div>"}else"fbshare"==this.field("type")?(acc=impresslist.findOAuthFacebookPageById(parseInt(this.field("typedata").account)),html+="\t<div class='socialqueue-item indented thinnest "+(1==this.field("ready")?"ready":"")+"'> \t\t\t\t\t\t\t<div class='oa'> \t\t\t\t\t\t\t\t<img class='icon' src='"+acc.field("page_image")+"'/> \t\t\t\t\t\t\t\t<p class='fl'><b>Facebook Share by <a href='http://facebook.com/"+acc.field("page_id")+"'>"+acc.field("page_name")+"</a></b></p> \t\t\t\t\t\t\t\t<p class='fr text-muted' style='margin-left:10px;'> <a data-socialitem-id='"+this.id+"' data-toggle='modal' data-target='.social_modal' style='cursor:pointer'><i class='glyphicon glyphicon-pencil'></i></a></p> \t\t\t\t\t\t\t\t<p class='fr text-muted'><i class='glyphicon glyphicon-time'></i> <span data-social-id='"+this.id+"' data-toggle='tooltip' data-placement='left' title='"+reldate+"'>"+thedate+"</span> </p> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div>"):"blank"==this.field("type")&&(html+="\t<div class='socialqueue-item thinnest "+(1==this.field("ready")?"ready":"")+"'> \t\t\t\t\t\t\t<div class='oa'> \t\t\t\t\t\t\t\t<p class='fl'><b>Blank </b></p> \t\t\t\t\t\t\t\t<p class='fr text-muted' style='margin-left:10px;'> <a data-socialitem-id='"+this.id+"' data-toggle='modal' data-target='.social_modal' style='cursor:pointer'><i class='glyphicon glyphicon-pencil'></i></a></p> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div>");$(".socialqueue-item-container[data-social-id="+this.id+"]").html(html),$(".socialqueue-item-container[data-social-id="+this.id+"]").attr("data-timestamp",this.field("timestamp"))},SocialTimelineItem.prototype.update=function(){var th=this;$(".socialqueue-imageattachment").click(function(){var attid=$(this).attr("data-attachment-id");console.log(attid);var containerSelector=".socialqueue-imageattachment-container[data-social-id="+th.id+"][data-attachment-id="+attid+"]",imageSelector=".socialqueue-imageattachment[data-social-id="+th.id+"][data-attachment-id="+attid+"]";"100px"==$(containerSelector).css("height")?($(containerSelector).css("height","100%"),$(imageSelector).css("margin-top","0px")):($(containerSelector).css("height","100px"),$(imageSelector).css("margin-top","-25%"))}),$("[data-social-id="+this.id+'][data-toggle="tooltip"]').tooltip(),$(this.openSelector()).click(function(){th.open()}),$(this.openShareSelector()).click(function(){th.openShareDialog()})},SocialTimelineItem.prototype.openSelector=function(){return"#social-timeline a[data-socialitem-id='"+this.id+"']"},SocialTimelineItem.prototype.openShareSelector=function(){return".social-timeline-opensharedialog[data-socialitem-id='"+this.id+"']"},SocialTimelineItem.prototype.close=function(){$(".social_modal").modal("hide")},SocialTimelineItem.prototype.save=function(){var type=$("#social-modal-type").val();console.log("type: "+type);var date=new Date($("#social-modal-timepicker").data("DateTimePicker").date()),timestamp=Math.floor(date.getTime()/1e3),ready=$("#social-modal-edit-ready").is(":checked");if("tweet"==type){for(var account=$("#social-modal-account").val(),typedata={message:$("#social-modal-tweet-message").val(),account:account,attachments:[]},selectedOptionValues=$("#social-modal-tweet-attachments option:selected").map(function(a,item){return item.value}),i=0;i<selectedOptionValues.length;i++)typedata.attachments.push({type:"image",file:selectedOptionValues[i]});API.saveSocialTimelineItem(this,type,typedata,timestamp,ready)}else if("retweet"==type){account=$("#social-modal-account").val(),typedata={tweet:$("#social-modal-retweet-select").val(),account:account};API.saveSocialTimelineItem(this,type,typedata,timestamp,ready)}else if("fbpost"==type){for(account=$("#social-modal-account").val(),typedata={message:$("#social-modal-fbpost-message").val(),account:account,attachments:[]},selectedOptionValues=$("#social-modal-fbpost-attachments option:selected").map(function(a,item){return item.value}),i=0;i<selectedOptionValues.length;i++)typedata.attachments.push({type:"image",file:selectedOptionValues[i]});API.saveSocialTimelineItem(this,type,typedata,timestamp,ready)}else if("fbshare"==type){account=$("#social-modal-account").val(),typedata={post:$("#social-modal-fbshare-select").val(),account:account};API.saveSocialTimelineItem(this,type,typedata,timestamp,ready)}else if("blank"==type){typedata={};API.saveSocialTimelineItem(this,type,typedata,timestamp,ready)}},SocialTimelineItem.prototype.updateTwitterCharactersLeft=function(){var msg=$("#social-modal-tweet-message").val(),remaining=140;remaining-=twttr.txt.getTweetLength(msg,{short_url_length:impresslist.config.system.twitter.short_url_length,short_url_length_https:impresslist.config.system.twitter.short_url_length_https}),remaining-=Math.min(1,this.testAttachments)*impresslist.config.system.twitter.characters_reserved_per_media,$("#social-modal-tweet-charsleft").html(remaining)};var impresslist={config:{system:{email:"",backups:{lastmanual:0}},user:{id:0,game:0,audience:0,gmail:0,admin:!(SocialTimelineItem.prototype.setFormEnabled=function(boo){boo=!boo,$("#social-modal-type").attr("disabled",boo),$("#social-modal-account").attr("disabled",boo),$("#social-modal-edit-timestamp").attr("disabled",boo),$("#social-modal-tweet-message").attr("disabled",boo),$("#social-modal-tweet-attachments").attr("disabled",boo),$("#social-modal-retweet-select").attr("disabled",boo),$("#social-modal-edit-ready").attr("disabled",boo),$("#save_socialitemId"+this.id).attr("disabled",boo),$("#delete_socialitemId"+this.id).attr("disabled",boo)}),superadmin:!1,imapServer:"",smtpServer:""},tags:{},misc:{countries:[]}},people:[],publications:[],personPublications:[],personYoutubeChannels:[],personTwitchChannels:[],youtubers:[],twitchchannels:[],podcasts:[],emails:[],users:[],companies:[],games:[],audiences:[],coverage:[],watchedgames:[],simpleMailouts:[],oauthTwitterAccounts:[],oauthFacebookAccounts:[],oauthFacebookPages:[],socialUploads:[],socialTimelineItems:[],loading:{people:!1,publications:!1,personPublications:!1,personYoutubeChannels:!1,personTwitchChannels:!1,youtubeChannels:!1,twitchChannels:!1,emails:!1,users:!1,companies:!1,games:!1,coverage:!1,socialUploads:!1,socialTimelineItems:!1,set:function(type,b){impresslist.loading[type]=b,$("#"+type+"-loading-"+b).show(),$("#"+type+"-loading-"+!b).hide()},isLoading:function(t){return impresslist.loading[t]},category:{home:0,home_loaded:!1,social:0,social_loaded:!1,mailout:0,mailout_loaded:!1,project:0,project_loaded:!1},onPageChanged:function(page){console.log("Page changed to:",page),"home"!=page||this.category.home_loaded?"social"!=page||this.category.social_loaded?"mailout"!=page||this.category.mailout_loaded?"project"!=page||this.category.project_loaded||this.load_project():this.load_mailout():this.load_social():this.load_home()},onCategoryItemLoaded:function(category){impresslist.loading.category[category]-=1,0==impresslist.loading.category[category]&&(impresslist.loading.category[category+"_loaded"]=!0,this.onCategoryFullyLoaded(category),impresslist.refreshTotals())},onCategoryFullyLoaded:function(category){"project"==category&&(0==impresslist.coverage.length?$("#coverage-footer").show():$("#coverage-footer").hide(),0==impresslist.watchedgames.length?$("#watchedgames-footer").show():$("#watchedgames-footer").hide())},load_home:function(){impresslist.loading.category.home_loaded||0<impresslist.loading.category.home||(console.log("Loading Home..."),impresslist.loading.category.home+=8,API.listPeople(),API.listPublications(),API.listPersonPublications(),API.listPersonYoutubeChannels(),API.listPersonTwitchChannels(),API.listYoutubeChannels(),API.listTwitchChannels(),API.listEmails())},load_social:function(){impresslist.loading.category.social_loaded||0<impresslist.loading.category.social||(console.log("Loading Social..."),impresslist.loading.category.social+=5,API.listOAuthTwitterAccounts(),API.listOAuthFacebookAccounts(),API.listOAuthFacebookPages(),setTimeout(function(){impresslist.loading.load_social_timeline()},1e3))},load_social_timeline:function(){API.listSocialTimeline(),API.listSocialUploads()},load_mailout:function(){impresslist.loading.category.mailout_loaded||0<impresslist.loading.category.mailout||(console.log("Loading Mailouts"),impresslist.loading.category.mailout+=1,API.listSimpleMailouts())},load_project:function(){impresslist.loading.category.project_loaded||0<impresslist.loading.category.project||(console.log("Loading Project"),impresslist.loading.category.project+=2,API.listCoverage(!0,function(data){$("#coverage-stats-table").html(impresslist.util.templates.StatsTable(data.stats))}),API.listWatchedGames())}},route:function(){var path=window.location.pathname;"/"==path?impresslist.changePageTo("home"):"/mailout/"==path?impresslist.changePageTo("mailout"):"/project/"==path?impresslist.changePageTo("project"):"/social/"==path&&impresslist.changePageTo("social")},init:function(){this.route();var thiz=this;$("#nav-add-person").click(API.addPerson),$("#nav-add-publication").click(API.addPublication),$("#nav-add-youtuber").click(API.addYoutuber),$("#nav-add-twitchchannel").click(API.addTwitchChannel),$("#nav-add-podcast").click(API.addPodcast),$("#nav-add-youtuber-search-batch").click(function(){YouTuberBatchModal.open()}),$("#nav-add-coverage-publication").click(API.addPublicationCoverage),$("#nav-add-coverage-youtuber").click(API.addYoutuberCoverage),$("#nav-add-simplemailout").click(API.addSimpleMailout),$("#nav-add-user").click(API.addUser),$("#nav-user-changeproject").click(function(){thiz.findUserById(thiz.config.user.id).openChangeProject()}),$("#nav-user-changeaudience").click(function(){thiz.findUserById(thiz.config.user.id).openChangeAudience()}),$("#nav-user-changepassword").click(function(){thiz.findUserById(thiz.config.user.id).openChangePassword()}),$("#nav-user-changeimapsettings").click(function(){thiz.findUserById(thiz.config.user.id).openChangeIMAPSettings()}),$(".nav-user-changeimapsettings").click(function(){$("#nav-user-changeimapsettings").click()}),$("#nav-home").click(this.changePage),$("#nav-social").click(this.changePage),$("#nav-mailout").click(this.changePage),$("#nav-mailout-addrecipients").click(this.changePage),$("#nav-mailout-tips").click(this.changePage),$("#nav-project").click(this.changePage),$("#nav-admin").click(this.changePage),$("#nav-importtool").click(this.changePage),$("#nav-help").click(this.changePage),$("#nav-feedback").attr("href",impresslist.util.mailtoClient("ashley@forceofhab.it","impresslist feedback","")),$("#sql-query-submit").click(function(){API.sqlQuery($("#sql-query-text").val())}),$("#nav-add-project").click(function(){API.request("/project/add/",{name:$("#nav-add-project-name").val(),iconurl:$("#nav-add-project-iconurl").val()},function(data){var game=new Game(data.project);impresslist.addGame(game,!1)},function(){API.errorMessage("Could not add Project.")})}),$("#current-user-name").html(this.findUserById(this.config.user.id).fullname()),$("#current-project-name").html(this.findGameById(this.config.user.game).field("name")),$("[data-last-backup='true']").html(new Date(1e3*this.config.system.backups.lastmanual).toUTCString());var fullsearchKeyUpTimeout=null;$("#full-search").keyup(function(key){0<=impresslist.util.cancellableKeys.indexOf(key.keyCode)||(null!=fullsearchKeyUpTimeout&&(clearTimeout(fullsearchKeyUpTimeout),fullsearchKeyUpTimeout=null),fullsearchKeyUpTimeout=setTimeout(function(){if(null!=fullsearchKeyUpTimeout){var q=$("#full-search").val();0<q.length?($("#full-search-results-container").show(),$("#full-search-results-loading").show(),$("#full-search-results").hide(),$("#full-search-results-error").hide(),API.search(q,function(results){$("#full-search-results-loading").hide();var html="";if(html+="<h4 style='margin-top:0px;font-weight:bold;'>People:</h4>",0<results.people.length){html+="<table class='table'>";for(var i=0;i<results.people.length;i++){html+='\t<tr onclick="impresslist.findPersonById('+(p=results.people[i]).id+").open();\" data-person-id='"+p.id+"' data-person-tablerow='true' data-toggle='modal' data-target='.person_modal' style='cursor:pointer;'>\t\t\t\t\t\t\t\t\t\t\t\t\t<td data-value='"+p.forename+" "+p.surnames+"'><span data-person-id='"+p.id+"' data-field='name'>"+p.firstname+" "+p.surnames+"</span></td> \t\t\t\t\t\t\t\t\t\t\t\t\t<td data-person-id='"+p.id+"'><a href='http://twitter.com/"+p.twitter+"' target='new'>"+p.twitter+"</a></td> \t\t\t\t\t\t\t\t\t\t\t\t\t<td data-person-id='"+p.id+"'data-value='"+p.tags+"'>"+impresslist.util.buildTags(p.tags)+"</td> \t\t\t\t\t\t\t\t\t\t\t\t</tr>"}html+="</table>"}else html+="<p style='margin-bottom:20px;font-weight:bold;'>None</h3>";if(html+="<h4 style='margin-top:0px;font-weight:bold;'>Publications:</h4>",0<results.publications.length){html+="<table class='table'>";for(i=0;i<results.publications.length;i++){html+='\t<tr onclick="impresslist.findPublicationById('+(p=results.publications[i]).id+").open();\" data-publication-id='"+p.id+"' data-publication-tablerow='true' data-toggle='modal' data-target='.publication_modal' style='cursor:pointer;'>\t\t\t\t\t\t\t\t\t\t\t\t\t<td data-value='"+p.name+"'><span data-publication-id='"+p.id+"' data-field='name'>"+p.name+"</span></td> \t\t\t\t\t\t\t\t\t\t\t\t\t<td data-publication-id='"+p.id+"'><a href='http://twitter.com/"+p.twitter+"' target='new'>"+p.twitter+"</a></td> \t\t\t\t\t\t\t\t\t\t\t\t\t<td data-publication-id='"+p.id+"'data-value='"+p.tags+"'>"+impresslist.util.buildTags(p.tags)+"</td> \t\t\t\t\t\t\t\t\t\t\t\t</tr>"}html+="</table>"}else html+="<p style='margin-bottom:20px;font-weight:bold;'>None</h3>";if(html+="<h4 style='margin-top:0px;font-weight:bold;'>YouTubers:</h4>",0<results.youtubers.length){html+="<table class='table'>";for(i=0;i<results.youtubers.length;i++){html+='\t<tr onclick="impresslist.findYoutuberById('+(p=results.youtubers[i]).id+").open();\" data-youtuber-id='"+p.id+"' data-youtuber-tablerow='true' data-toggle='modal' data-target='.youtuber_modal' style='cursor:pointer;'>\t\t\t\t\t\t\t\t\t\t\t\t\t<td data-value='"+p.name+"'><span data-youtuber-id='"+p.id+"' data-field='name'>"+p.name+"</span></td> \t\t\t\t\t\t\t\t\t\t\t\t\t<td data-youtuber-id='"+p.id+"'><a href='http://twitter.com/"+p.twitter+"' target='new'>"+p.twitter+"</a></td> \t\t\t\t\t\t\t\t\t\t\t\t\t<td data-youtuber-id='"+p.id+"'data-value='"+p.tags+"'>"+impresslist.util.buildTags(p.tags)+"</td> \t\t\t\t\t\t\t\t\t\t\t\t</tr>"}html+="</table>"}else html+="<p style='margin-bottom:20px;font-weight:bold;'>None</h3>";if(html+="<h4 style='margin-top:0px;font-weight:bold;'>Twitch Channels:</h4>",0<results.twitchchannels.length){html+="<table class='table'>";for(i=0;i<results.twitchchannels.length;i++){var p;html+='\t<tr onclick="impresslist.findTwitchChannelById('+(p=results.twitchchannels[i]).id+").open();\" data-twitchchannel-id='"+p.id+"' data-twitchchannel-tablerow='true' data-toggle='modal' data-target='.twitchchannel_modal' style='cursor:pointer;'>\t\t\t\t\t\t\t\t\t\t\t\t\t<td data-value='"+p.name+"'><span data-twitchchannel-id='"+p.id+"' data-field='name'>"+p.name+"</span></td> \t\t\t\t\t\t\t\t\t\t\t\t\t<td data-twitchchannel-id='"+p.id+"'><a href='http://twitter.com/"+p.twitter+"' target='new'>"+p.twitter+"</a></td> \t\t\t\t\t\t\t\t\t\t\t\t\t<td data-twitchchannel-id='"+p.id+"'data-value='"+p.tags+"'>"+impresslist.util.buildTags(p.tags)+"</td> \t\t\t\t\t\t\t\t\t\t\t\t</tr>"}html+="</table>"}else html+="<p style='margin-bottom:0px;margin-bottom:0px;font-weight:bold;'>None</h3>";$("#full-search-results").html(html),$("#full-search-results").show()},function(){$("#full-search-results-loading").hide(),$("#full-search-results").show(),$("#full-search-results-error").html("There was an error in the request?"),$("#full-search-results-error").show()})):($("#full-search-results-container").hide(),$("#full-search-results-error").hide(),$("#full-search-results").hide())}fullsearchKeyUpTimeout=null},300))});var searchKeyUpTimeout=null;$("#filter-search").keyup(function(key){0<=impresslist.util.cancellableKeys.indexOf(key.keyCode)||(null!=searchKeyUpTimeout&&(clearTimeout(searchKeyUpTimeout),searchKeyUpTimeout=null),searchKeyUpTimeout=setTimeout(function(){null!=searchKeyUpTimeout&&impresslist.refreshFilter(),searchKeyUpTimeout=null},300))}),$("#filter-recent-contact").change(this.refreshFilter),$("#filter-personal-contact").change(this.refreshFilter),$("#filter-high-priority").change(this.refreshFilter),$("#filter-email-attached").change(this.refreshFilter),$("#filter-assigned-self").change(this.refreshFilter),$("#filter-show-outofdate").change(this.refreshFilter),$(".filter-tag").change(this.refreshTagFilter),$("#importtool-fieldselect").change(function(){var val=$(this).val();if("---"!=val){var html="<div class='tag' data-tag='"+val+"'>"+val+" &nbsp; <a href='javascript:;' data-remove-tag='"+val+"'>x</a></div>";$("#importtool-order").append(html),$("#importtool-fieldselect").val("---"),$('a[data-remove-tag="'+val+'"]').click(function(){$('.tag[data-tag="'+val+'"]').remove()})}}),$("#importtool-submit").click(function(){function importtool_disableForm(boo){$("#importtool-type-csv").attr("disabled",boo),$("#importtool-type-tsv").attr("disabled",boo),$("#importtool-maintext").attr("disabled",boo),$("#importtool-fieldselect").attr("disabled",boo),$("#importtool-submit").attr("disabled",boo),$(".bootstrap-tagsinput").attr("disabled",boo)}importtool_disableForm(!0);var importString=$("#importtool-maintext").val(),importType=$('input[name="importtool-type"]:checked').val();if(null==importType)return importtool_disableForm(!1),void API.errorMessage("Invalid import type. Please select CSV or TSV.");console.log(importType);for(var importOrder=[],importTags=$("#importtool-order .tag"),i=0;i<importTags.length;i++)importOrder.push($(importTags[i]).attr("data-tag"));console.log(importOrder);var formData=new FormData;formData.append("data",importString);var url="api.php?endpoint=/import/";url+="&audience="+encodeURIComponent(impresslist.config.user.audience),url+="&type="+encodeURIComponent(importType),url+="&order="+encodeURIComponent(importOrder.join()),$.ajax({url:url,type:"POST",data:formData,contentType:!1,cache:!1,processData:!1,success:function(result){if(importtool_disableForm(!1),"{"==result.substr(0,1)){var json=JSON.parse(result);json.success?alert(result):API.errorMessage(json.message)}else API.errorMessage(result)},error:function(e,e2,e3){API.errorMessage("Could not import list."),importtool_disableForm(!1)}})}),$("#mailout-content").keyup(function(){impresslist.findGameById(impresslist.config.user.game).name;var steam_keys_md="**Steam Keys:**\n\n";steam_keys_md+="* XXXXX-XXXXX-XXXXX *(Sent by Nick on 23rd March 2015)*\n",steam_keys_md+="* XXXXX-XXXXX-XXXXX *(Sent by Ashley on 3rd March 2015)*\n\n";var switch_keys_md="**Nintendo Switch Keys:**\n\n";switch_keys_md+="* XXXXX-XXXXX-XXXXX *(Sent by Nick on 23rd March 2015)*\n",switch_keys_md+="* XXXXX-XXXXX-XXXXX *(Sent by Ashley on 3rd March 2015)*\n\n";var md_content=$(this).val();md_content=(md_content=(md_content=(md_content=(md_content=md_content.replace("{{first_name}}","(First Name)")).replace("{{steam_key}}","XXXXX-XXXXX-XXXXX")).replace("{{steam_keys}}",steam_keys_md)).replace("{{switch_key}}","XXXXX-XXXXX-XXXXX")).replace("{{switch_keys}}",switch_keys_md);for(var i=0;i<impresslist.games.length;i++){steam_keys_md="**Steam Keys ("+impresslist.games[i].name+"):**\n\n";steam_keys_md+="* XXXXX-XXXXX-XXXXX *(Sent by Nick on 23rd March 2015)*\n",steam_keys_md+="* XXXXX-XXXXX-XXXXX *(Sent by Ashley on 3rd March 2015)*\n\n";switch_keys_md="**Nintendo Switch Keys ("+impresslist.games[i].name+"):**\n\n";switch_keys_md+="* XXXXX-XXXXX-XXXXX *(Sent by Nick on 23rd March 2015)*\n",switch_keys_md+="* XXXXX-XXXXX-XXXXX *(Sent by Ashley on 3rd March 2015)*\n\n",md_content=(md_content=md_content.replace("{{switch_keys:"+impresslist.games[i].field("nameuniq")+"}}",switch_keys_md)).replace("{{steam_keys:"+impresslist.games[i].field("nameuniq")+"}}",steam_keys_md)}var html_content=markdown.toHTML(md_content);$("#mailout-preview").html(html_content)});function selectAllCheckedForType(type,checked){$("input[data-"+type+'-checkbox="true"]').each(function(){if($(this).is(":visible")){var typeId=$(this).attr("data-"+type+"-id");null!=typeId&&(checked?$("input[data-"+type+'-checkbox="true"][data-'+type+'-id="'+typeId+'"]').prop("checked",!0):$("input[data-"+type+'-checkbox="true"][data-'+type+'-id="'+typeId+'"]').prop("checked",!1))}})}$(".nav-select-edit").click(function(){impresslist.toggleSelectMode()}),$(".nav-select-all").click(function(){var type=$(this).attr("data-type");selectAllCheckedForType(type,!0),impresslist.refreshMailoutRecipients()}),$(".nav-deselect-all").click(function(){var type=$(this).attr("data-type");selectAllCheckedForType(type,!1),impresslist.refreshMailoutRecipients()}),$("#nav-project").click(function(){$(".current-project-name").html(impresslist.findGameById(impresslist.config.user.game).field("name"))}),$("#nav-keys").click(function(){function addremovekeysform(datacount){$("#keys-remove-submit").unbind("click"),$("#keys-remove-platform").change(function(){var val=$("#keys-remove-platform").val();$("#keys-remove-subplatform-row").hide(),"steam"==val?$("#keys-remove-subplatform").val("---"):"switch"==val&&$("#keys-remove-subplatform-row").show()}),$("#keys-remove-submit").click(function(){var submitGame=impresslist.config.user.game,platform=$("#keys-remove-platform").val(),subplatform=$("#keys-remove-subplatform").val(),amount=$("#keys-remove-amount").val();"---"==subplatform&&(subplatform=""),API.popKeys(submitGame,platform,subplatform,amount,function(data){for(var html="",i=0;i<data.keys.length;i++)html+="<li>"+data.keys[i].keystring+"</li>";$("#keys-removed-list").html(html),$("#keys-removed-container").show(),$("#steam_keys_available_count").html(parseInt($("#"+platform+"_keys_available_count").html())-data.count)})}),$("#keys-remove-form").show()}API.listKeys(impresslist.config.user.game,"steam","",!0,function(data){$("#steam_keys_assigned_count").html(data.count)}),API.listKeys(impresslist.config.user.game,"steam","",!1,function(data){$("#steam_keys_available_count").html(data.count),0<data.count&&addremovekeysform()});for(var switchRegions=["us","eu","au","jp"],i=0;i<switchRegions.length;i++){!function(region){API.listKeys(impresslist.config.user.game,"switch",region,!0,function(data){$("#switch_"+region+"_keys_assigned_count").html(data.count)}),API.listKeys(impresslist.config.user.game,"switch",region,!1,function(data){$("#switch_"+region+"_keys_available_count").html(data.count),0<data.count&&addremovekeysform()})}(switchRegions[i])}$("#keys-timepicker").datetimepicker(),$("#keys-timepicker").data("DateTimePicker").defaultDate(moment(0,"X")),$("#keys-timepicker").data("DateTimePicker").format("DD/MM/YYYY h:mma"),$("#keys-radio-expiry-never").unbind("click"),$("#keys-radio-expiry-time").unbind("click"),$("#keys-radio-expiry-never").click(function(){$("#keys-timepicker").hide()}),$("#keys-radio-expiry-time").click(function(){$("#keys-timepicker").show()}),$("#keys-timepicker").hide(),$("#keys-radio-expiry-never").prop("checked","true")}),$("#keys-add-platform").change(function(){var val=$("#keys-add-platform").val();$("#keys-add-subplatform-row").hide(),"steam"==val?$("#keys-add-subplatform").val("---"):"switch"==val&&$("#keys-add-subplatform-row").show()}),$("#keys-add-submit").click(function(){function keys_setFormEnabled(boo){boo=!boo,$("#keys-add-platform").attr("disabled",boo),$("#keys-add-subplatform").attr("disabled",boo),$("#keys-add-textfield").attr("disabled",boo),$("#keys-radio-expiry-never").attr("disabled",boo),$("#keys-radio-expiry-time").attr("disabled",boo),$("#keys-timepicker").attr("disabled",boo),$("#keys-add-submit").attr("disabled",boo)}keys_setFormEnabled(!1);var submitList=$("#keys-add-textfield").val(),submitGame=impresslist.config.user.game,submitPlatform=$("#keys-add-platform").val();if("---"==submitPlatform)return API.errorMessage("Please select an platform for these keys."),void keys_setFormEnabled(!0);var submitSubplatform=$("#keys-add-subplatform").val();"---"==submitSubplatform&&(submitSubplatform="");var whichtime=$('input[name="keys-expiry-radio"]:checked').val();if(null==whichtime)return API.errorMessage("Please select an expiry for these keys."),void keys_setFormEnabled(!0);var expiresOn=0;if("time"==whichtime){var date=new Date($("#keys-timepicker").data("DateTimePicker").date());expiresOn=Math.floor(date.getTime()/1e3)}API.addKeys(submitList,submitGame,submitPlatform,submitSubplatform,expiresOn,function(d){keys_setFormEnabled(!0),$("#keys-add-platform").val("---"),$("#keys-add-subplatform").val("---"),$("#keys-add-textfield").val(""),$("#nav-keys").click()},function(){keys_setFormEnabled(!0)})}),$("#social-timeline-add").click(function(){API.addSocialTimelineItem()}),$("#social-addtwitteraccount-link").click(function(){$("#social-addtwitteraccount-buttonpage").hide(),$("#social-addtwitteraccount-verifypage").show()}),$("#social-addtwitteraccount-cancel").click(function(){$("#social-addtwitteraccount-verifypage").hide(),$("#social-addtwitteraccount-buttonpage").show()}),$("#social-addtwitteraccount-submit").click(function(){var token=$("#social-addtwitteraccount-requesttoken").val(),tokenSecret=$("#social-addtwitteraccount-requesttokensecret").val(),pin=$("#social-addtwitteraccount-pin").val();API.addOAuthTwitterAccount(token,tokenSecret,pin)}),$("#social-addfacebookpage").click(function(){$("#modals").append("<div class='modal fade addfacebookpage_modal' tabindex='-1' role='dialog'> \t\t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'> \t\t\t\t\t\t\t\t\t<div style='min-height:100px;padding:20px;'> \t\t\t\t\t\t\t\t\t\t<h3>Add Facebook Page</h3> \t\t\t\t\t\t\t\t\t\t<form id='social-addfacebookpage-form' role='form' class='oa' onsubmit='return false;'>\t\t\t\t\t\t\t\t\t\t\t<p>Loading...</p>\t\t\t\t\t</form> \t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>"),API.queryOAuthFacebookPages(function(data){for(var html="",i=0;i<data.length;i++)html+="<p id='social-officialfacebookpage-"+data[i].id+"'>",html+="\t<img src='"+data[i].image+"' /> <a href='http://facebook.com/"+data[i].id+"' target='new'>"+data[i].name+"</a>",html+="\t<button id='social-add-officialfacebookpage-"+data[i].id+"' class='btn btn-lg btn-primary fr' style='margin-top:2px;' \t\t\t\t\t\t\t\t\tdata-page-id='"+data[i].id+"' \t\t\t\t\t\t\t\t\tdata-page-name='"+data[i].name+"' \t\t\t\t\t\t\t\t\tdata-page-accessToken='"+data[i].access_token+"' \t\t\t\t\t\t\t\t\tdata-page-image='"+data[i].image+"' \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>Add</button>",html+="</p>";0==data.length&&(html+="<p>No pages...</p>"),$("#social-addfacebookpage-form").html(html);for(i=0;i<data.length;i++)$("#social-add-officialfacebookpage-"+data[i].id).click(function(){API.addOAuthFacebookPage($(this).attr("data-page-id"),$(this).attr("data-page-name"),$(this).attr("data-page-accessToken"),$(this).attr("data-page-image"),function(dt){$("#social-officialfacebookpage-"+dt.facebookpage.page_id).remove()})})})}),this.chat.init(),this.jobs.init()},selectModeIsOpen:!1,openSelectMode:function(){this.selectModeIsOpen||this.toggleSelectMode()},closeSelectMode:function(){this.selectModeIsOpen&&this.toggleSelectMode()},toggleSelectMode:function(){this.selectModeIsOpen=!this.selectModeIsOpen;for(var i=0;i<this.people.length;i++)this.people[i].refreshEmails();for(i=0;i<this.publications.length;i++)this.publications[i].refreshEmails();for(i=0;i<this.youtubers.length;i++)this.youtubers[i].refreshEmails();for(i=0;i<this.twitchchannels.length;i++)this.twitchchannels[i].refreshEmails();this.refreshMailoutRecipients();var type="person";$('.checkbox-column[data-type="'+type+'"]').each(function(){$(this).toggle()}),type="publication",$('.checkbox-column[data-type="'+type+'"]').each(function(){$(this).toggle()}),type="youtuber",$('.checkbox-column[data-type="'+type+'"]').each(function(){$(this).toggle()}),type="twitchchannel",$('.checkbox-column[data-type="'+type+'"]').each(function(){$(this).toggle()}),this.refreshFilter()},changePageTo:function(page){$("[data-type-page='true']").hide(),$("[data-type-page='true'][data-page='"+page+"']").show(),impresslist.loading.onPageChanged(page)},changePage:function(){var page=$(this).attr("data-nav-page");impresslist.changePageTo(page)},refreshFilter:function(){impresslist.applyFilter($("#filter-search").val().toLowerCase())},applyFilter:function(text){for(var countPeopleVisible=0,i=0;i<impresslist.people.length;i++)impresslist.people[i].filter(text)&&countPeopleVisible++;var countPublicationsVisible=0;for(i=0;i<impresslist.publications.length;i++)impresslist.publications[i].filter(text)&&countPublicationsVisible++;var countYoutubeChannelsVisible=0;for(i=0;i<impresslist.youtubers.length;i++)impresslist.youtubers[i].filter(text)&&countYoutubeChannelsVisible++;var countTwitchChannelsVisible=0;for(i=0;i<impresslist.twitchchannels.length;i++)impresslist.twitchchannels[i].filter(text)&&countTwitchChannelsVisible++;0==countPeopleVisible?$("#people-footer").show():$("#people-footer").hide(),0==countPublicationsVisible?$("#publications-footer").show():$("#publications-footer").hide(),0==countYoutubeChannelsVisible?$("#youtubers-footer").show():$("#youtubers-footer").hide(),0==countTwitchChannelsVisible?$("#twitchchannels-footer").show():$("#twitchchannels-footer").hide(),0<impresslist.people.length&&0==countPeopleVisible?$("#people-container").hide():$("#people-container").show(),0<impresslist.publications.length&&0==countPublicationsVisible?$("#publications-container").hide():$("#publications-container").show(),0<impresslist.youtubers.length&&0==countYoutubeChannelsVisible?$("#youtubers-container").hide():$("#youtubers-container").show(),0<impresslist.twitchchannels.length&&0==countTwitchChannelsVisible?$("#twitchchannels-container").hide():$("#twitchchannels-container").show(),$("#people-count").html("("+countPeopleVisible+")"),$("#publication-count").html("("+countPublicationsVisible+")"),$("#youtuber-count").html("("+countYoutubeChannelsVisible+")"),$("#twitchchannel-count").html("("+countTwitchChannelsVisible+")"),0<text.length?$("#chat-container").hide():$("#chat-container").show()},refreshTotals:function(){0==impresslist.people.length?$("#people-footer").show():$("#people-footer").hide(),0==impresslist.publications.length?$("#publications-footer").show():$("#publications-footer").hide(),0==impresslist.youtubers.length?$("#youtubers-footer").show():$("#youtubers-footer").hide(),0==impresslist.twitchchannels.length?$("#twitchchannels-footer").show():$("#twitchchannels-footer").hide(),$("#people-count").html("("+impresslist.people.length+")"),$("#publication-count").html("("+impresslist.publications.length+")"),$("#youtuber-count").html("("+impresslist.youtubers.length+")"),$("#twitchchannel-count").html("("+impresslist.twitchchannels.length+")")},refreshTagFilter:function(){var tagsEnabled=[];$(".filter-tag").each(function(r,e){$(e).prop("checked")&&tagsEnabled.push($(e).attr("data-tag"))}),impresslist.applyTagFilter(tagsEnabled)},applyTagFilter:function(tags){for(var countPeopleVisible=0,i=0;i<impresslist.people.length;i++)impresslist.people[i].filterTags(tags)&&countPeopleVisible++;var countPublicationsVisible=0;for(i=0;i<impresslist.publications.length;i++)impresslist.publications[i].filterTags(tags)&&countPublicationsVisible++;var countYoutubeChannelsVisible=0;for(i=0;i<impresslist.youtubers.length;i++)impresslist.youtubers[i].filterTags(tags)&&countYoutubeChannelsVisible++;var countTwitchChannelsVisible=0;for(i=0;i<impresslist.twitchchannels.length;i++)impresslist.twitchchannels[i].filterTags(tags)&&countTwitchChannelsVisible++;0==countPeopleVisible?$("#people-footer").show():$("#people-footer").hide(),0==countPublicationsVisible?$("#publications-footer").show():$("#publications-footer").hide(),0==countYoutubeChannelsVisible?$("#youtubers-footer").show():$("#youtubers-footer").hide(),0==countTwitchChannelsVisible?$("#twitchchannels-footer").show():$("#twitchchannels-footer").hide(),0<impresslist.people.length&&0==countPeopleVisible?$("#people-container").hide():$("#people-container").show(),0<impresslist.publications.length&&0==countPublicationsVisible?$("#publications-container").hide():$("#publications-container").show(),0<impresslist.youtubers.length&&0==countYoutubeChannelsVisible?$("#youtubers-container").hide():$("#youtubers-container").show(),0<impresslist.twitchchannels.length&&0==countTwitchChannelsVisible?$("#twitchchannels-container").hide():$("#twitchchannels-container").show(),console.log("countPeopleVisible",countPeopleVisible),console.log("countPublicationsVisible",countPublicationsVisible),console.log("countYoutubeChannelsVisible",countYoutubeChannelsVisible),console.log("countTwitchChannelsVisible",countTwitchChannelsVisible),$("#people-count").html("("+countPeopleVisible+")"),$("#publication-count").html("("+countPublicationsVisible+")"),$("#youtuber-count").html("("+countYoutubeChannelsVisible+")"),$("#twitchchannel-count").html("("+countTwitchChannelsVisible+")")},refreshMailoutRecipients:function(){var peopleSelected=$('input[data-type="person"][data-checkbox="true"]:checked'),publicationsSelected=$('input[data-type="publication"][data-checkbox="true"]:checked'),youtubersSelected=$('input[data-type="youtuber"][data-checkbox="true"]:checked'),twitchchannelsSelected=$('input[data-type="twitchchannel"][data-checkbox="true"]:checked');if(peopleSelected.length+publicationsSelected.length+youtubersSelected.length+twitchchannelsSelected.length==0)return $("#mailout-recipients-none").show(),void $("#mailout-recipients").hide();for(var combined=[],i=0;i<peopleSelected.length;i++)combined.push(peopleSelected[i]);for(i=0;i<publicationsSelected.length;i++)combined.push(publicationsSelected[i]);for(i=0;i<youtubersSelected.length;i++)combined.push(youtubersSelected[i]);for(i=0;i<twitchchannelsSelected.length;i++)combined.push(twitchchannelsSelected[i]);var html="";for(i=0;i<combined.length;i++){var readBool=$(combined[i]).attr("mailout-read"),remindedTwitterDM="true"==$(combined[i]).attr("mailout-reminded-twitter-dm"),personName=$(combined[i]).attr("data-mailout-name"),personType=$(combined[i]).attr("data-mailout-type"),personTypeId=$(combined[i]).attr("data-mailout-typeid"),personTypeName=$(combined[i]).attr("data-mailout-typename");html+="<tr>",html+="\t<td data-value='"+personName+"'>"+personName+"</td>",html+="\t<td data-value='"+personTypeName+"'>"+personTypeName+"</td>",html+="\t<td class='mailout-readflags mailout-read-"+readBool+"' data-value='"+readBool+"'>"+readBool+"</td>",html+="\t<td class='mailout-readflags'>",html+=remindedTwitterDM?"\t DM : <a href='javascript:;'>done!</a>":"\t <a id='mailout-recipient-remind-twitter-dm-"+personType+"-"+personTypeId+"' href='javascript:;'>DM</a>",html+="\t</td>",html+="</tr>"}$("#mailout-recipients-tbody").html(html);for(i=0;i<combined.length;i++){!function(personType,personTypeId){$("#mailout-recipient-remind-twitter-dm-"+personType+"-"+personTypeId).click(function(){"person"==personType?impresslist.findPersonById(personTypeId):"publication"==personType?impresslist.findPublicationById(personTypeId):"personPublication"==personType?(personId=impresslist.findPersonPublicationById(personTypeId).person.id,impresslist.findPersonById(personId)):"youtuber"==personType?impresslist.findYoutuberById(personTypeId):"twitchchannel"==personType&&impresslist.findTwitchChannelById(personTypeId)})}(personType=$(combined[i]).attr("data-mailout-type"),personTypeId=$(combined[i]).attr("data-mailout-typeid"))}$("#mailout-recipients").show(),$("#mailout-recipients-none").hide()},addPerson:function(obj,fromInit){this.people.push(obj),obj.onAdded(),fromInit||impresslist.refreshFilter()},addPublication:function(obj,fromInit){this.publications.push(obj),obj.onAdded(),fromInit||impresslist.refreshFilter()},addPersonPublication:function(obj,fromInit){this.personPublications.push(obj),obj.onAdded(fromInit),fromInit||impresslist.refreshFilter()},addPersonYoutubeChannel:function(obj,fromInit){this.personYoutubeChannels.push(obj),obj.onAdded(fromInit),fromInit||impresslist.refreshFilter()},addPersonTwitchChannel:function(obj,fromInit){this.personTwitchChannels.push(obj),obj.onAdded(fromInit),fromInit||impresslist.refreshFilter()},addEmail:function(obj,fromInit){this.emails.push(obj),obj.onAdded(),fromInit||impresslist.refreshFilter()},addUser:function(obj,fromInit){this.users.push(obj),obj.onAdded(),fromInit||impresslist.refreshFilter()},addCompany:function(obj,fromInit){this.companies.push(obj),obj.onAdded(),fromInit||impresslist.refreshFilter()},addYoutuber:function(obj,fromInit){this.youtubers.push(obj),obj.onAdded(),fromInit||impresslist.refreshFilter()},addTwitchChannel:function(obj,fromInit){this.twitchchannels.push(obj),obj.onAdded(),fromInit||impresslist.refreshFilter()},addPodcast:function(obj,fromInit){this.podcasts.push(obj),obj.onAdded(),fromInit||impresslist.refreshFilter()},addGame:function(obj,fromInit){this.games.push(obj),obj.onAdded()},addAudience:function(obj,fromInit){this.audiences.push(obj),obj.onAdded()},addCoverage:function(obj,fromInit){this.coverage.push(obj),obj.onAdded(fromInit)},addWatchedGame:function(obj,fromInit){this.watchedgames.push(obj),obj.onAdded(fromInit)},removeWatchedGame:function(obj){for(var i=0,len=this.watchedgames.length;i<len;++i)if(this.watchedgames[i].id==obj.id){console.log("watched game removed: "+obj.id),obj.onRemoved(),this.watchedgames.splice(i,1),impresslist.refreshFilter();break}},addOAuthTwitterAccount:function(obj,fromInit){this.oauthTwitterAccounts.push(obj),obj.onAdded(fromInit)},removeOAuthTwitterAccount:function(obj){for(var i=0,len=this.oauthTwitterAccounts.length;i<len;++i)if(this.oauthTwitterAccounts[i].id==obj.id){console.log("oauth twitter removed: "+obj.id),obj.onRemoved(),this.oauthTwitterAccounts.splice(i,1);break}},addOAuthFacebookAccount:function(obj,fromInit){this.oauthFacebookAccounts.push(obj),obj.onAdded(fromInit)},removeOAuthFacebookAccount:function(obj){for(var i=0,len=this.oauthFacebookAccounts.length;i<len;++i)if(this.oauthFacebookAccounts[i].id==obj.id){console.log("oauth facebook removed: "+obj.id),obj.onRemoved(),this.oauthFacebookAccounts.splice(i,1);break}},addOAuthFacebookPage:function(obj,fromInit){this.oauthFacebookPages.push(obj),obj.onAdded(fromInit)},removeOAuthFacebookPage:function(obj){for(var i=0,len=this.oauthFacebookPages.length;i<len;++i)if(this.oauthFacebookPages[i].id==obj.id){console.log("oauth facebook page removed: "+obj.id),obj.onRemoved(),this.oauthFacebookPages.splice(i,1);break}},addSocialUpload:function(obj,fromInit){this.socialUploads.push(obj),obj.onAdded(fromInit)},removeSocialUpload:function(obj){for(var i=0,len=this.socialUploads.length;i<len;++i)if(this.socialUploads[i].id==obj.id){console.log("social upload removed: "+obj.id),obj.onRemoved(),this.socialUploads.splice(i,1);break}},addSocialTimelineItem:function(obj,fromInit){this.socialTimelineItems.push(obj),obj.onAdded(fromInit)},removeSocialTimelineItem:function(obj){for(var i=0,len=this.socialTimelineItems.length;i<len;++i)if(this.socialTimelineItems[i].id==obj.id){console.log("social timeline item removed: "+obj.id),obj.onRemoved(),this.socialTimelineItems.splice(i,1);break}},addSimpleMailout:function(obj,fromInit){this.simpleMailouts.push(obj),obj.onAdded(fromInit)},removeSimpleMailout:function(obj){for(var i=0,len=this.simpleMailouts.length;i<len;++i)if(this.simpleMailouts[i].id==obj.id){console.log("simple mailout removed: "+obj.id),obj.onRemoved(),this.simpleMailouts.splice(i,1);break}},removePerson:function(obj){for(var i=0,len=this.people.length;i<len;++i)if(this.people[i].id==obj.id){console.log("person removed: "+obj.id),obj.onRemoved(),this.people.splice(i,1),impresslist.refreshFilter();break}},removePublication:function(obj){for(var i=0,len=this.publications.length;i<len;++i)if(this.publications[i].id==obj.id){console.log("publication removed: "+obj.id),obj.onRemoved(),this.publications.splice(i,1),impresslist.refreshFilter();break}},removeYoutuber:function(obj){for(var i=0,len=this.youtubers.length;i<len;++i)if(this.youtubers[i].id==obj.id){console.log("youtuber removed: "+obj.id),obj.onRemoved(),this.youtubers.splice(i,1),impresslist.refreshFilter();break}},removeTwitchChannel:function(obj){for(var i=0,len=this.twitchchannels.length;i<len;++i)if(this.twitchchannels[i].id==obj.id){console.log("twitchchannels removed: "+obj.id),obj.onRemoved(),this.twitchchannels.splice(i,1),impresslist.refreshFilter();break}},removePodcast:function(obj){for(var i=0,len=this.podcasts.length;i<len;++i)if(this.podcasts[i].id==obj.id){console.log("podcast removed: "+obj.id),obj.onRemoved(),this.podcasts.splice(i,1),impresslist.refreshFilter();break}},removePersonPublication:function(obj){for(var i=0,len=this.personPublications.length;i<len;++i)if(this.personPublications[i].id==obj.id){console.log("person publication removed: "+obj.id),obj.onRemoved(),this.personPublications.splice(i,1),impresslist.refreshFilter();break}},removePersonYoutubeChannel:function(obj){for(var i=0,len=this.personYoutubeChannels.length;i<len;++i)if(this.personYoutubeChannels[i].id==obj.id){console.log("person youtube channel removed: "+obj.id),obj.onRemoved(),this.personYoutubeChannels.splice(i,1),impresslist.refreshFilter();break}},removePersonTwitchChannel:function(obj){for(var i=0,len=this.personTwitchChannels.length;i<len;++i)if(this.personTwitchChannels[i].id==obj.id){console.log("person twitch channel removed: "+obj.id),obj.onRemoved(),this.personTwitchChannels.splice(i,1),impresslist.refreshFilter();break}},removeCoverage:function(obj){for(var i=0,len=this.coverage.length;i<len;++i)if(this.coverage[i].id==obj.id){console.log("coverage removed: "+obj.id),obj.onRemoved(),this.coverage.splice(i,1),impresslist.refreshFilter();break}},removeUser:function(obj){for(var i=0,len=this.users.length;i<len;++i)if(this.users[i].id==obj.id){console.log("user removed: "+obj.id),obj.onRemoved(),this.users.splice(i,1),impresslist.refreshFilter();break}},findPersonById:function(id){var r=this.binarySearchById(this.people,id);return null!=r?r:(console.log("impresslist: could not findPersonById: "+id),null)},findPersonPublicationById:function(id){var r=this.binarySearchById(this.personPublications,id);return null!=r?r:(console.log("impresslist: could not findPersonPublicationById: "+id),null)},findPublicationById:function(id){var r=this.binarySearchById(this.publications,id);return null!=r?r:(console.error("impresslist: could not findPublicationById: "+id),null)},findYoutuberByChannelId:function(channelId){for(var i=0;i<this.youtubers.length;++i)if(this.youtubers[i].field("youtubeId")==channelId||this.youtubers[i].field("channel")==channelId)return this.youtubers[i];return console.log("impresslist: could not findYoutuberByChannelId: "+channelId),null},findYoutuberById:function(id){var r=this.binarySearchById(this.youtubers,id);return null!=r?r:(console.log("impresslist: could not findYoutuberById: "+id),null)},findTwitchChannelById:function(id){var r=this.binarySearchById(this.twitchchannels,id);return null!=r?r:(console.log("impresslist: could not findTwitchChannelById: "+id),null)},findPodcastById:function(id){var r=this.binarySearchById(this.podcasts,id);return null!=r?r:(console.log("impresslist: could not findPodcastById: "+id),null)},findUserById:function(id){var r=this.binarySearchById(this.users,id);return null!=r?r:(console.log("impresslist: could not findUserById: "+id),null)},findEmailById:function(id){var r=this.binarySearchById(this.emails,id);return null!=r?r:(console.log("impresslist: could not findEmailById: "+id),null)},findGameById:function(id){for(var i=0;i<this.games.length;++i)if(this.games[i].id==id)return this.games[i];return console.log("impresslist: could not findGameById: "+id),null},findOAuthTwitterAccountById:function(id){var r=this.binarySearchById(this.oauthTwitterAccounts,id);return null!=r?r:(console.log("impresslist: could not findOAuthTwitterAccountById: "+id),null)},findOAuthFacebookAccountById:function(id){var r=this.binarySearchById(this.oauthFacebookAccounts,id);return null!=r?r:(console.log("impresslist: could not findOAuthFacebookAccountById: "+id),null)},findOAuthFacebookPageById:function(id){var r=this.binarySearchById(this.oauthFacebookPages,id);return null!=r?r:(console.log("impresslist: could not findOAuthFacebookPageById: "+id),null)},binarySearchById:function(list,id){for(var guess,min=0,max=list.length-1;min<=max;){if(list[guess=Math.floor((min+max)/2)].id==id)return list[guess];list[guess].id<id?min=guess+1:max=guess-1}return null},backup:function(){}};impresslist.jobs={enabled:!1,selectors:{text:"#jobs-textarea",button:"#jobs-save-all"},init:function(fromInit){if(this.enabled){$("#jobs-pill-link").show(),this.update(fromInit);var thiz=this;$(this.selectors.button).click(function(){var message=$(thiz.selectors.text).val();0<message.trim().length&&thiz.save(message)})}},update:function(fromInit){var thiz=this;$.ajax("api.php?endpoint=/job/list/").done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(thiz.populate(json.jobs),$(thiz.selectors.button).removeAttr("disabled")):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list Jobs.")})},save:function(message){var thiz=this,url="api.php?endpoint=/job/save-all/&jobs="+encodeURIComponent(message);$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(thiz.populate(json.jobs),API.successMessage("Jobs saved")):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not save Jobs.")})},populate:function(jobs){for(var jobsString="",i=0;i<jobs.length;++i)jobsString+=jobs[i],i<jobs.length-1&&(jobsString+="\n");console.log(jobsString),$(this.selectors.text).html(jobsString)}},impresslist.chat={enabled:!1,online_users:new Array,current_filesize:0,latest_message_time:(new Date).getTime()/1e3-43200,selectors:{users:"#chat .online-users",messages:"#chat .messages",text:"#chat .message",button:"#chat .submit-message"},init:function(){if(this.enabled){$("#chat-pill-link").show(),this.updateOnlineUsers(),setInterval(this.updateOnlineUsers,3e4),this.update(!0);var thiz=this;$(this.selectors.text).keyup(function(e){13==e.which&&$(thiz.selectors.button).click()}),$(this.selectors.button).click(function(){var message=$(thiz.selectors.text).val();$(thiz.selectors.text).val(""),0<message.trim().length&&thiz.send(message)})}},updateOnlineUsers:function(fromInit){var thiz=impresslist.chat,url="api.php?endpoint=/chat/online-users/";console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(!json.success)return json.logout?void(window.location="/"):void API.errorMessage(json.message);$(thiz.selectors.users).html("");for(var i=0;i<json.data.users.length;++i){var u=impresslist.findUserById(json.data.users[i]);$(thiz.selectors.users).append(" <span style='color:"+u.field("color")+"'>"+u.fullname()+"</span>")}}else API.errorMessage(result)})},update:function(fromInit){var thiz=this;$.ajax({type:"GET",url:"api.php?endpoint=/chat/lines/&time="+this.latest_message_time+"&size="+this.current_filesize,dataType:"text",cache:!1,success:function(result){if(console.log(result),"{"==result.substr(0,1)){var json=JSON.parse(result);if(!json.success)return json.logout?void(window.location="/"):void API.errorMessage(json.message);fromInit&&$(thiz.selectors.messages).html("");for(var i=0;i<json.data.lines.length;i++){var user=impresslist.findUserById(json.data.lines[i].user),date=new Date(1e3*json.data.lines[i].time),text="";text+=date.getUTCDate()+"/",text+=impresslist.util.zeropad(date.getUTCMonth()+1,2)+"/",text+=date.getUTCFullYear()+" - ",text+=date.getUTCHours()+":",text+=impresslist.util.zeropad(date.getUTCMinutes(),2)+"",text+=" - <span style='color:"+user.field("color")+"'>",text+=user.field("surname"),text+="</span>: ",text+=json.data.lines[i].message,text+="<br/>",$(thiz.selectors.messages).append(text),$(thiz.selectors.messages).scrollTop($(thiz.selectors.messages)[0].scrollHeight)}thiz.latest_message_time=json.data.meta.time,thiz.current_filesize=json.data.meta.size,setTimeout(function(){thiz.update(!1)},1e3)}else API.errorMessage(result)}})},send:function(line){$.ajax({type:"POST",url:"api.php?endpoint=/chat/send/",data:{message:line},dataType:"text",cache:!1,success:function(result){if(console.log(result),"{"==result.substr(0,1)){var json=JSON.parse(result);json.success||API.errorMessage(json.message)}else API.errorMessage(result)}})}},impresslist.util={cancellableKeys:[37,38,39,40,16,17,18,20,91],formatnumber:function(v){return new Number(v).toLocaleString()},iframe:function(url,title){var height=Math.round(.8*window.innerHeight),html="";html+="\t<div id='iframe_modal' class='modal fade' tabindex='-1' role='dialog'> \t\t\t\t\t\t<div class='modal-dialog'> \t\t\t\t\t\t\t<div class='modal-content' style='padding:5px;'> \t\t\t\t\t\t\t\t<div style='min-height:"+height+"px;padding:0px;'>",html+="\t\t\t\t\t<iframe id='iframe_modal_frame' src='"+url+"' style='width:100%; height:100%; min-height:"+height+"px; border:0;'></iframe>",html+="\t\t\t\t</div> \t\t\t\t\t\t\t</div> \t\t\t\t\t\t</div> \t\t\t\t\t</div>",$("#modals").html(html),$("#iframe_modal").modal("show")},findTagKey:function(tagName){var inverseTags=[];for(var key in impresslist.config.tags)inverseTags[impresslist.config.tags[key].name]=key;return inverseTags[tagName]},tagStringToInputField:function(str){var output="";if(0==str.trim().length)return output;var bits=str.split(",");console.log(bits);for(var i=0;i<bits.length;i++)output+=impresslist.config.tags[bits[i]].name,i!=bits.length-1&&(output+=",");return output},tagInputFieldToString:function(data){var array=[];if("string"==typeof data){if(0==data.trim().length)return"";array=data.split(",")}else array=data;for(var str="",i=0;i<array.length;i++)str+=impresslist.util.findTagKey(array[i]),i!=array.length-1&&(str+=",");return str},buildTags:function(tagsString){var html="";if(0==tagsString.length)return"None";for(var tags=tagsString.split(","),i=0;i<tags.length;i++)html+="<span class='tag tag-"+tags[i]+"'>"+impresslist.config.tags[tags[i]].name+"</span>";return html},relativetime_contact:function(previous){return 0==Number(previous)||3600==Number(previous)?"Never":this.relativetime(previous)},relativetime:function(previous){return this.relativetime2(parseInt(Date.now()/1e3),Number(previous))},relativetime2:function(current,previous){var elapsed,num;return(elapsed=current-previous)<0?(elapsed=Math.abs(elapsed))<60?0==(num=Math.round(elapsed/1e3))?"now":num+" seconds from now":elapsed<3600?Math.round(elapsed/60)+" minutes from now":elapsed<86400?Math.round(elapsed/3600)+" hours from now":elapsed<2592e3?"~"+Math.round(elapsed/86400)+" days from now":elapsed<31536e3?"~"+Math.round(elapsed/2592e3)+" months from now":"~"+Math.round(elapsed/31536e3)+" years from now":elapsed<60?0==(num=Math.round(elapsed/1e3))?"now":num+" seconds ago":elapsed<3600?Math.round(elapsed/60)+" minutes ago":elapsed<86400?Math.round(elapsed/3600)+" hours ago":elapsed<2592e3?"~"+Math.round(elapsed/86400)+" days ago":elapsed<31536e3?"~"+Math.round(elapsed/2592e3)+" months ago":"~"+Math.round(elapsed/31536e3)+" years ago"},zeropad:function(num,digits){for(var newstr=""+num;newstr.length<digits;)newstr="0"+newstr;return newstr},mailtoClient:function(defaultEmail,emailSubject,emailBody,emailBCC){var str="mailto:"+defaultEmail+"?subject="+emailSubject+"&body="+emailBody;return 0<(emailBCC=void 0!==emailBCC?emailBCC:"").length&&(str+="&bcc="+emailBCC),str},mailtoGmail:function(defaultEmail,emailSubject,emailBody,emailBCC,emailGmailIndex){var str="https://mail.google.com/mail/u/"+(emailGmailIndex=void 0!==emailGmailIndex?emailGmailIndex:"0")+"/?view=cm&fs=1&to="+defaultEmail+"&su="+emailSubject+"&body="+emailBody;return 0<(emailBCC=void 0!==emailBCC?emailBCC:"").length&&(str+="&bcc="+emailBCC),str},templates:{StatsTable:function(stats){var table="";return table+="\t<table class='table'>\t\t\t\t\t\t\t<thead class='thead-light'>\t\t\t\t\t\t\t\t<th colspan='6'>Youtube</th>\t\t\t\t\t\t\t</thead>\t\t\t\t\t\t\t<thead class='thead-light'>\t\t\t\t\t\t\t\t<th>Videos</th>\t\t\t\t\t\t\t\t<th>Views</th>\t\t\t\t\t\t\t\t<th>Likes</th>\t\t\t\t\t\t\t\t<th>Dislikes</th>\t\t\t\t\t\t\t\t<th>Favourites</th>\t\t\t\t\t\t\t\t<th>Comments</th>\t\t\t\t\t\t\t</thead>\t\t\t\t\t\t\t<tr>\t\t\t\t\t\t\t\t<td id='coverage-stats-youtube-videos'>"+impresslist.util.formatnumber(stats.youtube.videoCount)+"</td>\t\t\t\t\t\t\t\t<td id='coverage-stats-youtube-views'>"+impresslist.util.formatnumber(stats.youtube.viewCount)+"</td>\t\t\t\t\t\t\t\t<td id='coverage-stats-youtube-likes'>"+impresslist.util.formatnumber(stats.youtube.likeCount)+"</td>\t\t\t\t\t\t\t\t<td id='coverage-stats-youtube-dislikes'>"+impresslist.util.formatnumber(stats.youtube.dislikeCount)+"</td>\t\t\t\t\t\t\t\t<td id='coverage-stats-youtube-favourites'>"+impresslist.util.formatnumber(stats.youtube.favoriteCount)+"</td>\t\t\t\t\t\t\t\t<td id='coverage-stats-youtube-comments'>"+impresslist.util.formatnumber(stats.youtube.commentCount)+"</td>\t\t\t\t\t\t\t</tr>\t\t\t\t\t\t</table>"}}},impresslist.noop=function(){},API=function(){},API.prototype={},API.root="",API.search=function(q,successCallback,failCallback){var url=API.root+"api.php?endpoint=/search/&q="+encodeURIComponent(q);$.ajax(url).done(function(result){if("{"!=result.substr(0,1))return API.errorMessage(result),void(failCallback&&failCallback());var json=JSON.parse(result);if(!json.success)return API.errorMessage(json.message),void(failCallback&&failCallback());successCallback&&successCallback(json)}).fail(function(){API.errorMessage("Could not perform Full Search."),failCallback&&failCallback()})},API.listSocialTimeline=function(fromInit){void 0===fromInit&&(fromInit=!0),impresslist.loading.set("socialTimelineItem",!0);var url=API.root+"api.php?endpoint=/social/timeline/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.timeline.length;++i){var item=new SocialTimelineItem(json.timeline[i]);impresslist.addSocialTimelineItem(item,fromInit)}0==json.timeline.length&&($("#social-timeline-none").show(),$("#social-timeline-loading").hide()),impresslist.loading.set("socialTimelineItem",!1),fromInit&&impresslist.loading.onCategoryItemLoaded("social")}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not pull Social Timeline.")})},API.addSocialTimelineItem=function(){var url=API.root+"api.php?endpoint=/social/timeline/item/add/";console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){API.successMessage("Schedule Item added."),console.log(json);var item=new SocialTimelineItem(json.socialTimelineItem);impresslist.addSocialTimelineItem(item,!1)}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Schedule Item.")})},API.addSocialTimelineItemRetweets=function(obj,accounts,timesep,donecallback){var url=API.root+"api.php?endpoint=/social/timeline/item/add-retweets/&id="+encodeURIComponent(obj.id)+"&accounts="+encodeURIComponent(accounts)+"&timesep="+encodeURIComponent(timesep);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){API.successMessage("Shares added."),console.log(json);for(var i=0;i<json.socialTimelineItems.length;++i){var item=new SocialTimelineItem(json.socialTimelineItems[i]);impresslist.addSocialTimelineItem(item,!1)}void 0!==donecallback&&donecallback()}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Shares.")})},API.saveSocialTimelineItem=function(obj,type,typedata,timestamp,ready){var url=API.root+"api.php?endpoint=/social/timeline/item/save/&id="+encodeURIComponent(obj.id)+"&type="+encodeURIComponent(type)+"&data="+encodeURIComponent(JSON.stringify(typedata))+"&timestamp="+encodeURIComponent(timestamp)+"&ready="+encodeURIComponent(ready);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Schedule Item saved."),console.log(json),obj.init(json.socialTimelineItem),obj.updateRow(),obj.update(),SocialTimelineItem.displaySort()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not save Schedule Item.")})},API.removeSocialTimelineItem=function(obj){var url=API.root+"api.php?endpoint=/social/timeline/item/remove/&id="+encodeURIComponent(obj.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Schedule Item removed."),impresslist.removeSocialTimelineItem(obj)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Schedule Item.")})},API.listSocialUploads=function(fromInit){void 0===fromInit&&(fromInit=!0),impresslist.loading.set("socialUploads",!0);var url=API.root+"api.php?endpoint=/social/uploads/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.uploads.length;++i){var upload=new SocialUpload(json.uploads[i]);impresslist.addSocialUpload(upload,fromInit)}impresslist.loading.set("socialUploads",!1),fromInit&&impresslist.loading.onCategoryItemLoaded("social")}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list Social Uploads.")})},API.addSocialUpload=function(d,successCallback){var url=API.root+"api.php?endpoint=/social/uploads/add/";console.log(url),$.ajax({url:API.root+"api.php?endpoint=/social/uploads/add/",type:"POST",data:d,contentType:!1,cache:!1,processData:!1,success:function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){API.successMessage("Social Upload added."),console.log(json);var upload=new SocialUpload(json.upload);impresslist.addSocialUpload(upload,!1),void 0!==successCallback&&successCallback()}else API.errorMessage(json.message)}else API.errorMessage(result)},error:function(e,e2,e3){API.errorMessage("Could not add Social Upload."),console.log("error: "+e+" "+e2+" "+e3)}})},API.removeSocialUpload=function(acc){var url=API.root+"api.php?endpoint=/social/uploads/remove/&name="+encodeURIComponent(acc.field("name"));console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Social Upload removed."),impresslist.removeSocialUpload(acc)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Social Upload.")})},API.listPeople=function(fromInit){void 0===fromInit&&(fromInit=!0);var url=API.root+"api.php?endpoint=/person/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.people.length;++i){var person=new Person(json.people[i]);impresslist.addPerson(person,fromInit)}fromInit&&impresslist.loading.onCategoryItemLoaded("home")}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list People.")})},API.listPublications=function(fromInit){void 0===fromInit&&(fromInit=!0);var url=API.root+"api.php?endpoint=/publication/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.publications.length;++i){var publication=new Publication(json.publications[i]);impresslist.addPublication(publication,fromInit)}fromInit&&impresslist.loading.onCategoryItemLoaded("home")}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list Publications.")})},API.listPersonPublications=function(fromInit){void 0===fromInit&&(fromInit=!0);var url=API.root+"api.php?endpoint=/person-publication/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.personPublications.length;++i){var publication=new PersonPublication(json.personPublications[i]);impresslist.addPersonPublication(publication,fromInit)}fromInit&&impresslist.loading.onCategoryItemLoaded("home")}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list Person Publications.")})},API.listPersonYoutubeChannels=function(fromInit){void 0===fromInit&&(fromInit=!0);var url=API.root+"api.php?endpoint=/person-youtube-channel/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.personYoutubeChannels.length;++i){var channel=new PersonYoutubeChannel(json.personYoutubeChannels[i]);impresslist.addPersonYoutubeChannel(channel,fromInit)}fromInit&&impresslist.loading.onCategoryItemLoaded("home")}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list Person Youtube Channels.")})},API.listPersonTwitchChannels=function(fromInit){void 0===fromInit&&(fromInit=!0);var url=API.root+"api.php?endpoint=/person-twitchchannel/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.personTwitchChannels.length;++i){var channel=new PersonTwitchChannel(json.personTwitchChannels[i]);impresslist.addPersonTwitchChannel(channel,fromInit)}fromInit&&impresslist.loading.onCategoryItemLoaded("home")}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list Person Youtube Channels.")})},API.listYoutubeChannels=function(fromInit){void 0===fromInit&&(fromInit=!0),impresslist.loading.set("youtubeChannels",!0);var url=API.root+"api.php?endpoint=/youtuber/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.youtubechannels.length;++i){var youtuber=new Youtuber(json.youtubechannels[i]);impresslist.addYoutuber(youtuber,fromInit)}impresslist.loading.set("youtubeChannels",!1),fromInit&&impresslist.loading.onCategoryItemLoaded("home")}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list Youtubers.")})},API.listTwitchChannels=function(fromInit){void 0===fromInit&&(fromInit=!0),impresslist.loading.set("twitchChannels",!0);var url=API.root+"api.php?endpoint=/twitchchannel/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.twitchchannels.length;++i){var channel=new TwitchChannel(json.twitchchannels[i]);impresslist.addTwitchChannel(channel,fromInit)}fromInit&&impresslist.loading.onCategoryItemLoaded("home"),impresslist.loading.set("twitchChannels",!1)}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list Twitch Channels.")})},API.listEmails=function(fromInit){void 0===fromInit&&(fromInit=!0);var url=API.root+"api.php?endpoint=/email/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.emails.length;++i){var email=new Email(json.emails[i]);impresslist.addEmail(email,fromInit)}fromInit&&impresslist.loading.onCategoryItemLoaded("home")}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list Emails.")})},API.listCoverage=function(fromInit,successCallback){void 0===fromInit&&(fromInit=!0),impresslist.loading.set("coverage",!0);var url=API.root+"api.php?endpoint=/coverage/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.coverage.length;++i){var coverage=new Coverage(json.coverage[i]);impresslist.addCoverage(coverage,fromInit)}successCallback&&successCallback(json),fromInit&&impresslist.loading.onCategoryItemLoaded("project"),impresslist.loading.set("coverage",!1)}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list Coverage.")})},API.listWatchedGames=function(fromInit){void 0===fromInit&&(fromInit=!0),impresslist.loading.set("watchedgames",!0);var url=API.root+"api.php?endpoint=/watchedgame/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.watchedgames.length;++i){var watchedgame=new WatchedGame(json.watchedgames[i]);impresslist.addWatchedGame(watchedgame,fromInit)}fromInit&&impresslist.loading.onCategoryItemLoaded("project"),impresslist.loading.set("watchedgames",!1)}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list Watched Games.")})},API.saveWatchedGame=function(watchedgame,name,keywords,successCallback,failCallback){var url=API.root+"api.php?endpoint=/watchedgame/save/&id="+encodeURIComponent(watchedgame.id)+"&name="+encodeURIComponent(name)+"&keywords="+encodeURIComponent(keywords);console.log(url),$.ajax({method:"GET",url:url}).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(!json.success)return API.errorMessage(json.message),void(failCallback&&failCallback());API.successMessage("Watched Game saved."),obj.init(json.watchedgame),obj.update(),successCallback&&successCallback()}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not save Watched Game."),failCallback&&failCallback()})},API.removeWatchedGame=function(watchedgame,successCallback,failCallback){var url=API.root+"api.php?endpoint=/watchedgame/remove/&id="+encodeURIComponent(watchedgame.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(!json.success)return API.errorMessage(json.message),void(failCallback&&failCallback());API.successMessage("Watched Game removed."),impresslist.removeWatchedGame(person),successCallback&&successCallback()}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Watched Game."),failCallback&&failCallback()})},API.assignedKeys=function(type,typeId,successCallback,errorCallback){var url=API.root+"api.php?endpoint=/keys/assigned/&type="+encodeURIComponent(type)+"&type_id="+encodeURIComponent(typeId);console.log(url),$.ajax(url).done(function(result){if("{"!=result.substr(0,1))return API.errorMessage(result),void(errorCallback&&errorCallback());var json=JSON.parse(result);if(!json.success)return API.errorMessage(json.message),void(errorCallback&&errorCallback());successCallback&&successCallback(json)}).fail(function(){API.errorMessage("Could not list assigned keys."),errorCallback&&errorCallback()})},API.listKeys=function(game,platform,subplatform,assigned,callbackfunction){var url=API.root+"api.php?endpoint=/keys/list/&game="+encodeURIComponent(game)+"&platform="+encodeURIComponent(platform)+"&subplatform="+encodeURIComponent(subplatform)+"&assigned="+encodeURIComponent(assigned);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?callbackfunction(json):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list keys.")})},API.addKeys=function(keys,game,platform,subplatform,expiresOn,callbackfunction,failCallback){var url=API.root+"api.php?endpoint=/keys/add/&keys="+encodeURIComponent(keys)+"&game="+encodeURIComponent(game)+"&platform="+encodeURIComponent(platform)+"&subplatform="+encodeURIComponent(subplatform)+"&expiresOn="+encodeURIComponent(expiresOn);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(!json.success)return failCallback(),void API.errorMessage(json.message);API.successMessage("Keys added."),console.log(json),callbackfunction(json)}else API.errorMessage(result)}).fail(function(){failCallback(),API.errorMessage("Could not add Keys.")})},API.popKeys=function(game,platform,subplatform,amount,successCallback){var url=API.root+"api.php?endpoint=/keys/pop/&game="+encodeURIComponent(game)+"&platform="+encodeURIComponent(platform)+"&subplatform="+encodeURIComponent(subplatform)+"&amount="+encodeURIComponent(amount);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Keys popped."),console.log(json),successCallback(json)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not pop Keys.")})},API.listSimpleMailouts=function(fromInit){void 0===fromInit&&(fromInit=!0);var url=API.root+"api.php?endpoint=/mailout/simple/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.mailouts.length;++i){var mailout=new SimpleMailout(json.mailouts[i]);impresslist.addSimpleMailout(mailout,fromInit)}fromInit&&impresslist.loading.onCategoryItemLoaded("mailout")}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list Mailouts.")})},API.addSimpleMailout=function(){var url=API.root+"api.php?endpoint=/mailout/simple/add/";console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){API.successMessage("Simple Mailout added."),console.log(json);var simpleMailout=new SimpleMailout(json.mailout);impresslist.addSimpleMailout(simpleMailout,!1)}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Simple Mailout.")})},API.duplicateSimpleMailout=function(obj,successCallback,errorCallback){var url=API.root+"api.php?endpoint=/mailout/simple/duplicate/&id="+encodeURIComponent(obj.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(!json.success)return API.errorMessage(json.message),void(errorCallback&&errorCallback());API.successMessage("Simple Mailout duplicated."),console.log(json);var simpleMailout=new SimpleMailout(json.mailout);impresslist.addSimpleMailout(simpleMailout,!1),successCallback&&successCallback(simpleMailout)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not duplicate Simple Mailout."),errorCallback&&errorCallback()})},API.saveSimpleMailout=function(obj,name,subject,recipients,markdown,timestamp,successCallback,errorCallback){var url=API.root+"api.php?endpoint=/mailout/simple/save/&id="+encodeURIComponent(obj.id)+"&name="+encodeURIComponent(name)+"&subject="+encodeURIComponent(subject)+"&recipients=look_in_post_data&markdown="+encodeURIComponent(markdown)+"&timestamp="+encodeURIComponent(timestamp);console.log(url),$.ajax({method:"POST",url:url,data:{recipients:encodeURIComponent(JSON.stringify(recipients))}}).done(function(result){if("{"!=result.substr(0,1))return API.errorMessage(result),void(errorCallback&&errorCallback(json));var json=JSON.parse(result);if(!json.success)return API.errorMessage(json.message),void(errorCallback&&errorCallback(json));API.successMessage("Simple Mailout saved."),obj.init(json.mailout),obj.update(),successCallback&&successCallback(json)}).fail(function(){API.errorMessage("Could not save Simple Mailout.")})},API.sendSimpleMailout=function(obj){var url=API.root+"api.php?endpoint=/mailout/simple/send/&id="+encodeURIComponent(obj.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Simple Mailout sent!"),obj.init(json.mailout),obj.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not send Simple Mailout.")})},API.cancelSimpleMailout=function(obj){var url=API.root+"api.php?endpoint=/mailout/simple/cancel/&id="+encodeURIComponent(obj.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Simple Mailout cancelled send!"),obj.init(json.mailout),obj.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not cancel send of Simple Mailout.")})},API.removeSimpleMailout=function(simpleMailout){var url=API.root+"api.php?endpoint=/mailout/simple/remove/&id="+encodeURIComponent(simpleMailout.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Simple Mailout removed."),impresslist.removeSimpleMailout(simpleMailout)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Simple Mailout.")})},API.addPerson=function(){var url=API.root+"api.php?endpoint=/person/add/&firstname="+encodeURIComponent("Blank")+"&surnames="+encodeURIComponent("Surname")+"&email="+encodeURIComponent("blank@blank.com")+"&twitter="+encodeURIComponent("")+"&notes="+encodeURIComponent("");console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){API.successMessage("Person added."),console.log(json);var person=new Person(json.person);impresslist.addPerson(person,!1),$(person.openSelector()).click()}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Person.")})},API.addPersonPublication=function(personObj,publicationId){var url=API.root+"api.php?endpoint=/person/add-publication/&person="+encodeURIComponent(personObj.id)+"&publication="+encodeURIComponent(publicationId);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Person publication added."),console.log(json),impresslist.addPersonPublication(new PersonPublication(json.personPublication),!1)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Person.")})},API.addPersonYoutubeChannel=function(personObj,youtubeChannelId){var url=API.root+"api.php?endpoint=/person/add-youtube-channel/&person="+encodeURIComponent(personObj.id)+"&youtubeChannel="+encodeURIComponent(youtubeChannelId);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Person Youtube Channel added."),console.log(json),impresslist.addPersonYoutubeChannel(new PersonYoutubeChannel(json.personYoutubeChannel),!1)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Person - Youtube Channel.")})},API.removePersonYoutubeChannel=function(personYoutuberObj){var url=API.root+"api.php?endpoint=/person/remove-youtube-channel/&personYoutubeChannel="+encodeURIComponent(personYoutuberObj.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Person Youtube Channel removed."),console.log(json),impresslist.removePersonYoutubeChannel(personYoutuberObj)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not removed Person Youtube Channel.")})},API.addPersonTwitchChannel=function(personObj,twitchChannelId){var url=API.root+"api.php?endpoint=/person/add-twitchchannel/&person="+encodeURIComponent(personObj.id)+"&twitchchannel="+encodeURIComponent(twitchChannelId);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Person Twitch Channel added."),console.log(json),impresslist.addPersonTwitchChannel(new PersonTwitchChannel(json.personTwitchChannel),!1)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Person - Twitch Channel.")})},API.removePersonTwitchChannel=function(personTwitchObj){var url=API.root+"api.php?endpoint=/person/remove-twitchchannel/&personTwitchChannel="+encodeURIComponent(personTwitchObj.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Person Twitch Channel removed."),console.log(json),impresslist.removePersonTwitchChannel(personTwitchObj)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not removed Person Twitch Channel.")})},API.savePersonPublication=function(personPublicationObj,email){var url=API.root+"api.php?endpoint=/person/save-publication/&personPublication="+encodeURIComponent(personPublicationObj.id)+"&email="+encodeURIComponent(email);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Person publication saved."),console.log(json),personPublicationObj.init(json.personPublication),personPublicationObj.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not save Person publication.")})},API.removePersonPublication=function(personPublicationObj){var url=API.root+"api.php?endpoint=/person/remove-publication/&personPublication="+encodeURIComponent(personPublicationObj.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Person publication removed."),console.log(json),impresslist.removePersonPublication(personPublicationObj)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not removed Person.")})},API.addPublicationCoverage=function(){var url=API.root+"api.php?endpoint=/coverage/publication/add/";console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){API.successMessage("Coverage added."),console.log(json);var coverage=new Coverage(json.coverage);impresslist.addCoverage(coverage,!1)}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Coverage.")})},API.savePublicationCoverage=function(coverage,publication,person,title,url,timestamp,thanked){url=API.root+"api.php?endpoint=/coverage/publication/save/&id="+encodeURIComponent(coverage.id)+"&publication="+encodeURIComponent(publication)+"&person="+encodeURIComponent(person)+"&title="+encodeURIComponent(title)+"&url="+encodeURIComponent(url)+"&timestamp="+encodeURIComponent(timestamp)+"&thanked="+encodeURIComponent(thanked);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Coverage saved."),console.log(json),coverage.init(json.coverage),coverage.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Coverage.")})},API.removePublicationCoverage=function(coverage){var url=API.root+"api.php?endpoint=/coverage/publication/remove/&id="+encodeURIComponent(coverage.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Coverage removed."),console.log(json),impresslist.removeCoverage(coverage)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Coverage.")})},API.addYoutuberCoverage=function(){var url=API.root+"api.php?endpoint=/coverage/youtuber/add/";console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){API.successMessage("Coverage added."),console.log(json);var coverage=new Coverage(json.coverage);impresslist.addCoverage(coverage,!1)}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Coverage.")})},API.saveYoutuberCoverage=function(coverage,youtuber,person,title,url,timestamp,thanked){url=API.root+"api.php?endpoint=/coverage/youtuber/save/&id="+encodeURIComponent(coverage.id)+"&youtuber="+encodeURIComponent(youtuber)+"&person="+encodeURIComponent(person)+"&title="+encodeURIComponent(title)+"&url="+encodeURIComponent(url)+"&timestamp="+encodeURIComponent(timestamp)+"&thanked="+encodeURIComponent(thanked);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Coverage saved."),console.log(json),coverage.init(json.coverage),coverage.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Coverage.")})},API.removeYoutuberCoverage=function(coverage){var url=API.root+"api.php?endpoint=/coverage/youtuber/remove/&id="+encodeURIComponent(coverage.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Coverage removed."),console.log(json),impresslist.removeCoverage(coverage)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Coverage.")})},API.addTwitchChannelCoverage=function(){var url=API.root+"api.php?endpoint=/coverage/twitchchannel/add/";console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){API.successMessage("Coverage added."),console.log(json);var coverage=new Coverage(json.coverage);impresslist.addCoverage(coverage,!1)}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Coverage.")})},API.saveTwitchChannelCoverage=function(coverage,twitchchannel,person,title,url,timestamp,thanked){url=API.root+"api.php?endpoint=/coverage/twitchchannel/save/&id="+encodeURIComponent(coverage.id)+"&twitchchannel="+encodeURIComponent(twitchchannel)+"&person="+encodeURIComponent(person)+"&title="+encodeURIComponent(title)+"&url="+encodeURIComponent(url)+"&timestamp="+encodeURIComponent(timestamp)+"&thanked="+encodeURIComponent(thanked);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Coverage saved."),console.log(json),coverage.init(json.coverage),coverage.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Coverage.")})},API.removeTwitchChannelCoverage=function(coverage){var url=API.root+"api.php?endpoint=/coverage/twitchchannel/remove/&id="+encodeURIComponent(coverage.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Coverage removed."),console.log(json),impresslist.removeCoverage(coverage)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Coverage.")})},API.setPersonPriority=function(person,priority,gameId){var url=API.root+"api.php?endpoint=/person/set-priority/&id="+encodeURIComponent(person.id)+"&priority="+encodeURIComponent(priority)+"&game="+encodeURIComponent(gameId);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Person priority set."),person.init(json.person),person.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not set priority on Person.")})},API.setPersonAssignment=function(person,user,gameId){var url=API.root+"api.php?endpoint=/person/set-assignment/&id="+encodeURIComponent(person.id)+"&user="+encodeURIComponent(user);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Person user-assignment set."),person.init(json.person),person.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not set user-assignment on Person.")})},API.savePerson=function(person,firstname,surnames,email,twitter,notes,country,language,tags,outofdate){var url=API.root+"api.php?endpoint=/person/save/&id="+encodeURIComponent(person.id)+"&firstname="+encodeURIComponent(firstname)+"&surnames="+encodeURIComponent(surnames)+"&email="+encodeURIComponent(email)+"&twitter="+encodeURIComponent(twitter)+"&notes="+encodeURIComponent(notes)+"&country="+encodeURIComponent(country)+"&language="+encodeURIComponent(language)+"&tags="+encodeURIComponent(tags)+"&outofdate="+encodeURIComponent(outofdate);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Person saved."),person.init(json.person),person.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not save Person.")})},API.removePerson=function(person){var url=API.root+"api.php?endpoint=/person/remove/&id="+encodeURIComponent(person.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Person removed."),impresslist.removePerson(person)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Person.")})},API.addPublication=function(){var url=API.root+"api.php?endpoint=/publication/add/&name="+encodeURIComponent("Blank");console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){API.successMessage("Publication added."),console.log(json);var publication=new Publication(json.publication);impresslist.addPublication(publication,!1),$(publication.openSelector()).click()}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Publication.")})},API.setPublicationPriority=function(publication,priority,gameId){var url=API.root+"api.php?endpoint=/publication/set-priority/&id="+encodeURIComponent(publication.id)+"&priority="+encodeURIComponent(priority)+"&game="+encodeURIComponent(gameId);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Publication priority set."),publication.init(json.publication),publication.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not set priority on Publication.")})},API.savePublication=function(publication,name,url,email,rssfeedurl,twitter,notes,country,tags){url=API.root+"api.php?endpoint=/publication/save/&id="+encodeURIComponent(publication.id)+"&name="+encodeURIComponent(name)+"&url="+encodeURIComponent(url)+"&email="+encodeURIComponent(email)+"&rssfeedurl="+encodeURIComponent(rssfeedurl)+"&twitter="+encodeURIComponent(twitter)+"&notes="+encodeURIComponent(notes)+"&country="+encodeURIComponent(country)+"&tags="+encodeURIComponent(tags);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(console.log(json),API.successMessage("Publication saved."),publication.init(json.publication),publication.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not save Publication.")})},API.removePublication=function(publication){var url=API.root+"api.php?endpoint=/publication/remove/&id="+encodeURIComponent(publication.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Publication removed."),impresslist.removePublication(publication)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Publication.")})},API.searchYouTube=function(search,order,successCallback,failCallback){var url=API.root+"api.php?endpoint=/youtuber/search-youtube/&search="+encodeURIComponent(search)+"&order="+encodeURIComponent(order);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(!json.success)return API.errorMessage(json.message),void(failCallback&&failCallback());successCallback&&successCallback(json.results)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not Search YouTube."),failCallback&&failCallback()})},API.addYoutuber=function(openImmediately,successCallback,failCallback){openImmediately=void 0===openImmediately||openImmediately;var url=API.root+"api.php?endpoint=/youtuber/add/&channel=youtube";console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(!json.success)return API.errorMessage(json.message),void(failCallback&&failCallback());API.successMessage("Youtuber added."),console.log(json);var youtuber=new Youtuber(json.youtubechannel);impresslist.addYoutuber(youtuber,!1),openImmediately&&$(youtuber.openSelector()).click(),successCallback&&successCallback(youtuber)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Youtuber."),failCallback&&failCallback()})},API.setYoutuberPriority=function(youtuber,priority,gameId){var url=API.root+"api.php?endpoint=/youtuber/set-priority/&id="+encodeURIComponent(youtuber.id)+"&priority="+encodeURIComponent(priority)+"&game="+encodeURIComponent(gameId);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(console.log(json.youtubechannel),API.successMessage("Youtuber priority set."),youtuber.init(json.youtubechannel),youtuber.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not set priority on Youtuber.")})},API.saveYoutuber=function(youtuber,channel,nameOverride,email,twitter,notes,country,tags){var url=API.root+"api.php?endpoint=/youtuber/save/&id="+encodeURIComponent(youtuber.id)+"&channel="+encodeURIComponent(channel)+"&name="+encodeURIComponent(nameOverride)+"&email="+encodeURIComponent(email)+"&twitter="+encodeURIComponent(twitter)+"&notes="+encodeURIComponent(notes)+"&country="+encodeURIComponent(country)+"&tags="+encodeURIComponent(tags);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(console.log(json),API.successMessage("Youtuber saved."),youtuber.init(json.youtubechannel),youtuber.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not save Youtuber.")})},API.removeYoutuber=function(youtuber){var url=API.root+"api.php?endpoint=/youtuber/remove/&id="+encodeURIComponent(youtuber.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Youtuber removed."),impresslist.removeYoutuber(youtuber)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Youtuber.")})},API.addTwitchChannel=function(openImmediately,successCallback,failCallback){openImmediately=void 0===openImmediately||openImmediately;var url=API.root+"api.php?endpoint=/twitchchannel/add/&channel=twitch";console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(!json.success)return API.errorMessage(json.message),void(failCallback&&failCallback());API.successMessage("Twitch Channel added."),console.log(json);var twitchchannel=new TwitchChannel(json.twitchchannel);impresslist.addTwitchChannel(twitchchannel,!1),openImmediately&&$(twitchchannel.openSelector()).click(),successCallback&&successCallback(twitchchannel)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Twitch Channel."),failCallback&&failCallback()})},API.setTwitchChannelPriority=function(twitchchannel,priority,gameId){var url=API.root+"api.php?endpoint=/twitchchannel/set-priority/&id="+encodeURIComponent(twitchchannel.id)+"&priority="+encodeURIComponent(priority)+"&game="+encodeURIComponent(gameId);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(console.log(json.twitchchannel),API.successMessage("Twitch Channel priority set."),twitchchannel.init(json.twitchchannel),twitchchannel.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not set priority on Twitch Channel.")})},API.saveTwitchChannel=function(twitchchannel,channel,email,twitter,notes,tags){var url=API.root+"api.php?endpoint=/twitchchannel/save/&id="+encodeURIComponent(twitchchannel.id)+"&channel="+encodeURIComponent(channel)+"&email="+encodeURIComponent(email)+"&twitter="+encodeURIComponent(twitter)+"&notes="+encodeURIComponent(notes)+"&tags="+encodeURIComponent(tags);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(console.log(json),API.successMessage("Twitch Channel saved."),twitchchannel.init(json.twitchchannel),twitchchannel.update()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not save Twitch Channel.")})},API.removeTwitchChannel=function(twitchchannel){var url=API.root+"api.php?endpoint=/twitchchannel/remove/&id="+encodeURIComponent(twitchchannel.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Twitch Channel removed."),impresslist.removeTwitchChannel(twitchchannel)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Twitch Channel.")})},API.userChangeIMAPSettings=function(user,smtpServer,imapServer,imapPassword){var url=API.root+"api.php?endpoint=/user/change-imap-settings/";url+="&id="+encodeURIComponent(user.id),url+="&smtpServer="+encodeURIComponent(smtpServer),url+="&imapServer="+encodeURIComponent(imapServer),url+="&imapPassword="+encodeURIComponent(imapPassword),console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?API.successMessage("IMAP settings changed."):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not change IMAP settings.")})},API.userChangeProject=function(user,newProject,onSuccess,onFail){var url=API.root+"api.php?endpoint=/user/change-project/&id="+encodeURIComponent(user.id)+"&newProject="+encodeURIComponent(newProject);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(!json.success)return API.errorMessage(json.message),void(onFail&&onFail());API.successMessage("Project changed."),onSuccess&&onSuccess()}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not change Project."),onFail&&onFail()})},API.userChangePassword=function(user,currentPassword,newPassword){var url=API.root+"api.php?endpoint=/user/change-password/&id="+encodeURIComponent(user.id)+"&currentPassword="+encodeURIComponent(currentPassword)+"&newPassword="+encodeURIComponent(newPassword);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?API.successMessage("Password changed."):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not change Password.")})},API.userChangeAudience=function(user,audience,successFunc){var url=API.root+"api.php?endpoint=/user/change-audience/&id="+encodeURIComponent(user.id)+"&audience="+encodeURIComponent(audience);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Audience changed."),successFunc&&successFunc()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not change Audience.")})},API.queryOAuthFacebookPages=function(callbackFunction){var url=API.root+"api.php?endpoint=/social/account/facebook-page/query/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?callbackFunction(json.facebookpages):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not query Facebook Pages.")})},API.listOAuthFacebookPages=function(fromInit){void 0===fromInit&&(fromInit=!0);var url=API.root+"api.php?endpoint=/social/account/facebook-page/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.facebookpages.length;++i){var acc=new OAuthFacebookPage(json.facebookpages[i]);impresslist.addOAuthFacebookPage(acc,!1)}fromInit&&impresslist.loading.onCategoryItemLoaded("social")}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list Facebook Pages.")})},API.addOAuthFacebookPage=function(page_id,page_name,page_accessToken,page_image,callbackFunction){var url=API.root+"api.php?endpoint=/social/account/facebook-page/add/&page_id="+encodeURIComponent(page_id)+"&page_name="+encodeURIComponent(page_name)+"&page_accessToken="+encodeURIComponent(page_accessToken)+"&page_image="+encodeURIComponent(page_image);$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){if(void 0===json.updated){API.successMessage("Facebook Page added."),console.log(json);var fbpage=new OAuthFacebookPage(json.facebookpage);impresslist.addOAuthFacebookPage(fbpage,!1)}else{API.successMessage("Facebook Page updated."),console.log(json),(fbpage=impresslist.findOAuthFacebookPageById(json.facebookpage.id)).init(json.facebookpage),$("#social-homepage-twitteracc-list-none").hide()}void 0!==callbackFunction&&callbackFunction(json)}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Facebook Page.")})},API.removeOAuthFacebookPage=function(acc){var url=API.root+"api.php?endpoint=/social/account/facebook-page/remove/&id="+encodeURIComponent(acc.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Faceobok Page removed."),impresslist.removeOAuthFacebookPage(acc)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Facebook Account.")})},API.listOAuthFacebookAccounts=function(fromInit){void 0===fromInit&&(fromInit=!0);var url=API.root+"api.php?endpoint=/social/account/facebook/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.facebookaccs.length;++i){var twacc=new OAuthFacebookAccount(json.facebookaccs[i]);impresslist.addOAuthFacebookAccount(twacc,fromInit)}$("#social-homepage-facebookacc-list-loading").hide(),0==json.facebookaccs.length&&$("#social-homepage-facebookacc-list-none").show(),fromInit&&impresslist.loading.onCategoryItemLoaded("social")}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list OAuth Facebook Accounts.")})},API.removeOAuthFacebookAccount=function(acc){var url=API.root+"api.php?endpoint=/social/account/facebook/remove/&id="+encodeURIComponent(acc.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Faceobok Account removed."),impresslist.removeOAuthFacebookAccount(acc)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Facebook Account.")})},API.listOAuthTwitterAccounts=function(fromInit){void 0===fromInit&&(fromInit=!0);var url=API.root+"api.php?endpoint=/social/account/twitter/list/";$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){for(var i=0;i<json.twitteraccs.length;++i){var twacc=new OAuthTwitterAccount(json.twitteraccs[i]);impresslist.addOAuthTwitterAccount(twacc,fromInit)}$("#social-homepage-twitteracc-list-loading").hide(),0==json.twitteraccs.length&&$("#social-homepage-twitteracc-list-none").show(),fromInit&&impresslist.loading.onCategoryItemLoaded("social")}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not list OAuth Twitter Accounts.")})},API.addOAuthTwitterAccount=function(request_token,request_token_secret,pin){var url=API.root+"api.php?endpoint=/social/account/twitter/add/&request_token="+encodeURIComponent(request_token)+"&request_token_secret="+encodeURIComponent(request_token_secret)+"&pin="+encodeURIComponent(pin);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success)if(void 0===json.updated){API.successMessage("Twitter Account added."),console.log(json);var oauthtwitter=new OAuthTwitterAccount(json.twitteracc);impresslist.addOAuthTwitterAccount(oauthtwitter,!1)}else{API.successMessage("Twitter Account updated."),console.log(json),(oauthtwitter=impresslist.findOAuthTwitterAccountById(json.twitteracc.id)).init(json.twitteracc),$("#social-homepage-twitteracc-list-none").hide()}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Twitter Account.")})},API.removeOAuthTwitterAccount=function(acc){var url=API.root+"api.php?endpoint=/social/account/twitter/remove/&id="+encodeURIComponent(acc.id);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Twitter Account removed."),impresslist.removeOAuthTwitterAccount(acc)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove Twitter Account.")})},API.getOAuthTwitterAccountInactiveFollowings=function(handle,years,successCallback,errorCallback){var url=API.root+"api.php?endpoint=/social/account/twitter/tools/inactive-followings/&handle="+encodeURIComponent(handle)+"&years="+years;$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?successCallback&&successCallback(json):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not get OAuth Twitter Accounts Inactive Followings."),errorCallback&&errorCallback()})},API.getOAuthTwitterAccountUnrequitedFollowings=function(handle,successCallback,errorCallback){var url=API.root+"api.php?endpoint=/social/account/twitter/tools/unrequited-followings/&handle="+encodeURIComponent(handle);$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?successCallback&&successCallback(json):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not get OAuth Twitter Accounts Unrequited Followings."),errorCallback&&errorCallback()})},API.doOAuthTwitterAccountUnfollow=function(fromId,handle,successCallback,errorCallback){var url=API.root+"api.php?endpoint=/social/account/twitter/tools/unfollow/&id="+encodeURIComponent(fromId)+"&handle="+encodeURIComponent(handle);$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("Unfollow successful."),successCallback&&successCallback(json)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not unfollow Twitter Account."),errorCallback&&errorCallback()})},API.sqlQuery=function(query){var url=API.root+"api.php?endpoint=/admin/sql-query/&query="+encodeURIComponent(query);console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?API.successMessage("Query successful."):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not execute query.")})},API.addUser=function(){var url=API.root+"api.php?endpoint=/admin/user/add/";console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){API.successMessage("User added."),console.log(json);var user=new User(json.user);impresslist.addUser(user,!1)}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add User.")})},API.saveUser=function(user,forename,surname,email,color,admin,successCallback){var url=API.root+"api.php?endpoint=/admin/user/save/";url+="&id="+encodeURIComponent(user.id),url+="&forename="+encodeURIComponent(forename),url+="&surname="+encodeURIComponent(surname),url+="&email="+encodeURIComponent(email),url+="&color="+encodeURIComponent(color),url+="&admin="+encodeURIComponent(admin),console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("User saved."),console.log(json),console.log(json),user.init(json.user),user.update(),void 0!==successCallback&&successCallback()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not save User.")})},API.removeUser=function(user){var url=API.root+"api.php?endpoint=/admin/user/remove/";url+="&id="+encodeURIComponent(user.id),console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("User removed."),impresslist.removeUser(user)):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not remove User.")})},API.saveUserPassword=function(user,password1,password2,successCallback){var url=API.root+"api.php?endpoint=/admin/user/change-password/";url+="&id="+encodeURIComponent(user.id),url+="&password1="+encodeURIComponent(password1),url+="&password2="+encodeURIComponent(password2),console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage("User password changed."),void 0!==successCallback&&successCallback()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not change User password.")})},API.addCompany=function(){var url=API.root+"api.php?endpoint=/superadmin/company/add/";console.log(url),$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);if(json.success){API.successMessage("Company added."),console.log(json);var company=new Company(json.company);impresslist.addCompany(company,!1)}else API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage("Could not add Company.")})},API.saveCompany=function(companyObj,name,keywords,email,twitter,facebook,discord_enabled,discord_webhookId,discord_webhookToken,successCallback,failCallback){var url=API.root+"api.php?endpoint=/superadmin/company/save/";url+="&id="+encodeURIComponent(companyObj.id),url+="&name="+encodeURIComponent(name),url+="&keywords="+encodeURIComponent(keywords),url+="&email="+encodeURIComponent(email),url+="&twitter="+encodeURIComponent(twitter),url+="&facebook="+encodeURIComponent(facebook),url+="&discord_enabled="+encodeURIComponent(discord_enabled),url+="&discord_webhookId="+encodeURIComponent(discord_webhookId),url+="&discord_webhookToken="+encodeURIComponent(discord_webhookToken),API._companyRequest(companyObj,url,"Company saved!","Could not save Company.",successCallback,failCallback)},API.addCompanyGame=function(companyObj,successCallback,failCallback){var url=API.root+"api.php?endpoint=/superadmin/company/game/add/&company="+encodeURIComponent(companyObj.id);API._companyRequest(companyObj,url,"Added game - you must now edit!","Could not add Game.",successCallback,failCallback)},API.removeCompanyGame=function(companyObj,gameId,successCallback,failCallback){var url=API.root+"api.php?endpoint=/superadmin/company/game/remove/&company="+encodeURIComponent(companyObj.id)+"&game="+encodeURIComponent(gameId);API._companyRequest(companyObj,url,"Removed game successfully!","Could not remove Game.",successCallback,failCallback)},API.saveCompanyGame=function(companyObj,gameId,name,keywords,blackwords,twitchId,successCallback,failCallback){var url=API.root+"api.php?endpoint=/superadmin/company/game/save/";url+="&company="+encodeURIComponent(companyObj.id),url+="&game="+encodeURIComponent(gameId),url+="&name="+encodeURIComponent(name),url+="&keywords="+encodeURIComponent(keywords),url+="&blackwords="+encodeURIComponent(blackwords),url+="&twitchId="+encodeURIComponent(twitchId),API._companyRequest(companyObj,url,"Game saved!","Could not save Game.",successCallback,failCallback)},API.testDiscordWebhook=function(companyId){$.ajax(API.root+"api.php?endpoint=/superadmin/company/webhook/discord/test/&company="+encodeURIComponent(companyId))},API._companyRequest=function(companyObj,url,successMessage,failMessage,successCallback,failCallback){$.ajax(url).done(function(result){if("{"==result.substr(0,1)){var json=JSON.parse(result);json.success?(API.successMessage(successMessage),companyObj.init(json.company),companyObj.update(),successCallback&&successCallback()):API.errorMessage(json.message)}else API.errorMessage(result)}).fail(function(){API.errorMessage(failMessage),failCallback&&failCallback()})},API.request=function(endpoint,data,successCallback,failCallback){var url=API.root+"api.php?endpoint="+encodeURIComponent(endpoint);for(var field in data)url+="&"+field+"="+encodeURIComponent(data[field]);console.log(url),$.ajax(url).done(function(result){if("{"!=result.substr(0,1))return API.errorMessage(result),void failCallback();var json=JSON.parse(result);if(!json.success)return API.errorMessage(json.message),void failCallback();successCallback(json)}).fail(function(){failCallback()})},API.successMessage=function(message){$.bootstrapGrowl(message,{type:"success",offset:{from:"top",amount:70},align:"center",delay:2e3})},API.infoMessage=function(message){$.bootstrapGrowl(message,{type:"info",offset:{from:"top",amount:70},align:"center",delay:5e3})},API.errorMessage=function(message){$.bootstrapGrowl(message,{type:"danger",offset:{from:"top",amount:70},align:"center",delay:1e4})};
//# sourceMappingURL=compiled.all.min.map