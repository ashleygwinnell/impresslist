angular.module("App",["ui.router","App.Api","App.Filters","App.Shell","App.Model","App.Person","App.Publication","App.Priority","App.User","App.Views"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,o){e.state("home",{url:"home/",templateUrl:"app/views/index/index.template.html"}),e.state("login",{url:"login/",templateUrl:"app/views/login/login.template.html"}),e.state("home.people",{url:"people/"}),e.state("home.publications",{url:"publications/"}),e.state("home.youtubers",{url:"youtubers/"}),e.state("home.chat",{url:"chat/"}),e.state("home.jobs",{url:"jobs/"}),e.state("home.people.person",{url:":id/",onEnter:["$state","$stateParams","App","PersonModal",function(e,t,o,r){var n=o.people[t.id];console.log(n),r.open(n)}],resolve:{}}),e.state("admin",{url:"admin/"})}]).run(["$rootScope","$log","$state","$timeout","App",function(e,t,o,r,n){e.$log=t,e.App=n,r(function(){e.App.start()})}]).filter("priority",function(){return function(e){return 0==e?"N/A":1==e?"Low":2==e?"Medium":"3"==e?"High":"-"}}).filter("relativetime",function(){return function(e){return impresslist.util.relativetime_contact(e)}}),angular.module("App").controller("AppController",["$scope","$compile","App",function(e,t,o){e.App=o}]),angular.module("App").service("App",["$rootScope","$state","$location","$stateParams","$timeout","Api","User","Person","Publication","PersonModal",function(e,t,o,r,n,i,l,a,s,p){var u=this;this.user=null,this.people=[],this.publications=[],this.users=[],this.config={system:{email:"email"},user:{gmail:"gmail"}},this.name="impress[]",this.description="A service to help you impress people.",this.start=function(){i.request("/auth/check/").then(function(e){e.success?(t.go("home"),u.user=l.populate(e.user)[0],u.load()):t.go("login")})},this.load=function(){i.request("/person/list/").then(function(e){u.people=a.populateKeyed(e.people,"id")}),i.request("/publication/list/").then(function(e){u.publications=s.populateKeyed(e.publications,"id")}),i.request("/user/list/").then(function(e){u.users=l.populateKeyed(e.users,"id")})},this.parts=[""],this.part=function(e){return u.parts[e]||!1},this.updateParts=function(e){u.parts=e.split(".")},e.$on("$stateChangeStart",function(e,t,o,r,n,i){u.updateParts(t.name)})}]),angular.module("App.Api",[]),angular.module("App.Api").factory("ApiResponseTransformer",function(){return function(e){return JSON.parse(e)}}),angular.module("App.Api").service("Api",["$http","$q","ApiResponseTransformer",function(e,t,o){this.request=function(r,n){console.log("Api.request - "+r),n&&console.log(n);var i=t.defer();return e({method:"POST",url:"backend/api.php?endpoint="+r,transformResponse:o,data:n}).success(function(e){i.resolve(e)}),i.promise}}]),angular.module("App.Filters",[]),angular.module("App.Filters").service("Filters",["$rootScope","$state",function(e,t){this.searchText="",this.recentContact=!1,this.highPriority=!1,this.personalContact=!1,this.emailAttached=!1,this.assignedSelf=!1,this.outOfDate=!1}]),angular.module("App.Filters").directive("impressFilters",function(){return{restrict:"E",templateUrl:"app/components/filters/filters.template.html"}}),angular.module("App.Filters").controller("FiltersController",["$scope","$http","$location","App","Filters",function(e,t,o,r,n){e.Filters=n}]),angular.module("App.Model",[]),angular.module("App.Model").factory("Model",["$rootScope","$state",function(e,t){var o={};return o.create=function(t){return t.prototype.initPriorities=function(t){var o=this.field(t);if("undefined"==typeof o||0==o.length)return void(this["priority_"+e.App.user.game]=0);for(var r=o.split(","),n=0;n<r.length;++n){var i=r[n].split("="),l=i[0],a=i[1];this["priority_"+l]=a}},t.prototype.priority=function(){var t=this["priority_"+e.App.user.game];return"undefined"==typeof t?0:t},t.prototype.onAdded=function(){},t.prototype.onRemoved=function(){},t.prototype.field=function(e){var t=this[e];return null==t?(console.error("field "+e+" was null."),console.error(this.fields),""):t},t.populateKeyed=function(e,o){var r={};if(e&&angular.isArray(e)&&e.length)for(var n=0;n<e.length;++n)r[e[n][o]]=new t(e[n]);else e&&angular.isObject(e)&&(r[e[o]]=new t(e));return r},t.populate=function(e){var o=[];if(e&&angular.isArray(e)&&e.length)for(var r=0;r<e.length;++r)o.push(new t(e[r]));else e&&angular.isObject(e)&&o.push(new t(e));return o},t},o}]),angular.module("App.Person",[]),angular.module("App.Person").directive("impressPersonRow",["PersonModal",function(e){return{restrict:"A",templateUrl:"app/components/person/row.template.html",link:function(e,t,o){}}}]),angular.module("App.Person").factory("Person",["$rootScope","$state","$compile","Model","Filters","PersonModal",function(e,t,o,r,n,i){function l(e){angular.extend(this,r),e&&angular.extend(this,e),this.twitter_followers_formatted=new Number(e.twitter_followers).toLocaleString(),this.modal=i}return l.prototype.testFunction=function(){},l.prototype.fullname=function(){return this.firstname+" "+this.surnames},l.prototype.search=function(e){var t=!0;return 0==e.length?t:(t=-1!=this.fullname().toLowerCase().indexOf(e))?t:(t=-1!=this.notes.toLowerCase().indexOf(e))?t:(t=-1!=this.email.toLowerCase().indexOf(e),t?t:!1)},l.prototype.visible=function(){return n.searchText.length>0&&!this.search(n.searchText)?!1:n.recentContact&&Number(this.lastcontacted)<Date.now()/1e3-604800?!1:n.highPriority&&this.priority()<3?!1:n.emailAttached&&0==this.email.length?!1:n.assignedSelf&&this.assigned!=e.App.user.id?!1:n.outOfDate&&0==this.outofdate?!1:!n.personalContact||null!=this.lastcontactedby_me},r.create(l)}]).filter("personArrayFilter",function(){return function(e){var t={};return angular.forEach(e,function(e){e.visible()&&(t[e.id]=e)}),t}}),angular.module("App.Person").service("PersonModal",["$rootScope",function(e){var t={person:null,open:function(o){t.person=o,e.$broadcast("PersonModal.open",o),$(".person_modal").modal({show:!0})},close:function(){$(".person_modal").modal("hide")},emailClientLink:function(e){return impresslist.util.mailtoClient(defaultEmail,emailSubject,emailBody,emailBCC)},emailGmailLink:function(e){return impresslist.util.mailtoGmail(defaultEmail,emailSubject,emailBody,emailBCC,emailGmailIndex)}};return t}]).filter("emailArrayFilter",function(){return function(e){var t=[];return angular.forEach(e,function(e){e.email.length>0&&t.push(e)}),t}}),angular.module("App.Person").controller("PersonModalController",["$scope","PersonModal",function(e,t){e.$on("PersonModal.open",function(o){e.person=t.person}),e.person=t.person}]),angular.module("App.Priority",[]),angular.module("App.Priority").directive("impressPriorityName",function(){return{restrict:"A",scope:{priority:"@"},controller:["$scope","$element",function(e,t){e.name=t.attr("priority")}],template:"<td>{{ $scope.name }}</td>"}}),angular.module("App.Publication",[]),angular.module("App.Publication").factory("Publication",["$rootScope","$state","Model","Filters",function(e,t,o,r){function n(e){angular.extend(this,o),e&&angular.extend(this,e),this.twitter_followers_formatted=new Number(e.twitter_followers).toLocaleString()}return n.prototype.open=function(){console.log("open")},n.prototype.search=function(e){var t=!0;return 0==e.length?t:(t=-1!=this.name.toLowerCase().indexOf(e))?t:(t=-1!=this.notes.toLowerCase().indexOf(e),t?t:!1)},n.prototype.visible=function(){return r.searchText.length>0&&!this.search(r.searchText)?!1:r.recentContact&&Number(this.lastcontacted)<Date.now()/1e3-604800?!1:r.highPriority&&this.priority()<3?!1:r.emailAttached&&0==this.email.length?!1:r.assignedSelf&&this.assigned!=e.App.user.id?!1:r.outOfDate&&0==this.outofdate?!1:!r.personalContact||null!=this.lastcontactedby_me},o.create(n)}]).filter("publicationArrayFilter",function(){return function(e){var t=[];return angular.forEach(e,function(e){e.visible()&&t.push(e)}),t}}),angular.module("App.Shell",[]),angular.module("App.Shell").directive("impressFooter",function(){return{restrict:"E",templateUrl:"app/components/shell/footer/footer.template.html"}}),angular.module("App.Shell").directive("impressNav",function(){return{restrict:"E",templateUrl:"app/components/shell/nav/nav.template.html"}}),angular.module("App.Shell").controller("NavController",["$scope","$http","$location","App","Filters",function(e,t,o,r,n){e.Filters=n}]),angular.module("App.User",[]),angular.module("App.User").factory("User",["$rootScope","$state","Model",function(e,t,o){function r(e){e&&angular.extend(this,e)}return r.prototype.testFunction=function(){},r.prototype.fullname=function(){return this.forename+" "+this.surname},o.create(r)}]),angular.module("App.Views",[]),angular.module("App.Views").controller("LoginController",["$scope","$state","App","Api","User",function(e,t,o,r,n){e.App=o,e.Api=r,e.errors=[],e.login=function(e,i){r.request("/auth/login/",{email:e,password:i}).then(function(e){o.user=n.populate(e.data.user)[0],o.load(),console.log(o.user),t.go("home")})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImFwcC5jb250cm9sbGVyLmpzIiwiYXBwLnNlcnZpY2UuanMiLCJhcGkuanMiLCJyZXNwb25zZS10cmFuc2Zvcm1lci5mYWN0b3J5LmpzIiwiYXBpLnNlcnZpY2UuanMiLCJmaWx0ZXJzLmpzIiwiZmlsdGVycy5zZXJ2aWNlLmpzIiwiZmlsdGVycy5kaXJlY3RpdmUuanMiLCJmaWx0ZXJzLmNvbnRyb2xsZXIuanMiLCJtb2RlbC5qcyIsIm1vZGVsLmZhY3RvcnkuanMiLCJwZXJzb24uanMiLCJyb3cuZGlyZWN0aXZlLmpzIiwicGVyc29uLmZhY3RvcnkuanMiLCJtb2RhbC5zZXJ2aWNlLmpzIiwibW9kYWwuY29udHJvbGxlci5qcyIsInByaW9yaXR5LmpzIiwicHJpb3JpdHktbmFtZS5kaXJlY3RpdmUuanMiLCJwdWJsaWNhdGlvbi5qcyIsInB1YmxpY2F0aW9uLmZhY3RvcnkuanMiLCJzaGVsbC5qcyIsImZvb3Rlci5kaXJlY3RpdmUuanMiLCJuYXYuZGlyZWN0aXZlLmpzIiwibmF2LmNvbnRyb2xsZXIuanMiLCJ1c2VyLmpzIiwidXNlci5mYWN0b3J5LmpzIiwidmlld3MuanMiLCJsb2dpbi5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsIm9uRW50ZXIiLCIkc3RhdGUiLCIkc3RhdGVQYXJhbXMiLCJBcHAiLCJQZXJzb25Nb2RhbCIsInBlcnNvbiIsInBlb3BsZSIsImlkIiwiY29uc29sZSIsImxvZyIsIm9wZW4iLCJyZXNvbHZlIiwicnVuIiwiJHJvb3RTY29wZSIsIiRsb2ciLCIkdGltZW91dCIsInN0YXJ0IiwiZmlsdGVyIiwidiIsImltcHJlc3NsaXN0IiwidXRpbCIsInJlbGF0aXZldGltZV9jb250YWN0IiwiY29udHJvbGxlciIsIiRzY29wZSIsIiRjb21waWxlIiwic2VydmljZSIsIiRsb2NhdGlvbiIsIkFwaSIsIlVzZXIiLCJQZXJzb24iLCJQdWJsaWNhdGlvbiIsInRoIiwidGhpcyIsInVzZXIiLCJwdWJsaWNhdGlvbnMiLCJ1c2VycyIsInN5c3RlbSIsImVtYWlsIiwiZ21haWwiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJyZXF1ZXN0IiwidGhlbiIsImRhdGEiLCJzdWNjZXNzIiwiZ28iLCJwb3B1bGF0ZSIsImxvYWQiLCJwb3B1bGF0ZUtleWVkIiwicGFydHMiLCJwYXJ0IiwiaW5kZXgiLCJ1cGRhdGVQYXJ0cyIsInN0ciIsInNwbGl0IiwiJG9uIiwiZXZlbnQiLCJ0b1N0YXRlIiwidG9QYXJhbXMiLCJmcm9tU3RhdGUiLCJmcm9tUGFyYW1zIiwib3B0aW9ucyIsImZhY3RvcnkiLCJKU09OIiwicGFyc2UiLCIkaHR0cCIsIiRxIiwiQXBpUmVzcG9uc2VUcmFuc2Zvcm1lciIsImVuZHBvaW50IiwiZGVmZXJyZWQiLCJkZWZlciIsIm1ldGhvZCIsInRyYW5zZm9ybVJlc3BvbnNlIiwicHJvbWlzZSIsInNlYXJjaFRleHQiLCJyZWNlbnRDb250YWN0IiwiaGlnaFByaW9yaXR5IiwicGVyc29uYWxDb250YWN0IiwiZW1haWxBdHRhY2hlZCIsImFzc2lnbmVkU2VsZiIsIm91dE9mRGF0ZSIsImRpcmVjdGl2ZSIsInJlc3RyaWN0IiwiRmlsdGVycyIsIk1vZGVsIiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJwcm90b3R5cGUiLCJpbml0UHJpb3JpdGllcyIsImZpZWxkIiwidHh0IiwibGVuZ3RoIiwiZ2FtZSIsInByaXMiLCJpIiwiYml0cyIsImdhbWVfaWQiLCJnYW1lX3ByaW9yaXR5IiwicHJpb3JpdHkiLCJyZXQiLCJvbkFkZGVkIiwib25SZW1vdmVkIiwiZiIsInIiLCJlcnJvciIsImZpZWxkcyIsInJvd3MiLCJrZXkiLCJtb2RlbHMiLCJpc0FycmF5IiwiaXNPYmplY3QiLCJwdXNoIiwibGluayIsInNjb3BlIiwiZWxlbWVudCIsImF0dHJzIiwiZXh0ZW5kIiwidHdpdHRlcl9mb2xsb3dlcnNfZm9ybWF0dGVkIiwiTnVtYmVyIiwidHdpdHRlcl9mb2xsb3dlcnMiLCJ0b0xvY2FsZVN0cmluZyIsIm1vZGFsIiwidGVzdEZ1bmN0aW9uIiwiZnVsbG5hbWUiLCJzZWFyY2giLCJ0ZXh0IiwidG9Mb3dlckNhc2UiLCJpbmRleE9mIiwidmlzaWJsZSIsIkRhdGUiLCJub3ciLCJsYXN0Y29udGFjdGVkYnlfbWUiLCJpbnB1dCIsIm91dCIsImZvckVhY2giLCIkYnJvYWRjYXN0IiwiJCIsInNob3ciLCJjbG9zZSIsImVtYWlsQ2xpZW50TGluayIsIm1haWx0b0NsaWVudCIsImRlZmF1bHRFbWFpbCIsImVtYWlsU3ViamVjdCIsImVtYWlsQm9keSIsImVtYWlsQkNDIiwiZW1haWxHbWFpbExpbmsiLCJtYWlsdG9HbWFpbCIsImVtYWlsR21haWxJbmRleCIsIiRlbGVtZW50IiwiYXR0ciIsInRlbXBsYXRlIiwicHVibGljYXRpb24iLCJlcnJvcnMiLCJsb2dpbiIsInBhc3N3b3JkIl0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBQUMsT0FBQSxPQUNBLFlBQ0EsVUFDQSxjQUNBLFlBQ0EsWUFDQSxhQUNBLGtCQUNBLGVBQ0EsV0FDQSxjQUdBQyxRQUFBLGlCQUFBLHFCQUFBLG9CQUNBLFNBQUFDLEVBQUFDLEVBQUFDLEdBRUFGLEVBQUFHLE1BQUEsUUFBQUMsSUFBQSxRQUFBQyxZQUFBLHdDQUNBTCxFQUFBRyxNQUFBLFNBQUFDLElBQUEsU0FBQUMsWUFBQSx3Q0FFQUwsRUFBQUcsTUFBQSxlQUFBQyxJQUFBLFlBQ0FKLEVBQUFHLE1BQUEscUJBQUFDLElBQUEsa0JBQ0FKLEVBQUFHLE1BQUEsa0JBQUFDLElBQUEsZUFDQUosRUFBQUcsTUFBQSxhQUFBQyxJQUFBLFVBQ0FKLEVBQUFHLE1BQUEsYUFBQUMsSUFBQSxVQUVBSixFQUFBRyxNQUFBLHNCQUNBQyxJQUFBLE9BQ0FFLFNBQUEsU0FBQSxlQUFBLE1BQUEsY0FBQSxTQUFBQyxFQUFBQyxF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U0FBQUgsRUFBQUEsS0FBQVYsTUFBQSxHQUNBOUIsRUFBQTRDLE9BQ0F2QyxRQUFBQyxJQUFBTixFQUFBOEIsTUFDQWhDLEVBQUE0QyxHQUFBIiwiZmlsZSI6ImltcHJlc3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZShcIkFwcFwiLCBbXHJcblx0J3VpLnJvdXRlcicsXHJcblx0J0FwcC5BcGknLFxyXG5cdCdBcHAuRmlsdGVycycsXHJcblx0J0FwcC5TaGVsbCcsXHJcblx0J0FwcC5Nb2RlbCcsXHJcblx0J0FwcC5QZXJzb24nLFxyXG5cdCdBcHAuUHVibGljYXRpb24nLFxyXG5cdCdBcHAuUHJpb3JpdHknLFxyXG5cdCdBcHAuVXNlcicsXHJcblx0J0FwcC5WaWV3cycsXHJcbl0pXHJcblxyXG4uY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJyxcclxuXHRcdGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XHJcblxyXG5cdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdob21lJywgeyB1cmw6ICdob21lLycsIHRlbXBsYXRlVXJsOiAnYXBwL3ZpZXdzL2luZGV4L2luZGV4LnRlbXBsYXRlLmh0bWwnIH0pO1xyXG5cdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdsb2dpbicsIHsgdXJsOiAnbG9naW4vJywgdGVtcGxhdGVVcmw6ICdhcHAvdmlld3MvbG9naW4vbG9naW4udGVtcGxhdGUuaHRtbCcgfSk7XHJcblxyXG5cdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdob21lLnBlb3BsZScsIHsgdXJsOiAncGVvcGxlLycgfSk7XHJcblx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2hvbWUucHVibGljYXRpb25zJywgeyB1cmw6ICdwdWJsaWNhdGlvbnMvJyB9KTtcclxuXHQkc3RhdGVQcm92aWRlci5zdGF0ZSgnaG9tZS55b3V0dWJlcnMnLCB7IHVybDogJ3lvdXR1YmVycy8nIH0pO1xyXG5cdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdob21lLmNoYXQnLCB7IHVybDogJ2NoYXQvJyB9KTtcclxuXHQkc3RhdGVQcm92aWRlci5zdGF0ZSgnaG9tZS5qb2JzJywgeyB1cmw6ICdqb2JzLycgfSk7XHJcblxyXG5cdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdob21lLnBlb3BsZS5wZXJzb24nLCB7XHJcblx0XHR1cmw6ICc6aWQvJyxcclxuXHRcdG9uRW50ZXI6IFsnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICdBcHAnLCAnUGVyc29uTW9kYWwnLCBmdW5jdGlvbigkc3RhdGUsICRzdGF0ZVBhcmFtcywgQXBwLCBQZXJzb25Nb2RhbCkge1xyXG5cdFx0XHR2YXIgcGVyc29uID0gQXBwLnBlb3BsZVskc3RhdGVQYXJhbXMuaWRdO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhwZXJzb24pO1xyXG5cdFx0XHRQZXJzb25Nb2RhbC5vcGVuKHBlcnNvbik7XHJcblx0XHR9XSxcclxuXHRcdHJlc29sdmU6IHtcclxuXHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdhZG1pbicsIHsgdXJsOiAnYWRtaW4vJyB9KTtcclxuXHJcbn1dKVxyXG5cclxuLnJ1bihbJyRyb290U2NvcGUnLCAnJGxvZycsICckc3RhdGUnLCAnJHRpbWVvdXQnLCAnQXBwJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJGxvZywgJHN0YXRlLCAkdGltZW91dCwgQXBwKSB7XHJcblx0JHJvb3RTY29wZS4kbG9nID0gJGxvZztcclxuXHQkcm9vdFNjb3BlLkFwcCA9IEFwcDtcclxuXHJcblx0JHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHQkcm9vdFNjb3BlLkFwcC5zdGFydCgpO1xyXG5cdH0pO1xyXG59XSlcclxuLypcclxuLmRpcmVjdGl2ZSgnaW1wcmVzc1Nob3cnLCBmdW5jdGlvbigpe1xyXG5cdHJldHVybiB7XHJcblx0XHRyZXN0cmljdDogXCJBXCIsXHJcblx0XHR0cmFuc2NsdWRlOiB0cnVlLFxyXG5cdFx0dGVtcGxhdGU6ICc8ZGl2IG5nLXRyYW5zY2x1ZGUgbmctc2hvdz1cInZpc1wiPjwvZGl2PicsXHJcblx0XHRzY29wZToge1xyXG5cdFx0XHRpbXByZXNzU2hvdzogJ0AnXHJcblx0XHR9LFxyXG5cdFx0Y29udHJvbGxlcjogWyckc2NvcGUnLCAnQXBwJywgZnVuY3Rpb24oJHNjb3BlLCBBcHApIHtcclxuXHRcdFx0JHNjb3BlLkFwcCA9IEFwcDtcclxuXHRcdFx0Ly8gJHNjb3BlLnZpcyA9IGZhbHNlO1xyXG5cdCAgLy8gICBcdCRzY29wZS4kd2F0Y2goJHNjb3BlLkFwcC5wYXJ0cywgZnVuY3Rpb24odmFsdWUpIHtcclxuXHRcdCAvLyAgICBcdGNvbnNvbGUubG9nKCAnbGluayBpbXByZWVzcyBzaG93JyApO1xyXG5cdFx0IC8vICAgIFx0Y29uc29sZS5sb2coIGF0dHIuaW1wcmVzc1Nob3cgKTtcclxuXHRcdCAvLyAgICBcdGNvbnNvbGUubG9nKCB2YWx1ZSApO1xyXG5cdFx0IC8vICAgIFx0Y29uc29sZS5sb2coIHNjb3BlLkFwcC5wYXJ0cyApO1xyXG5cdFx0IC8vICAgIFx0Ly9BcHAucGFydHNbMF0gPT0gJ2hvbWUnXHJcblxyXG5cdFx0IC8vICAgIFx0JHNjb3BlLnZpcyA9IGF0dHIuaW1wcmVzc1Nob3cgPT0gdmFsdWVbMF07XHJcblxyXG5cdFx0IC8vICAgIH0pO1xyXG5cdFx0fV0sXHJcblx0ICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XHJcblx0ICAgIFx0Ly9jb25zb2xlLmxvZygnd2hhdCcpO1xyXG5cdCAgICBcdC8vY29uc29sZS5sb2coY3RybCk7XHJcblx0ICAgIH1cclxuXHR9XHJcbn0pKi9cclxuXHJcbi5maWx0ZXIoJ3ByaW9yaXR5JywgZnVuY3Rpb24oKXtcclxuXHRyZXR1cm4gZnVuY3Rpb24odikge1xyXG5cdFx0aWYgKHYgPT0gMCkge1xyXG5cdFx0XHRyZXR1cm4gXCJOL0FcIjtcclxuXHRcdH0gZWxzZSBpZiAodiA9PSAxKSB7XHJcblx0XHRcdHJldHVybiBcIkxvd1wiO1xyXG5cdFx0fSBlbHNlIGlmICh2ID09IDIpIHtcclxuXHRcdFx0cmV0dXJuIFwiTWVkaXVtXCI7XHJcblx0XHR9IGVsc2UgaWYgKHYgPT0gXCIzXCIpIHtcclxuXHRcdFx0cmV0dXJuIFwiSGlnaFwiO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIFwiLVwiO1xyXG5cdH1cclxufSlcclxuXHJcbi5maWx0ZXIoJ3JlbGF0aXZldGltZScsIGZ1bmN0aW9uKCkge1xyXG5cdHJldHVybiBmdW5jdGlvbih2KSB7XHJcblx0XHRyZXR1cm4gaW1wcmVzc2xpc3QudXRpbC5yZWxhdGl2ZXRpbWVfY29udGFjdCh2KTtcclxuXHR9XHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZShcIkFwcFwiKVxyXG5cclxuLmNvbnRyb2xsZXIoXCJBcHBDb250cm9sbGVyXCIsIFsnJHNjb3BlJywgJyRjb21waWxlJywgJ0FwcCcsIGZ1bmN0aW9uKCRzY29wZSwgJGNvbXBpbGUsIEFwcCkge1xyXG5cclxuXHQkc2NvcGUuQXBwID0gQXBwO1xyXG5cclxufV0pO1xyXG5cclxuLypcclxuLmRpcmVjdGl2ZShcImR1bWJQYXNzd29yZFwiLCBmdW5jdGlvbigpIHtcclxuXHR2YXIgdmFsaWRFbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KFwiPGRpdj57e21vZGVsLmlucHV0fX08L2Rpdj5cIik7XHJcblxyXG5cdHRoaXMubGluayA9IGZ1bmN0aW9uKHNjb3BlKSB7XHJcblx0XHRzY29wZS4kd2F0Y2goXCJtb2RlbC5pbnB1dFwiLCBmdW5jdGlvbiAodmFsdWUpIHtcclxuXHRcdFx0aWYgKHZhbHVlID09PSBcInBhc3N3b3JkXCIpIHtcclxuXHRcdFx0XHR2YWxpZEVsZW1lbnQudG9nZ2xlQ2xhc3MoXCJhbGVydC1ib3ggYWxlcnRcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdHJlc3RyaWN0OiBcIkVcIixcclxuXHRcdHJlcGxhY2U6IHRydWUsXHJcblx0XHR0ZW1wbGF0ZTogXCJcdDxkaXY+IFxcXHJcblx0XHRcdFx0XHRcdDxpbnB1dCB0eXBlPSd0ZXh0JyBuZy1tb2RlbD0nbW9kZWwuaW5wdXQnPiBcXFxyXG5cdFx0XHRcdFx0PC9kaXY+XCIsXHJcblx0XHRjb21waWxlOiBmdW5jdGlvbih0ZW1wbGF0ZUVsZW1lbnQpIHtcclxuXHRcdFx0dGVtcGxhdGVFbGVtZW50LmFwcGVuZCh2YWxpZEVsZW1lbnQpO1xyXG5cdFx0XHRyZXR1cm4gbGluaztcclxuXHRcdH1cclxuXHR9XHJcbn0pXHJcblxyXG5cclxuLmRpcmVjdGl2ZShcInRlbXBsYXRlRnJvbVVybFwiLCBmdW5jdGlvbigpIHtcclxuXHR2YXIgdmFsaWRFbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KFwiPGRpdj57e21vZGVsLmlucHV0fX08L2Rpdj5cIik7XHJcblxyXG5cdHRoaXMubGluayA9IGZ1bmN0aW9uKHNjb3BlKSB7XHJcblx0XHRzY29wZS4kd2F0Y2goXCJtb2RlbC5pbnB1dFwiLCBmdW5jdGlvbiAodmFsdWUpIHtcclxuXHRcdFx0aWYgKHZhbHVlID09PSBcInBhc3N3b3JkXCIpIHtcclxuXHRcdFx0XHR2YWxpZEVsZW1lbnQudG9nZ2xlQ2xhc3MoXCJhbGVydC1ib3ggYWxlcnRcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdHJlc3RyaWN0OiBcIkVcIixcclxuXHRcdHJlcGxhY2U6IHRydWUsXHJcblx0XHRzY29wZToge30sXHJcblx0XHR0ZW1wbGF0ZVVybDogXCJ0ZXN0VGVtcGxhdGUuaHRtbFwiLFxyXG5cdFx0Y29tcGlsZTogZnVuY3Rpb24odGVtcGxhdGVFbGVtZW50KSB7XHJcblx0XHRcdHRlbXBsYXRlRWxlbWVudC5hcHBlbmQodmFsaWRFbGVtZW50KTtcclxuXHRcdFx0cmV0dXJuIGxpbms7XHJcblx0XHR9XHJcblx0fVxyXG59KVxyXG5cclxuXHJcblxyXG4uZGlyZWN0aXZlKFwiY291bnRyeVwiLCBmdW5jdGlvbigpIHtcclxuXHRyZXR1cm4ge1xyXG5cdFx0cmVzdHJpY3Q6IFwiRVwiLFxyXG5cdFx0Y29udHJvbGxlcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHRoaXMubWFrZUFubm91bmNlbWVudCA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIkNvdW50cnkgc2F5czogXCIgKyBtZXNzYWdlKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxufSlcclxuLmRpcmVjdGl2ZShcImNpdHlcIiwgZnVuY3Rpb24oKSB7XHJcblx0cmV0dXJuIHtcclxuXHRcdHJlc3RyaWN0OiBcIkVcIixcclxuXHRcdHJlcXVpcmU6IFwiXmNvdW50cnlcIixcclxuXHRcdGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY291bnRyeUNvbnRyb2xsZXIpIHtcclxuXHRcdFx0Y291bnRyeUNvbnRyb2xsZXIubWFrZUFubm91bmNlbWVudChcIkRvIHRoaW5ncyFcIik7XHJcblx0XHR9XHJcblx0fVxyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGRlZmVyRXhhbXBsZXMoKSB7XHJcblx0dmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuXHRkZWZlci5wcm9taXNlLnRoZW4oZnVuY3Rpb24oKSB7XHJcblxyXG5cdH0pO1xyXG5cdGRlZmVyLnJlc29sdmUoKTtcclxuXHJcblx0Ly8gcmVxdWVzdHNcclxuXHQkaHR0cC5nZXQoXCJiYWNrZW5kL2FwaS5waHA/ZW5kcG9pbnQ9L3Rlc3QvdGVzdC9cIilcclxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcblx0XHRcdGNvbnNvbGUubG9nKGRhdGEpO1xyXG5cdFx0fSk7XHJcblxyXG5cdCRodHRwLnBvc3QoXCIvXCIsIHt9KVxyXG5cdFx0LnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSl7XHJcblx0XHRcdC8vY29uc29sZS5sb2coZGF0YSk7XHJcblx0XHR9KVxyXG5cclxuXHQvLyBwcm9taXNlc1xyXG5cdHZhciBvbmUgPSAkcS5kZWZlcigpO1xyXG5cdHZhciB0d28gPSAkcS5kZWZlcigpO1xyXG5cdHZhciB0aHIgPSAkcS5kZWZlcigpO1xyXG5cclxuXHR2YXIgc3VjY2VzcyA9IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdGNvbnNvbGUubG9nKGRhdGEpO1xyXG5cdH1cclxuXHR2YXIgYWxsID0gJHEuYWxsKFtvbmUucHJvbWlzZSwgdHdvLnByb21pc2UsIHRoci5wcm9taXNlXSk7XHJcblx0YWxsLnRoZW4oc3VjY2Vzcyk7XHJcblxyXG5cdG9uZS5wcm9taXNlLnRoZW4oc3VjY2Vzcyk7XHJcblx0dHdvLnByb21pc2UudGhlbihzdWNjZXNzKTtcclxuXHR0aHIucHJvbWlzZS50aGVuKHN1Y2Nlc3MpO1xyXG5cclxuXHQkdGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdG9uZS5yZXNvbHZlKFwib25lIGRvbmVcIik7XHJcblx0fSwgTWF0aC5yYW5kb20oKSAqIDEwMDApO1xyXG5cclxuXHQkdGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdHR3by5yZXNvbHZlKFwidHdvIGRvbmVcIik7XHJcblx0fSwgTWF0aC5yYW5kb20oKSAqIDEwMDApO1xyXG5cclxuXHQkdGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdHRoci5yZXNvbHZlKFwidGhyIGRvbmVcIik7XHJcblx0fSwgTWF0aC5yYW5kb20oKSAqIDEwMDApO1xyXG59Ki8iLCJhbmd1bGFyLm1vZHVsZShcIkFwcFwiKVxuXG4uc2VydmljZShcIkFwcFwiLCBbJyRyb290U2NvcGUnLCAnJHN0YXRlJywgJyRsb2NhdGlvbicsICckc3RhdGVQYXJhbXMnLCAnJHRpbWVvdXQnLCAnQXBpJywgJ1VzZXInLCAnUGVyc29uJywgJ1B1YmxpY2F0aW9uJywgJ1BlcnNvbk1vZGFsJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHN0YXRlLCAkbG9jYXRpb24sICRzdGF0ZVBhcmFtcywgJHRpbWVvdXQsIEFwaSwgVXNlciwgUGVyc29uLCBQdWJsaWNhdGlvbiwgUGVyc29uTW9kYWwpIHtcblx0dmFyIHRoID0gdGhpcztcblx0dGhpcy51c2VyID0gbnVsbDtcblxuXHR0aGlzLnBlb3BsZSA9IFtdO1xuXHR0aGlzLnB1YmxpY2F0aW9ucyA9IFtdO1xuXHR0aGlzLnVzZXJzID0gW107XG5cblx0dGhpcy5jb25maWcgPSB7XG5cdFx0c3lzdGVtOiB7XG5cdFx0XHRlbWFpbDogXCJlbWFpbFwiXG5cdFx0fSxcblx0XHR1c2VyOiB7XG5cdFx0XHRnbWFpbDogXCJnbWFpbFwiXG5cdFx0fVxuXHR9O1xuXG5cdHRoaXMubmFtZSA9IFwiaW1wcmVzc1tdXCI7XG5cdHRoaXMuZGVzY3JpcHRpb24gPSBcIkEgc2VydmljZSB0byBoZWxwIHlvdSBpbXByZXNzIHBlb3BsZS5cIjtcblxuXHR0aGlzLnN0YXJ0ID0gZnVuY3Rpb24oKSB7XG5cdFx0QXBpLnJlcXVlc3QoXCIvYXV0aC9jaGVjay9cIilcblx0XHRcdC50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcblxuXHRcdFx0XHRpZiAoZGF0YS5zdWNjZXNzKSB7XG5cdFx0XHRcdFx0Ly9pZiAobG9jYXRpb24uaGFzaCA9PSAnJykge1xuXHRcdFx0XHRcdFx0JHN0YXRlLmdvKCdob21lJyk7XG5cdFx0XHRcdFx0Ly99XG5cdFx0XHRcdFx0dGgudXNlciA9IFVzZXIucG9wdWxhdGUoIGRhdGEudXNlciApWzBdO1xuXHRcdFx0XHRcdHRoLmxvYWQoKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkc3RhdGUuZ28oJ2xvZ2luJyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHR9XG5cblx0dGhpcy5sb2FkID0gZnVuY3Rpb24oKSB7XG5cdFx0QXBpLnJlcXVlc3QoXCIvcGVyc29uL2xpc3QvXCIpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0dGgucGVvcGxlID0gUGVyc29uLnBvcHVsYXRlS2V5ZWQoZGF0YS5wZW9wbGUsICdpZCcpO1xuXHRcdH0pO1xuXHRcdEFwaS5yZXF1ZXN0KFwiL3B1YmxpY2F0aW9uL2xpc3QvXCIpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0dGgucHVibGljYXRpb25zID0gUHVibGljYXRpb24ucG9wdWxhdGVLZXllZChkYXRhLnB1YmxpY2F0aW9ucywgJ2lkJyk7XG5cdFx0fSk7XG5cdFx0QXBpLnJlcXVlc3QoXCIvdXNlci9saXN0L1wiKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdHRoLnVzZXJzID0gVXNlci5wb3B1bGF0ZUtleWVkKGRhdGEudXNlcnMsICdpZCcpO1xuXHRcdH0pO1xuXHR9XG5cblx0dGhpcy5wYXJ0cyA9IFsnJ107XG5cdHRoaXMucGFydCA9IGZ1bmN0aW9uKGluZGV4KSB7XG5cdFx0cmV0dXJuIHRoLnBhcnRzW2luZGV4XSB8fCBmYWxzZTtcblx0fVxuXHR0aGlzLnVwZGF0ZVBhcnRzID0gZnVuY3Rpb24oc3RyKSB7XG5cdFx0Ly9jb25zb2xlLmxvZyhzdHIpO1xuXHRcdHRoLnBhcnRzID0gc3RyLnNwbGl0KCcuJyk7XG5cdFx0Ly9jb25zb2xlLmxvZygnVXBkYXRpbmcgVVJMIHBhcnRzOiAnICsgdGgucGFydHMuam9pbignIC0gJykpO1xuXHR9XG5cdCRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCBvcHRpb25zKXtcblx0XHR0aC51cGRhdGVQYXJ0cyggdG9TdGF0ZS5uYW1lICk7XG5cdH0pO1xuXG59XSk7XG4iLCJhbmd1bGFyLm1vZHVsZShcIkFwcC5BcGlcIiwgWyBdKTtcclxuXHJcbiIsImFuZ3VsYXIubW9kdWxlKFwiQXBwLkFwaVwiKVxuXG4uZmFjdG9yeShcIkFwaVJlc3BvbnNlVHJhbnNmb3JtZXJcIiwgZnVuY3Rpb24oKSB7XG5cdHJldHVybiBmdW5jdGlvbihkYXRhKSB7XG5cdFx0cmV0dXJuIEpTT04ucGFyc2UoZGF0YSk7XG5cdH1cbn0pOyIsImFuZ3VsYXIubW9kdWxlKFwiQXBwLkFwaVwiKVxuXG4uc2VydmljZShcIkFwaVwiLCBbJyRodHRwJywgJyRxJywgJ0FwaVJlc3BvbnNlVHJhbnNmb3JtZXInLCBmdW5jdGlvbigkaHR0cCwgJHEsIEFwaVJlc3BvbnNlVHJhbnNmb3JtZXIpIHtcblxuXHR0aGlzLnJlcXVlc3QgPSBmdW5jdGlvbihlbmRwb2ludCwgZGF0YSkge1xuXHRcdGNvbnNvbGUubG9nKFwiQXBpLnJlcXVlc3QgLSBcIiArIGVuZHBvaW50KTtcblx0XHRpZiAoZGF0YSkgeyBjb25zb2xlLmxvZyhkYXRhKTsgfVxuXG5cdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblx0XHQkaHR0cCh7XG5cdFx0XHRtZXRob2Q6IFwiUE9TVFwiLFxuXHRcdFx0dXJsOiBcImJhY2tlbmQvYXBpLnBocD9lbmRwb2ludD1cIiArIGVuZHBvaW50LFxuXHRcdFx0dHJhbnNmb3JtUmVzcG9uc2U6IEFwaVJlc3BvbnNlVHJhbnNmb3JtZXIsXG5cdFx0XHRkYXRhOiBkYXRhIFxuXHRcdH0pXG5cdFx0XHQuc3VjY2VzcyhmdW5jdGlvbihkYXRhKXtcblx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShkYXRhKTtcblx0XHRcdH0pO1xuXHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuXHR9XG5cbn1dKTsiLCJhbmd1bGFyLm1vZHVsZShcIkFwcC5GaWx0ZXJzXCIsIFsgXSk7XHJcblxyXG4iLCJhbmd1bGFyLm1vZHVsZShcIkFwcC5GaWx0ZXJzXCIpXG5cbi5zZXJ2aWNlKFwiRmlsdGVyc1wiLCBbJyRyb290U2NvcGUnLCAnJHN0YXRlJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHN0YXRlKSB7XG5cblx0dGhpcy5zZWFyY2hUZXh0ID0gJyc7XG5cblx0dGhpcy5yZWNlbnRDb250YWN0ID0gZmFsc2U7XG5cdHRoaXMuaGlnaFByaW9yaXR5ID0gZmFsc2U7XG5cdHRoaXMucGVyc29uYWxDb250YWN0ID0gZmFsc2U7XG5cdHRoaXMuZW1haWxBdHRhY2hlZCA9IGZhbHNlO1xuXHR0aGlzLmFzc2lnbmVkU2VsZiA9IGZhbHNlO1xuXHR0aGlzLm91dE9mRGF0ZSA9IGZhbHNlO1xuXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoXCJBcHAuRmlsdGVyc1wiKS5kaXJlY3RpdmUoXCJpbXByZXNzRmlsdGVyc1wiLCBmdW5jdGlvbigpIHtcclxuXHRyZXR1cm4ge1xyXG5cdFx0cmVzdHJpY3Q6IFwiRVwiLFxyXG5cdFx0dGVtcGxhdGVVcmw6IFwiYXBwL2NvbXBvbmVudHMvZmlsdGVycy9maWx0ZXJzLnRlbXBsYXRlLmh0bWxcIlxyXG5cdH1cclxufSlcclxuIiwiYW5ndWxhci5tb2R1bGUoXCJBcHAuRmlsdGVyc1wiKVxyXG5cclxuLmNvbnRyb2xsZXIoXCJGaWx0ZXJzQ29udHJvbGxlclwiLCBbJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCAnQXBwJywgJ0ZpbHRlcnMnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbG9jYXRpb24sIEFwcCwgRmlsdGVycylcclxue1xyXG5cdCRzY29wZS5GaWx0ZXJzID0gRmlsdGVyc1xyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoXCJBcHAuTW9kZWxcIiwgWyBdKTtcclxuXHJcbiIsImFuZ3VsYXIubW9kdWxlKFwiQXBwLk1vZGVsXCIpXG5cbi5mYWN0b3J5KFwiTW9kZWxcIiwgWyckcm9vdFNjb3BlJywgJyRzdGF0ZScsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzdGF0ZSkge1xuXG5cdHZhciBNb2RlbCA9IHt9O1xuXHRNb2RlbC5jcmVhdGUgPSBmdW5jdGlvbihjb25zdHJ1Y3Rvcikge1xuXG5cdFx0Y29uc3RydWN0b3IucHJvdG90eXBlLmluaXRQcmlvcml0aWVzID0gZnVuY3Rpb24oZmllbGQpIHtcblx0XHRcdC8vIFByaW9yaXRpZXM6XG5cdFx0XHQvLyAxPTMsMj0xXG5cdFx0XHQvL2NvbnNvbGUubG9nKHRoaXMuZmllbGQoJ3ByaW9yaXRpZXMnKSk7XG5cdFx0XHR2YXIgdHh0ID0gdGhpcy5maWVsZChmaWVsZCk7XG5cdFx0XHRpZiAodHlwZW9mIHR4dCA9PSAndW5kZWZpbmVkJyB8fCB0eHQubGVuZ3RoID09IDApIHtcblx0XHRcdFx0dGhpc1sncHJpb3JpdHlfJyArICRyb290U2NvcGUuQXBwLnVzZXIuZ2FtZV0gPSAwO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHR2YXIgcHJpcyA9IHR4dC5zcGxpdChcIixcIik7XG5cdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgcHJpcy5sZW5ndGg7ICsraSkge1xuXHRcdFx0XHR2YXIgYml0cyA9IHByaXNbaV0uc3BsaXQoXCI9XCIpO1xuXHRcdFx0XHR2YXIgZ2FtZV9pZCA9IGJpdHNbMF07XG5cdFx0XHRcdHZhciBnYW1lX3ByaW9yaXR5ID0gYml0c1sxXTtcblx0XHRcdFx0dGhpc1sncHJpb3JpdHlfJyArIGdhbWVfaWRdID0gZ2FtZV9wcmlvcml0eTtcblx0XHRcdH1cblx0XHR9XG5cdFx0Y29uc3RydWN0b3IucHJvdG90eXBlLnByaW9yaXR5ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgcmV0ID0gdGhpc1sncHJpb3JpdHlfJyArICRyb290U2NvcGUuQXBwLnVzZXIuZ2FtZV07XG5cdFx0XHRpZiAodHlwZW9mIHJldCA9PSAndW5kZWZpbmVkJykge1xuXHRcdFx0XHRyZXR1cm4gMDtcblx0XHRcdH1cblx0XHRcdHJldHVybiByZXQ7XG5cdFx0fVxuXG5cdFx0Y29uc3RydWN0b3IucHJvdG90eXBlLm9uQWRkZWQgPSBmdW5jdGlvbigpIHtcblxuXHRcdH1cblx0XHRjb25zdHJ1Y3Rvci5wcm90b3R5cGUub25SZW1vdmVkID0gZnVuY3Rpb24oKSB7XG5cblx0XHR9XG5cdFx0Y29uc3RydWN0b3IucHJvdG90eXBlLmZpZWxkID0gZnVuY3Rpb24oZikge1xuXHRcdFx0dmFyIHIgPSB0aGlzW2ZdO1xuXHRcdFx0aWYgKHIgPT0gbnVsbCkgeyBjb25zb2xlLmVycm9yKFwiZmllbGQgXCIgKyBmICsgXCIgd2FzIG51bGwuXCIpOyBjb25zb2xlLmVycm9yKHRoaXMuZmllbGRzKTsgcmV0dXJuIFwiXCI7IH1cblx0XHRcdHJldHVybiByO1xuXHRcdH1cblxuXHRcdGNvbnN0cnVjdG9yLnBvcHVsYXRlS2V5ZWQgPSBmdW5jdGlvbihyb3dzLCBrZXkpIHtcblx0XHRcdHZhciBtb2RlbHMgPSB7fTtcblx0XHRcdGlmICggcm93cyAmJiBhbmd1bGFyLmlzQXJyYXkoIHJvd3MgKSAmJiByb3dzLmxlbmd0aCApIHtcblx0XHRcdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7ICsraSApIHtcblx0XHRcdFx0XHRtb2RlbHNbcm93c1tpXVtrZXldXSA9IG5ldyBjb25zdHJ1Y3Rvciggcm93c1tpXSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKHJvd3MgJiYgYW5ndWxhci5pc09iamVjdChyb3dzKSApIHtcblx0XHRcdFx0bW9kZWxzW3Jvd3Nba2V5XV0gPSBuZXcgY29uc3RydWN0b3IoIHJvd3MgKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBtb2RlbHM7XG5cdFx0fVxuXHRcdGNvbnN0cnVjdG9yLnBvcHVsYXRlID0gZnVuY3Rpb24ocm93cykge1xuXHRcdFx0dmFyIG1vZGVscyA9IFtdO1xuXHRcdFx0aWYgKCByb3dzICYmIGFuZ3VsYXIuaXNBcnJheSggcm93cyApICYmIHJvd3MubGVuZ3RoICkge1xuXHRcdFx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCByb3dzLmxlbmd0aDsgKytpICkge1xuXHRcdFx0XHRcdG1vZGVscy5wdXNoKCBuZXcgY29uc3RydWN0b3IoIHJvd3NbaV0gKSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKHJvd3MgJiYgYW5ndWxhci5pc09iamVjdChyb3dzKSApIHtcblx0XHRcdFx0bW9kZWxzLnB1c2goIG5ldyBjb25zdHJ1Y3Rvciggcm93cyApIClcblx0XHRcdH1cblx0XHRcdHJldHVybiBtb2RlbHM7XG5cdFx0fVxuXHRcdHJldHVybiBjb25zdHJ1Y3Rvcjtcblx0fVxuXG5cdHJldHVybiBNb2RlbDtcblxufV0pOyIsImFuZ3VsYXIubW9kdWxlKFwiQXBwLlBlcnNvblwiLCBbIF0pO1xyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoXCJBcHAuUGVyc29uXCIpXG5cbi5kaXJlY3RpdmUoXCJpbXByZXNzUGVyc29uUm93XCIsIFsnUGVyc29uTW9kYWwnLCBmdW5jdGlvbihQZXJzb25Nb2RhbCkge1xuXHRyZXR1cm4ge1xuXHRcdHJlc3RyaWN0OiAnQScsXG5cdFx0dGVtcGxhdGVVcmw6ICdhcHAvY29tcG9uZW50cy9wZXJzb24vcm93LnRlbXBsYXRlLmh0bWwnLFxuXHRcdGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuXHRcdFx0Ly9lbGVtZW50LmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHQvL1x0UGVyc29uTW9kYWwub3Blbiggc2NvcGUucGVyc29uICk7XG5cdFx0XHQvL30pXG5cdFx0fVxuXHR9XG59XSlcbiIsImFuZ3VsYXIubW9kdWxlKFwiQXBwLlBlcnNvblwiKVxuXG4uZmFjdG9yeShcIlBlcnNvblwiLCBbJyRyb290U2NvcGUnLCAnJHN0YXRlJywgJyRjb21waWxlJywgJ01vZGVsJywgJ0ZpbHRlcnMnLCAnUGVyc29uTW9kYWwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc3RhdGUsICRjb21waWxlLCBNb2RlbCwgRmlsdGVycywgUGVyc29uTW9kYWwpIHtcblxuXHRmdW5jdGlvbiBQZXJzb24oZGF0YSkge1xuXHRcdGFuZ3VsYXIuZXh0ZW5kKCB0aGlzLCBNb2RlbCApO1xuXHRcdGlmIChkYXRhKSB7XG5cdFx0XHRhbmd1bGFyLmV4dGVuZCggdGhpcywgZGF0YSApO1xuXHRcdH1cblxuXHRcdHRoaXMudHdpdHRlcl9mb2xsb3dlcnNfZm9ybWF0dGVkID0gbmV3IE51bWJlcihkYXRhLnR3aXR0ZXJfZm9sbG93ZXJzKS50b0xvY2FsZVN0cmluZygpO1xuXHRcdHRoaXMubW9kYWwgPSBQZXJzb25Nb2RhbDtcblx0fVxuXG5cdFBlcnNvbi5wcm90b3R5cGUudGVzdEZ1bmN0aW9uID0gZnVuY3Rpb24oKSB7XG5cblx0fVxuXG5cblxuXG5cdFBlcnNvbi5wcm90b3R5cGUuZnVsbG5hbWUgPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpc1tcImZpcnN0bmFtZVwiXSArIFwiIFwiICsgdGhpc1tcInN1cm5hbWVzXCJdO1xuXHR9XG5cblx0UGVyc29uLnByb3RvdHlwZS5zZWFyY2ggPSBmdW5jdGlvbih0ZXh0KSB7XG5cdFx0dmFyIHJldCA9IHRydWU7XG5cblx0XHRpZiAodGV4dC5sZW5ndGggPT0gMCkgeyByZXR1cm4gcmV0OyB9XG5cblx0XHRyZXQgPSB0aGlzLmZ1bGxuYW1lKCkudG9Mb3dlckNhc2UoKS5pbmRleE9mKHRleHQpICE9IC0xO1xuXHRcdGlmIChyZXQpIHsgcmV0dXJuIHJldDsgfVxuXG5cdFx0cmV0ID0gdGhpc1snbm90ZXMnXS50b0xvd2VyQ2FzZSgpLmluZGV4T2YodGV4dCkgIT0gLTE7XG5cdFx0aWYgKHJldCkgeyByZXR1cm4gcmV0OyB9XG5cblx0XHRyZXQgPSB0aGlzWydlbWFpbCddLnRvTG93ZXJDYXNlKCkuaW5kZXhPZih0ZXh0KSAhPSAtMTtcblx0XHRpZiAocmV0KSB7IHJldHVybiByZXQ7IH1cblxuXHRcdC8vIFNlYXJjaCBhbGwgcHVibGljYXRpb25zIHRvby5cblx0XHQvKnZhciBsZW4gPSBpbXByZXNzbGlzdC5wZXJzb25QdWJsaWNhdGlvbnMubGVuZ3RoO1xuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuXHRcdFx0aWYgKGltcHJlc3NsaXN0LnBlcnNvblB1YmxpY2F0aW9uc1tpXS5maWVsZHNbJ3BlcnNvbiddID09IHRoaXMuaWQpIHtcblx0XHRcdFx0dmFyIHB1YiA9IGltcHJlc3NsaXN0LmZpbmRQdWJsaWNhdGlvbkJ5SWQoIGltcHJlc3NsaXN0LnBlcnNvblB1YmxpY2F0aW9uc1tpXS5maWVsZHNbJ3B1YmxpY2F0aW9uJ10gKTtcblx0XHRcdFx0cmV0ID0gcHViLnNlYXJjaCh0ZXh0KTtcblx0XHRcdFx0aWYgKHJldCkgeyByZXR1cm4gcmV0OyB9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gU2VhcmNoIGFsbCB5b3V0dWJlIGNoYW5uZWxzIHRvby5cblx0XHRsZW4gPSBpbXByZXNzbGlzdC5wZXJzb25Zb3V0dWJlQ2hhbm5lbHMubGVuZ3RoO1xuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuXHRcdFx0aWYgKGltcHJlc3NsaXN0LnBlcnNvbllvdXR1YmVDaGFubmVsc1tpXS5maWVsZHNbJ3BlcnNvbiddID09IHRoaXMuaWQpIHtcblx0XHRcdFx0dmFyIHB1YiA9IGltcHJlc3NsaXN0LmZpbmRZb3V0dWJlckJ5SWQoIGltcHJlc3NsaXN0LnBlcnNvbllvdXR1YmVDaGFubmVsc1tpXS5maWVsZHNbJ3lvdXR1YmVyJ10gKTtcblx0XHRcdFx0cmV0ID0gcHViLnNlYXJjaCh0ZXh0KTtcblx0XHRcdFx0aWYgKHJldCkgeyByZXR1cm4gcmV0OyB9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdCovXG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXG5cdFBlcnNvbi5wcm90b3R5cGUudmlzaWJsZSA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0aWYgKEZpbHRlcnMuc2VhcmNoVGV4dC5sZW5ndGggPiAwICYmICF0aGlzLnNlYXJjaChGaWx0ZXJzLnNlYXJjaFRleHQpKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYgKEZpbHRlcnMucmVjZW50Q29udGFjdCAmJiBOdW1iZXIodGhpc1snbGFzdGNvbnRhY3RlZCddKSA8IChEYXRlLm5vdygpLzEwMDApIC0gKDg2NDAwKjcpKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYgKEZpbHRlcnMuaGlnaFByaW9yaXR5ICYmIHRoaXMucHJpb3JpdHkoKSA8IDMpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRpZiAoRmlsdGVycy5lbWFpbEF0dGFjaGVkICYmIHRoaXNbJ2VtYWlsJ10ubGVuZ3RoID09IDApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRpZiAoRmlsdGVycy5hc3NpZ25lZFNlbGYgJiYgdGhpc1snYXNzaWduZWQnXSAhPSAkcm9vdFNjb3BlLkFwcC51c2VyLmlkICkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdGlmIChGaWx0ZXJzLm91dE9mRGF0ZSAmJiB0aGlzWydvdXRvZmRhdGUnXSA9PSAwKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYgKEZpbHRlcnMucGVyc29uYWxDb250YWN0ICYmIHRoaXMubGFzdGNvbnRhY3RlZGJ5X21lID09IG51bGwpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cblx0cmV0dXJuIE1vZGVsLmNyZWF0ZSggUGVyc29uICk7XG5cbn1dKVxuXG5cbi5maWx0ZXIoXCJwZXJzb25BcnJheUZpbHRlclwiLCBmdW5jdGlvbigpIHtcblxuXHRyZXR1cm4gZnVuY3Rpb24oaW5wdXQpIHtcblx0XHR2YXIgb3V0ID0ge307XG5cdFx0YW5ndWxhci5mb3JFYWNoKGlucHV0LCBmdW5jdGlvbihwZXJzb24pIHtcblx0XHRcdGlmIChwZXJzb24udmlzaWJsZSgpKSB7XG5cdFx0XHRcdG91dFtwZXJzb24uaWRdID0gcGVyc29uO1xuXHRcdFx0fVxuXHQgICAgfSk7XG5cdFx0cmV0dXJuIG91dDtcblx0fVxuXG59KTtcblxuXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoXCJBcHAuUGVyc29uXCIpXG5cbi5zZXJ2aWNlKFwiUGVyc29uTW9kYWxcIiwgWyckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHJvb3RTY29wZSlcbntcblx0dmFyIHNlcnZpY2UgPSB7XG5cdFx0cGVyc29uOiBudWxsLFxuXHRcdG9wZW46IGZ1bmN0aW9uKHBlcnNvbikge1xuXHRcdFx0c2VydmljZS5wZXJzb24gPSBwZXJzb247XG5cdFx0XHQkcm9vdFNjb3BlLiRicm9hZGNhc3QoICdQZXJzb25Nb2RhbC5vcGVuJywgcGVyc29uICk7XG5cblx0XHRcdCQoJy5wZXJzb25fbW9kYWwnKS5tb2RhbCh7c2hvdzp0cnVlfSk7XG5cdFx0fSxcblx0XHRjbG9zZTogZnVuY3Rpb24oKSB7XG5cdFx0XHQkKCcucGVyc29uX21vZGFsJykubW9kYWwoJ2hpZGUnKTtcblx0XHR9LFxuXHRcdGVtYWlsQ2xpZW50TGluazogZnVuY3Rpb24oZW1haWwpIHtcblx0XHRcdHJldHVybiBpbXByZXNzbGlzdC51dGlsLm1haWx0b0NsaWVudChkZWZhdWx0RW1haWwsIGVtYWlsU3ViamVjdCwgZW1haWxCb2R5LCBlbWFpbEJDQyk7XG5cdFx0fSxcblx0XHRlbWFpbEdtYWlsTGluazogZnVuY3Rpb24oZW1haWwpIHtcblx0XHRcdHJldHVybiBpbXByZXNzbGlzdC51dGlsLm1haWx0b0dtYWlsKGRlZmF1bHRFbWFpbCwgZW1haWxTdWJqZWN0LCBlbWFpbEJvZHksIGVtYWlsQkNDLCBlbWFpbEdtYWlsSW5kZXgpO1xuXHRcdH1cblx0fTtcblxuXHRyZXR1cm4gc2VydmljZTtcbn1dKVxuXG4uZmlsdGVyKFwiZW1haWxBcnJheUZpbHRlclwiLCBmdW5jdGlvbigpIHtcblx0cmV0dXJuIGZ1bmN0aW9uKGlucHV0KSB7XG5cdFx0dmFyIG91dCA9IFtdO1xuXHRcdGFuZ3VsYXIuZm9yRWFjaChpbnB1dCwgZnVuY3Rpb24oZW1haWwpIHtcblx0XHRcdGlmIChlbWFpbC5lbWFpbC5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdG91dC5wdXNoKGVtYWlsKTtcblx0XHRcdH1cblx0ICAgIH0pO1xuXHRcdHJldHVybiBvdXQ7XG5cdH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZShcIkFwcC5QZXJzb25cIilcblxuLmNvbnRyb2xsZXIoXCJQZXJzb25Nb2RhbENvbnRyb2xsZXJcIiwgWyckc2NvcGUnLCAnUGVyc29uTW9kYWwnLCBmdW5jdGlvbigkc2NvcGUsIFBlcnNvbk1vZGFsKSB7XG5cblx0JHNjb3BlLiRvbihcIlBlcnNvbk1vZGFsLm9wZW5cIiwgZnVuY3Rpb24oZXZlbnQpIHtcblx0XHQkc2NvcGUucGVyc29uID0gUGVyc29uTW9kYWwucGVyc29uO1xuXHRcdC8vJHNjb3BlLiRhcHBseSgpO1xuXHR9KVxuXG5cdCRzY29wZS5wZXJzb24gPSBQZXJzb25Nb2RhbC5wZXJzb247XG5cbn1dKSIsImFuZ3VsYXIubW9kdWxlKFwiQXBwLlByaW9yaXR5XCIsIFtdKTsiLCJhbmd1bGFyLm1vZHVsZShcIkFwcC5Qcmlvcml0eVwiKS5kaXJlY3RpdmUoXCJpbXByZXNzUHJpb3JpdHlOYW1lXCIsIGZ1bmN0aW9uKCkge1xuIFx0cmV0dXJuIHtcbiBcdFx0cmVzdHJpY3Q6IFwiQVwiLFxuIFx0XHRzY29wZToge1xuIFx0XHRcdHByaW9yaXR5OiBcIkBcIlxuIFx0XHR9LFxuIFx0XHRjb250cm9sbGVyOiBbJyRzY29wZScsICckZWxlbWVudCcsIGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQpIHtcbiBcdFx0XHQkc2NvcGUubmFtZSA9ICRlbGVtZW50LmF0dHIoJ3ByaW9yaXR5Jyk7XG4gXHRcdH1dLFxuIFx0XHQvKmxpbms6IGZ1bmN0aW9uKHNjb3BlLCBpRWxlbWVudCwgaUF0dHJzKSB7XG5cblx0ICAgICAgaUF0dHJzLiRvYnNlcnZlKCdwcmlvcml0eScsIGZ1bmN0aW9uKHYpIHtcblxuXHQgICAgICAgIHZhciBzdiA9IFwiXCI7XG5cdCAgICAgIFx0aWYgKHYgPT0gMCkge1xuXHRcdFx0XHRzdiA9IFwiTi9BXCI7XG5cdFx0XHR9IGVsc2UgaWYgKHYgPT0gMSkge1xuXHRcdFx0XHRzdiA9IFwiTG93XCI7XG5cdFx0XHR9IGVsc2UgaWYgKHYgPT0gMikge1xuXHRcdFx0XHRzdiA9IFwiTWVkaXVtXCI7XG5cdFx0XHR9IGVsc2UgaWYgKHYgPT0gXCIzXCIpIHtcblx0XHRcdFx0c3YgPSBcIkhpZ2hcIjtcblx0XHRcdH1cblx0ICAgICAgICBzY29wZS52YWwgPSBzdjtcblx0ICAgICAgICBjb25zb2xlLmxvZyhzdik7XG5cdCAgICAgIH0pO1xuXHQgICAgfSwqL1xuIFx0XHR0ZW1wbGF0ZTogXCI8dGQ+e3sgJHNjb3BlLm5hbWUgfX08L3RkPlwiXG4gXHR9XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoXCJBcHAuUHVibGljYXRpb25cIiwgWyBdKTtcclxuIiwiYW5ndWxhci5tb2R1bGUoXCJBcHAuUHVibGljYXRpb25cIilcblxuLmZhY3RvcnkoXCJQdWJsaWNhdGlvblwiLCBbJyRyb290U2NvcGUnLCAnJHN0YXRlJywgJ01vZGVsJywgJ0ZpbHRlcnMnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc3RhdGUsIE1vZGVsLCBGaWx0ZXJzKSB7XG5cblx0ZnVuY3Rpb24gUHVibGljYXRpb24oZGF0YSkge1xuXHRcdGFuZ3VsYXIuZXh0ZW5kKCB0aGlzLCBNb2RlbCApO1xuXHRcdGlmIChkYXRhKSB7XG5cdFx0XHRhbmd1bGFyLmV4dGVuZCggdGhpcywgZGF0YSApO1xuXHRcdH1cblxuXHRcdHRoaXMudHdpdHRlcl9mb2xsb3dlcnNfZm9ybWF0dGVkID0gbmV3IE51bWJlcihkYXRhLnR3aXR0ZXJfZm9sbG93ZXJzKS50b0xvY2FsZVN0cmluZygpO1xuXHR9XG5cblx0UHVibGljYXRpb24ucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbigpIHtcblx0XHRjb25zb2xlLmxvZygnb3BlbicpO1xuXHR9XG5cblx0UHVibGljYXRpb24ucHJvdG90eXBlLnNlYXJjaCA9IGZ1bmN0aW9uKHRleHQpIHtcblx0XHR2YXIgcmV0ID0gdHJ1ZTtcblxuXHRcdGlmICh0ZXh0Lmxlbmd0aCA9PSAwKSB7IHJldHVybiByZXQ7IH1cblxuXHRcdHJldCA9IHRoaXMubmFtZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YodGV4dCkgIT0gLTE7XG5cdFx0aWYgKHJldCkgeyByZXR1cm4gcmV0OyB9XG5cblx0XHRyZXQgPSB0aGlzWydub3RlcyddLnRvTG93ZXJDYXNlKCkuaW5kZXhPZih0ZXh0KSAhPSAtMTtcblx0XHRpZiAocmV0KSB7IHJldHVybiByZXQ7IH1cblxuXHRcdC8vcmV0ID0gdGhpc1snZW1haWwnXS50b0xvd2VyQ2FzZSgpLmluZGV4T2YodGV4dCkgIT0gLTE7XG5cdFx0Ly9pZiAocmV0KSB7IHJldHVybiByZXQ7IH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cblx0UHVibGljYXRpb24ucHJvdG90eXBlLnZpc2libGUgPSBmdW5jdGlvbigpIHtcblxuXHRcdGlmIChGaWx0ZXJzLnNlYXJjaFRleHQubGVuZ3RoID4gMCAmJiAhdGhpcy5zZWFyY2goRmlsdGVycy5zZWFyY2hUZXh0KSkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdGlmIChGaWx0ZXJzLnJlY2VudENvbnRhY3QgJiYgTnVtYmVyKHRoaXNbJ2xhc3Rjb250YWN0ZWQnXSkgPCAoRGF0ZS5ub3coKS8xMDAwKSAtICg4NjQwMCo3KSkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdGlmIChGaWx0ZXJzLmhpZ2hQcmlvcml0eSAmJiB0aGlzLnByaW9yaXR5KCkgPCAzKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYgKEZpbHRlcnMuZW1haWxBdHRhY2hlZCAmJiB0aGlzWydlbWFpbCddLmxlbmd0aCA9PSAwKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYgKEZpbHRlcnMuYXNzaWduZWRTZWxmICYmIHRoaXNbJ2Fzc2lnbmVkJ10gIT0gJHJvb3RTY29wZS5BcHAudXNlci5pZCApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRpZiAoRmlsdGVycy5vdXRPZkRhdGUgJiYgdGhpc1snb3V0b2ZkYXRlJ10gPT0gMCkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdGlmIChGaWx0ZXJzLnBlcnNvbmFsQ29udGFjdCAmJiB0aGlzLmxhc3Rjb250YWN0ZWRieV9tZSA9PSBudWxsKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblxuXG5cdHJldHVybiBNb2RlbC5jcmVhdGUoIFB1YmxpY2F0aW9uICk7XG5cbn1dKVxuXG5cbi5maWx0ZXIoXCJwdWJsaWNhdGlvbkFycmF5RmlsdGVyXCIsIGZ1bmN0aW9uKCkge1xuXG5cdHJldHVybiBmdW5jdGlvbihpbnB1dCkge1xuXHRcdHZhciBvdXQgPSBbXTtcblx0XHRhbmd1bGFyLmZvckVhY2goaW5wdXQsIGZ1bmN0aW9uKHB1YmxpY2F0aW9uKSB7XG5cdFx0XHRpZiAocHVibGljYXRpb24udmlzaWJsZSgpKSB7XG5cdFx0XHRcdG91dC5wdXNoKHB1YmxpY2F0aW9uKTtcblx0XHRcdH1cblx0ICAgIH0pO1xuXHRcdHJldHVybiBvdXQ7XG5cdH1cblxufSk7XG5cblxuXG5cbiIsImFuZ3VsYXIubW9kdWxlKFwiQXBwLlNoZWxsXCIsIFtdKTsiLCJhbmd1bGFyLm1vZHVsZShcIkFwcC5TaGVsbFwiKS5kaXJlY3RpdmUoXCJpbXByZXNzRm9vdGVyXCIsIGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4ge1xuXHRcdHJlc3RyaWN0OiBcIkVcIixcblx0XHR0ZW1wbGF0ZVVybDogXCJhcHAvY29tcG9uZW50cy9zaGVsbC9mb290ZXIvZm9vdGVyLnRlbXBsYXRlLmh0bWxcIlxuXHR9XG59KSIsImFuZ3VsYXIubW9kdWxlKFwiQXBwLlNoZWxsXCIpLmRpcmVjdGl2ZShcImltcHJlc3NOYXZcIiwgZnVuY3Rpb24oKSB7XG5cdHJldHVybiB7XG5cdFx0cmVzdHJpY3Q6IFwiRVwiLFxuXHRcdHRlbXBsYXRlVXJsOiBcImFwcC9jb21wb25lbnRzL3NoZWxsL25hdi9uYXYudGVtcGxhdGUuaHRtbFwiXG5cdH1cbn0pIiwiYW5ndWxhci5tb2R1bGUoXCJBcHAuU2hlbGxcIilcblxuLmNvbnRyb2xsZXIoXCJOYXZDb250cm9sbGVyXCIsIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsICdBcHAnLCAnRmlsdGVycycsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbiwgQXBwLCBGaWx0ZXJzKVxue1xuXHQvLyRzY29wZS5BcHAgPSBBcHA7XG5cdCRzY29wZS5GaWx0ZXJzID0gRmlsdGVycztcbn1dKVxuIiwiYW5ndWxhci5tb2R1bGUoXCJBcHAuVXNlclwiLCBbIF0pO1xyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoXCJBcHAuVXNlclwiKVxuXG4uZmFjdG9yeShcIlVzZXJcIiwgWyckcm9vdFNjb3BlJywgJyRzdGF0ZScsICdNb2RlbCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzdGF0ZSwgTW9kZWwpIHtcblxuXHRmdW5jdGlvbiBVc2VyKGRhdGEpIHtcblx0XHRpZiAoZGF0YSkge1xuXHRcdFx0YW5ndWxhci5leHRlbmQoIHRoaXMsIGRhdGEgKTtcblx0XHR9XG5cdH1cblxuXHRVc2VyLnByb3RvdHlwZS50ZXN0RnVuY3Rpb24gPSBmdW5jdGlvbigpIHtcblxuXHR9XG5cblx0VXNlci5wcm90b3R5cGUuZnVsbG5hbWUgPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpc1tcImZvcmVuYW1lXCJdICsgXCIgXCIgKyB0aGlzW1wic3VybmFtZVwiXTtcblx0fVxuXG5cdHJldHVybiBNb2RlbC5jcmVhdGUoIFVzZXIgKTtcblxufV0pOyIsImFuZ3VsYXIubW9kdWxlKFwiQXBwLlZpZXdzXCIsIFsgXSk7XG4iLCJhbmd1bGFyLm1vZHVsZShcIkFwcC5WaWV3c1wiKVxuXG4uY29udHJvbGxlcihcIkxvZ2luQ29udHJvbGxlclwiLCBbJyRzY29wZScsICckc3RhdGUnLCAnQXBwJywgJ0FwaScsICdVc2VyJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIEFwcCwgQXBpLCBVc2VyKVxue1xuXHQkc2NvcGUuQXBwID0gQXBwO1xuXHQkc2NvcGUuQXBpID0gQXBpO1xuXG5cdCRzY29wZS5lcnJvcnMgPSBbXTtcblxuXHQkc2NvcGUubG9naW4gPSBmdW5jdGlvbihlbWFpbCwgcGFzc3dvcmQpIHtcblx0XHRBcGkucmVxdWVzdChcIi9hdXRoL2xvZ2luL1wiLCB7ZW1haWw6IGVtYWlsLCBwYXNzd29yZDogcGFzc3dvcmR9KVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0XHQvL2NvbnNvbGUubG9nKGRhdGEpO1xuXHRcdFx0XHQvL2NvbnNvbGUubG9nKGRhdGEuZGF0YS5zdWNjZXNzKTtcblx0XHRcdFx0QXBwLnVzZXIgPSBVc2VyLnBvcHVsYXRlKCBkYXRhLmRhdGEudXNlciApWzBdO1xuXHRcdFx0XHRBcHAubG9hZCgpO1xuXHRcdFx0XHRjb25zb2xlLmxvZyhBcHAudXNlcik7XG5cdFx0XHRcdCRzdGF0ZS5nbygnaG9tZScpO1xuXG5cdFx0XHR9KTtcblx0fVxufV0pXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
